import{u as i,v as t,w as l,x as Oi,y as Ai,z as Nm,D as Cn,H as ki,J as V,K as Sr,L as Ur,N as Tm,O as vm,Q as ot,U as wm,V as Pi,W as Rm,X as ou,Y as Dt,Z as ym,_ as Om,$ as Am,a0 as sn,a1 as an,a2 as Di,a3 as zs,a4 as iu,a5 as lu,a6 as cu,a7 as km,a8 as Pm,a9 as uu,aa as Dm,ab as Mm,ac as du,ad as Ba,ae as mu,af as Lm,ag as Um,ah as gu,ai as li,aj as xm,ak as Fm,al as Gm,am as Bm,an as Vm,ao as Mi,ap as Li,aq as Hm,ar as Wm,as as jm,at as qm,au as gl,av as Ym,aw as zm,ax as To,ay as vo,az as wo,aA as $m}from"./vendor-53e8e451.js";import{N as ls,a as ur,H as $s,M as ye,T as fn,R as te,b as tt,A as gs,c as un,G as Km,d as Q,D as Xm,C as ln,e as Qm,f as He,g as Jm,h as Va,i as tr,j as gr,k as Ui,l as Ha,E as Zm,m as hl,n as Rn,o as Us,p as ht,F as xa,q as xs,S as Ks,r as As,s as eg,t as hu,u as Fs,v as tg,w as ng,x as rg,y as Wa,z as Dn,B as cr,O as fu,V as Rt,I as Ro,P as Is,J as xt,K as Un,U as sg,L as ag,Q as yo,W as pu,X as fr,Y as og,Z as ig,_ as lg,$ as cg,a0 as ug,a1 as dg,a2 as mg,a3 as gg,a4 as hg,a5 as fg,a6 as pg,a7 as Ig,a8 as Iu,a9 as Eg,aa as _g,ab as Cg,ac as bg,ad as Sg,ae as Ng,af as Tg,ag as vg,ah as wg,ai as Rg,aj as yg,ak as Og,al as Ag,am as kg,an as ci,ao as Pg,ap as Eu,aq as Dg,ar as Mg,as as Lg,at as Ug,au as xg,av as Fg,aw as Gg,ax as Bg,ay as Vg,az as Hg,aA as Wg,aB as jg,aC as qg,aD as _u,aE as Yg,aF as zg,aG as $g,aH as fl,aI as Kg,aJ as Xg,aK as Qg,aL as ao,aM as Jg,aN as Zg,aO as Cu,aP as eh,aQ as th,aR as ja,aS as qt,aT as vs,aU as bu,aV as Su,aW as nh,aX as rh,aY as sh,aZ as ah,a_ as oh,a$ as ih,b0 as lh,b1 as ch,b2 as xi,b3 as Ps,b4 as Nu,b5 as pl,b6 as uh,b7 as dh,b8 as mh,b9 as gh,ba as hh,bb as fh,bc as ph,bd as Ih,be as Eh,bf as _h,bg as Ch,bh,bi as Sh,bj as Nh,bk as Th,bl as vh,bm as wh,bn as Rh,bo as yh,bp as Oh,bq as Ah,br as kh,bs as Ph,bt as Dh,bu as Mh,bv as Lh,bw as Uh,bx as xh,by as Fh,bz as Gh,bA as Tu,bB as ui,bC as Bh,bD as vu,bE as Vh,bF as Hh,bG as Wh,bH as jh,bI as qh,bJ as Yh,bK as zh,bL as $h,bM as Kh,bN as Xh,bO as Qh,bP as Jh,bQ as Zh,bR as ef,bS as tf,bT as nf,bU as rf,bV as sf,bW as af,bX as of,bY as lf,bZ as cf,b_ as uf,b$ as df,c0 as mf,c1 as gf,c2 as hf,c3 as ff,c4 as pf,c5 as If,c6 as Ef,c7 as _f,c8 as Cf,c9 as bf,ca as wu,cb as Ru,cc as qa,cd as Sf,ce as Nf,cf as Gs,cg as yu,ch as rt,ci as Tf,cj as vf,ck as wf,cl as Rf,cm as yf,cn as Of,co as Af,cp as kf,cq as Pf,cr as Df,cs as Mf,ct as Oo,cu as Lf,cv as Uf,cw as xf,cx as Ff,cy as Gf,cz as Bf,cA as Il,cB as Vf,cC as Hf,cD as Wr,cE as Wf,cF as jf,cG as pn,cH as pt,cI as qf,cJ as Yf,cK as zf,cL as la,cM as Gn,cN as we,cO as $f,cP as Lt,cQ as Kf,cR as Xf,cS as Qf,cT as Jf,cU as Zf,cV as ep,cW as tp,cX as np,cY as rp,cZ as sp,c_ as ap,c$ as op,d0 as ip,d1 as lp,d2 as cp,d3 as up,d4 as dp,d5 as di,d6 as mp,d7 as gp,d8 as hp,d9 as Ou,da as fp,db as pp,dc as El,dd as Ip,de as Ep,df as _p,dg as Cp,dh as mi,di as bp,dj as Sp,dk as Np,dl as Tp,dm as ca,dn as _l,dp as vp,dq as wp,dr as Rp,ds as yp,dt as Au,du as Op,dv as ku,dw as Ap,dx as Pu,dy as kp,dz as Pp,dA as Dp,dB as Mp,dC as Cl,dD as wn,dE as Du,dF as gi,dG as Jn,dH as bl,dI as Sl,dJ as It,dK as vr,dL as Lp,dM as Up,dN as xp,dO as Fp,dP as Ao,dQ as Gp,dR as Nl,dS as Tl,dT as Bp,dU as ko,dV as Po,dW as Vp,dX as Mu,dY as Hp,dZ as ua,d_ as Wp,d$ as Lu,e0 as jp,e1 as qp,e2 as Yp,e3 as zp,e4 as $p,e5 as Kp,e6 as Xp,e7 as Qp,e8 as Do,e9 as Jp,ea as Zp,eb as eI,ec as tI,ed as nI,ee as rI,ef as Uu,eg as sI,eh as aI,ei as oI,ej as iI,ek as lI,el as Ds,em as cI,en as uI,eo as dI,ep as mI,eq as vl,er as gI,es as hI,et as fI,eu as pI,ev as II,ew as EI,ex as wl,ey as _I,ez as CI,eA as bI,eB as SI,eC as NI,eD as TI,eE as vI,eF as wI,eG as RI,eH as yI,eI as xu,eJ as OI,eK as AI,eL as kI,eM as PI,eN as DI,eO as Fu,eP as MI,eQ as LI,eR as UI,eS as xI,eT as FI,eU as GI,eV as BI,eW as VI,eX as HI,eY as WI,eZ as jI,e_ as qI,e$ as YI,f0 as zI,f1 as $I,f2 as KI,f3 as XI,f4 as Fi,f5 as Xs,f6 as QI,f7 as Mo,f8 as JI,f9 as Rl,fa as ZI,fb as eE,fc as Xt,fd as tE,fe as nE,ff as rE,fg as sE,fh as aE,fi as oE,fj as iE,fk as lE,fl as cE,fm as uE,fn as dE,fo as mE,fp as gE,fq as hE,fr as fE,fs as pE,ft as Gu,fu as yl,fv as Bu,fw as IE,fx as EE,fy as _E,fz as CE,fA as bE,fB as SE,fC as NE,fD as TE,fE as vE,fF as Hn,fG as wE,fH as RE,fI as yE,fJ as OE,fK as AE,fL as kE,fM as PE,fN as DE,fO as ME,fP as LE,fQ as UE,fR as xE,fS as FE,fT as GE,fU as BE,fV as VE,fW as HE,fX as WE,fY as Ol,fZ as jE,f_ as qE,f$ as YE,g0 as zE,g1 as $E,g2 as KE,g3 as da,g4 as Al,g5 as XE,g6 as QE,g7 as ma,g8 as Vu,g9 as JE,ga as Lo,gb as ZE,gc as e_,gd as t_,ge as Hu,gf as n_,gg as r_,gh as s_,gi as a_,gj as o_,gk as i_,gl as l_,gm as c_,gn as u_,go as d_,gp as m_,gq as g_,gr as h_,gs as Es,gt as f_,gu as kl,gv as p_,gw as I_,gx as E_,gy as Wu,gz as __,gA as C_,gB as b_,gC as S_,gD as N_,gE as T_,gF as v_,gG as w_,gH as R_,gI as y_,gJ as O_,gK as A_,gL as ju,gM as k_,gN as qu,gO as P_,gP as D_,gQ as M_,gR as L_,gS as lr,gT as Uo,gU as U_,gV as Pl,gW as x_,gX as F_,gY as Gi,gZ as Yu,g_ as xn,g$ as G_,h0 as B_,h1 as V_,h2 as zu,h3 as $u,h4 as H_,h5 as W_,h6 as j_,h7 as Ku,h8 as q_,h9 as Y_,ha as z_,hb as $_,hc as K_,hd as X_,he as Q_,hf as J_,hg as Z_,hh as eC,hi as tC,hj as nC,hk as ga,hl as mt,hm as rC,hn as xo,ho as Dl,hp as sC,hq as aC,hr as oC,hs as iC,ht as lC,hu as cC,hv as uC,hw as dC,hx as mC,hy as gC,hz as hC,hA as fC,hB as pC,hC as IC,hD as Ml,hE as Kn,hF as ha}from"./nitro-renderer-86c28025.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))r(o);new MutationObserver(o=>{for(const s of o)if(s.type==="childList")for(const c of s.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&r(c)}).observe(document,{childList:!0,subtree:!0});function n(o){const s={};return o.integrity&&(s.integrity=o.integrity),o.referrerPolicy&&(s.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?s.credentials="include":o.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(o){if(o.ep)return;o.ep=!0;const s=n(o);fetch(o.href,s)}})();function _e(){return ls.instance}function _t(a){_e().addLinkEventTracker(a)}function Nt(){return _e().avatar}function Ll(a){return Nt().structureData.getPalette(a)}function Ul(a){return Nt().structureData.getSetType(a)}function Ms(){return _e().cameraManager}function EC(){return _e().core}function _C(){return EC().configuration}function ee(a){a=a.startsWith("event:")?a.substring(6):a,_e().createLinkEvent(a)}function Bs(){var a;return(a=_e())==null?void 0:a.communication}function K(a,e=null){return ur.getValue(a,e)}function hi(){var a;return(a=Bs())==null?void 0:a.connection}function Xu(){return _e().localization}const Xr=a=>{!a||!a.length||(a.startsWith("http")?$s.openWebPage(a):ee(a))};function Ct(a){_e().removeLinkEventTracker(a)}function q(){return _e().roomEngine}let Fo=!1,fa=0,pa=0;const Ia=(a,e=1)=>{const n=a.clientX,r=a.clientY;let o=a.type;switch(o===ye.MOUSE_CLICK&&(fa&&(pa=1,fa>=Date.now()-300&&pa++),fa=Date.now(),pa===2&&(Fo||(o=ye.DOUBLE_CLICK),pa=0,fa=null)),o){case ye.MOUSE_CLICK:break;case ye.DOUBLE_CLICK:break;case ye.MOUSE_MOVE:Fo=!0;break;case ye.MOUSE_DOWN:Fo=!1;break;case ye.MOUSE_UP:break;case ye.RIGHT_CLICK:break;default:return}q().dispatchMouseEvent(e,n,r,o,a.altKey,a.ctrlKey||a.metaKey,a.shiftKey,!1)};let Go=!1,Ea=0,_a=0;const Ca=(a,e=1,n=!1,r=!1,o=!1,s=!1)=>{let c=0,u=0;a.touches[0]?(c=a.touches[0].clientX,u=a.touches[0].clientY):a.changedTouches[0]&&(c=a.changedTouches[0].clientX,u=a.changedTouches[0].clientY);let m=a.type;switch(n&&(m=fn.TOUCH_LONG),(m===ye.MOUSE_CLICK||m===fn.TOUCH_END)&&(m=ye.MOUSE_CLICK,Ea&&(_a=1,Ea>=Date.now()-300&&_a++),Ea=Date.now(),_a===2&&(Go||(m=ye.DOUBLE_CLICK),_a=0,Ea=null)),m){case ye.MOUSE_CLICK:break;case ye.DOUBLE_CLICK:break;case fn.TOUCH_START:m=ye.MOUSE_DOWN,Go=!1;break;case fn.TOUCH_MOVE:m=ye.MOUSE_MOVE,Go=!0;break;case fn.TOUCH_END:m=ye.MOUSE_UP;break;case fn.TOUCH_LONG:m=ye.MOUSE_DOWN_LONG;break;default:return}m===fn.TOUCH_START&&q().dispatchMouseEvent(e,c,u,m,r,o,s,!1),q().dispatchMouseEvent(e,c,u,m,r,o,s,!1)};function Wt(a){if(!a||!a.model)return!1;const e=H().userId,n=a.model.getValue(te.FURNITURE_OWNER_ID);return e===n}function Vs(a,e,n){return a?a.isRoomOwner||a.controllerLevel>=tt.GUEST||H().isModerator||Wt(q().getRoomObject(a.roomId,e,n)):!1}function Qr(){return _e().roomSessionManager}function jr(a,e=null){Qr().createSession(a,e)}function CC(){const a=Jr();return a?a.model.getValue(te.FIGURE_CAN_STAND_UP):gs.POSTURE_STAND}function Bo(){const a=Jr();if(!a)return!1;const n=a.model.getValue(te.FIGURE_EFFECT);return!(n===29||n===30||n===185)}function H(){return _e().sessionDataManager}function In(){return K("hc.disabled",!1)?un.VIP:H().clubLevel}class rn{}rn.OKAY=0;rn.MISSING_OFFER=1;rn.FURNI_LIMIT_REACHED=2;rn.NOT_IN_ROOM=3;rn.NOT_ROOM_OWNER=4;rn.GUILD_ROOM=5;rn.VISITORS_IN_ROOM=6;class bC{constructor(e,n,r){this._depth=0,this._localization="",this._pageId=-1,this._pageName="",this._iconId=0,this._depth=n,this._parent=r,this._localization=e.localization,this._pageId=e.pageId,this._pageName=e.pageName,this._iconId=e.icon,this._children=[],this._offerIds=e.offerIds,this._isVisible=e.visible,this._isActive=!1,this._isOpen=!1}activate(){this._isActive=!0}deactivate(){this._isActive=!1}open(){this._isOpen=!0}close(){this._isOpen=!1}addChild(e){e&&this._children.push(e)}get depth(){return this._depth}get isBranch(){return this._children.length>0}get isLeaf(){return this._children.length===0}get localization(){return this._localization}get pageId(){return this._pageId}get pageName(){return this._pageName}get iconId(){return this._iconId}get children(){return this._children}get offerIds(){return this._offerIds}get parent(){return this._parent}get isVisible(){return this._isVisible}get isActive(){return this._isActive}get isOpen(){return this._isOpen}}const Qu=class{constructor(a,e,n,r,o,s=-1){this._pageId=a,this._layoutCode=e,this._localization=n,this._offers=r,this._acceptSeasonCurrencyAsCredits=o;for(const c of r)c.page=this;s===-1?this._mode=Qu.MODE_NORMAL:this._mode=s}get pageId(){return this._pageId}get layoutCode(){return this._layoutCode}get localization(){return this._localization}get offers(){return this._offers}get acceptSeasonCurrencyAsCredits(){return this._acceptSeasonCurrencyAsCredits}get mode(){return this._mode}};let Bi=Qu;Bi.MODE_NORMAL=0;class ut{}ut.DUCKET_INFO="ducket_info";ut.CREDITS="credits";ut.AVATAR_EFFECTS="avatar_effects";ut.HC_MEMBERSHIP="hc_membership";ut.CLUB_GIFTS="club_gifts";ut.LIMITED_SOLD="limited_sold";ut.PET_ACCESSORIES="pet_accessories";ut.TRAX_SONGS="trax_songs";ut.NEW_ADDITIONS="new_additions";ut.QUEST_SHELL="quest_shell";ut.QUEST_SNOWFLAKES="quest_snowflakes";ut.VAL_QUESTS="val_quests";ut.GUILD_CUSTOM_FURNI="guild_custom_furni";ut.GIFT_SHOP="gift_shop";ut.HORSE_STYLES="horse_styles";ut.HORSE_SHOE="horse_shoe";ut.SET_EASTER="set_easter";ut.ECOTRON_TRANSFORM="ecotron_transform";ut.LOYALTY_INFO="loyalty_info";ut.ROOM_BUNDLES="room_bundles";ut.ROOM_BUNDLES_MOBILE="room_bundles_mobile";ut.HABBO_CLUB_DESKTOP="habbo_club_desktop";ut.MOBILE_SUBSCRIPTIONS="mobile_subscriptions";class SC{constructor(e,n){this.breed=e,this.palettes=n}}class Be{}Be.NONE=0;Be.CONFIRM=1;Be.PURCHASE=2;Be.NO_CREDITS=3;Be.NO_POINTS=4;Be.SOLD_OUT=5;Be.FAILED=6;class On{}On.NORMAL="NORMAL";On.BUILDER="BUILDERS_CLUB";const NC=a=>"",TC=a=>"",xl=(a,e)=>{const n=a.get(e),r=[];if(n&&n.length)for(const o of n)o.isVisible&&r.push(o);return r},Ju=(a,e,n,r)=>{if(n.isVisible&&n.pageId>0){let o=!1;const s=[n.pageName,n.localization].join(" ").toLowerCase().replace(/ /gi,"");if(s.indexOf(a)>-1&&(r.push(n),o=!0),!o){for(const c of e)if(s.indexOf(c)>=0){r.push(n);break}}}for(const o of n.children)Ju(a,e,o,r)};function vC(a){if(!a.length)return 0;let e=a.length-1;for(;e>=0&&!isNaN(parseInt(a.charAt(e)));)e--;return e>0?parseInt(a.substring(e+1)):-1}function wC(a,e){switch(a){case 0:return[[16743226],[16750435],[16764339],[16094464],[16498012],[16704690],[15586304],[16115545],[16513201],[8694111],[11585939],[14413767],[6664599],[9553845],[12971486],[8358322],[10002885],[13292268],[10780600],[12623573],[14403561],[12418717],[14327229],[15517403],[14515069],[15764368],[16366271],[11250603],[13948116],[16777215],[14256481],[14656129],[15848130],[14005087],[14337152],[15918540],[15118118],[15531929],[9764857],[11258085]];case 1:return[[16743226],[16750435],[16764339],[16094464],[16498012],[16704690],[15586304],[16115545],[16513201],[8694111],[11585939],[14413767],[6664599],[9553845],[12971486],[8358322],[10002885],[13292268],[10780600],[12623573],[14403561],[12418717],[14327229],[15517403],[14515069],[15764368],[16366271],[11250603],[13948116],[16777215],[14256481],[14656129],[15848130],[14005087],[14337152],[15918540],[15118118],[15531929],[9764857],[11258085]];case 2:return[[16579283],[15378351],[8830016],[15257125],[9340985],[8949607],[6198292],[8703620],[9889626],[8972045],[12161285],[13162269],[8620113],[12616503],[8628101],[13827840],[9764857]];case 3:return[[16777215],[15658734],[14540253]];case 4:return[[16777215],[16053490],[15464440],[16248792],[15396319],[15007487]];case 5:return[[16777215],[15658734],[14540253]];case 6:return[[16777215],[15658734],[14540253],[16767177],[16770205],[16751331]];case 7:return[[13421772],[11447982],[16751331],[10149119],[16763290],[16743786]];default:{const n=[];for(const r of e){const o=q().getPetColorResult(a,r.paletteId);o&&(o.primaryColor===o.secondaryColor?n.push([o.primaryColor]):n.push([o.primaryColor,o.secondaryColor]))}return n}}}class ue{}ue.WALL="i";ue.FLOOR="s";ue.EFFECT="e";ue.HABBO_CLUB="h";ue.BADGE="b";ue.GAME_TOKEN="GAME_TOKEN";ue.PET="p";ue.ROBOT="r";const Zu=class{constructor(a,e,n,r,o,s,c=!1,u=0,m=0){this._productType=a.toLowerCase(),this._productClassId=e,this._extraParam=n,this._productCount=r,this._productData=o,this._furnitureData=s,this._isUniqueLimitedItem=c,this._uniqueLimitedItemSeriesSize=u,this._uniqueLimitedItemsLeft=m}static stripAddonProducts(a){return a.length===1?a:a.filter(e=>e.productType!==ue.BADGE&&e.productType!==ue.EFFECT&&e.productClassId!==Zu.EFFECT_CLASSID_NINJA_DISAPPEAR)}getIconUrl(a=null,e=null){switch(this._productType){case ue.FLOOR:return q().getFurnitureFloorIconUrl(this.productClassId);case ue.WALL:{if(a&&this._furnitureData){let n="";switch(this._furnitureData.className){case"floor":n=["th",this._furnitureData.className,a.product.extraParam].join("_");break;case"wallpaper":n=["th","wall",a.product.extraParam].join("_");break;case"landscape":n=["th",this._furnitureData.className,(a.product.extraParam||"").replace(".","_"),"001"].join("_");break}if(n!=="")return`${K("catalog.asset.url")}/${n}.png`}return q().getFurnitureWallIconUrl(this.productClassId,this._extraParam)}case ue.EFFECT:return NC(this.productClassId);case ue.HABBO_CLUB:return TC(this.productClassId);case ue.BADGE:return H().getBadgeUrl(this._extraParam);case ue.ROBOT:return null}return null}get productType(){return this._productType}get productClassId(){return this._productClassId}get extraParam(){return this._extraParam}set extraParam(a){this._extraParam=a}get productCount(){return this._productCount}get productData(){return this._productData}get furnitureData(){return this._furnitureData}get isUniqueLimitedItem(){return this._isUniqueLimitedItem}get uniqueLimitedItemSeriesSize(){return this._uniqueLimitedItemSeriesSize}get uniqueLimitedItemsLeft(){return this._uniqueLimitedItemsLeft}set uniqueLimitedItemsLeft(a){this._uniqueLimitedItemsLeft=a}};let Yr=Zu;Yr.EFFECT_CLASSID_NINJA_DISAPPEAR=108;const Xn=class{constructor(a,e,n,r,o,s,c,u,m,h){this._clubLevel=0,this._bundlePurchaseAllowed=!1,this._offerId=a,this._localizationId=e,this._isRentOffer=n,this._priceInCredits=r,this._priceInActivityPoints=o,this._activityPointType=s,this._giftable=c,this._clubLevel=u,this._products=m,this._bundlePurchaseAllowed=h,this.setPricingModelForProducts(),this.setPricingType();for(const g of m)if(g.productType===ue.BADGE){this._badgeCode=g.extraParam;break}}activate(){}get clubLevel(){return this._clubLevel}get page(){return this._page}set page(a){this._page=a}get offerId(){return this._offerId}get localizationId(){return this._localizationId}get priceInCredits(){return this._priceInCredits}get priceInActivityPoints(){return this._priceInActivityPoints}get activityPointType(){return this._activityPointType}get giftable(){return this._giftable}get product(){if(!this._products||!this._products.length)return null;if(this._products.length===1)return this._products[0];const a=Yr.stripAddonProducts(this._products);return a.length?a[0]:null}get pricingModel(){return this._pricingModel}get priceType(){return this._priceType}get bundlePurchaseAllowed(){return this._bundlePurchaseAllowed}get isRentOffer(){return this._isRentOffer}get badgeCode(){return this._badgeCode}get localizationName(){const a=hs(this._localizationId);return a?a.name:d(this._localizationId)}get localizationDescription(){const a=hs(this._localizationId);return a?a.description:d(this._localizationId)}get isLazy(){return!1}get products(){return this._products}setPricingModelForProducts(){const a=Yr.stripAddonProducts(this._products);a.length===1?a[0].productCount===1?this._pricingModel=Xn.PRICING_MODEL_SINGLE:this._pricingModel=Xn.PRICING_MODEL_MULTI:a.length>1?this._pricingModel=Xn.PRICING_MODEL_BUNDLE:this._pricingModel=Xn.PRICING_MODEL_UNKNOWN}setPricingType(){this._priceInCredits>0&&this._priceInActivityPoints>0?this._priceType=Xn.PRICE_TYPE_CREDITS_ACTIVITYPOINTS:this._priceInCredits>0?this._priceType=Xn.PRICE_TYPE_CREDITS:this._priceInActivityPoints>0?this._priceType=Xn.PRICE_TYPE_ACTIVITYPOINTS:this._priceType=Xn.PRICE_TYPE_NONE}clone(){const a=[],e=hs(this.localizationId);for(const r of this._products){const o=fi(r.productClassId,r.productType);a.push(new Yr(r.productType,r.productClassId,r.extraParam,r.productCount,e,o))}const n=new Xn(this.offerId,this.localizationId,this.isRentOffer,this.priceInCredits,this.priceInActivityPoints,this.activityPointType,this.giftable,this.clubLevel,a,this.bundlePurchaseAllowed);return n.page=this.page,n}};let it=Xn;it.PRICING_MODEL_UNKNOWN="pricing_model_unknown";it.PRICING_MODEL_SINGLE="pricing_model_single";it.PRICING_MODEL_MULTI="pricing_model_multi";it.PRICING_MODEL_BUNDLE="pricing_model_bundle";it.PRICING_MODEL_FURNITURE="pricing_model_furniture";it.PRICE_TYPE_NONE="price_type_none";it.PRICE_TYPE_CREDITS="price_type_credits";it.PRICE_TYPE_ACTIVITYPOINTS="price_type_activitypoints";it.PRICE_TYPE_CREDITS_ACTIVITYPOINTS="price_type_credits_and_activitypoints";class RC{constructor(e){this._furniData=e,this._product=new Yr(this._furniData.type,this._furniData.id,this._furniData.customParams,1,hs(this._furniData.className),this._furniData)}activate(){M(new Km(this._furniData.rentOfferId>-1?this._furniData.rentOfferId:this._furniData.purchaseOfferId))}get offerId(){return this.isRentOffer?this._furniData.rentOfferId:this._furniData.purchaseOfferId}get priceInActivityPoints(){return 0}get activityPointType(){return 0}get priceInCredits(){return 0}get page(){return this._page}set page(e){this._page=e}get priceType(){return""}get product(){return this._product}get products(){return[this._product]}get localizationId(){return"roomItem.name."+this._furniData.id}get bundlePurchaseAllowed(){return!1}get isRentOffer(){return this._furniData.rentOfferId>-1}get giftable(){return!1}get pricingModel(){return it.PRICING_MODEL_FURNITURE}get clubLevel(){return 0}get badgeCode(){return""}get localizationName(){return this._furniData.name}get localizationDescription(){return this._furniData.description}get isLazy(){return!0}}const yC=(a,e,n=null)=>{let r=null;switch(a.toLocaleLowerCase()){case ue.FLOOR:r=q().getFurnitureFloorIconUrl(e);break;case ue.WALL:r=q().getFurnitureWallIconUrl(e,n);break}return r};class OC{constructor(e){this._isEnabled=!1,this._price=null,this._stuffTypes=null,this._boxTypes=null,this._ribbonTypes=null,this._defaultStuffTypes=null,this._isEnabled=e.isEnabled,this._price=e.price,this._boxTypes=e.boxTypes,this._ribbonTypes=e.ribbonTypes,this._stuffTypes=e.giftWrappers,this._defaultStuffTypes=e.giftFurnis}get isEnabled(){return this._isEnabled}get price(){return this._price}get stuffTypes(){return this._stuffTypes}get boxTypes(){return this._boxTypes}get ribbonTypes(){return this._ribbonTypes}get defaultStuffTypes(){return this._defaultStuffTypes}}class Qs{constructor(e,n,r,o,s,c,u,m,h=-1){this._timeLeftMinutes=-1,this._offerId=e,this._furniId=n,this._furniType=r,this._extraData=o,this._stuffData=s,this._price=c,this._status=u,this._averagePrice=m,this._offerCount=h}get offerId(){return this._offerId}set offerId(e){this._offerId=e}get furniId(){return this._furniId}get furniType(){return this._furniType}get extraData(){return this._extraData}get stuffData(){return this._stuffData}get price(){return this._price}set price(e){this._price=e}get averagePrice(){return this._averagePrice}get image(){return this._image}set image(e){this._image=e}get imageCallback(){return this._imageCallback}set imageCallback(e){this._imageCallback=e}get status(){return this._status}get timeLeftMinutes(){return this._timeLeftMinutes}set timeLeftMinutes(e){this._timeLeftMinutes=e}get offerCount(){return this._offerCount}set offerCount(e){this._offerCount=e}get isUniqueLimitedItem(){return this.stuffData&&this.stuffData.uniqueSeries>0}}Qs.TYPE_FLOOR=1;Qs.TYPE_WALL=2;class $r{}$r.ONGOING=1;$r.ONGOING_OWN=1;$r.SOLD=2;$r.EXPIRED=3;class Ut{}Ut.BY_ACTIVITY=1;Ut.BY_VALUE=2;Ut.ADVANCED=3;class ed{constructor(e,n){this._images=e,this._texts=n}getText(e){let n=this._texts[e]||"";return n&&n.length&&(n=n.replace(/\r\n|\r|\n/g,"<br />")),n}getImage(e){const n=this._images[e]||"";if(!n||!n.length)return null;let r=K("catalog.asset.image.url");return r=r.replace("%name%",n),r}}class AC{constructor(e,n,r,o,s,c,u,m){this.roomId=e,this.objectId=n,this.category=r,this.wallLocation=o,this.x=s,this.y=c,this.direction=u,this.offer=m}get offerId(){return this.offer.offerId}get productClassId(){return this.offer.product.productClassId}get productData(){return this.offer.product.productData}get furniData(){return this.offer.product.furnitureData}get extraParam(){return this.offer.product.extraParam}}const cs=class{constructor(){this._requestType=cs.REQUEST_TYPE_NONE}resetRequest(){this._requestType=cs.REQUEST_TYPE_NONE,this._requestById=-1,this._requestedByOfferId=-1,this._requestByName=null}get requestType(){return this._requestType}get requestById(){return this._requestById}set requestById(a){this._requestType=cs.REQUEST_TYPE_ID,this._requestById=a}get requestedByOfferId(){return this._requestedByOfferId}set requestedByOfferId(a){this._requestType=cs.REQUEST_TYPE_OFFER,this._requestedByOfferId=a}get requestByName(){return this._requestByName}set requestByName(a){this._requestType=cs.REQUEST_TYPE_NAME,this._requestByName=a}};let hr=cs;hr.REQUEST_TYPE_NONE=0;hr.REQUEST_TYPE_ID=1;hr.REQUEST_TYPE_OFFER=2;hr.REQUEST_TYPE_NAME=3;class kC{constructor(e,n,r){this.searchValue=e,this.offers=n,this.filteredNodes=r}}function fi(a,e){let n=null;switch(e.toLowerCase()){case ue.FLOOR:n=H().getFloorItemData(a);break;case ue.WALL:n=H().getWallItemData(a);break}return n}function oo(a,e,n){const r=q().getRoomObject(a,e,n);if(!r)return;const o=r.model.getValue(te.FURNITURE_TYPE_ID);switch(n){case Q.FLOOR:return H().getFloorItemData(o);case Q.WALL:return H().getWallItemData(o)}return null}function PC(){const a=Jr();return a?a.model.getValue(te.FIGURE_POSTURE):gs.POSTURE_STAND}function hs(a){return a?H().getProductData(a):null}function Oe(){return Qr().getSession(-1)}function pi(){M(new Xm)}function qr(){return H().clubLevel>=un.CLUB}function ba(){return H().clubLevel>=un.VIP}function DC(a){const e=q().getRoomObject(Oe().roomId,a,Q.FLOOR);if(!e||!e.model)return!1;const n=H().userId,r=e.model.getValue(te.FURNITURE_OWNER_ID);return n===r}function MC(){const a=Jr();return a?a.model.getValue(te.FIGURE_EFFECT)===77:!1}function LC(a){Qr().startSession(a)}const Vi=()=>{Oe()&&(pi(),Qr().removeSession(-1))};function Jr(){const a=H().userId,e=q().activeRoomId,n=Q.UNIT,r=q().getTotalObjectsForManager(e,n);let o=0;for(;o<r;){const s=q().getRoomObjectByIndex(e,o,n);if(s){const c=Oe().userDataManager.getUserDataByIndex(s.id);if(c&&c.webID===a)return s}o++}return null}const Hi=(a,e,n,r=1)=>{const o=q().getRoomObjectBoundingRectangle(a,e,n,r);return o?(o.x=Math.round(o.x),o.y=Math.round(o.y),o):null},td=(a,e,n,r=1)=>{const o=q().getRoomObjectScreenLocation(a,e,n,r);return o?(o.x=Math.round(o.x),o.y=Math.round(o.y),o):null},UC=(a,e,n=1)=>{const r=q(),o=r.activeRoomId;r.initializeRoomInstanceRenderingCanvas(o,n,a,e)};function xC(a){let e=!1;const n=q().getRoomObject(a.roomId,a.objectId,a.category);return n&&n.model.getValue(te.FURNITURE_SELECTION_DISABLED)===1&&(e=!0,H().isModerator&&(e=!1)),e}function ds(a,e,n){q().processRoomObjectOperation(a,e,n)}function Fl(a){q().setActiveRoomId(a)}const M=a=>hi().send(a);class cn{static getAchievementBadgeCode(e){if(!e)return null;let n=e.badgeId;return e.finalLevel||(n=Xu().getPreviousLevelBadgeId(n)),n}static getAchievementCategoryImageUrl(e,n=null,r=!1){const o=K("achievements.images.url");let s=r?"achicon_":"achcategory_";return s+=e.code,n!==null&&(s+=`_${n>0?"active":"inactive"}`),o.replace("%image%",s)}static getAchievementCategoryMaxProgress(e){if(!e)return 0;let n=0;for(const r of e.achievements)n+=r.levelCount;return n}static getAchievementCategoryProgress(e){if(!e)return 0;let n=0;for(const r of e.achievements)n+=r.finalLevel?r.level:r.level-1;return n}static getAchievementCategoryTotalUnseen(e){if(!e)return 0;let n=0;for(const r of e.achievements)r.unseen>0&&n++;return n}static getAchievementHasStarted(e){return e?!!(e.finalLevel||e.level-1>0):!1}static getAchievementIsIgnored(e){if(!e)return!1;const n=K("achievements.unseen.ignored"),r=e.badgeId.replace(/[0-9]/g,"");return n.indexOf(r)>=0}static getAchievementLevel(e){return e?e.finalLevel?e.level:e.level-1:0}}class Gl{constructor(e){this._code=e,this._achievements=[]}getProgress(){return cn.getAchievementCategoryProgress(this)}getMaxProgress(){return cn.getAchievementCategoryMaxProgress(this)}get code(){return this._code}get achievements(){return this._achievements}set achievements(e){this._achievements=e}}class yn{}yn.ACTION_SAVE="AEA_ACTION_SAVE";yn.ACTION_CLEAR="AEA_ACTION_CLEAR";yn.ACTION_RESET="AEA_ACTION_RESET";yn.ACTION_RANDOMIZE="AEA_ACTION_RANDOMIZE";class FC{constructor(e,n=!1){this._partColor=e,this._isDisabled=n,this._isHC=this._partColor.clubLevel>0,this._isSelected=!1}dispose(){this._partColor=null}get partColor(){return this._partColor}get color(){return ln.int2rgb(this._partColor.rgb)}get isDisabled(){return this._isDisabled}get isHC(){return this._isHC}get isSelected(){return this._isSelected}set isSelected(e){this._isSelected=e,this.notify&&this.notify()}get notify(){return this._notifier}set notify(e){this._notifier=e}}class Wi{constructor(e,n,r){this._selectedPartIndex=-1,this._name=e,this._parts=n,this._palettes=r,this._selectedPartIndex=-1}static defaultColorId(e,n){if(!e||!e.length)return-1;let r=0;for(;r<e.length;){const o=e[r];if(o.partColor&&o.partColor.clubLevel<=n)return o.partColor.id;r++}return-1}init(){for(const e of this._parts)e&&e.init()}dispose(){if(this._parts){for(const e of this._parts)e.dispose();this._parts=null}if(this._palettes){for(const e of this._palettes)for(const n of e)n.dispose();this._palettes=null}this._selectedPartIndex=-1,this._paletteIndexes=null}selectPartId(e){if(!this._parts)return;let n=0;for(;n<this._parts.length;){if(this._parts[n].id===e){this.selectPartIndex(n);return}n++}}selectColorIds(e){if(!e||!this._palettes)return;this._paletteIndexes=new Array(e.length);let n=0;for(;n<this._palettes.length;){const r=this.getPalette(n);if(r){let o=0;if(e.length>n)o=e[n];else{const c=r[0];c&&c.partColor&&(o=c.partColor.id)}let s=0;for(;s<r.length;){const c=r[s];c.partColor.id===o?(this._paletteIndexes[n]=s,c.isSelected=!0):c.isSelected=!1,s++}}n++}this.updatePartColors()}selectPartIndex(e){if(!this._parts)return null;if(this._selectedPartIndex>=0&&this._parts.length>this._selectedPartIndex){const n=this._parts[this._selectedPartIndex];n&&(n.isSelected=!1)}if(this._parts.length>e){const n=this._parts[e];if(n)return n.isSelected=!0,this._selectedPartIndex=e,n}return null}selectColorIndex(e,n){const r=this.getPalette(n);if(!r||r.length<=e)return null;this.deselectColorIndex(this._paletteIndexes[n],n),this._paletteIndexes[n]=e;const o=r[e];return o?(o.isSelected=!0,this.updatePartColors(),o):null}getCurrentColorIndex(e){return this._paletteIndexes[e]}deselectColorIndex(e,n){const r=this.getPalette(n);if(!r||r.length<=e)return;const o=r[e];o&&(o.isSelected=!1)}getSelectedColorIds(){if(!this._paletteIndexes||!this._paletteIndexes.length||!this._palettes||!this._palettes.length)return null;const e=this._palettes[0];if(!e||!e.length)return null;const n=e[0];if(!n||!n.partColor)return null;const r=n.partColor.id,o=[];let s=0;for(;s<this._paletteIndexes.length;){const u=this._palettes[s];if(!(!u||u.length<=s))if(u.length>this._paletteIndexes[s]){const m=u[this._paletteIndexes[s]];m&&m.partColor?o.push(m.partColor.id):o.push(r)}else o.push(r);s++}const c=this.getCurrentPart();return c?o.slice(0,Math.max(c.maxColorIndex,1)):null}getSelectedColors(){const e=[];let n=0;for(;n<this._paletteIndexes.length;){const r=this.getSelectedColor(n);r?e.push(r.partColor):e.push(null),n++}return e}getSelectedColor(e){const n=this.getPalette(e);return!n||n.length<=this._paletteIndexes[e]?null:n[this._paletteIndexes[e]]}getSelectedColorId(e){const n=this.getSelectedColor(e);return n&&n.partColor?n.partColor.id:0}getPalette(e){return!this._paletteIndexes||!this._palettes||this._palettes.length<=e?null:this._palettes[e]}getCurrentPart(){return this._parts[this._selectedPartIndex]}updatePartColors(){const e=this.getSelectedColors();for(const n of this._parts)n&&(n.partColors=e)}hasClubSelectionsOverLevel(e){let n=!1;const r=this.getSelectedColors();if(r){let s=0;for(;s<r.length;){const c=r[s];c&&c.clubLevel>e&&(n=!0),s++}}const o=this.getCurrentPart();if(o&&o.partSet){const s=o.partSet;s&&s.clubLevel>e&&(n=!0)}return n}hasInvalidSelectedItems(e){const n=this.getCurrentPart();if(!n)return!1;const r=n.partSet;if(!(!r||!r.isSellable))return e.indexOf(r.id)>-1}stripClubItemsOverLevel(e){const n=this.getCurrentPart();if(n&&n.partSet&&n.partSet.clubLevel>e){const o=this.selectPartIndex(0);return o&&!o.partSet&&this.selectPartIndex(1),!0}return!1}stripClubColorsOverLevel(e){const n=[],r=this.getSelectedColors(),o=this.getPalette(0);let s=!1;const c=Wi.defaultColorId(o,e);if(c===-1)return!1;let u=0;for(;u<r.length;){const m=r[u];m?m.clubLevel>e?(n.push(c),s=!0):n.push(m.id):(n.push(c),s=!0),u++}return s&&this.selectColorIds(n),s}get name(){return this._name}get parts(){return this._parts}get selectedPartIndex(){return this._selectedPartIndex}}class gt{static getGender(e){switch(e){case ce.MALE:case"m":case"M":e=ce.MALE;break;case ce.FEMALE:case"f":case"F":e=ce.FEMALE;break;default:e=ce.MALE}return e}static hasFigureSetId(e){return this.FIGURE_SET_IDS.indexOf(e)>=0}static createCategory(e,n){if(!e||!n||!this.CURRENT_FIGURE)return null;const r=[],o=[];let s=0;for(;s<this.MAX_PALETTES;)o.push([]),s++;const c=Ul(n);if(!c)return null;const u=Ll(c.paletteID);if(!u)return null;let m=this.CURRENT_FIGURE.getColorIds(n);m||(m=[]);const h=new Array(m.length),g=this.clubItemsDimmed,f=In();for(const b of u.colors.getValues())if(b.isSelectable&&(g||f>=b.clubLevel)){let N=0;for(;N<this.MAX_PALETTES;){const v=f<b.clubLevel,O=new FC(b,v);o[N].push(O),N++}if(n!==ce.FACE){let v=0;for(;v<m.length;)b.id===m[v]&&(h[v]=b),v++}}let _=[];if(g?_=Nt().getMandatoryAvatarPartSetIds(this.CURRENT_FIGURE.gender,2):_=Nt().getMandatoryAvatarPartSetIds(this.CURRENT_FIGURE.gender,f),_.indexOf(n)===-1){const b=new Hs(null,null,!1);b.isClear=!0,r.push(b)}const I=n!==ce.FACE,C=c.partSets;for(s=C.length-1;s>=0;){const b=C.getWithIndex(s);let N=!1;if((b.gender===ce.UNISEX||b.gender===this.CURRENT_FIGURE.gender)&&(N=!0),b.isSelectable&&N&&(g||f>=b.clubLevel)){const v=f<b.clubLevel;let O=!0;b.isSellable&&(O=this.hasFigureSetId(b.id)),O&&r.push(new Hs(b,h,I,v))}s--}for(r.sort(this.clubItemsFirst?this.clubSorter:this.noobSorter),s=0;s<this.MAX_PALETTES;)o[s].sort(this.colorSorter),s++;return new Wi(n,r,o)}static clubSorter(e,n){const r=e.partSet?e.partSet.clubLevel:9999999999,o=n.partSet?n.partSet.clubLevel:9999999999,s=e.partSet?e.partSet.isSellable:!1,c=n.partSet?n.partSet.isSellable:!1;return s&&!c?1:c&&!s||r>o?-1:r<o?1:e.partSet.id>n.partSet.id?-1:e.partSet.id<n.partSet.id?1:0}static colorSorter(e,n){const r=e.partColor?e.partColor.clubLevel:-1,o=n.partColor?n.partColor.clubLevel:-1;return r<o?-1:r>o?1:e.partColor.index<n.partColor.index?-1:e.partColor.index>n.partColor.index?1:0}static noobSorter(e,n){const r=e.partSet?e.partSet.clubLevel:-1,o=n.partSet?n.partSet.clubLevel:-1,s=e.partSet?e.partSet.isSellable:!1,c=n.partSet?n.partSet.isSellable:!1;return s&&!c?1:c&&!s||r<o?-1:r>o?1:e.partSet.id<n.partSet.id?-1:e.partSet.id>n.partSet.id?1:0}static avatarSetFirstSelectableColor(e){const n=Ul(e);if(!n)return-1;const r=Ll(n.paletteID);if(!r)return-1;for(const o of r.colors.getValues())if(!(!o.isSelectable||In()<o.clubLevel))return o.id;return-1}static get clubItemsFirst(){return K("avatareditor.show.clubitems.first",!0)}static get clubItemsDimmed(){return K("avatareditor.show.clubitems.dimmed",!0)}}gt.MAX_PALETTES=2;gt.CURRENT_FIGURE=null;gt.FIGURE_SET_IDS=[];gt.BOUND_FURNITURE_NAMES=[];const Se=class{constructor(){this._gender="M",this._direction=Se.DEFAULT_DIRECTION,this._avatarEffectType=-1,this._notifier=null}loadAvatarData(a,e){this._data=new Map,this._colors=new Map,this._gender=e,this.parseFigureString(a),this.updateView()}parseFigureString(a){if(!a)return;const e=a.split(".");if(!(!e||!e.length))for(const n of e){const r=n.split("-");if(!r.length)continue;const o=r[0],s=parseInt(r[1]),c=[];let u=2;for(;u<r.length;)c.push(parseInt(r[u])),u++;c.length||c.push(0),this.savePartSetId(o,s,!1),this.savePartSetColourId(o,c,!1)}}getPartSetId(a){const e=this._data.get(a);return e!==void 0?e:-1}getColorIds(a){const e=this._colors.get(a);return e!==void 0?e:[gt.avatarSetFirstSelectableColor(a)]}getFigureString(){let a="";const e=[];for(const[r,o]of this._data.entries()){const s=this._colors.get(r);let c=r+"-"+o;if(s&&s.length){let u=0;for(;u<s.length;)c=c+("-"+s[u]),u++}e.push(c)}let n=0;for(;n<e.length;)a=a+e[n],n<e.length-1&&(a=a+"."),n++;return a}savePartData(a,e,n,r=!1){this.savePartSetId(a,e,r),this.savePartSetColourId(a,n,r)}savePartSetId(a,e,n=!0){switch(a){case Se.FACE:case Se.HAIR:case Se.HAT:case Se.HEAD_ACCESSORIES:case Se.EYE_ACCESSORIES:case Se.FACE_ACCESSORIES:case Se.SHIRT:case Se.JACKET:case Se.CHEST_ACCESSORIES:case Se.CHEST_PRINTS:case Se.TROUSERS:case Se.SHOES:case Se.TROUSER_ACCESSORIES:e>=0?this._data.set(a,e):this._data.delete(a);break}n&&this.updateView()}savePartSetColourId(a,e,n=!0){switch(a){case Se.FACE:case Se.HAIR:case Se.HAT:case Se.HEAD_ACCESSORIES:case Se.EYE_ACCESSORIES:case Se.FACE_ACCESSORIES:case Se.SHIRT:case Se.JACKET:case Se.CHEST_ACCESSORIES:case Se.CHEST_PRINTS:case Se.TROUSERS:case Se.SHOES:case Se.TROUSER_ACCESSORIES:this._colors.set(a,e);break}n&&this.updateView()}getFigureStringWithFace(a,e=!0){let n="";const r=[Se.FACE],o=[];for(const c of r){const u=this._colors.get(c);if(!u)continue;let m=this._data.get(c);c===Se.FACE&&e&&(m=a);let h=c+"-"+m;if(m>=0){let g=0;for(;g<u.length;)h=h+("-"+u[g]),g++}o.push(h)}let s=0;for(;s<o.length;)n=n+o[s],s<o.length-1&&(n=n+"."),s++;return n}updateView(){this.notify&&this.notify()}get gender(){return this._gender}get direction(){return this._direction}set direction(a){this._direction=a,this.updateView()}set avatarEffectType(a){this._avatarEffectType=a}get avatarEffectType(){return this._avatarEffectType}get notify(){return this._notifier}set notify(a){this._notifier=a}};let ce=Se;ce.DEFAULT_DIRECTION=4;ce.MALE="M";ce.FEMALE="F";ce.UNISEX="U";ce.SCALE="h";ce.STD="std";ce.DEFAULT_FRAME="0";ce.FACE="hd";ce.HAIR="hr";ce.HAT="ha";ce.HEAD_ACCESSORIES="he";ce.EYE_ACCESSORIES="ea";ce.FACE_ACCESSORIES="fa";ce.JACKET="cc";ce.SHIRT="ch";ce.CHEST_ACCESSORIES="ca";ce.CHEST_PRINTS="cp";ce.TROUSERS="lg";ce.SHOES="sh";ce.TROUSER_ACCESSORIES="wa";ce.SET_TYPES=[Se.FACE,Se.HAIR,Se.HAT,Se.HEAD_ACCESSORIES,Se.EYE_ACCESSORIES,Se.FACE_ACCESSORIES,Se.JACKET,Se.SHIRT,Se.CHEST_ACCESSORIES,Se.CHEST_PRINTS,Se.TROUSERS,Se.SHOES,Se.TROUSERS];const us=class{constructor(a,e,n=!0,r=!1){if(this._renderManager=Nt(),this._partSet=a,this._partColors=e,this._useColors=n,this._isDisabled=r,this._thumbContainer=null,this._imageUrl=null,this._maxColorIndex=0,this._isValidFigure=!1,this._isHC=!1,this._isSellable=!1,this._isClear=!1,this._isSelected=!1,this._disposed=!1,this._isInitalized=!1,a){const o=a.parts;for(const s of o)this._maxColorIndex=Math.max(this._maxColorIndex,s.colorLayerIndex)}}init(){this._isInitalized||(this._isInitalized=!0,this.update())}dispose(){this._disposed||(this._renderManager=null,this._partSet=null,this._partColors=null,this._imageUrl=null,this._disposed=!0,this._isInitalized=!1,this._thumbContainer&&(this._thumbContainer.destroy(),this._thumbContainer=null))}update(){this.updateThumbVisualization()}analyzeFigure(){if(!this._renderManager||!this._partSet||!this._partSet.parts||!this._partSet.parts.length)return!1;const a=this._renderManager.createFigureContainer(this.partSet.type+"-"+this.partSet.id);return this._renderManager.isFigureContainerReady(a)?(this._isValidFigure=!0,!0):(this._renderManager.downloadAvatarFigure(a,this),!1)}renderThumb(){if(!this._renderManager||!this._partSet||!this._isValidFigure&&!this.analyzeFigure())return null;const a=this._partSet.parts.concat().sort(this.sortByDrawOrder),e=new Jm;for(const n of a){if(!n)continue;let r=null,o=0,s=!1;for(;!s&&o<us.THUMB_DIRECTIONS.length;){const g=ce.SCALE+"_"+ce.STD+"_"+n.type+"_"+n.id+"_"+us.THUMB_DIRECTIONS[o]+"_"+ce.DEFAULT_FRAME;r=this._renderManager.getAssetByName(g),r&&r.texture?s=!0:o++}if(!s)continue;const c=r.offsetX,u=r.offsetY;let m=null;if(this._useColors&&n.colorLayerIndex>0){const g=this._partColors[n.colorLayerIndex-1];g&&(m=g)}const h=new Va(r.texture);h.position.set(c,u),m&&(h.tint=m.rgb),e.addChild(h)}return e}updateThumbVisualization(){if(!this._isInitalized)return;let a=this._thumbContainer;a||(a=this.renderThumb()),a&&(this._partSet?(this._isHC=this._partSet.clubLevel>0,this._isSellable=this._partSet.isSellable):(this._isHC=!1,this._isSellable=!1),this._isDisabled&&this.setAlpha(a,.2),this._imageUrl=tr.generateImageUrl(a),this.notify&&this.notify())}setAlpha(a,e){return a.filters=[us.ALPHA_FILTER],a}sortByDrawOrder(a,e){const n=us.DRAW_ORDER.indexOf(a.type),r=us.DRAW_ORDER.indexOf(e.type);return n<r?-1:n>r?1:a.index<e.index?-1:a.index>e.index?1:0}resetFigure(a){this.analyzeFigure()&&this.update()}get disposed(){return this._disposed}get id(){return this._partSet?this._partSet.id:-1}get partSet(){return this._partSet}set partColors(a){this._partColors=a,this.update()}get isDisabled(){return this._isDisabled}set thumbContainer(a){this._thumbContainer=a,this.update()}get imageUrl(){return this._imageUrl}get maxColorIndex(){return this._maxColorIndex}get isHC(){return this._isHC}get isSellable(){return this._isSellable}get isClear(){return this._isClear}set isClear(a){this._isClear=a}get isSelected(){return this._isSelected}set isSelected(a){this._isSelected=a,this.notify&&this.notify()}get notify(){return this._notifier}set notify(a){this._notifier=a}};let Hs=us;Hs.ALPHA_FILTER=new Qm(.2);Hs.THUMB_DIRECTIONS=[2,6,0,4,3,1];Hs.DRAW_ORDER=[He.LEFT_HAND_ITEM,He.LEFT_HAND,He.LEFT_SLEEVE,He.LEFT_COAT_SLEEVE,He.BODY,He.SHOES,He.LEGS,He.CHEST,He.CHEST_ACCESSORY,He.COAT_CHEST,He.CHEST_PRINT,He.WAIST_ACCESSORY,He.RIGHT_HAND,He.RIGHT_SLEEVE,He.RIGHT_COAT_SLEEVE,He.HEAD,He.FACE,He.EYES,He.HAIR,He.HAIR_BIG,He.FACE_ACCESSORY,He.EYE_ACCESSORY,He.HEAD_ACCESSORY,He.HEAD_ACCESSORY_EXTRA,He.RIGHT_HAND_ITEM];class io{constructor(){this._isInitalized=!1,this._maxPaletteCount=0}dispose(){this._categories=null,this._disposed=!0}get disposed(){return this._disposed}init(){this._categories||(this._categories=new Map)}reset(){if(this._isInitalized=!1,this._categories)for(const e of this._categories.values())e&&e.dispose();this._categories=new Map}addCategory(e){let n=this._categories.get(e);n||(n=gt.createCategory(this,e),n&&(this._categories.set(e,n),this.updateSelectionsFromFigure(e)))}updateSelectionsFromFigure(e){const n=this._categories.get(e);if(!n)return;const r=gt.CURRENT_FIGURE.getPartSetId(e);let o=gt.CURRENT_FIGURE.getColorIds(e);o||(o=[]),n.selectPartId(r),n.selectColorIds(o)}hasClubSelectionsOverLevel(e){if(!this._categories)return!1;for(const n of this._categories.values())if(n&&n.hasClubSelectionsOverLevel(e))return!0;return!1}hasInvalidSelectedItems(e){if(!this._categories)return!1;for(const n of this._categories.values())if(n.hasInvalidSelectedItems(e))return!0;return!1}stripClubItemsOverLevel(e){if(!this._categories)return!1;let n=!1;for(const[r,o]of this._categories.entries()){let s=!1;if(o.stripClubItemsOverLevel(e)&&(s=!0),o.stripClubColorsOverLevel(e)&&(s=!0),s){const c=o.getCurrentPart();c&&gt.CURRENT_FIGURE&&gt.CURRENT_FIGURE.savePartData(r,c.id,o.getSelectedColorIds(),!0),n=!0}}return n}stripInvalidSellableItems(){if(!this._categories)return!1;let e=!1;for(const[n,r]of this._categories.entries());return e}selectPart(e,n){const r=this._categories.get(e);if(!r)return;const o=r.selectedPartIndex;r.selectPartIndex(n);const s=r.getCurrentPart();if(s){if(s.isDisabled){r.selectPartIndex(o);return}this._maxPaletteCount=s.maxColorIndex,gt.CURRENT_FIGURE.savePartData(e,s.id,r.getSelectedColorIds(),!0)}}selectColor(e,n,r){const o=this._categories.get(e);if(!o)return;const s=o.getCurrentColorIndex(r);if(o.selectColorIndex(n,r),o.getSelectedColor(r).isDisabled){o.selectColorIndex(s,r);return}gt.CURRENT_FIGURE.savePartSetColourId(e,o.getSelectedColorIds(),!0)}getCategoryData(e){return this._isInitalized||this.init(),this._categories?this._categories.get(e):null}get categories(){return this._categories}get canSetGender(){return!1}get maxPaletteCount(){return this._maxPaletteCount||1}set maxPaletteCount(e){this._maxPaletteCount=e}get name(){return null}}class GC extends io{constructor(){super(...arguments),this._imageCallBackHandled=!1}init(){super.init(),this.addCategory(ce.FACE),this._isInitalized=!0}selectColor(e,n,r){super.selectColor(e,n,r),this.updateSelectionsFromFigure(ce.FACE)}updateSelectionsFromFigure(e){if(!this._categories||!gt.CURRENT_FIGURE)return;const n=this._categories.get(e);if(!n)return;const r=gt.CURRENT_FIGURE.getPartSetId(e);let o=gt.CURRENT_FIGURE.getColorIds(e);o||(o=[]),n.selectPartId(r),n.selectColorIds(o);for(const s of n.parts){const c=u=>{const m=gt.CURRENT_FIGURE.getFigureStringWithFace(s.id),h=Nt().createAvatarImage(m,Ui.LARGE,null,{resetFigure:c,dispose:null,disposed:!1}),g=h.getImageAsSprite(Ha.HEAD);g&&(g.y=10,s.thumbContainer=g,setTimeout(()=>h.dispose(),0))};c()}}get canSetGender(){return!0}get name(){return gr.GENERIC}}const Kt=a=>{if(a==null||typeof a!="object")return a;const e=new a.constructor;for(const n in a)a.hasOwnProperty(n)&&(e[n]=a[n]);return e};class Qt{static makeColorHex(e){return"#"+e}static makeColorNumberHex(e){return"#"+e.toString(16).padStart(6,"0")}static convertFromHex(e){return parseInt(e.replace("#",""),16)}static uintHexColor(e){const n=e>>>0;return Qt.makeColorHex(n.toString(16).substring(2))}static int_to_8BitVals(e){const n=e>>24&255,r=e>>16&255,o=e>>8&255,s=e&255;return[n,r,o,s]}static eight_bitVals_to_int(e,n,r,o){return(e<<24)+(n<<16)+(r<<8)+(o|0)}static int2rgb(e){e>>>=0;const n=e&255,r=(e&65280)>>>8;return"rgba("+[(e&16711680)>>>16,r,n,1].join(",")+")"}}const xr=a=>{let e=Math.floor(a/86400),n=Math.floor(a%86400/3600),r=Math.floor(a%86400%3600/60),o=a%86400%3600%60;return e.toString().padStart(2,"0")+":"+n.toString().padStart(2,"0")+":"+r.toString().padStart(2,"0")+":"+o.toString().padStart(2,"0")},Ya=a=>{try{JSON.parse(window.localStorage.getItem(a))}catch{return null}};class Zr{}Zr.CATALOG_PLACE_MULTIPLE_OBJECTS="catalogPlaceMultipleObjects";Zr.CATALOG_SKIP_PURCHASE_CONFIRMATION="catalogSkipPurchaseConfirmation";Zr.TRANSLATE_CHAT_MESSAGE_TO_ENGLISH="translateChatMessageToEnglish";const ji=a=>{let e=_e().localization.getBadgeDesc(a);return(!e||!e.length)&&(e=`badge_desc_${a}`),e},Js=a=>{let e=_e().localization.getBadgeName(a);return(!e||!e.length)&&(e=`badge_name_${a}`),e};function za(a){return!a||isNaN(a)?"0":a.toString().replace(/\B(?=(\d{3})+(?!\d))/g," ")}function BC(a){if(!a||isNaN(a))return"0";let e=Math.abs(a);const n=Math.pow(10,1),r=a<0;let o="";const s=[{key:"Q",value:Math.pow(10,15)},{key:"T",value:Math.pow(10,12)},{key:"B",value:Math.pow(10,9)},{key:"M",value:Math.pow(10,6)},{key:"K",value:1e3}];for(const c of s){let u=e/c.value;if(u=Math.round(u*n)/n,u>=1){e=u,o=c.key;break}}return(r?"-":"")+e+o}function d(a,e=null,n=null){return _e().getLocalizationWithParameters(a,e,n)}const nd=(a,e)=>a.dispatchEvent(e),Ii=a=>nd(_e().events,a),nr=new Zm,St=a=>nd(nr,a);let rd=!1;const rr=a=>{rd&&Ii(new hl(hl.PLAY_SOUND,a))},Bl=[ye.MOUSE_CLICK],VC=()=>{const a=()=>Bl.forEach(n=>window.removeEventListener(n,e)),e=n=>(rd=!0)&&a();Bl.forEach(n=>window.addEventListener(n,e))};VC();class Z{}Z.DEFAULT=1;Z.WALL_PAPER=2;Z.FLOOR=3;Z.LANDSCAPE=4;Z.POST_IT=5;Z.POSTER=6;Z.SOUND_SET=7;Z.TRAX_SONG=8;Z.PRESENT=9;Z.ECOTRON_BOX=10;Z.TROPHY=11;Z.CREDIT_FURNI=12;Z.PET_SHAMPOO=13;Z.PET_CUSTOM_PART=14;Z.PET_CUSTOM_PART_SHAMPOO=15;Z.PET_SADDLE=16;Z.GUILD_FURNI=17;Z.GAME_FURNI=18;Z.MONSTERPLANT_SEED=19;Z.MONSTERPLANT_REVIVAL=20;Z.MONSTERPLANT_REBREED=21;Z.MONSTERPLANT_FERTILIZE=22;Z.FIGURE_PURCHASABLE_SET=23;class Ws{constructor(e){e&&(this._locked=!1,this._id=e.itemId,this._type=e.spriteId,this._ref=e.ref,this._category=e.category,this._groupable=e.isGroupable&&!e.rentable,this._tradeable=e.tradable,this._recyclable=e.isRecycleable,this._sellable=e.sellable,this._stuffData=e.stuffData,this._extra=e.extra,this._secondsToExpiration=e.secondsToExpiration,this._expirationTimeStamp=e.expirationTimeStamp,this._hasRentPeriodStarted=e.hasRentPeriodStarted,this._creationDay=e.creationDay,this._creationMonth=e.creationMonth,this._creationYear=e.creationYear,this._slotId=e.slotId,this._songId=e.songId,this._flatId=e.flatId,this._isRented=e.rentable,this._isWallItem=e.isWallItem)}get rentable(){return this._isRented}get id(){return this._id}get ref(){return this._ref}get category(){return this._category}get type(){return this._type}get stuffData(){return this._stuffData}set stuffData(e){this._stuffData=e}get extra(){return this._extra}get recyclable(){return this._recyclable}get isTradable(){return this._tradeable}get isGroupable(){return this._groupable}get sellable(){return this._sellable}get secondsToExpiration(){if(this._secondsToExpiration===-1)return-1;let e=-1;return this._hasRentPeriodStarted?(e=this._secondsToExpiration-(Rn()-this._expirationTimeStamp)/1e3,e<0&&(e=0)):e=this._secondsToExpiration,e}get creationDay(){return this._creationDay}get creationMonth(){return this._creationMonth}get creationYear(){return this._creationYear}get slotId(){return this._slotId}get songId(){return this._songId}get locked(){return this._locked}set locked(e){this._locked=e}get flatId(){return this._flatId}get isWallItem(){return this._isWallItem}get hasRentPeriodStarted(){return this._hasRentPeriodStarted}get expirationTimeStamp(){return this._expirationTimeStamp}update(e){this._type=e.spriteId,this._ref=e.ref,this._category=e.category,this._groupable=e.isGroupable&&!e.rentable,this._tradeable=e.tradable,this._recyclable=e.isRecycleable,this._sellable=e.sellable,this._stuffData=e.stuffData,this._extra=e.extra,this._secondsToExpiration=e.secondsToExpiration,this._expirationTimeStamp=e.expirationTimeStamp,this._hasRentPeriodStarted=e.hasRentPeriodStarted,this._creationDay=e.creationDay,this._creationMonth=e.creationMonth,this._creationYear=e.creationYear,this._slotId=e.slotId,this._songId=e.songId,this._flatId=e.flatId,this._isRented=e.rentable,this._isWallItem=e.isWallItem}clone(){const e=new Ws(null);return e._expirationTimeStamp=this._expirationTimeStamp,e._isWallItem=this._isWallItem,e._songId=this._songId,e._locked=this._locked,e._id=this._id,e._ref=this._ref,e._category=this._category,e._type=this._type,e._stuffData=this._stuffData,e._extra=this._extra,e._recyclable=this._recyclable,e._tradeable=this._tradeable,e._groupable=this._groupable,e._sellable=this._sellable,e._secondsToExpiration=this._secondsToExpiration,e._hasRentPeriodStarted=this._hasRentPeriodStarted,e._creationDay=this._creationDay,e._creationMonth=this._creationMonth,e._creationYear=this._creationYear,e._slotId=this._slotId,e._isRented=this._isRented,e._flatId=this._flatId,e}}class qi{constructor(e=-1,n=-1,r=null,o=null,s=-1){this._type=e,this._category=n,this._roomEngine=r,this._stuffData=o,this._extra=s,this._isWallItem=!1,this._iconUrl=null,this._name=null,this._description=null,this._locked=!1,this._selected=!1,this._hasUnseenItems=!1,this._items=[]}clone(){const e=new qi;return e._type=this._type,e._category=this._category,e._roomEngine=this._roomEngine,e._stuffData=this._stuffData,e._extra=this._extra,e._isWallItem=this._isWallItem,e._iconUrl=this._iconUrl,e._name=this._name,e._description=this._description,e._locked=this._locked,e._selected=this._selected,e._hasUnseenItems=this._hasUnseenItems,e._items=this._items,e}prepareGroup(){this.setIcon(),this.setName(),this.setDescription()}dispose(){}getItemByIndex(e){return this._items[e]}getItemById(e){for(const n of this._items)if(n.id===e)return n;return null}getTradeItems(e){const n=[],r=this.getLastItem();if(!r)return n;let o=0,s=0;for(;s<this._items.length&&!(o>=e);){const c=this.getItemByIndex(s);!c.locked&&c.isTradable&&c.type===r.type&&(n.push(c),o++),s++}return n}push(e){const n=[...this._items];let r=0;for(;r<n.length;){let o=n[r];if(o.id===e.id){o=o.clone(),o.locked=!1,n.splice(r,1),n.push(o),this._items=n;return}r++}n.push(e),this._items=n,this._items.length===1&&this.prepareGroup()}pop(){const e=[...this._items];let n=null;if(e.length>0){const r=e.length-1;n=e[r],e.splice(r,1)}return this._items=e,n}remove(e){const n=[...this._items];let r=0;for(;r<n.length;){let o=n[r];if(o.id===e)return n.splice(r,1),this._items=n,o;r++}return null}getTotalCount(){if(this._category===Z.POST_IT){let e=0,n=0;for(;n<this._items.length;){const r=this.getItemByIndex(n);e=e+parseInt(r.stuffData.getLegacyString()),n++}return e}return this._items.length}getUnlockedCount(){if(this.category===Z.POST_IT)return this.getTotalCount();let e=0,n=0;for(;n<this._items.length;)this.getItemByIndex(n).locked||e++,n++;return e}getLastItem(){return this._items.length?this.getItemByIndex(this._items.length-1):null}unlockAllItems(){const e=[...this._items];let n=0;for(;n<e.length;){const r=e[n];if(r.locked){const o=r.clone();o.locked=!1,e[n]=o}n++}this._items=e}lockItemIds(e){const n=[...this._items];let r=0,o=!1;for(;r<n.length;){const s=n[r],c=e.indexOf(s.ref)>=0;if(s.locked!==c){o=!0;const u=s.clone();u.locked=c,n[r]=u}r++}return this._items=n,o}setName(){const e=this.getLastItem();if(!e){this._name="";return}let n="";switch(this._category){case Z.POSTER:n="poster_"+e.stuffData.getLegacyString()+"_name";break;case Z.TRAX_SONG:this._name="SONG_NAME";return;default:this.isWallItem?n="wallItem.name."+e.type:n="roomItem.name."+e.type}this._name=d(n)}setDescription(){this._description=""}setIcon(){if(this._iconUrl)return;let e=null;this.isWallItem?e=this._roomEngine.getFurnitureWallIconUrl(this._type,this._stuffData.getLegacyString()):e=this._roomEngine.getFurnitureFloorIconUrl(this._type),e&&(this._iconUrl=e)}get type(){return this._type}get category(){return this._category}get stuffData(){return this._stuffData}get extra(){return this._extra}get iconUrl(){return this._iconUrl}get name(){return this._name}get description(){return this._description}get hasUnseenItems(){return this._hasUnseenItems}set hasUnseenItems(e){this._hasUnseenItems=e}get locked(){return this._locked}set locked(e){this._locked=e}get selected(){return this._selected}set selected(e){this._selected=e}get isWallItem(){const e=this.getItemByIndex(0);return e?e.isWallItem:!1}get isGroupable(){const e=this.getItemByIndex(0);return e?e.isGroupable:!1}get isSellable(){const e=this.getItemByIndex(0);return e?e.sellable:!1}get items(){return this._items}set items(e){this._items=e}}const Yi=(a,e,n,r=NaN)=>new qi(a,e,q(),n,r),HC=(a,e,n)=>{const r=[];for(const s of a)s.type===e.type&&r.push(s);for(const s of r)if(s.getItemById(e.id))return s;const o=Yi(e.type,e.category,e.stuffData,e.extra);return o.push(e),n?(o.hasUnseenItems=!0,a.unshift(o)):a.push(o),o},WC=(a,e,n)=>{let r=null;for(const o of a)if(o.type===e.type&&o.isWallItem===e.isWallItem&&o.isGroupable)if(e.category===Z.POSTER){if(o.stuffData.getLegacyString()===e.stuffData.getLegacyString()){r=o;break}}else if(e.category===Z.GUILD_FURNI){if(e.stuffData.compare(o.stuffData)){r=o;break}}else{r=o;break}if(r){if(r.push(e),n){r.hasUnseenItems=!0;const o=a.indexOf(r);o>=0&&a.splice(o,1),a.unshift(r)}return r}return r=Yi(e.type,e.category,e.stuffData,e.extra),r.push(e),n?(r.hasUnseenItems=!0,a.unshift(r)):a.push(r),r},Vl=(a,e,n)=>{e.isGroupable?WC(a,e,n):HC(a,e,n)},jC=(a,e,n,r)=>{if(e===1)return a;r[n]=a;for(const s of r)if(!s)return null;const o=new Map;for(const s of r){for(const[c,u]of s)o.set(c,u);s.clear()}return r=null,o},qC=a=>{const e=[];for(const n of a){let r=n.getTotalCount();n.category===Z.POST_IT&&(r=1);let o=0;for(;o<r;)e.push(n.getItemByIndex(o).id),o++}return e};let sd=!1,ad=-1;const YC=()=>sd,Zs=a=>sd=a,_s=()=>ad,lo=a=>ad=a,js=()=>{_s()!==-1&&(q().cancelRoomObjectPlacement(),lo(-1),Zs(!1))},Ei=(a,e=!1)=>{const n=a.petData;if(!n)return!1;const r=Qr().getSession(1);return!r||!r.isRoomOwner&&!r.allowPets?!1:(ee("inventory/hide"),q().processRoomObjectPlacement(Us.INVENTORY,-n.id,Q.UNIT,ht.PET,n.figureData.figuredata)&&(lo(n.id),Zs(!0)),!0)},Cs=(a,e=!1)=>{if(!a||!a.getUnlockedCount())return!1;const n=a.getLastItem();if(!n)return!1;if(n.category===Z.FLOOR||n.category===Z.WALL_PAPER||n.category===Z.LANDSCAPE)return e||M(new xa(n.id)),!1;{ee("inventory/hide");let r=0,o=!1;n.isWallItem?r=Q.WALL:r=Q.FLOOR,n.category===Z.POSTER?o=q().processRoomObjectPlacement(Us.INVENTORY,n.id,r,n.type,n.stuffData.getLegacyString()):o=q().processRoomObjectPlacement(Us.INVENTORY,n.id,r,n.type,n.extra.toString(),n.stuffData),o&&(lo(n.ref),Zs(!0))}return!0},_i=(a,e=!1)=>{const n=a.botData;if(!n)return!1;const r=Qr().getSession(1);return!r||!r.isRoomOwner?!1:(ee("inventory/hide"),q().processRoomObjectPlacement(Us.INVENTORY,-n.id,Q.UNIT,ht.RENTABLE_BOT,n.figure)&&(lo(n.id),Zs(!0)),!0)};class qe{}qe.FURNI=1;qe.RENTABLE=2;qe.PET=3;qe.BADGE=4;qe.BOT=5;qe.GAMES=6;const zC=a=>a.map(e=>e.petData.id),od=(a,e,n=!0)=>{const r={petData:a};return n?e.unshift(r):e.push(r),r},id=(a,e)=>{let n=0;for(;n<e.length;){const r=e[n];if(r&&r.petData.id===a)return _s()===r.petData.id&&(js(),ee("inventory/open")),e.splice(n,1),r;n++}return null},$C=(a,e,n)=>{const r=zC(a),o=[],s=[];for(const c of e.keys())r.indexOf(c)===-1&&o.push(c);for(const c of r)!e.get(c)&&s.push(c);r.length;for(const c of s)id(c,a);for(const c of o){const u=e.get(c);u&&od(u,a,n(qe.PET,u.id))}return a},KC=(a,e,n,r)=>{if(e===1)return a;r[n]=a;for(const s of r)if(!s)return null;const o=new Map;for(const s of r){for(const[c,u]of s)o.set(c,u);s.clear()}return r=null,o};class nt{}nt.TRADING_STATE_READY=0;nt.TRADING_STATE_RUNNING=1;nt.TRADING_STATE_COUNTDOWN=2;nt.TRADING_STATE_CONFIRMING=3;nt.TRADING_STATE_CONFIRMED=4;nt.TRADING_STATE_COMPLETED=5;nt.TRADING_STATE_CANCELLED=6;class Hl{constructor(e=-1,n="",r=new xs,o=0,s=0,c=!1,u=!1){this.userId=e,this.userName=n,this.userItems=r,this.itemCount=o,this.creditsCount=s,this.accepts=c,this.canTrade=u}}class bt{}bt.ALERT_SCAM=0;bt.HOTEL_TRADING_DISABLED=1;bt.YOU_NOT_ALLOWED=2;bt.THEY_NOT_ALLOWED=4;bt.ROOM_DISABLED=6;bt.YOU_OPEN=7;bt.THEY_OPEN=8;bt.ERROR_WHILE_COMMIT=9;bt.THEY_CANCELLED=10;const Wl=a=>{var e;return((e=H().getWallItemData(a))==null?void 0:e.isExternalImage)||!1},jl=a=>{const e=new xs;if(a.length)for(const r of a){const o=r.spriteId,s=r.category;let c=r.furniType+o;(!r.isGroupable||Wl(o))&&(c="itemid"+r.itemId),r.category===Z.POSTER?c=r.itemId+"poster"+r.stuffData.getLegacyString():r.category===Z.GUILD_FURNI&&(c="");let u=r.isGroupable&&!Wl(r.spriteId)?e.getValue(c):null;u||(u=Yi(o,s,r.stuffData),e.add(c,u)),u.push(new Ws(r))}return e},XC=(a,e)=>{let n=a.toString();if(!(e instanceof Ks))return n;let r=1;for(;r<5;)n=n+(","+e.getValue(r)),r++;return n};class Fa{static getProductImageUrl(e,n,r){let o=null;switch(e){case As.S:o=q().getFurnitureFloorIconUrl(n);break;case As.I:this.getProductCategory(As.I,n)===1&&(o=q().getFurnitureWallIconUrl(n,r));break}return o}static getProductCategory(e,n){if(e===As.S)return 1;if(e===As.I){if(n===3001)return Z.WALL_PAPER;if(n===3002)return Z.FLOOR;if(n===4057)return Z.LANDSCAPE}return 1}}class $a{static getRandomNumber(e){return Math.floor(Math.random()*e)}static getRandomElement(e){return e[this.getRandomNumber(e.length)]}static getRandomElements(e,n){const r=new Array(n);let o=e.length;const s=new Array(o);for(;n--;){var c=this.getRandomNumber(o);r[n]=e[c in s?s[c]:c],s[c]=--o in s?s[o]:o}return r}}const Tt=new Map;Tt.set("r","red");Tt.set("b","blue");Tt.set("g","green");Tt.set("y","yellow");Tt.set("w","white");Tt.set("o","orange");Tt.set("c","cyan");Tt.set("br","brown");Tt.set("pr","purple");Tt.set("pk","pink");Tt.set("red","red");Tt.set("blue","blue");Tt.set("green","green");Tt.set("yellow","yellow");Tt.set("white","white");Tt.set("orange","orange");Tt.set("cyan","cyan");Tt.set("brown","brown");Tt.set("purple","purple");Tt.set("pink","pink");const QC=a=>a.replace(/([\u00A0-\u9999<>&])(.|$)/g,(e,n,r)=>n!=="&"||r!=="#"?(/[\u00A0-\u9999<>&]/.test(r)&&(r="&#"+r.charCodeAt(0)+";"),"&#"+n.charCodeAt(0)+";"+r):e),JC=a=>{let e="";if(a=QC(a),a.startsWith("@")&&a.indexOf("@",1)>-1){let n=null;for(;(n=/@[a-zA-Z]+@/g.exec(a))!==null;){const r=n[0].toString(),o=r.substr(1,r.length-2),s=a.replace(r,"");Tt.has(o)?e='<span style="color: '+Tt.get(o)+'">'+s+"</span>":e=s;break}}else e=a;return e},ZC=async a=>{const e={method:"POST",body:JSON.stringify({q:a,source:"auto",target:"en",format:"text"}),headers:{"Content-Type":"application/json"}};let n=null;try{const r=await fetch(K("translation.url"),e);r.status===200&&(n=await r.json())}catch{}return n},ld=(a,e)=>window.localStorage.setItem(a,JSON.stringify(e));class dn{}dn.CAMERA_SHUTTER="camera_shutter";dn.CREDITS="credits";dn.DUCKETS="duckets";dn.MESSENGER_NEW_THREAD="messenger_new_thread";dn.MESSENGER_MESSAGE_RECEIVED="messenger_message_received";dn.MODTOOLS_NEW_TICKET="modtools_new_ticket";function eb(a){const e=a.parts;let n=0;for(const r of e)n=Math.max(n,r.colorLayerIndex);return n}function tb(a,e){return e=e.filter(n=>a.indexOf(n)===-1),[...a,...$a.getRandomElements(e,$a.getRandomNumber(e.length)+1)]}function nb(a,e,n=0,r=[]){if(!a)return null;const o=a.partSets.getValues().filter(s=>!s.isSelectable||s.gender!=="U"&&s.gender!==e||s.clubLevel>n||s.isSellable&&r.indexOf(s.id)===-1?null:s);return!o||!o.length?null:$a.getRandomElement(o)}function rb(a,e,n=0){if(!a)return[];const r=a.colors.getValues().filter(o=>!o.isSelectable||o.clubLevel>n?null:o);return!r||!r.length?null:$a.getRandomElements(r,eb(e))}function sb(a,e,n=0,r=[],o=[]){const s=Nt().structure,c=new eg(""),u=tb(s.getMandatorySetTypeIds(e,n),ce.SET_TYPES);for(const m of o){const h=a.getPartSetId(m),g=a.getColorIds(m);c.updatePart(m,h,g)}for(const m of u){if(c.hasPartType(m))continue;const h=s.figureData.getSetType(m),g=nb(h,e,n,r);if(!g)continue;let f=[];g.isColorable&&(f=rb(s.figureData.getPalette(h.paletteID),g,n).map(_=>_.id)),c.updatePart(h.type,g.id,f)}return c.getFigureString()}class ab extends io{init(){super.init(),this.addCategory(ce.HAIR),this.addCategory(ce.HAT),this.addCategory(ce.HEAD_ACCESSORIES),this.addCategory(ce.EYE_ACCESSORIES),this.addCategory(ce.FACE_ACCESSORIES),this._isInitalized=!0}get name(){return gr.HEAD}}class ob extends io{init(){super.init(),this.addCategory(ce.TROUSERS),this.addCategory(ce.SHOES),this.addCategory(ce.TROUSER_ACCESSORIES),this._isInitalized=!0}get name(){return gr.LEGS}}class ib extends io{init(){super.init(),this.addCategory(ce.SHIRT),this.addCategory(ce.CHEST_PRINTS),this.addCategory(ce.JACKET),this.addCategory(ce.CHEST_ACCESSORIES),this._isInitalized=!0}get name(){return gr.TORSO}}class qs{}qs.COLORMATRIX="colormatrix";qs.COMPOSITE="composite";class lb{constructor(e,n){this.texture=e,this.imageUrl=n}}class cb{constructor(e,n){this.effectName=e,this.thumbnailUrl=n}}class ub{constructor(e,n,r){this._productName=e,this._customImage=n,this._furnitureClassName=r}get productName(){return this._productName}get customImage(){return this._customImage}get furnitureClassName(){return this._furnitureClassName}}class Ft{}Ft.STATE_UNLOCKED=1;Ft.STATE_LOCKED_AVAILABLE=2;Ft.STATE_LOCKED_EXPIRED=3;Ft.STATE_LOCKED_FUTURE=4;class Pn{}Pn.TYPE_CHAT=1;Pn.TYPE_ROOM_INFO=2;Pn.TYPE_IM=3;const cd=()=>{const a=new Date;return`${a.getHours().toString().padStart(2,"0")}:${a.getMinutes().toString().padStart(2,"0")}`},ql=(a=0)=>{const e=a?new Date(Date.now()-a*1e3):new Date;return`${e.getHours().toString().padStart(2,"0")}:${e.getMinutes().toString().padStart(2,"0")}`},ud=a=>{if(!a||!a.length)return null;const e=a.split("/"),n=e[0],r=e[1],o=parseInt(e[2]);return{username:n,figure:r,userId:o}};class jt{constructor(){this.id=-1,this.name=null,this.gender=0,this.online=!1,this.followingAllowed=!1,this.figure=null,this.categoryId=0,this.motto=null,this.realName=null,this.lastAccess=null,this.persistedMessageUser=!1,this.vipMember=!1,this.pocketHabboUser=!1,this.relationshipStatus=-1,this.unread=0}populate(e){this.id=e.id,this.name=e.name,this.gender=e.gender,this.online=e.online,this.followingAllowed=e.followingAllowed,this.figure=e.figure,this.categoryId=e.categoryId,this.motto=e.motto,this.realName=e.realName,this.lastAccess=e.lastAccess,this.persistedMessageUser=e.persistedMessageUser,this.vipMember=e.vipMember,this.pocketHabboUser=e.pocketHabboUser,this.relationshipStatus=e.relationshipStatus}}jt.RELATIONSHIP_NONE=0;jt.RELATIONSHIP_HEART=1;jt.RELATIONSHIP_SMILE=2;jt.RELATIONSHIP_BOBBA=3;class zr{}zr.GROUP_CHAT=0;zr.PRIVATE_CHAT=1;class Wn{}Wn.HIDDEN=0;Wn.SHOW=1;Wn.UNREAD=2;class Yl{populate(e){return e?(this._id=e.requestId,this._name=e.requesterName,this._figureString=e.figureString,this._requesterUserId=e.requesterUserId,!0):!1}get id(){return this._id}get name(){return this._name}get requesterUserId(){return this._requesterUserId}get figureString(){return this._figureString}}class db{constructor(e=0,n=0,r=0,o=[]){this.userFriendLimit=e,this.normalFriendLimit=n,this.extendedFriendLimit=r,this.categories=o}}class jn{constructor(e,n,r=0,o=null,s=0){this._type=s,this._senderId=e,this._message=n,this._secondsSinceSent=r,this._extraData=o,this._date=new Date}get type(){return this._type}get senderId(){return this._senderId}get message(){return this._message}get secondsSinceSent(){return this._secondsSinceSent}get extraData(){return this._extraData}get date(){return this._date}}jn.CHAT=0;jn.ROOM_INVITE=1;jn.STATUS_NOTIFICATION=2;jn.SECURITY_NOTIFICATION=3;class mb{constructor(e,n=zr.PRIVATE_CHAT){this._userId=e,this._chats=[],this._type=n}addChat(e){this._chats.push(e)}get userId(){return this._userId}get chats(){return this._chats}get type(){return this._type}set type(e){this._type=e}}const dd=class{constructor(a){this._threadId=++dd.THREAD_ID,this._participant=a,this._groups=[],this._lastUpdated=new Date,this._unreadCount=0}addMessage(a,e,n=0,r=null,o=0){const s=a<0&&r,c=s?ud(r).userId:a,u=this.getLastGroup(c);if(!u)return;s&&(u.type=zr.GROUP_CHAT);const m=new jn(a,e,n,r,o);return u.addChat(m),this._lastUpdated=new Date,this._unreadCount++,m}getLastGroup(a){let e=this._groups[this._groups.length-1];return e&&e.userId===a||(e=new mb(a),this._groups.push(e)),e}setRead(){this._unreadCount=0}get threadId(){return this._threadId}get participant(){return this._participant}get groups(){return this._groups}get lastUpdated(){return this._lastUpdated}get unreadCount(){return this._unreadCount}get unread(){return this._unreadCount>0}};let zi=dd;zi.MESSAGE_RECEIVED="MT_MESSAGE_RECEIVED";zi.THREAD_ID=0;function co(a=0){ee(a===0?"friends-messenger/toggle":`friends-messenger/${a}`)}const gb=()=>hu.RENDERER_VERSION,md=()=>"2.1.1";function ea(a){M(new Fs(a,!0))}function gd(a){ee(`groups/manage/${a}`)}function zl(a,e){ee(e?`group-members/${a}/${e}`:`group-members/${a}`)}const Ci=class{constructor(a,e,n,r){this.type=a,this.key=e||0,this.color=n||0,this.position=r||4}get code(){return this.key===0&&this.type!==Ci.BASE?null:Ci.getCode(this.type,this.key,this.color,this.position)}static getCode(a,e,n,r){return a+(e<10?"0":"")+e+(n<10?"0":"")+n+r}};let zt=Ci;zt.BASE="b";zt.SYMBOL="s";class vt{}vt.NOT_MEMBER=0;vt.MEMBER=1;vt.REQUEST_PENDING=2;class on{}on.REGULAR=0;on.EXCLUSIVE=1;on.PRIVATE=2;const hb=a=>{M(a.favourite?new tg(a.groupId):new ng(a.groupId))},$i=a=>M(new rg(a));class ge{}ge.NONE="NONE";ge.ERROR="ERROR";ge.REJECTED="REJECTED";ge.USER_CREATE="USER_CREATE";ge.USER_PENDING="USER_PENDING";ge.USER_ONGOING="USER_ONGOING";ge.USER_FEEDBACK="USER_FEEDBACK";ge.USER_NO_HELPERS="USER_NO_HELPERS";ge.USER_SOMETHING_WRONG="USER_SOMETHING_WRONG";ge.USER_THANKS="USER_THANKS";ge.USER_GUIDE_DISCONNECTED="USER_GUIDE_DISCONNECTED";ge.GUIDE_TOOL_MENU="GUIDE_TOOL_MENU";ge.GUIDE_ACCEPT="GUIDE_ACCEPT";ge.GUIDE_ONGOING="GUIDE_ONGOING";ge.GUIDE_CLOSED="GUIDE_CLOSED";ge.GUARDIAN_CHAT_REVIEW_ACCEPT="GUARDIAN_CHAT_REVIEW_ACCEPT";ge.GUARDIAN_CHAT_REVIEW_WAIT_FOR_VOTERS="GUARDIAN_CHAT_REVIEW_WAIT_FOR_VOTERS";ge.GUARDIAN_CHAT_REVIEW_VOTE="GUARDIAN_CHAT_REVIEW_VOTE";ge.GUARDIAN_CHAT_REVIEW_WAIT_FOR_RESULTS="GUARDIAN_CHAT_REVIEW_WAIT_FOR_RESULTS";ge.GUARDIAN_CHAT_REVIEW_RESULTS="GUARDIAN_CHAT_REVIEW_RESULTS";class $l{constructor(e,n){this._message=e,this._roomId=n}get message(){return this._message}get roomId(){return this._roomId}}class Kl{constructor(e){this._userId=e,this._messages=[]}addChat(e){this._messages.push(e)}get userId(){return this._userId}get messages(){return this._messages}}class Bn{}Bn.ACTIVE="active";Bn.NONE="none";Bn.EXPIRED="expired";const fb="HC1",pb=["ACH_VipHC1","ACH_VipHC2","ACH_VipHC3","ACH_VipHC4","ACH_VipHC5","HC1","HC2","HC3","HC4","HC5"],Ib=a=>{let e=null;return pb.forEach(n=>a.indexOf(n)>-1&&(e=n)),e||fb};class Ka{}Ka.TOO_MANY_PENDING_CALLS_CODE=1;Ka.HAS_ABUSIVE_CALL_CODE=2;const Eb=a=>a===1?"useless":a===2?"abusive":"resolved";class kt{}kt.SELECT_USER=0;kt.SELECT_CHATS=1;kt.SELECT_TOPICS=2;kt.INPUT_REPORT_MESSAGE=3;kt.REPORT_SUMMARY=4;class Ve{}Ve.EMERGENCY=1;Ve.GUIDE=2;Ve.IM=3;Ve.ROOM=4;Ve.BULLY=6;Ve.THREAD=7;Ve.MESSAGE=8;Ve.PHOTO=9;const _b=a=>{switch(a){case 1:case 2:return"Normal";case 3:return"Automatic";case 4:return"Automatic IM";case 5:return"Guide System";case 6:return"IM";case 7:return"Room";case 8:return"Panic";case 9:return"Guardian";case 10:return"Automatic Helper";case 11:return"Discussion";case 12:return"Selfie";case 14:return"Photo";case 15:return"Ambassador"}return"Unknown"};class Le{constructor(e,n,r,o,s){this._actionId=e,this._name=n,this._actionType=r,this._sanctionTypeId=o,this._actionLengthHours=s}get actionId(){return this._actionId}get name(){return this._name}get actionType(){return this._actionType}get sanctionTypeId(){return this._sanctionTypeId}get actionLengthHours(){return this._actionLengthHours}}Le.ALERT=1;Le.MUTE=2;Le.BAN=3;Le.KICK=4;Le.TRADE_LOCK=5;Le.MESSAGE=6;class Pe{}Pe.NONE=0;Pe.START_DOORBELL=1;Pe.START_PASSWORD=2;Pe.STATE_PENDING_SERVER=3;Pe.UPDATE_STATE=4;Pe.STATE_WAITING=5;Pe.STATE_NO_ANSWER=6;Pe.STATE_WRONG_PASSWORD=7;Pe.STATE_ACCEPTED=8;class dr{}dr.LIST=0;dr.THUMBNAILS=1;dr.FORCED_THUMBNAILS=2;const Cb=()=>{const a=[];for(let e=10;e<=100;e=e+10)a.push(e);return a},Xl=Cb(),ss=[{name:"anything",query:null},{name:"room.name",query:"roomname"},{name:"owner",query:"owner"},{name:"tag",query:"tag"},{name:"group",query:"group"}];function En(a){M(new Wa(a,!1,!0))}class de{}de.DEFAULT="default";de.MOTD="motd";de.MODERATION="moderation";de.EVENT="event";de.NITRO="nitro";de.SEARCH="search";de.ALERT="alert";const bi=class{constructor(a,e=de.DEFAULT,n=null,r=null,o=null,s=null){bi.ITEM_ID+=1,this._id=bi.ITEM_ID,this._messages=a,this._alertType=e,this._clickUrl=n,this._clickUrlText=r,this._title=o,this._imageUrl=s}get id(){return this._id}get messages(){return this._messages}set alertType(a){this._alertType=a}get alertType(){return this._alertType}get clickUrl(){return this._clickUrl}get clickUrlText(){return this._clickUrlText}get title(){return this._title}get imageUrl(){return this._imageUrl}};let Si=bi;Si.ITEM_ID=-1;class $e{}$e.FRIENDOFFLINE="friendoffline";$e.FRIENDONLINE="friendonline";$e.THIRDPARTYFRIENDOFFLINE="thirdpartyfriendoffline";$e.THIRDPARTYFRIENDONLINE="thirdpartyfriendonline";$e.ACHIEVEMENT="achievement";$e.BADGE_RECEIVED="badge_received";$e.INFO="info";$e.RECYCLEROK="recyclerok";$e.RESPECT="respect";$e.CLUB="club";$e.SOUNDMACHINE="soundmachine";$e.PETLEVEL="petlevel";$e.CLUBGIFT="clubgift";$e.BUYFURNI="buyfurni";$e.VIP="vip";$e.ROOMMESSAGESPOSTED="roommessagesposted";const Ni=class{constructor(a,e=$e.INFO,n=null,r=null){Ni.ITEM_ID+=1,this._id=Ni.ITEM_ID,this._message=a,this._notificationType=e,this._iconUrl=n,this._linkUrl=r}get id(){return this._id}get message(){return this._message}get notificationType(){return this._notificationType}get iconUrl(){return this._iconUrl}get linkUrl(){return this._linkUrl}};let hd=Ni;hd.ITEM_ID=-1;const Ti=class{constructor(a,e,n,r,o,s,c){Ti.ITEM_ID+=1,this._id=Ti.ITEM_ID,this._confirmType=a,this._message=e,this._onConfirm=n,this._onCancel=r,this._confirmText=o,this._cancelText=s,this._title=c}get id(){return this._id}get confirmType(){return this._confirmType}get message(){return this._message}get onConfirm(){return this._onConfirm}get onCancel(){return this._onCancel}get confirmText(){return this._confirmText}get cancelText(){return this._cancelText}get title(){return this._title}};let fd=Ti;fd.ITEM_ID=-1;class Ki{constructor(){this._credits=0,this._activityPoints=new Map,this._clubDays=0,this._clubPeriods=0,this._isVIP=!1,this._pastClubDays=0,this._pastVipDays=0,this._isExpiring=!1,this._minutesUntilExpiration=0,this._minutesSinceLastModified=0,this._lastUpdated=0}static from(e){const n=new Ki;return n._credits=e._credits,n._activityPoints=e._activityPoints,n._clubDays=e._clubDays,n._clubPeriods=e._clubPeriods,n._isVIP=e._isVIP,n._pastClubDays=e._pastClubDays,n._pastVipDays=e._pastVipDays,n._isExpiring=e._isExpiring,n._minutesUntilExpiration=e._minutesUntilExpiration,n._minutesSinceLastModified=e._minutesSinceLastModified,n._lastUpdated=e._lastUpdated,n}get credits(){return this._credits}set credits(e){this._lastUpdated=Rn(),this._credits=e}get activityPoints(){return this._activityPoints}set activityPoints(e){this._lastUpdated=Rn(),this._activityPoints=e}get clubDays(){return this._clubDays}set clubDays(e){this._lastUpdated=Rn(),this._clubDays=e}get clubPeriods(){return this._clubPeriods}set clubPeriods(e){this._lastUpdated=Rn(),this._clubPeriods=e}get hasClubLeft(){return this._clubDays>0||this._clubPeriods>0}get isVip(){return this._isVIP}set isVip(e){this._isVIP=e}get pastClubDays(){return this._pastClubDays}set pastClubDays(e){this._lastUpdated=Rn(),this._pastClubDays=e}get pastVipDays(){return this._pastVipDays}set pastVipDays(e){this._lastUpdated=Rn(),this._pastVipDays=e}get isExpiring(){return this._isExpiring}set isExpiring(e){this._isExpiring=e}get minutesUntilExpiration(){var e=(Rn()-this._lastUpdated)/6e4,n=this._minutesUntilExpiration-e;return n>0?n:0}set minutesUntilExpiration(e){this._lastUpdated=Rn(),this._minutesUntilExpiration=e}get minutesSinceLastModified(){return this._minutesSinceLastModified}set minutesSinceLastModified(e){this._lastUpdated=Rn(),this._minutesSinceLastModified=e}get lastUpdated(){return this._lastUpdated}get clubLevel(){return this.clubDays===0&&this.clubPeriods===0?un.NO_CLUB:this.isVip?un.VIP:un.CLUB}}class ta extends Dn{}class mr extends ta{constructor(e,n){super(e),this._id=-1,this._numQuestions=0,this._startMessage="",this._endMessage="",this._questionArray=null,this._pollType="",this._npsPoll=!1,this._id=n}get id(){return this._id}get summary(){return this._summary}set summary(e){this._summary=e}get headline(){return this._headline}set headline(e){this._headline=e}get numQuestions(){return this._numQuestions}set numQuestions(e){this._numQuestions=e}get startMessage(){return this._startMessage}set startMessage(e){this._startMessage=e}get endMessage(){return this._endMessage}set endMessage(e){this._endMessage=e}get questionArray(){return this._questionArray}set questionArray(e){this._questionArray=e}get pollType(){return this._pollType}set pollType(e){this._pollType=e}get npsPoll(){return this._npsPoll}set npsPoll(e){this._npsPoll=e}}mr.OFFER="RWPUW_OFFER";mr.ERROR="RWPUW_ERROR";mr.CONTENT="RWPUW_CONTENT";class Tr extends ta{constructor(e,n=0,r=0,o=0){super(e),this._hue=n,this._saturation=r,this._lightness=o}get hue(){return this._hue}get saturation(){return this._saturation}get lightness(){return this._lightness}}Tr.PREVIEW="RWUBCPE_PREVIEW";Tr.CLEAR_PREVIEW="RWUBCPE_CLEAR_PREVIEW";const pd=class extends ta{constructor(a,e){super(pd.CHAT_INPUT_CONTENT),this._chatMode="",this._userName="",this._chatMode=a,this._userName=e}get chatMode(){return this._chatMode}get userName(){return this._userName}};let wr=pd;wr.CHAT_INPUT_CONTENT="RWUCICE_CHAT_INPUT_CONTENT";wr.WHISPER="whisper";wr.SHOUT="shout";const Id=class extends ta{constructor(a,e,n,r,o,s,c){super(Id.UPDATE_CHAT),this._objectId=a,this._category=e,this._botId=n,this._chat=r,this._automaticChat=o,this._chatDelay=s,this._mixSentences=c}get objectId(){return this._objectId}get category(){return this._category}get botId(){return this._botId}get chat(){return this._chat}get automaticChat(){return this._automaticChat}get chatDelay(){return this._chatDelay}get mixSentences(){return this._mixSentences}};let Xi=Id;Xi.UPDATE_CHAT="RWURBCE_UPDATE_CHAT";class Re extends ta{constructor(e,n,r,o){super(e),this._id=n,this._category=r,this._roomId=o}get id(){return this._id}get category(){return this._category}get roomId(){return this._roomId}}Re.OBJECT_SELECTED="RWUROE_OBJECT_SELECTED";Re.OBJECT_DESELECTED="RWUROE_OBJECT_DESELECTED";Re.USER_REMOVED="RWUROE_USER_REMOVED";Re.FURNI_REMOVED="RWUROE_FURNI_REMOVED";Re.FURNI_ADDED="RWUROE_FURNI_ADDED";Re.USER_ADDED="RWUROE_USER_ADDED";Re.OBJECT_ROLL_OVER="RWUROE_OBJECT_ROLL_OVER";Re.OBJECT_ROLL_OUT="RWUROE_OBJECT_ROLL_OUT";Re.OBJECT_REQUEST_MANIPULATION="RWUROE_OBJECT_REQUEST_MANIPULATION";Re.OBJECT_DOUBLE_CLICKED="RWUROE_OBJECT_DOUBLE_CLICKED";class bs{constructor(e){this.type=e,this.id=0,this.category=0,this.name="",this.description="",this.image=null,this.isWallItem=!1,this.isStickie=!1,this.isRoomOwner=!1,this.roomControllerLevel=0,this.isAnyRoomController=!1,this.expiration=-1,this.purchaseCatalogPageId=-1,this.purchaseOfferId=-1,this.extraParam="",this.isOwner=!1,this.stuffData=null,this.groupId=0,this.ownerId=0,this.ownerName="",this.usagePolicy=0,this.rentCatalogPageId=-1,this.rentOfferId=-1,this.purchaseCouldBeUsedForBuyout=!1,this.rentCouldBeUsedForBuyout=!1,this.availableForBuildersClub=!1,this.tileSizeX=1,this.tileSizeY=1}}bs.FURNI="IFI_FURNI";class Ed{constructor(e,n,r,o,s,c=!1){this.roomIndex=e,this.category=n,this.id=r,this.name=o,this.userType=s,this.isFriend=c}}class Ss{constructor(e){this.type=e,this.level=0,this.maximumLevel=0,this.experience=0,this.levelExperienceGoal=0,this.energy=0,this.maximumEnergy=0,this.happyness=0,this.maximumHappyness=0,this.respectsPetLeft=0,this.respect=0,this.age=0,this.name="",this.id=-1,this.image=null,this.petType=0,this.petBreed=0,this.petFigure="",this.posture="std",this.isOwner=!1,this.ownerId=-1,this.ownerName="",this.canRemovePet=!1,this.roomIndex=0,this.unknownRarityLevel=0,this.saddle=!1,this.rider=!1,this.breedable=!1,this.skillTresholds=[],this.publiclyRideable=0,this.fullyGrown=!1,this.dead=!1,this.rarityLevel=0,this.maximumTimeToLive=0,this.remainingTimeToLive=0,this.remainingGrowTime=0,this.publiclyBreedable=!1}}Ss.PET_INFO="IPI_PET_INFO";class Ns{constructor(e){this.type=e,this.name="",this.motto="",this.webID=0,this.figure="",this.badges=[],this.carryItem=0,this.roomIndex=0,this.amIOwner=!1,this.amIAnyRoomController=!1,this.roomControllerLevel=0,this.ownerId=-1,this.ownerName="",this.botSkills=[]}}Ns.RENTABLE_BOT="IRBI_RENTABLE_BOT";const _d=class{constructor(a){this.type=a,this.name="",this.motto="",this.achievementScore=0,this.webID=0,this.xp=0,this.userType=-1,this.figure="",this.badges=[],this.groupId=0,this.groupName="",this.groupBadgeId="",this.carryItem=0,this.roomIndex=0,this.isSpectatorMode=!1,this.allowNameChange=!1,this.amIOwner=!1,this.amIAnyRoomController=!1,this.roomControllerLevel=0,this.canBeKicked=!1,this.canBeBanned=!1,this.canBeMuted=!1,this.respectLeft=0,this.isIgnored=!1,this.isGuildRoom=!1,this.canTrade=!1,this.canTradeReason=0,this.targetRoomControllerLevel=0,this.isAmbassador=!1}get isOwnUser(){return this.type===_d.OWN_USER}};let et=_d;et.OWN_USER="IUI_OWN_USER";et.PEER="IUI_PEER";et.BOT="IUI_BOT";et.TRADE_REASON_OK=0;et.TRADE_REASON_SHUTDOWN=2;et.TRADE_REASON_NO_TRADING=3;et.DEFAULT_BOT_BADGE_ID="BOT";class as{static getObjectName(e,n){const r=Oe();let o=-1,s=null,c=0;switch(n){case Q.FLOOR:case Q.WALL:{const u=q().getRoomObject(r.roomId,e,n);if(!u)break;if(u.type.indexOf("poster")===0)s=d("${poster_"+parseInt(u.type.replace("poster",""))+"_name}");else{let m=null;const h=u.model.getValue(te.FURNITURE_TYPE_ID);if(n===Q.FLOOR?m=H().getFloorItemData(h):n===Q.WALL&&(m=H().getWallItemData(h)),!m)break;o=m.id,s=m.name}break}case Q.UNIT:{const u=r.userDataManager.getUserDataByIndex(e);if(!u)break;o=u.webID,s=u.name,c=u.type;break}}return!s||!s.length?null:new Ed(e,n,o,s,c)}static getFurniInfo(e,n){const r=Oe(),o=new bs(bs.FURNI);o.id=e,o.category=n;const s=q().getRoomObject(r.roomId,e,n);if(!s)return;const c=s.model;c.getValue(cr.INFOSTAND_EXTRA_PARAM)&&(o.extraParam=c.getValue(cr.INFOSTAND_EXTRA_PARAM));const u=c.getValue(te.FURNITURE_DATA_FORMAT),m=fu.getData(u);m.initializeFromRoomObjectModel(c),o.stuffData=m;const h=s.type;if(h.indexOf("poster")===0){const I=parseInt(h.replace("poster",""));o.name=d("${poster_"+I+"_name}"),o.description=d("${poster_"+I+"_desc}")}else{const I=c.getValue(te.FURNITURE_TYPE_ID);let C=null;n===Q.FLOOR?C=H().getFloorItemData(I):n===Q.WALL&&(C=H().getWallItemData(I)),C&&(o.name=C.name,o.description=C.description,o.purchaseOfferId=C.purchaseOfferId,o.purchaseCouldBeUsedForBuyout=C.purchaseCouldBeUsedForBuyout,o.rentOfferId=C.rentOfferId,o.rentCouldBeUsedForBuyout=C.rentCouldBeUsedForBuyout,o.availableForBuildersClub=C.availableForBuildersClub,o.tileSizeX=C.tileSizeX,o.tileSizeY=C.tileSizeY)}h.indexOf("post_it")>-1&&(o.isStickie=!0);const g=c.getValue(te.FURNITURE_EXPIRY_TIME),f=c.getValue(te.FURNITURE_EXPIRTY_TIMESTAMP);o.expiration=g<0?g:Math.max(0,g-(Rn()-f)/1e3);let _=q().getRoomObjectImage(r.roomId,e,n,new Rt(180),64,null);(!_.data||_.data.width>140||_.data.height>200)&&(_=q().getRoomObjectImage(r.roomId,e,n,new Rt(180),1,null)),o.image=_.getImage(),o.isWallItem=n===Q.WALL,o.isRoomOwner=r.isRoomOwner,o.roomControllerLevel=r.controllerLevel,o.isAnyRoomController=H().isModerator,o.ownerId=c.getValue(te.FURNITURE_OWNER_ID),o.ownerName=c.getValue(te.FURNITURE_OWNER_NAME),o.usagePolicy=c.getValue(te.FURNITURE_USAGE_POLICY);const E=c.getValue(te.FURNITURE_GUILD_CUSTOMIZED_GUILD_ID);return E!==0&&(o.groupId=E),Wt(s)&&(o.isOwner=!0),o}static getUserInfo(e,n){const r=Oe();let o=et.OWN_USER;n.webID!==H().userId&&(o=et.PEER);const s=new et(o);s.isSpectatorMode=r.isSpectator,s.name=n.name,s.motto=n.custom,s.achievementScore=n.activityPoints,s.webID=n.webID,s.roomIndex=n.roomIndex,s.userType=ht.USER;const c=q().getRoomObject(r.roomId,n.roomIndex,e);if(c&&(s.carryItem=c.model.getValue(te.FIGURE_CARRY_OBJECT)||0),o===et.OWN_USER&&(s.allowNameChange=H().canChangeName),s.amIOwner=r.isRoomOwner,s.isGuildRoom=r.isGuildRoom,s.roomControllerLevel=r.controllerLevel,s.amIAnyRoomController=H().isModerator,s.isAmbassador=H().isAmbassador,o===et.PEER){if(c){const h=c.model.getValue(te.FIGURE_FLAT_CONTROL);h!==null&&(s.targetRoomControllerLevel=h),s.canBeMuted=this.canBeMuted(s),s.canBeKicked=this.canBeKicked(s),s.canBeBanned=this.canBeBanned(s)}s.isIgnored=H().isUserIgnored(n.name),s.respectLeft=H().respectsLeft;const u=H().isSystemShutdown,m=r.tradeMode;if(u)s.canTrade=!1;else switch(m){case Ro.ROOM_CONTROLLER_REQUIRED:{const h=s.roomControllerLevel!==tt.NONE&&s.roomControllerLevel!==tt.GUILD_MEMBER,g=s.targetRoomControllerLevel!==tt.NONE&&s.targetRoomControllerLevel!==tt.GUILD_MEMBER;s.canTrade=h||g;break}case Ro.NO_TRADING:s.canTrade=!0;break;default:s.canTrade=!1;break}s.canTradeReason=et.TRADE_REASON_OK,u&&(s.canTradeReason=et.TRADE_REASON_SHUTDOWN),m!==Ro.FREE_TRADING&&(s.canTradeReason=et.TRADE_REASON_NO_TRADING)}return s.groupId=n.groupId,s.groupBadgeId=H().getGroupBadge(s.groupId),s.groupName=n.groupName,s.badges=r.userDataManager.getUserBadges(n.webID),s.figure=n.figure,s}static getBotInfo(e,n){const r=Oe(),o=new et(et.BOT);o.name=n.name,o.motto=n.custom,o.webID=n.webID,o.roomIndex=n.roomIndex,o.userType=n.type;const s=q().getRoomObject(r.roomId,n.roomIndex,e);return s&&(o.carryItem=s.model.getValue(te.FIGURE_CARRY_OBJECT)||0),o.amIOwner=r.isRoomOwner,o.isGuildRoom=r.isGuildRoom,o.roomControllerLevel=r.controllerLevel,o.amIAnyRoomController=H().isModerator,o.isAmbassador=H().isAmbassador,o.badges=[et.DEFAULT_BOT_BADGE_ID],o.figure=n.figure,o}static getRentableBotInfo(e,n){const r=Oe(),o=new Ns(Ns.RENTABLE_BOT);o.name=n.name,o.motto=n.custom,o.webID=n.webID,o.roomIndex=n.roomIndex,o.ownerId=n.ownerId,o.ownerName=n.ownerName,o.botSkills=n.botSkills;const s=q().getRoomObject(r.roomId,n.roomIndex,e);return s&&(o.carryItem=s.model.getValue(te.FIGURE_CARRY_OBJECT)||0),o.amIOwner=r.isRoomOwner,o.roomControllerLevel=r.controllerLevel,o.amIAnyRoomController=H().isModerator,o.badges=[et.DEFAULT_BOT_BADGE_ID],o.figure=n.figure,o}static getPetInfo(e){const n=Oe(),r=n.userDataManager.getPetData(e.id);if(!r)return;const o=new Is(r.figure);let s=null;o.typeId===xt.MONSTERPLANT&&(e.level>=e.adultLevel?s="std":s="grw"+e.level);const c=e.ownerId===H().userId,u=new Ss(Ss.PET_INFO);return u.name=r.name,u.id=e.id,u.ownerId=e.ownerId,u.ownerName=e.ownerName,u.rarityLevel=e.rarityLevel,u.petType=o.typeId,u.petBreed=o.paletteId,u.petFigure=r.figure,u.posture=s,u.isOwner=c,u.roomIndex=r.roomIndex,u.level=e.level,u.maximumLevel=e.maximumLevel,u.experience=e.experience,u.levelExperienceGoal=e.levelExperienceGoal,u.energy=e.energy,u.maximumEnergy=e.maximumEnergy,u.happyness=e.happyness,u.maximumHappyness=e.maximumHappyness,u.respect=e.respect,u.respectsPetLeft=H().respectsPetLeft,u.age=e.age,u.saddle=e.saddle,u.rider=e.rider,u.breedable=e.breedable,u.fullyGrown=e.fullyGrown,u.dead=e.dead,u.rarityLevel=e.rarityLevel,u.skillTresholds=e.skillTresholds,u.canRemovePet=!1,u.publiclyRideable=e.publiclyRideable,u.maximumTimeToLive=e.maximumTimeToLive,u.remainingTimeToLive=e.remainingTimeToLive,u.remainingGrowTime=e.remainingGrowTime,u.publiclyBreedable=e.publiclyBreedable,(c||n.isRoomOwner||H().isModerator||n.controllerLevel>=tt.GUEST)&&(u.canRemovePet=!0),u}static checkGuildSetting(e){return e.isGuildRoom?e.roomControllerLevel>=tt.GUILD_ADMIN:e.roomControllerLevel>=tt.GUEST}static isValidSetting(e,n){const r=Oe();if(!r.isPrivateRoom)return!1;const o=r.moderationSettings;let s=!1;return o&&(s=n(e,o)),s&&e.targetRoomControllerLevel<tt.ROOM_OWNER}static canBeMuted(e){const n=(r,o)=>{switch(o.allowMute){case Un.MODERATION_LEVEL_USER_WITH_RIGHTS:return this.checkGuildSetting(r);default:return r.roomControllerLevel>=tt.ROOM_OWNER}};return this.isValidSetting(e,n)}static canBeKicked(e){const n=(r,o)=>{switch(o.allowKick){case Un.MODERATION_LEVEL_ALL:return!0;case Un.MODERATION_LEVEL_USER_WITH_RIGHTS:return this.checkGuildSetting(r);default:return r.roomControllerLevel>=tt.ROOM_OWNER}};return this.isValidSetting(e,n)}static canBeBanned(e){const n=(r,o)=>{switch(o.allowBan){case Un.MODERATION_LEVEL_USER_WITH_RIGHTS:return this.checkGuildSetting(r);default:return r.roomControllerLevel>=tt.ROOM_OWNER}};return this.isValidSetting(e,n)}}class Ne{}Ne.GENERIC_SKILL=0;Ne.DRESS_UP=1;Ne.SETUP_CHAT=2;Ne.RANDOM_WALK=3;Ne.DANCE=4;Ne.CHANGE_BOT_NAME=5;Ne.SERVE_BEVERAGE=6;Ne.INCLIENT_LINK=7;Ne.NUX_PROCEED=8;Ne.CHANGE_BOT_MOTTO=9;Ne.NUX_TAKE_TOUR=10;Ne.NO_PICK_UP=12;Ne.NAVIGATOR_SEARCH=14;Ne.DONATE_TO_USER=24;Ne.DONATE_TO_ALL=25;const Cd=class{constructor(a=-1,e=-1,n=-1,r="",o="",s="",c=null,u=0,m=0,h=null,g=null){this.senderId=a,this.senderCategory=e,this.roomId=n,this.text=r,this.formattedText=o,this.username=s,this.location=c,this.type=u,this.styleId=m,this.imageUrl=h,this.color=g,this.id=-1,this.width=0,this.height=0,this.elementRef=null,this.skipMovement=!1,this._top=0,this._left=0,this.id=++Cd.BUBBLE_COUNTER}get top(){return this._top}set top(a){this._top=a,this.elementRef&&(this.elementRef.style.top=this._top+"px")}get left(){return this._left}set left(a){this._left=a,this.elementRef&&(this.elementRef.style.left=this._left+"px")}};let bd=Cd;bd.BUBBLE_COUNTER=0;class Vn{}Vn.CHAT_DEFAULT=0;Vn.CHAT_WHISPER=1;Vn.CHAT_SHOUT=2;class Ql{constructor(e=0,n=0,r=0,o=0){this.id=e,this.type=n,this.color=r,this.light=o}}const bb=(a,e,n,r=0)=>!(a.left+r+a.width<e.left+r||a.left+r>e.left+r+e.width||a.top+a.height<e.top+n||a.top>e.top+n+e.height);class nn{static savePreset(e,n,r,o,s){Oe().updateMoodlightData(e,n,r,o,s)}static changeState(){Oe().toggleMoodlightState()}static previewDimmer(e,n,r){q().updateObjectRoomColor(Oe().roomId,e,n,r)}static scaleBrightness(e){return~~((e-this.MIN_BRIGHTNESS)*(100-0)/(this.MAX_BRIGHTNESS-this.MIN_BRIGHTNESS)+0)}}nn.AVAILABLE_COLORS=[7665141,21495,15161822,15353138,15923281,8581961,0];nn.HTML_COLORS=["#74F5F5","#0053F7","#E759DE","#EA4532","#F2F851","#82F349","#000000"];nn.MIN_BRIGHTNESS=76;nn.MAX_BRIGHTNESS=255;const Sb=130,Nb=100,Tb=130,vb=100,wb=130,Rb=100,Sd=a=>{let e=0,n=0,r=0,o=0;for(;o<a.length;){switch(o%3){case 0:e=e+a.charCodeAt(o)*37;break;case 1:n=n+a.charCodeAt(o)*37;break;case 2:r=r+a.charCodeAt(o)*37;break}o++}return e=e%Nb+Sb,n=n%vb+Tb,r=r%Rb+wb,`rgb(${e},${n},${r})`};class fs{static getMergedMannequinFigureContainer(e,n){const r=Nt().createFigureContainer(e),o=Nt().createFigureContainer(n);for(const s of this.MANNEQUIN_CLOTHING_PART_TYPES)r.removePart(s);for(const s of o.getPartTypeIds())r.updatePart(s,o.getPartSetId(s),o.getPartColorIds(s));return r}static transformAsMannequinFigure(e){for(const n of e.getPartTypeIds())this.MANNEQUIN_CLOTHING_PART_TYPES.indexOf(n)>=0||e.removePart(n);e.updatePart(this.MANNEQUIN_FIGURE[0],this.MANNEQUIN_FIGURE[1],this.MANNEQUIN_FIGURE[2])}}fs.MANNEQUIN_FIGURE=["hd",99999,[99998]];fs.MANNEQUIN_CLOTHING_PART_TYPES=[He.CHEST_ACCESSORY,He.COAT_CHEST,He.CHEST,He.LEGS,He.SHOES,He.WAIST_ACCESSORY];class Xa{}Xa.POSTURE_STAND=0;Xa.POSTURE_SIT=1;class ms{constructor(e,n,r){this._id=e,this._category=n,this._name=r}get id(){return this._id}get category(){return this._category}get name(){return this._name}}class yb{constructor(e,n,r,o,s,c,u){this.id=e,this.category=n,this.name=r,this.requestRoomObjectId=o,this.targetRoomObjectId=s,this.requestInventoryStripId=c,this.replace=u}}const Qa="0",Nd="1";class An{}An.UNSTARTED=-1;An.ENDED=0;An.PLAYING=1;An.PAUSED=2;An.BUFFERING=3;An.CUED=5;function Jt(a){M(new sg(a))}const na=a=>{const e=Math.floor(a/2);return a%2?(e+.5).toString():e.toString()};class he{}he.TOGGLE_FURNI_STATE=0;he.RESET=1;he.SET_FURNI_STATE=3;he.MOVE_FURNI=4;he.GIVE_SCORE=6;he.CHAT=7;he.TELEPORT=8;he.JOIN_TEAM=9;he.LEAVE_TEAM=10;he.CHASE=11;he.FLEE=12;he.MOVE_AND_ROTATE_FURNI=13;he.GIVE_SCORE_TO_PREDEFINED_TEAM=14;he.TOGGLE_TO_RANDOM_STATE=15;he.MOVE_FURNI_TO=16;he.GIVE_REWARD=17;he.CALL_ANOTHER_STACK=18;he.KICK_FROM_ROOM=19;he.MUTE_USER=20;he.BOT_TELEPORT=21;he.BOT_MOVE=22;he.BOT_TALK=23;he.BOT_GIVE_HAND_ITEM=24;he.BOT_FOLLOW_AVATAR=25;he.BOT_CHANGE_FIGURE=26;he.BOT_TALK_DIRECT_TO_AVTR=27;class fe{}fe.STATES_MATCH=0;fe.FURNIS_HAVE_AVATARS=1;fe.ACTOR_IS_ON_FURNI=2;fe.TIME_ELAPSED_MORE=3;fe.TIME_ELAPSED_LESS=4;fe.USER_COUNT_IN=5;fe.ACTOR_IS_IN_TEAM=6;fe.HAS_STACKED_FURNIS=7;fe.STUFF_TYPE_MATCHES=8;fe.STUFFS_IN_FORMATION=9;fe.ACTOR_IS_GROUP_MEMBER=10;fe.ACTOR_IS_WEARING_BADGE=11;fe.ACTOR_IS_WEARING_EFFECT=12;fe.NOT_STATES_MATCH=13;fe.FURNI_NOT_HAVE_HABBO=14;fe.NOT_ACTOR_ON_FURNI=15;fe.NOT_USER_COUNT_IN=16;fe.NOT_ACTOR_IN_TEAM=17;fe.NOT_HAS_STACKED_FURNIS=18;fe.NOT_FURNI_IS_OF_TYPE=19;fe.NOT_STUFFS_IN_FORMATION=20;fe.NOT_ACTOR_IN_GROUP=21;fe.NOT_ACTOR_WEARS_BADGE=22;fe.NOT_ACTOR_WEARING_EFFECT=23;fe.DATE_RANGE_ACTIVE=24;fe.ACTOR_HAS_HANDITEM=25;const Jl=a=>`${a.getFullYear()}/${("0"+(a.getMonth()+1)).slice(-2)}/${("0"+a.getDate()).slice(-2)} ${("0"+a.getHours()).slice(-2)}:${("0"+a.getMinutes()).slice(-2)}`;class ie{}ie.STUFF_SELECTION_OPTION_NONE=0;ie.STUFF_SELECTION_OPTION_BY_ID=1;ie.STUFF_SELECTION_OPTION_BY_ID_OR_BY_TYPE=2;ie.STUFF_SELECTION_OPTION_BY_ID_BY_TYPE_OR_FROM_CONTEXT=3;const Ob=`
attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;
uniform mat3 projectionMatrix;
varying vec2 vTextureCoord;
void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`,Ab=`
varying vec2 vTextureCoord;
uniform sampler2D uSampler;
uniform vec3 lineColor;
uniform vec3 color;
void main(void) {
    vec4 currentColor = texture2D(uSampler, vTextureCoord);
    vec3 colorLine = lineColor * currentColor.a;
    vec3 colorOverlay = color * currentColor.a;

    if(currentColor.r == 0.0 && currentColor.g == 0.0 && currentColor.b == 0.0 && currentColor.a > 0.0) {
        gl_FragColor = vec4(colorLine.r, colorLine.g, colorLine.b, currentColor.a);
    } else if(currentColor.a > 0.0) {
        gl_FragColor = vec4(colorOverlay.r, colorOverlay.g, colorOverlay.b, currentColor.a);
    }
}`;class kb extends ag{constructor(e,n){super(Ob,Ab),this.uniforms.lineColor=new Float32Array(3),this.uniforms.color=new Float32Array(3),this.lineColor=e,this.color=n}get lineColor(){return this._lineColor}set lineColor(e){const n=this.uniforms.lineColor;typeof e=="number"?(ln.hex2rgb(e,n),this._lineColor=e):(n[0]=e[0],n[1]=e[1],n[2]=e[2],this._lineColor=ln.rgb2hex(n))}get color(){return this._color}set color(e){const n=this.uniforms.color;typeof e=="number"?(ln.hex2rgb(e,n),this._color=e):(n[0]=e[0],n[1]=e[1],n[2]=e[2],this._color=ln.rgb2hex(n))}}const Qn=class{static show(a){Qn.applySelectionShader(Qn.getRoomObject(a))}static hide(a){Qn.clearSelectionShader(Qn.getRoomObject(a))}static clearSelectionShaderFromFurni(a){for(const e of a)Qn.clearSelectionShader(Qn.getRoomObject(e))}static applySelectionShaderToFurni(a){for(const e of a)Qn.applySelectionShader(Qn.getRoomObject(e))}static getRoomObject(a){const e=q();return e.getRoomObject(e.activeRoomId,a,Q.FLOOR)}static applySelectionShader(a){if(!a)return;const e=a.visualization;if(e)for(const n of e.sprites)n.blendMode!==1&&(n.filters=[Qn._selectionShader])}static clearSelectionShader(a){if(!a)return;const e=a.visualization;if(e)for(const n of e.sprites)n.filters=[]}};let ps=Qn;ps._selectionShader=new kb([1,1,1],[.6,.6,.6]);const Ts="	";class Je{}Je.AVATAR_SAYS_SOMETHING=0;Je.AVATAR_WALKS_ON_FURNI=1;Je.AVATAR_WALKS_OFF_FURNI=2;Je.EXECUTE_ONCE=3;Je.TOGGLE_FURNI=4;Je.EXECUTE_PERIODICALLY=6;Je.AVATAR_ENTERS_ROOM=7;Je.GAME_STARTS=8;Je.GAME_ENDS=9;Je.SCORE_ACHIEVED=10;Je.COLLISION=11;Je.EXECUTE_PERIODICALLY_LONG=12;Je.BOT_REACHED_STUFF=13;Je.BOT_REACHED_AVATAR=14;const U=a=>{const{ref:e=null,innerRef:n=null,display:r=null,fit:o=!1,fitV:s=!1,grow:c=!1,shrink:u=!1,fullWidth:m=!1,fullHeight:h=!1,overflow:g=null,position:f=null,float:_=null,pointer:E=!1,visible:I=null,textColor:C=null,classNames:p=[],className:b="",style:N={},children:v=null,...O}=a,R=i.useMemo(()=>{const P=[];return r&&r.length&&P.push("d-"+r),(o||m)&&P.push("w-100"),(o||h)&&P.push("h-100"),s&&P.push("vw-100","vh-100"),c&&P.push("flex-grow-1"),u&&P.push("flex-shrink-0"),g&&P.push("overflow-"+g),f&&P.push("position-"+f),_&&P.push("float-"+_),E&&P.push("cursor-pointer"),I!==null&&P.push(I?"visible":"invisible"),C&&P.push("text-"+C),p.length&&P.push(...p),P},[r,o,s,c,u,m,h,g,f,_,E,I,C,p]),y=i.useMemo(()=>{let P=R.join(" ");return b.length&&(P+=" "+b),P.trim()},[R,b]),F=i.useMemo(()=>{let P={};return Object.keys(N).length&&(P={...P,...N}),P},[N]);return t("div",{ref:n,className:y,style:F,...O,children:v})},Td=i.createContext({isCssGrid:!1}),Pb=a=>t(Td.Provider,{value:a.value,children:a.children}),Db=()=>i.useContext(Td),ne=a=>{const{inline:e=!1,gap:n=2,maxContent:r=!1,columnCount:o=0,center:s=!1,alignSelf:c=null,alignItems:u=null,justifyContent:m=null,fullHeight:h=!0,classNames:g=[],style:f={},..._}=a,E=i.useMemo(()=>{const C=[];return e?C.push("inline-grid"):C.push("grid"),n?C.push("gap-"+n):n===0&&C.push("gap-0"),r&&C.push("flex-basis-max-content"),c&&C.push("align-self-"+c),u&&C.push("align-items-"+u),m&&C.push("justify-content-"+m),!u&&!m&&s&&C.push("align-items-center","justify-content-center"),g.length&&C.push(...g),C},[e,n,r,c,u,m,s,g]),I=i.useMemo(()=>{let C={};return o&&(C["--bs-columns"]=o.toString()),Object.keys(f).length&&(C={...C,...f}),C},[o,f]);return t(Pb,{value:{isCssGrid:!0},children:t(U,{fullHeight:h,classNames:E,style:I,..._})})},Ue=a=>{const{columnMinWidth:e=40,columnMinHeight:n=40,columnCount:r=0,fullHeight:o=!1,maxContent:s=!0,overflow:c="auto",style:u={},...m}=a,h=i.useMemo(()=>{let g={};return g["--nitro-grid-column-min-height"]=n+"px",r>1&&(g.gridTemplateColumns=`repeat(auto-fill, minmax(${e}px, 1fr))`),Object.keys(u).length&&(g={...g,...u}),g},[e,n,r,u]);return t(ne,{columnCount:r,fullHeight:o,overflow:c,style:h,...m})},w=a=>{const{display:e="flex",column:n=void 0,reverse:r=!1,gap:o=null,center:s=!1,alignSelf:c=null,alignItems:u=null,justifyContent:m=null,classNames:h=[],...g}=a,f=i.useMemo(()=>{const _=[];return n?r?_.push("flex-column-reverse"):_.push("flex-column"):r&&_.push("flex-row-reverse"),o&&_.push("gap-"+o),c&&_.push("align-self-"+c),u&&_.push("align-items-"+u),m&&_.push("justify-content-"+m),!u&&!m&&s&&_.push("align-items-center","justify-content-center"),h.length&&_.push(...h),_},[n,r,o,s,c,u,m,h]);return t(U,{display:e,classNames:f,...g})},L=a=>{const{variant:e="primary",size:n="sm",active:r=!1,disabled:o=!1,classNames:s=[],...c}=a,u=i.useMemo(()=>{const m=["btn"];return e&&m.push("btn-"+e),n&&m.push("btn-"+n),r&&m.push("active"),o&&m.push("disabled"),s.length&&m.push(...s),m},[e,n,r,o,s]);return t(w,{center:!0,classNames:u,...c})},er=a=>{const{classNames:e=[],...n}=a,r=i.useMemo(()=>{const o=["btn-group"];return e.length&&o.push(...e),o},[e]);return t(U,{classNames:r,...n})},vd=i.createContext({closers:null,setClosers:null,closeAll:null}),Mb=a=>t(vd.Provider,{...a}),Lb=()=>i.useContext(vd),Ja=a=>{const{alignItems:e="center",gap:n=1,children:r=null,...o}=a;return t(w,{alignItems:e,gap:n,...o,children:r})},Za=a=>{const{headerText:e="",isExpanded:n=!1,gap:r=0,classNames:o=[],children:s=null,...c}=a,[u,m]=i.useState(!1),{setClosers:h=null,closeAll:g=null}=Lb(),f=()=>{g(),m(I=>!I)},_=i.useCallback(()=>m(!1),[]),E=i.useMemo(()=>{const I=["nitro-card-accordion-set"];return u&&I.push("active"),o&&o.length&&I.push(...o),I},[u,o]);return i.useEffect(()=>{m(n)},[n]),i.useEffect(()=>{const I=_;return h(C=>{const p=[...C];return p.push(I),p}),()=>{h(C=>{const p=[...C],b=p.indexOf(I);return b>=0&&p.splice(b,1),p})}},[_,h]),l(T,{classNames:E,gap:r,...c,children:[l(w,{pointer:!0,justifyContent:"between",className:"nitro-card-accordion-set-header px-2 py-1",onClick:f,children:[t(S,{children:e}),u&&t(Oi,{className:"fa-icon"}),!u&&t(Ai,{className:"fa-icon"})]}),u&&t(T,{fullHeight:!0,overflow:"auto",gap:0,className:"nitro-card-accordion-set-content",children:s})]})},Ub=a=>{const{...e}=a,[n,r]=i.useState([]),o=i.useCallback(()=>{for(const s of n)s()},[n]);return t(Mb,{value:{closers:n,setClosers:r,closeAll:o},children:t(T,{gap:0,...e})})},re=a=>{const{overflow:e="auto",classNames:n=[],...r}=a,o=i.useMemo(()=>{const s=["container-fluid","content-area"];return n.length&&s.push(...n),s},[n]);return t(T,{classNames:o,overflow:e,...r})},xb=i.createContext({theme:null}),Fb=a=>t(xb.Provider,{value:a.value,children:a.children}),se=a=>{const{headerText:e=null,isGalleryPhoto:n=!1,noCloseButton:r=!1,onReportPhoto:o=null,onCloseClick:s=null,justifyContent:c="center",alignItems:u="center",classNames:m=[],children:h=null,...g}=a,f=i.useMemo(()=>{const E=["drag-handler","container-fluid","nitro-card-header"];return m.length&&E.push(...m),E},[m]);return t(T,{center:!0,position:"relative",classNames:f,...g,children:l(w,{fullWidth:!0,center:!0,children:[t("span",{className:"nitro-card-header-text",children:e}),n&&t(U,{position:"absolute",className:"end-4 nitro-card-header-report-camera",onClick:o,children:t(Nm,{className:"fa-icon"})}),t(w,{center:!0,position:"absolute",className:"end-2 nitro-card-header-close",onMouseDownCapture:E=>{E.stopPropagation(),E.nativeEvent.stopImmediatePropagation()},onClick:s,children:t(Cn,{className:"fa-icon w-12 h-12"})})]})})},wd=a=>{const{justifyContent:e="center",classNames:n=[],variant:r="muted",...o}=a,s=i.useMemo(()=>{const c=["container-fluid","p-1"];return n.length&&c.push(...n),c.push("bg-"+r),c},[n,r]);return t(w,{justifyContent:e,classNames:s,...o})};class Pt{}Pt.CENTER="DWP_CENTER";Pt.TOP_CENTER="DWP_TOP_CENTER";Pt.TOP_LEFT="DWP_TOP_LEFT";Pt.NOTHING="DWP_NOTHING";const ir=[],Zl=0,ec=0,Ar=a=>{const{uniqueKey:e=null,handleSelector:n=".drag-handler",windowPosition:r=Pt.CENTER,disableDrag:o=!1,dragStyle:s={},children:c=null,offsetLeft:u=0,offsetTop:m=0}=a,[h,g]=i.useState(null),[f,_]=i.useState(null),[E,I]=i.useState({x:0,y:0}),[C,p]=i.useState(!1),[b,N]=i.useState(null),v=i.useRef(),O=i.useCallback(()=>{let Y=400;for(const Ee of ir)Y+=1,Ee.style.zIndex=Y.toString()},[]),R=i.useCallback(()=>{const Y=ir.indexOf(v.current);if(Y===-1)ir.push(v.current);else{if(Y===ir.length-1)return;Y>=0&&(ir.splice(Y,1),ir.push(v.current))}O()},[O]),y=i.useCallback(Y=>{R()},[R]),F=i.useCallback(Y=>{R()},[R]),P=i.useCallback((Y,Ee)=>{I({x:Y,y:Ee}),p(!0)},[]),D=i.useCallback(Y=>{P(Y.clientX,Y.clientY)},[P]),A=i.useCallback(Y=>{const Ee=Y.touches[0];P(Ee.clientX,Ee.clientY)},[P]),k=i.useCallback(Y=>{g({x:Y.clientX-E.x,y:Y.clientY-E.y})},[E]),B=i.useCallback(Y=>{const Ee=Y.touches[0];g({x:Ee.clientX-E.x,y:Ee.clientY-E.y})},[E]),G=i.useCallback(()=>{if(!v.current||!b)return;let Y=f.x+h.x,Ee=f.y+h.y;const le=v.current.offsetLeft+Y,De=v.current.offsetTop+Ee;if(De<Zl?Ee=-v.current.offsetTop:De+b.offsetHeight>=document.body.offsetHeight-Zl&&(Ee=document.body.offsetHeight-v.current.offsetHeight-v.current.offsetTop),le+v.current.offsetWidth<ec?Y=-v.current.offsetLeft:le>=document.body.offsetWidth-ec&&(Y=document.body.offsetWidth-v.current.offsetWidth-v.current.offsetLeft),g({x:0,y:0}),_({x:Y,y:Ee}),p(!1),e!==null){const Qe={...Ya(`nitro.windows.${e}`)};Qe.offset={x:Y,y:Ee},ld(`nitro.windows.${e}`,Qe)}},[b,h,f,e]),z=i.useCallback(Y=>{G()},[G]),X=i.useCallback(Y=>{G()},[G]);return i.useEffect(()=>{const Y=v.current;if(!Y)return;if(ir.push(Y),O(),!o){const De=Y.querySelector(n);De&&N(De)}let Ee=0,le=0;switch(r){case Pt.TOP_CENTER:Y.style.top=50+m+"px",Y.style.left=`calc(50vw - ${Y.offsetWidth/2+u}px)`;break;case Pt.CENTER:Y.style.top=`calc(50vh - ${Y.offsetHeight/2+m}px)`,Y.style.left=`calc(50vw - ${Y.offsetWidth/2+u}px)`;break;case Pt.TOP_LEFT:Y.style.top=50+m+"px",Y.style.left=50+u+"px";break}return g({x:0,y:0}),_({x:Ee,y:le}),()=>{const De=ir.indexOf(Y);De>=0&&ir.splice(De,1)}},[n,r,e,o,u,m,O]),i.useEffect(()=>{if(!f&&!h)return;const Y=v.current;Y&&(Y.style.transform=`translate(${f.x+h.x}px, ${f.y+h.y}px)`,Y.style.visibility="visible")},[f,h]),i.useEffect(()=>{if(b)return b.addEventListener(ye.MOUSE_DOWN,D),b.addEventListener(fn.TOUCH_START,A),()=>{b.removeEventListener(ye.MOUSE_DOWN,D),b.removeEventListener(fn.TOUCH_START,A)}},[b,D,A]),i.useEffect(()=>{if(C)return document.addEventListener(ye.MOUSE_UP,z),document.addEventListener(fn.TOUCH_END,X),document.addEventListener(ye.MOUSE_MOVE,k),document.addEventListener(fn.TOUCH_MOVE,B),()=>{document.removeEventListener(ye.MOUSE_UP,z),document.removeEventListener(fn.TOUCH_END,X),document.removeEventListener(ye.MOUSE_MOVE,k),document.removeEventListener(fn.TOUCH_MOVE,B)}},[C,z,k,X,B]),i.useEffect(()=>{if(!e)return;const Y=Ya(`nitro.windows.${e}`);!Y||!Y.offset||(g({x:0,y:0}),Y.offset&&_(Y.offset))},[e]),ki.createPortal(t(U,{position:"absolute",innerRef:v,className:"draggable-window",onMouseDownCapture:y,onTouchStartCapture:F,style:s,children:c}),document.getElementById("draggable-windows-container"))},ae=a=>{const{theme:e="primary",uniqueKey:n=null,handleSelector:r=".drag-handler",windowPosition:o=Pt.CENTER,disableDrag:s=!1,overflow:c="hidden",position:u="relative",gap:m=0,classNames:h=[],...g}=a,f=i.useRef(),_=i.useMemo(()=>{const E=["nitro-card","rounded","shadow"];return E.push(`theme-${e||"primary"}`),h.length&&E.push(...h),E},[e,h]);return t(Fb,{value:{theme:e},children:t(Ar,{uniqueKey:n,handleSelector:r,windowPosition:o,disableDrag:s,children:t(T,{innerRef:f,overflow:c,position:u,gap:m,classNames:_,...g})})})},st=a=>{const{figure:e="",gender:n="M",headOnly:r=!1,direction:o=0,scale:s=1,classNames:c=[],style:u={},...m}=a,[h,g]=i.useState(null),[f,_]=i.useState(-1),E=i.useRef(!1),I=i.useMemo(()=>{const p=["avatar-image"];return c.length&&p.push(...c),p},[c]),C=i.useMemo(()=>{let p={};return h&&h.length&&(p.backgroundImage=`url('${h}')`),s!==1&&(p.transform=`scale(${s})`,s%1||(p.imageRendering="pixelated")),Object.keys(u).length&&(p={...p,...u}),p},[h,s,u]);return i.useEffect(()=>{const p=Nt().createAvatarImage(e,Ui.LARGE,n,{resetFigure:v=>{E.current||_(Math.random())},dispose:()=>{},disposed:!1},null);if(!p)return;let b=Ha.FULL;r&&(b=Ha.HEAD),p.setDirection(b,o);const N=p.getCroppedImage(b);N&&g(N.src),p.dispose()},[e,n,o,r,f]),i.useEffect(()=>(E.current=!1,()=>{E.current=!0}),[]),t(U,{classNames:I,style:C,...m})},Rd=a=>{const{imageUrl:e=null,fit:n=!0,style:r=null,...o}=a,s=i.useMemo(()=>{const c={...r};return e&&(c.background=`url(${e}) center no-repeat`),c},[r,e]);return t(U,{fit:n,style:s,...o})},je=a=>{const{badgeCode:e=null,isGroup:n=!1,showInfo:r=!1,customTitle:o=null,isGrayscale:s=!1,scale:c=1,classNames:u=[],style:m={},children:h=null,...g}=a,[f,_]=i.useState(null),E=i.useMemo(()=>{const C=["badge-image"];return n&&C.push("group-badge"),s&&C.push("grayscale"),u.length&&C.push(...u),C},[u,n,s]),I=i.useMemo(()=>{let C={};return f&&(C.backgroundImage=`url(${n?f.src:K("badge.asset.url").replace("%badgename%",e.toString())})`,C.width=f.width,C.height=f.height,c!==1&&(C.transform=`scale(${c})`,c%1||(C.imageRendering="pixelated"),C.width=f.width*c,C.height=f.height*c)),Object.keys(m).length&&(C={...C,...m}),C},[f,c,m]);return i.useEffect(()=>{if(!e||!e.length)return;let C=!1;const p=N=>{if(N.badgeId!==e)return;const v=tr.generateImage(new Va(N.image));v.onload=()=>_(v),C=!0,H().events.removeEventListener(yo.IMAGE_READY,p)};H().events.addEventListener(yo.IMAGE_READY,p);const b=n?H().getGroupBadgeImage(e):H().getBadgeImage(e);if(b&&!C){const N=tr.generateImage(new Va(b));N.onload=()=>_(N)}return()=>H().events.removeEventListener(yo.IMAGE_READY,p)},[e,n]),l(U,{classNames:E,style:I,...g,children:[r&&K("badge.descriptions.enabled",!0)&&l(U,{className:"badge-information text-black py-1 px-2 small",children:[t("div",{className:"fw-bold mb-1",children:n?o:Js(e)}),t("div",{children:n?d("group.badgepopup.body"):ji(e)})]}),h]})},Gb=a=>{const{day:e="00",hour:n="00",minutes:r="00",seconds:o="00",classNames:s=[],children:c=null,...u}=a,m=i.useMemo(()=>{const h=["nitro-counter-time"];return s.length&&h.push(...s),h},[s]);return l(w,{gap:1,children:[t(U,{classNames:m,...u,children:l("div",{children:[e!="00"?e:n,e!="00"?d("countdown_clock_unit_days"):d("countdown_clock_unit_hours")]})}),t(U,{style:{marginTop:"3px"},children:":"}),t(U,{classNames:m,...u,children:l("div",{children:[r,d("countdown_clock_unit_minutes")]})}),t(U,{style:{marginTop:"3px"},children:":"}),t(U,{classNames:m,...u,children:l("div",{children:[o,d("countdown_clock_unit_seconds")]})}),c]})},lt=a=>{const{type:e="",classNames:n=[],style:r={},...o}=a,s=i.useMemo(()=>{const m=["nitro-currency-icon"];return n.length&&m.push(...n),m},[n]),c=i.useMemo(()=>{let m=K("currency.asset.icon.url","");return m=m.replace("%type%",e.toString()),`url(${m})`},[e]),u=i.useMemo(()=>{let m={};return m.backgroundImage=c,Object.keys(r).length&&(m={...m,...r}),m},[r,c]);return t(U,{classNames:s,style:u,...o})},Qi=a=>{const{productType:e="s",productClassId:n=-1,direction:r=2,extraData:o="",scale:s=1,style:c={},...u}=a,[m,h]=i.useState(null),g=i.useMemo(()=>{var _;let f={};return(_=m==null?void 0:m.src)!=null&&_.length&&(f.backgroundImage=`url('${m.src}')`,f.width=m.width,f.height=m.height),s!==1&&(f.transform=`scale(${s})`,s%1||(f.imageRendering="pixelated")),Object.keys(c).length&&(f={...f,...c}),f},[m,s,c]);return i.useEffect(()=>{let f=null;const _={imageReady:(E,I,C)=>{!C&&I&&(C=tr.generateImage(I)),C.onload=()=>h(C)},imageFailed:null};switch(e.toLocaleLowerCase()){case ue.FLOOR:f=q().getFurnitureFloorImage(n,new Rt(r),64,_,0,o);break;case ue.WALL:f=q().getFurnitureWallImage(n,new Rt(r),64,_,0,o);break}if(f){const E=f.getImage();E.onload=()=>h(E)}},[e,n,r,o]),m?t(U,{classNames:["furni-image"],style:g,...u}):null},yd=a=>{const{figure:e=null,userName:n=null,message:r=null,editable:o=!1,onChange:s=null}=a;return l(w,{overflow:"hidden",className:"nitro-gift-card text-black",children:[l("div",{className:"d-flex align-items-center justify-content-center gift-face flex-shrink-0",children:[!n&&t("div",{className:"gift-incognito"}),e&&t("div",{className:"gift-avatar",children:t(st,{figure:e,direction:2,headOnly:!0})})]}),t(w,{overflow:"hidden",className:"w-100 pt-4 pb-4 pe-4 ps-3",children:l(T,{grow:!0,overflow:"auto",justifyContent:"between",children:[!o&&t(S,{textBreak:!0,className:"gift-message",children:r}),o&&s!==null&&t("textarea",{className:"gift-message h-100",maxLength:140,value:r,onChange:c=>s(c.target.value),placeholder:d("catalog.gift_wrapping_new.message_hint")}),n&&t(S,{italics:!0,textEnd:!0,className:"pe-1",children:d("catalog.gift_wrapping_new.message_from",["name"],[n])})]})})]})},T=a=>{const{size:e=0,offset:n=0,column:r=!0,gap:o=2,classNames:s=[],...c}=a,{isCssGrid:u=!1}=Db(),m=i.useMemo(()=>{const h=[];if(e){let g=`col-${e}`;u&&(g=`g-${g}`),h.push(g)}if(n){let g=`offset-${n}`;u&&(g=`g-start-${n}`),h.push(g)}return s.length&&h.push(...s),h},[e,n,u,s]);return t(w,{classNames:m,column:r,gap:o,...c})},Rr=a=>{const{count:e=0,position:n="absolute",classNames:r=[],children:o=null,...s}=a,c=i.useMemo(()=>{const u=["badge","border","border-black","bg-danger","px-1","nitro-item-count"];return r.length&&u.push(...r),u},[r]);return l(U,{position:"absolute",classNames:c,...s,children:[e,o]})},Ys=a=>{const{value:e=0}=a,n=e.toString().split("");return t(V,{children:n.map((r,o)=>t("i",{className:"limited-edition-number n-"+r},o))})},Od=a=>{const{uniqueNumber:e=0,uniqueSeries:n=0,classNames:r=[],children:o=null,...s}=a,c=i.useMemo(()=>{const u=["unique-compact-plate","z-index-1"];return r.length&&u.push(...r),u},[r]);return l(U,{classNames:c,...s,children:[t("div",{children:t(Ys,{value:e})}),t("div",{children:t(Ys,{value:n})}),o]})},Bb=a=>{const{uniqueLimitedItemsLeft:e=0,uniqueLimitedSeriesSize:n=0,classNames:r=[],...o}=a,s=i.useMemo(()=>{const c=["unique-complete-plate"];return r.length&&c.push(...r),c},[r]);return t(U,{classNames:s,...o,children:l(T,{className:"plate-container",gap:0,children:[l(w,{justifyContent:"between",alignItems:"center",children:[d("unique.items.left"),t("div",{children:t(Ys,{value:e})})]}),l(w,{justifyContent:"between",alignItems:"center",children:[d("unique.items.number.sold"),t("div",{children:t(Ys,{value:n})})]})]})})},be=a=>{const{itemImage:e=void 0,itemColor:n=void 0,itemActive:r=!1,itemCount:o=1,itemCountMinimum:s=1,itemUniqueSoldout:c=!1,itemUniqueNumber:u=-2,itemUnseen:m=!1,itemHighlight:h=!1,disabled:g=!1,center:f=!0,column:_=!0,style:E={},classNames:I=[],position:C="relative",overflow:p="hidden",children:b=null,...N}=a,v=i.useMemo(()=>{const R=["layout-grid-item","border","border-2","border-muted","rounded"];return r&&R.push("active"),(c||u>0)&&R.push("unique-item"),c&&R.push("sold-out"),m&&R.push("unseen"),h&&R.push("has-highlight"),g&&R.push("disabled"),e===null&&R.push("icon","loading-icon"),I.length&&R.push(...I),R},[r,c,u,m,h,g,e,I]),O=i.useMemo(()=>{let R={...E};return e&&!(c||u>0)&&(R.backgroundImage=`url(${e})`),n&&(R.backgroundColor=n),Object.keys(E).length&&(R={...R,...E}),R},[E,e,n,c,u]);return l(T,{center:f,pointer:!0,position:C,overflow:p,column:_,classNames:v,style:O,...N,children:[o>s&&t(Rr,{count:o}),u>0&&l(V,{children:[t(U,{fit:!0,className:"unique-bg-override",style:{backgroundImage:`url(${e})`}}),t("div",{className:"position-absolute bottom-0 unique-item-counter",children:t(Ys,{value:u})})]}),b]})},sr=a=>{const{imageUrl:e=null,className:n="",...r}=a;return t("img",{src:e,className:"no-select "+n,alt:"",...r})},Ji=a=>{const{...e}=a;return l(U,{classNames:["spinner-container"],...e,children:[t(U,{className:"spinner"}),t(U,{className:"spinner"}),t(U,{className:"spinner"})]})},Vb=a=>{const{roomId:e=-1,textureReceiver:n=null,onClose:r=null}=a,o=i.useRef(),s=()=>{if(!o||!o.current)return null;const u=o.current.getBoundingClientRect();return new pu(Math.floor(u.x),Math.floor(u.y),Math.floor(u.width),Math.floor(u.height))},c=()=>{rr(dn.CAMERA_SHUTTER),n(q().createTextureFromRoom(e,1,s()))};return t(Ar,{handleSelector:".nitro-room-thumbnail-camera",children:l("div",{className:"nitro-room-thumbnail-camera px-2",children:[t("div",{ref:o,className:"camera-frame"}),l("div",{className:"d-flex align-items-end h-100 pb-2",children:[t("button",{className:"btn btn-sm btn-danger w-100 mb-1 me-2",onClick:r,children:d("cancel")}),t("button",{className:"btn btn-sm btn-success w-100 mb-1",onClick:c,children:d("navigator.thumbeditor.save")})]})]})})},uo=a=>{const{title:e="",onClose:n=null,classNames:r=[],children:o=null,type:s=de.DEFAULT,...c}=a,u=i.useMemo(()=>{const m=["nitro-alert"];return m.push("nitro-alert-"+s),r.length&&m.push(...r),m},[r,s]);return l(ae,{classNames:u,theme:"primary-slim",...c,children:[t(se,{headerText:e,onCloseClick:n}),t(re,{grow:!0,justifyContent:"between",overflow:"hidden",className:"text-black",gap:0,children:o})]})};class wt{}wt.BOUNCE="bounce";wt.SLIDE_LEFT="slideLeft";wt.SLIDE_RIGHT="slideRight";wt.FLIP_X="flipX";wt.FADE_IN="fadeIn";wt.FADE_DOWN="fadeDown";wt.FADE_UP="fadeUp";wt.HEAD_SHAKE="headShake";function Hb(a,e,n=300){switch(a){case wt.BOUNCE:switch(e){default:return{};case Sr:return{animationName:"bounceIn",animationDuration:`${n}ms`};case Ur:return{animationName:"bounceOut",animationDuration:`${n}ms`}}case wt.SLIDE_LEFT:switch(e){default:return{};case Sr:return{animationName:"slideInLeft",animationDuration:`${n}ms`};case Ur:return{animationName:"slideOutLeft",animationDuration:`${n}ms`}}case wt.SLIDE_RIGHT:switch(e){default:return{};case Sr:return{animationName:"slideInRight",animationDuration:`${n}ms`};case Ur:return{animationName:"slideOutRight",animationDuration:`${n}ms`}}case wt.FLIP_X:switch(e){default:return{};case Sr:return{animationName:"flipInX",animationDuration:`${n}ms`};case Ur:return{animationName:"flipOutX",animationDuration:`${n}ms`}}case wt.FADE_UP:switch(e){default:return{};case Sr:return{animationName:"fadeInUp",animationDuration:`${n}ms`};case Ur:return{animationName:"fadeOutDown",animationDuration:`${n}ms`}}case wt.FADE_IN:switch(e){default:return{};case Sr:return{animationName:"fadeIn",animationDuration:`${n}ms`};case Ur:return{animationName:"fadeOut",animationDuration:`${n}ms`}}case wt.FADE_DOWN:switch(e){default:return{};case Sr:return{animationName:"fadeInDown",animationDuration:`${n}ms`};case Ur:return{animationName:"fadeOutUp",animationDuration:`${n}ms`}}case wt.HEAD_SHAKE:switch(e){default:return{};case Sr:return{animationName:"headShake",animationDuration:`${n}ms`}}}return null}const ra=a=>{const{type:e=null,inProp:n=!1,timeout:r=300,className:o=null,children:s=null}=a,[c,u]=i.useState(!1);return i.useEffect(()=>{let m=null;return n?u(!0):m=setTimeout(()=>{u(!1),clearTimeout(r)},r),()=>{m&&clearTimeout(m)}},[n,r]),t(Tm,{in:n,timeout:r,children:m=>t("div",{className:(o??"")+" animate__animated",style:{...Hb(e,m,r)},children:c&&s})})},Zi=a=>{const{fadesOut:e=!0,timeoutMs:n=8e3,onClose:r=null,overflow:o="hidden",classNames:s=[],...c}=a,[u,m]=i.useState(!1),h=i.useMemo(()=>{const g=["nitro-notification-bubble","rounded"];return s.length&&g.push(...s),g},[s]);return i.useEffect(()=>(m(!0),()=>m(!1)),[]),i.useEffect(()=>{if(!e)return;const g=setTimeout(()=>{m(!1),setTimeout(()=>r(),300)},n);return()=>clearTimeout(g)},[e,n,r]),t(ra,{type:wt.FADE_IN,inProp:u,timeout:300,children:t(w,{overflow:o,classNames:h,onClick:r,...c})})},Zn=a=>{const{figure:e="",typeId:n=-1,paletteId:r=-1,petColor:o=16777215,customParts:s=[],posture:c="std",headOnly:u=!1,direction:m=0,scale:h=1,style:g={},...f}=a,[_,E]=i.useState(null),[I,C]=i.useState(0),[p,b]=i.useState(0),N=i.useRef(!1),v=i.useMemo(()=>{let O={};return _&&_.length&&(O.backgroundImage=`url(${_})`),h!==1&&(O.transform=`scale(${h})`,h%1||(O.imageRendering="pixelated")),O.width=I,O.height=p,Object.keys(g).length&&(O={...O,...g}),O},[_,h,g,I,p]);return i.useEffect(()=>{let O=n,R=r,y=o,F=s,P=u;if(e&&e.length){const A=new Is(e);O=A.typeId,R=A.paletteId,y=A.color,F=A.customParts}O===16&&(P=!1);const D=q().getRoomObjectPetImage(O,R,y,new Rt(m*45),64,{imageReady:(A,k,B)=>{N.current||(B?(E(B.src),C(B.width),b(B.height)):k&&(E(tr.generateImageUrl(k)),C(k.width),b(k.height)))},imageFailed:A=>{}},P,0,F,c);if(D){const A=D.getImage();A&&(E(A.src),C(A.width),b(A.height))}},[e,n,r,o,s,c,u,m]),i.useEffect(()=>(N.current=!1,()=>{N.current=!0}),[]),t(U,{classNames:["pet-image"],style:v,...f})},el=a=>{const{text:e="",progress:n=0,maxProgress:r=100,position:o="relative",justifyContent:s="center",classNames:c=[],children:u=null,...m}=a,h=i.useMemo(()=>{const g=["nitro-progress-bar","text-white"];return c.length&&g.push(...c),g},[c]);return l(T,{position:o,justifyContent:s,classNames:h,...m,children:[e&&e.length>0&&t(w,{fit:!0,center:!0,position:"absolute",className:"nitro-progress-bar-text small",children:e}),t(U,{className:"nitro-progress-bar-inner",style:{width:~~((n-0)*(100-0)/(r-0)+0)+"%"}}),u]})},tl=a=>{const{level:e=0,classNames:n=[],children:r=null,...o}=a,s=i.useMemo(()=>{const c=["nitro-rarity-level"];return n.length&&c.push(...n),c},[n]);return l(U,{classNames:s,...o,children:[t("div",{children:e}),r]})},mo=a=>{const{roomPreviewer:e=null,height:n=0,children:r=null}=a,[o,s]=i.useState(null),c=i.useRef(),u=m=>{e&&(m.shiftKey?e.changeRoomObjectDirection():e.changeRoomObjectState())};return i.useEffect(()=>{if(!e)return;const m=g=>{!e||!o||!c.current||(e.updatePreviewRoomView(),o.canvasUpdated&&(c.current.style.backgroundImage=`url(${tr.generateImageUrl(o.master)})`))};if(!o&&c.current&&e){let f=document.defaultView.getComputedStyle(c.current,null).backgroundColor;f=ln.rgbStringToHex(f),f=f.replace("#","0x"),e.backgroundColor=parseInt(f,16);const _=c.current.parentElement.clientWidth;e.getRoomCanvas(_,n);const E=e.getRenderingCanvas();s(E),E.canvasUpdated=!0,m()}fr().add(m);const h=new ResizeObserver(()=>{if(!e||!c.current)return;const g=c.current.parentElement.offsetWidth;e.modifyRoomCanvas(g,n),m()});return h.observe(c.current),()=>{h.disconnect(),fr().remove(m)}},[o,e,c,n]),l("div",{className:"room-preview-container",children:[t("div",{ref:c,className:"room-preview-image",style:{height:n},onClick:u}),r]})},go=a=>{const{roomId:e=-1,customUrl:n=null,shrink:r=!0,overflow:o="hidden",classNames:s=[],children:c=null,...u}=a,m=i.useMemo(()=>{const g=["room-thumbnail","rounded","border"];return s.length&&g.push(...s),g},[s]),h=i.useMemo(()=>n&&n.length?K("image.library.url")+n:K("thumbnails.url").replace("%thumbnail%",e.toString()),[n,e]);return l(U,{shrink:r,overflow:o,classNames:m,...u,children:[h&&t("img",{alt:"",src:h}),c]})},Ad=a=>{const{color:e="",message:n="",date:r="",senderName:o="",customTitle:s=null,onCloseClick:c=null}=a;return t(Ar,{handleSelector:".drag-handler",children:l(T,{gap:0,alignItems:"center",className:`nitro-layout-trophy trophy-${e}`,children:[l(w,{center:!0,fullWidth:!0,position:"relative",className:"trophy-header drag-handler",children:[t(U,{position:"absolute",pointer:!0,className:"trophy-close",onClick:c}),t(S,{bold:!0,children:d("widget.furni.trophy.title")})]}),l(T,{className:"trophy-content py-1",gap:1,children:[s&&t(S,{bold:!0,children:s}),n]}),l(w,{alignItems:"center",justifyContent:"between",className:"trophy-footer mt-1",children:[t(S,{bold:!0,children:r}),t(S,{bold:!0,children:o})]})]})})},_n=a=>{const{userId:e=0,userName:n=null,classNames:r=[],pointer:o=!0,children:s=null,...c}=a,u=i.useMemo(()=>{const m=["nitro-friends-spritesheet","icon-profile-sm"];return r.length&&m.push(...r),m},[r]);return t(U,{classNames:u,pointer:o,onClick:m=>Jt(e),...c,children:s})},qn=a=>{const{isActive:e=!1,count:n=0,overflow:r="hidden",position:o="relative",pointer:s=!0,classNames:c=[],children:u=null,...m}=a,h=i.useMemo(()=>{const g=["nav-item","rounded-top","border"];return e&&g.push("active"),c.length&&g.push(...c),g},[e,c]);return l(w,{overflow:r,pointer:s,position:o,classNames:h,...m,children:[t(w,{shrink:!0,center:!0,children:u}),n>0&&t(Rr,{count:n})]})},Ir=a=>{const{justifyContent:e="center",gap:n=1,classNames:r=[],children:o=null,...s}=a,c=i.useMemo(()=>{const u=["container-fluid","nitro-card-tabs","pt-1"];return r.length&&u.push(...r),u},[r]);return t(w,{justifyContent:e,gap:n,classNames:c,...s,children:o})},Vt=(...a)=>a.filter(Boolean).join(" "),Wb=a=>{const{classNames:e=[],...n}=a,r=i.useMemo(()=>{const o=["form-group"];return e.length&&o.push(...e),o},[e]);return t(w,{classNames:r,...n})},jb=a=>{const{variant:e="black",height:n=1,classNames:r=[],style:o={},...s}=a,c=i.useMemo(()=>{const m=[];return e&&m.push("bg-"+e),r.length&&m.push(...r),m},[e,r]),u=i.useMemo(()=>{let m={display:"list-item"};return n>0&&(m.height=n),Object.keys(o).length&&(m={...m,...o}),m},[n,o]);return t(U,{classNames:c,style:u,...s})},ho=a=>{var E,I;const{rows:e=[],overscan:n=5,scrollToBottom:r=!1,rowRender:o=null}=a,[s,c]=i.useState(e.length-1),u=i.useRef(null),{virtualItems:m=[],totalSize:h=0,scrollToIndex:g=null}=vm({parentRef:u,size:e.length,overscan:n}),f=m.length>0&&((E=m==null?void 0:m[0])==null?void 0:E.start)||0,_=m.length>0?h-(((I=m==null?void 0:m[m.length-1])==null?void 0:I.end)||0):0;return i.useEffect(()=>{r&&g(s)},[r,s,g]),l(U,{fit:!0,innerRef:u,position:"relative",overflow:"auto",children:[f>0&&t("div",{style:{minHeight:`${f}px`}}),m.map(C=>{const p=e[C.index];return p?t("div",{"data-index":C.index,ref:C.measureRef,children:o(p)},C.key):t(i.Fragment,{},C.key)}),_>0&&t("div",{style:{minHeight:`${_}px`}})]})},S=a=>{const{variant:e="black",fontWeight:n=null,fontSize:r=0,align:o=null,bold:s=!1,underline:c=!1,italics:u=!1,truncate:m=!1,center:h=!1,textEnd:g=!1,small:f=!1,wrap:_=!1,noWrap:E=!1,textBreak:I=!1,...C}=a,p=i.useMemo(()=>{const b=["d-inline"];return e&&b.push("text-"+e),s&&b.push("fw-bold"),n&&b.push("fw-"+n),r&&b.push("fs-"+r),o&&b.push("text-"+o),c&&b.push("text-decoration-underline"),u&&b.push("fst-italic"),m&&b.push("text-truncate"),h&&b.push("text-center"),g&&b.push("text-end"),f&&b.push("small"),_&&b.push("text-wrap"),E&&b.push("text-nowrap"),I&&b.push("text-break"),b},[e,n,r,o,s,c,u,m,h,g,f,_,E,I]);return t(U,{classNames:p,...C})},qb=a=>{const{isError:e=!1,message:n="",percent:r=0}=a;return t(T,{fullHeight:!0,position:"relative",className:"nitro-loading",children:t(U,{fullHeight:!0,className:"container h-100",children:l(T,{fullHeight:!0,alignItems:"center",justifyContent:"end",children:[t(U,{className:"connecting-duck"}),t(T,{size:6,className:"text-center py-4",children:e&&n&&n.length?t(U,{className:"fs-4 text-shadow",children:n}):l(V,{children:[l(S,{fontSize:4,variant:"white",className:"text-shadow",children:[r.toFixed(),"%"]}),t(el,{progress:r,className:"mt-2 large"})]})})]})})})},Er=(a,e,n,r=!0)=>{i.useEffect(()=>{if(r)return Array.isArray(a)?a.map(o=>e.addEventListener(o,n)):e.addEventListener(a,n),()=>{Array.isArray(a)?a.map(o=>e.removeEventListener(o,n)):e.removeEventListener(a,n)}},[a,e,r,n])},tc=(a,e)=>Er(a,_C().events,e),Yb=(a,e)=>Er(a,_e().cameraManager.events,e),zb=(a,e)=>Er(a,_e().localization.events,e),Fr=(a,e)=>Er(a,_e().events,e),Te=(a,e)=>Er(a,q().events,e),Ye=(a,e)=>Er(a,Qr().events,e),$b=(a,e)=>Er(a,H().events,e),Hr=(a,e,n=!0)=>Er(a,_e().soundManager.events,e,n),x=(a,e)=>{i.useEffect(()=>{const n=new a(e);return Bs().registerMessageEvent(n),()=>Bs().removeMessageEvent(n)},[a,e])},ct=(a,e,n=!0)=>Er(a,nr,e,n),Kb=()=>{const[a,e]=i.useState(!0),[n,r]=i.useState([]),[o,s]=i.useState(null),[c,u]=i.useState(-1),[m,h]=i.useState(0),g=i.useMemo(()=>{let b=0;return n.forEach(N=>b+=cn.getAchievementCategoryTotalUnseen(N)),b},[n]),f=i.useMemo(()=>{let b=0;return n.forEach(N=>b+=N.getProgress()),b},[n]),_=i.useMemo(()=>{let b=0;return n.forEach(N=>b+=N.getMaxProgress()),b},[n]),E=i.useMemo(()=>~~((f-0)*(100-0)/(_-0)+0),[f,_]),I=i.useMemo(()=>o===null?null:n.find(b=>b.code===o),[n,o]),C=i.useMemo(()=>c===-1||!I?null:I.achievements.find(b=>b.achievementId===c),[I,c]),p=i.useCallback((b,N)=>{r(v=>{const O=[...v];for(const R of O)if(R.code===b)for(const y of R.achievements)y.achievementId===N&&(y.unseen=0);return O})},[]);return x(og,b=>{const v=b.getParser().achievement;r(O=>{const R=[...O],y=R.findIndex(F=>F.code===v.category);if(y===-1){const F=new Gl(v.category);F.achievements.push(v),R.push(F)}else{const F=Kt(R[y]),P=[...F.achievements],D=P.findIndex(k=>k.achievementId===v.achievementId);let A=null;D===-1?P.push(v):(A=P[D],P[D]=v),cn.getAchievementIsIgnored(v)||(v.unseen++,A&&(v.unseen+=A.unseen)),F.achievements=P,R[y]=F}return R})}),x(ig,b=>{const N=b.getParser(),v=[];for(const O of N.achievements){const R=O.category;let y=v.find(F=>F.code===R);y||(y=new Gl(R),v.push(y)),y.achievements.push(O)}r(v)}),x(lg,b=>{const N=b.getParser();h(N.score)}),i.useEffect(()=>{a&&(M(new cg),e(!1))},[a]),i.useEffect(()=>{!o||c===-1||p(o,c)},[o,c,p]),{achievementCategories:n,selectedCategoryCode:o,setSelectedCategoryCode:s,selectedAchievementId:c,setSelectedAchievementId:u,achievementScore:m,getTotalUnseen:g,getProgress:f,getMaxProgress:_,scaledProgressPercent:E,selectedCategory:I,selectedAchievement:C,setAchievementSeen:p}},fo=()=>ot(Kb),Xb=()=>{const[a,e]=i.useState([]),[n,r]=i.useState([]),[o,s]=i.useState(-1),[c,u]=i.useState(10),[m,h]=i.useState(null);return Yb(mg.INITIALIZED,g=>{e(Array.from(Ms().effects.values()))}),x(ug,g=>{const f=g.getParser();h({credits:f.creditPrice,duckets:f.ducketPrice,publishDucketPrice:f.publishDucketPrice})}),i.useEffect(()=>{if(!Ms().isLoaded){Ms().init(),M(new dg);return}},[]),{availableEffects:a,cameraRoll:n,setCameraRoll:r,selectedPictureIndex:o,setSelectedPictureIndex:s,myLevel:c,price:m}},kd=()=>ot(Xb);class mn extends Dn{}mn.SHOW_CATALOG="CE_SHOW_CATALOG";mn.HIDE_CATALOG="CE_HIDE_CATALOG";mn.TOGGLE_CATALOG="CE_TOGGLE_CATALOG";mn.SOLD_OUT="CE_SOLD_OUT";mn.APPROVE_NAME_RESULT="CE_APPROVE_NAME_RESULT";mn.PURCHASE_APPROVED="CE_PURCHASE_APPROVED";mn.INIT_GIFT="CE_INIT_GIFT";mn.CATALOG_RESET="CE_RESET";mn.CATALOG_INVISIBLE_PAGE_VISITED="CE_CATALOG_INVISIBLE_PAGE_VISITED";class Qb extends mn{constructor(e,n,r){super(mn.INIT_GIFT),this._pageId=e,this._offerId=n,this._extraData=r}get pageId(){return this._pageId}get offerId(){return this._offerId}get extraData(){return this._extraData}}const Pd=class extends mn{constructor(a){super(Pd.POST_MARKETPLACE),this._item=a}get item(){return this._item}};let nl=Pd;nl.POST_MARKETPLACE="CE_POST_MARKETPLACE";const Dd=class extends Dn{constructor(a){super(Dd.PURCHASE_SUCCESS),this._purchase=a}get purchase(){return this._purchase}};let pr=Dd;pr.PURCHASE_SUCCESS="CPE_PURCHASE_SUCCESS";const Md=class extends Dn{constructor(a){super(Md.PURCHASE_FAILED),this._code=a}get code(){return this._code}};let Kr=Md;Kr.PURCHASE_FAILED="CPFE_PURCHASE_FAILED";const Ld=class extends Dn{constructor(a){super(Ld.NOT_ALLOWED),this._code=a}get code(){return this._code}};let eo=Ld;eo.NOT_ALLOWED="CPNAE_NOT_ALLOWED";class yt extends Dn{}yt.WIDGETS_INITIALIZED="CWE_CWE_WIDGETS_INITIALIZED";yt.SELECT_PRODUCT="CWE_SELECT_PRODUCT";yt.SET_EXTRA_PARM="CWE_CWE_SET_EXTRA_PARM";yt.PURCHASE="CWE_PURCHASE";yt.COLOUR_ARRAY="CWE_COLOUR_ARRAY";yt.MULTI_COLOUR_ARRAY="CWE_MULTI_COLOUR_ARRAY";yt.COLOUR_INDEX="CWE_COLOUR_INDEX";yt.TEXT_INPUT="CWE_TEXT_INPUT";yt.DROPMENU_SELECT="CWE_CWE_DROPMENU_SELECT";yt.PURCHASE_OVERRIDE="CWE_PURCHASE_OVERRIDE";yt.SELLABLE_PET_PALETTES="CWE_SELLABLE_PET_PALETTES";yt.UPDATE_ROOM_PREVIEW="CWE_UPDATE_ROOM_PREVIEW";yt.GUILD_SELECTED="CWE_GUILD_SELECTED";yt.TOTAL_PRICE_WIDGET_INITIALIZED="CWE_TOTAL_PRICE_WIDGET_INITIALIZED";yt.PRODUCT_OFFER_UPDATED="CWE_CWE_PRODUCT_OFFER_UPDATED";yt.SET_PREVIEWER_STUFFDATA="CWE_CWE_SET_PREVIEWER_STUFFDATA";yt.EXTRA_PARAM_REQUIRED_FOR_BUY="CWE_CWE_EXTRA_PARAM_REQUIRED_FOR_BUY";yt.TOGGLE="CWE_CWE_TOGGLE";yt.BUILDER_SUBSCRIPTION_UPDATED="CWE_CWE_BUILDER_SUBSCRIPTION_UPDATED";yt.ROOM_CHANGED="CWE_CWE_ROOM_CHANGED";yt.SHOW_WARNING_TEXT="CWE_CWE_SHOW_WARNING_TEXT";const Ud=class extends Dn{constructor(){super(Ud.SOLD_OUT)}};let to=Ud;to.SOLD_OUT="CPSOE_SOLD_OUT";const xd=class extends Dn{constructor(a,e){super(xd.UPDATE_STUFF_DATA),this._offer=a,this._stuffData=e}get offer(){return this._offer}get stuffData(){return this._stuffData}};let Jb=xd;Jb.UPDATE_STUFF_DATA="SRPSA_UPDATE_STUFF_DATA";class Ht extends Dn{}Ht.SHOW_GUIDE_TOOL="GTE_SHOW_GUIDE_TOOL";Ht.HIDE_GUIDE_TOOL="GTE_HIDE_GUIDE_TOOL";Ht.TOGGLE_GUIDE_TOOL="GTE_TOGGLE_GUIDE_TOOL";Ht.CREATE_HELP_REQUEST="GTE_CREATE_HELP_REQUEST";Ht.CREATE_BULLY_REQUEST="GTE_CREATE_BULLY_REQUEST";class no extends Dn{}no.INIT="HC_NAME_CHANGE_INIT";const Fd=class extends Dn{constructor(a,e,n){super(Fd.FURNI_ADDED),this.id=a,this.spriteId=e,this.category=n}};let ro=Fd;ro.FURNI_ADDED="IFAE_FURNI_ADDED";class Fn extends Dn{}Fn.SHOW_THUMBNAIL="NE_SHOW_THUMBNAIL";Fn.HIDE_THUMBNAIL="NE_HIDE_THUMBNAIL";Fn.TOGGLE_THUMBNAIL="NE_TOGGLE_THUMBNAIL";const nc=a=>a&&a.length?a.replace(/\\r/g,"\r"):"",rc=a=>{const e="0"+a;return e.substr(e.length-2,e.length)};let ks=null;const Zb=()=>{const[a,e]=i.useState([]),[n,r]=i.useState([]),[o,s]=i.useState([]),[c,u]=i.useState(!1),[m,h]=i.useState(!1),g=()=>K("notification",{}),f=D=>{const A=g();return A?A[D]:null},_=(D,A,k,B)=>{if(D.has(k))return D.get(k);const G=["notification",A,k].join(".");return _e().localization.hasValue(G)||B?d(G,Array.from(D.keys()),Array.from(D.values())):null},E=(D,A)=>{let k=D.get("image");return k||(k=K("image.library.notifications.url","").replace("%image%",A.replace(/\./g,"_"))),d(k)},I=i.useCallback((D,A=null,k=null,B=null,G=null,z=null)=>{(!G||!G.length)&&(G=d("notifications.broadcast.title")),(!A||!A.length)&&(A=de.DEFAULT);const X=new Si([nc(D)],A,k,B,G,z);e(Y=>[X,...Y])},[]),C=i.useCallback(()=>I(null,de.NITRO),[I]),p=i.useCallback((D,A,k=null,B=null)=>{if(c)return;const G=new hd(D,A,k,B);r(z=>[G,...z])},[c]),b=(D,A=null)=>{A||(A=new Map);const k=f("notification."+D);if(k)for(const Ee in k)A.set(Ee,k[Ee]);D==="floorplan_editor.error"&&A.set("message",A.get("message").replace(/[^a-zA-Z._ ]/g,""));const B=_(A,D,"title",!0),G=_(A,D,"message",!0).replace(/\\r/g,"\r"),z=_(A,D,"linkTitle",!1),X=_(A,D,"linkUrl",!1),Y=E(A,D);A.get("display")==="BUBBLE"?p(d(G),$e.INFO,Y,X):I(d(G),D,X,z,B,Y),A.get("sound")&&rr(A.get("sound"))},N=i.useCallback((D,A,k,B=null,G=null,z=null,X=null)=>{(!B||!B.length)&&(B=d("generic.confirm")),(!G||!G.length)&&(G=d("generic.cancel")),(!z||!z.length)&&(z=d("notifications.broadcast.title"));const Y=new fd(X,D,A,k,B,G,z);s(Ee=>[Y,...Ee])},[]),v=(D,A=null,k=!0)=>{I(D,de.DEFAULT,A,d("mod.alert.link"),d("mod.alert.title"))},O=i.useCallback((D,A="")=>{switch(D){case bt.ALERT_SCAM:I(d("inventory.trading.warning.other_not_offering"),null,null,null,d("inventory.trading.notification.title"));return;case bt.HOTEL_TRADING_DISABLED:case bt.YOU_NOT_ALLOWED:case bt.THEY_NOT_ALLOWED:case bt.ROOM_DISABLED:case bt.YOU_OPEN:case bt.THEY_OPEN:I(d(`inventory.trading.openfail.${D}`,["otherusername"],[A]),null,null,null,d("inventory.trading.openfail.title"));return;case bt.ERROR_WHILE_COMMIT:I(`${d("inventory.trading.notification.caption")}, ${d("inventory.trading.notification.commiterror.info")}`,null,null,null,d("inventory.trading.notification.title"));return;case bt.THEY_CANCELLED:I(d("inventory.trading.info.closed"),null,null,null,d("inventory.trading.notification.title"));return}},[I]),R=i.useCallback(D=>{e(A=>{const k=[...A],B=k.findIndex(G=>D===G);return B>=0&&k.splice(B,1),k})},[]),y=i.useCallback(D=>{r(A=>{const k=[...A],B=k.findIndex(G=>D===G);return B>=0&&k.splice(B,1),k})},[]),F=i.useCallback(D=>{s(A=>{const k=[...A],B=k.findIndex(G=>D===G);return B>=0&&k.splice(B,1),k})},[]);x(gg,D=>{const A=D.getParser();if(A.userId!==H().userId)return;const k=d("notifications.text.respect.1"),B=d("notifications.text.respect.2",["count"],[A.respectsReceived.toString()]);p(k,$e.RESPECT),p(B,$e.RESPECT)}),x(hg,D=>{const A=D.getParser();I(A.message.replace(/\\r/g,"\r"),null,null,d("notifications.broadcast.title"))}),x(fg,D=>{const A=D.getParser(),k=d("achievements.levelup.desc"),B=Js(A.data.badgeCode),G=H().getBadgeUrl(A.data.badgeCode),z="questengine/achievements/"+A.data.category;p(k+" "+B,$e.ACHIEVEMENT,G,z)}),x(pg,D=>{const A=D.getParser();A.numGifts<=0||p(A.numGifts.toString(),$e.CLUBGIFT,null,"catalog/open/"+K("catalog.links")["hc.hc_gifts"])}),x(Ig,D=>{const A=D.getParser();v(A.message,A.url,!1)}),x(Iu,D=>{const A=D.getParser();if(A.amountChanged<=0||A.type!==5)return;const k=K("currency.asset.icon.url","").replace("%type%",A.type.toString());p(d("notifications.text.loyalty.received",["AMOUNT"],[A.amountChanged.toString()]),$e.INFO,k)}),x(Eg,D=>{const A=D.getParser();v(A.message)}),x(_g,D=>{const A=D.getParser();I(d("opening.hours."+(A.userThrowOutAtClose?"disconnected":"closed"),["h","m"],[rc(A.openHour),rc(A.openMinute)]),de.DEFAULT,null,null,d("opening.hours.title"))}),x(Cg,D=>{const A=D.getParser(),k=d("notifications.text."+(A.boughtAsGift?"petbought":"petreceived"));let B=null;const G=q().getRoomObjectPetImage(A.pet.typeId,A.pet.paletteId,parseInt(A.pet.color,16),new Rt(45*3),64,null,!0);G&&(B=G.getImage().src),p(k,$e.PETLEVEL,B)}),x(bg,D=>{const k=D.getParser().messages.map(G=>nc(G)),B=new Si(k,de.MOTD,null,null,d("notifications.motd.title"));e(G=>[B,...G])}),x(Sg,D=>{const A=D.getParser();let k=null;const B=q().getRoomObjectPetImage(A.figureData.typeId,A.figureData.paletteId,parseInt(A.figureData.color,16),new Rt(45*3),64,null,!0);B&&(k=B.getImage().src),p(d("notifications.text.petlevel",["pet_name","level"],[A.petName,A.level.toString()]),$e.PETLEVEL,k)}),x(Ng,D=>{const A=D.getParser();u(!A.enabled)}),x(Tg,D=>{const A=D.getParser();if(!A.products||!A.products.length)return;const k=A.products[0];k&&p(d("notifications.text.club_gift.selected"),$e.INFO,Fa.getProductImageUrl(k.productType,k.furniClassId,k.extraParam))}),x(vg,D=>{const A=D.getParser();I(d("maintenance.shutdown",["m","d"],[A.minutesUntilMaintenance.toString(),A.duration.toString()]),de.DEFAULT,null,null,d("opening.hours.title"))}),x(wg,D=>{const A=D.getParser();v(A.message,A.url)}),x(Rg,D=>{const A=D.getParser();b(A.type,A.parameters)}),x(yg,D=>{const A=D.getParser();I(d("opening.hours.shutdown",["m"],[A.openMinute.toString()]),de.DEFAULT,null,null,d("opening.hours.title"))}),x(Og,D=>{const A=D.getParser();I(d("opening.hours.disconnected",["h","m"],[A.openHour.toString(),A.openMinute.toString()]),de.DEFAULT,null,null,d("opening.hours.title"))}),x(Ag,D=>{const A=D.getParser();switch(A.errorCode){default:case 0:I(d("connection.server.error.desc",["errorCode"],[A.errorCode.toString()]),de.ALERT,null,null,d("connection.server.error.title"));break;case 1001:case 1002:case 1003:case 1004:case 1005:case 1006:case 1007:case 1008:case 1009:case 1010:case 1011:case 1012:case 1013:case 1014:case 1015:case 1016:case 1017:case 1018:case 1019:D.connection.dispose();break;case 4013:I(d("connection.room.maintenance.desc"),de.ALERT,null,null,d("connection.room.maintenance.title"));break}}),x(kg,D=>{const A=D.getParser();I(d(A.alertMessage),de.DEFAULT,null,null,d(A.titleMessage?A.titleMessage:"notifications.broadcast.title"))});const P=i.useCallback(()=>{if(!m)if(ci.isRunning()){if(ks)return;ks=setTimeout(()=>{P()},ci.totalRunningTime+5e3)}else ks&&(clearTimeout(ks),ks=null),p(d("mod.chatdisclaimer"),$e.INFO),h(!0)},[m,p]);return x(Pg,P),{alerts:a,bubbleAlerts:n,confirms:o,simpleAlert:I,showNitroAlert:C,showTradeAlert:O,showConfirm:N,showSingleBubble:p,closeAlert:R,closeBubbleAlert:y,closeConfirm:F}},Xe=()=>ot(Zb),eS=(a,e)=>{const[n,r]=i.useState(()=>{if(typeof window>"u")return e;try{return Ya(a)??e}catch{return e}});return[n,s=>{try{const c=s instanceof Function?s(n):s;r(c),typeof window<"u"&&ld(a,c)}catch(c){Eu.error(c)}}]},sa=eS,tS=()=>sa(Zr.CATALOG_PLACE_MULTIPLE_OBJECTS,!1),Gd=()=>ot(tS),nS=()=>sa(Zr.CATALOG_SKIP_PURCHASE_CONFIRMATION,!1),Bd=()=>ot(nS),rS=-12345678,sS=()=>{const[a,e]=i.useState(!1),[n,r]=i.useState(!1),[o,s]=i.useState(-1),[c,u]=i.useState(-1),[m,h]=i.useState(On.NORMAL),[g,f]=i.useState(null),[_,E]=i.useState(null),[I,C]=i.useState(null),[p,b]=i.useState(null),[N,v]=i.useState([]),[O,R]=i.useState(null),[y,F]=i.useState([]),[P,D]=i.useState(null),[A,k]=i.useState(!1),[B,G]=i.useState({quantity:1,extraData:null,extraParamRequired:!1,previewStuffData:null}),[z,X]=i.useState({}),[Y,Ee]=i.useState(!1),[le,De]=Gd(),[Qe,ft]=Bd(),[Ze,Gt]=i.useState(null),[We,Yt]=i.useState(null),[Nn,Fe]=i.useState(0),[Ie,ze]=i.useState(0),[Ot,me]=i.useState(0),[Ae,at]=i.useState(0),[en,pe]=i.useState(0),[Me,Tn]=i.useState(0),{simpleAlert:Pr=null}=Xe(),tn=i.useRef(new hr),ia=i.useCallback(()=>{s(-1),u(-1),f(null),E(null),C(null),b(null),v([]),R(null),F([]),e(!1)},[]),Rs=i.useCallback(W=>{if(!W)return rn.MISSING_OFFER;if(Nn<0||Nn>=Ie)return rn.FURNI_LIMIT_REACHED;const $=Oe();if(!$)return rn.NOT_IN_ROOM;if(!$.isRoomOwner)return rn.NOT_ROOM_OWNER;if(Ae<=0){const J=q();let oe=J.getRoomObjectCount($.roomId,Q.UNIT);for(;oe>0;){const ke=J.getRoomObjectByIndex($.roomId,oe,Q.UNIT),Ke=$.userDataManager.getUserDataByIndex(ke.id);if(Ke&&Ke.type===ht.USER&&Ke.roomIndex!==$.ownRoomIndex&&!Ke.isModerator)return rn.VISITORS_IN_ROOM;oe--}}return rn.OKAY},[Nn,Ie,Ae]),Dr=i.useCallback(W=>{const $=Oe();return!!(($&&W.page&&W.page.layoutCode!=="sold_ltd_items"&&m===On.NORMAL&&($.isRoomOwner||$.isGuildRoom&&$.controllerLevel>=tt.GUILD_MEMBER)||m===On.BUILDER&&Rs(W)===rn.OKAY)&&W.pricingModel!==it.PRICING_MODEL_BUNDLE&&W.product.productType!==ue.EFFECT&&W.product.productType!==ue.HABBO_CLUB)},[m,Rs]),Mr=i.useCallback(W=>{if(!Dr(W))return;const $=W.product;if(!$)return;let J=0;switch($.productType){case ue.FLOOR:J=Q.FLOOR;break;case ue.WALL:J=Q.WALL;break}q().processRoomObjectPlacement(Us.CATALOG,-W.offerId,J,$.productClassId,$.extraParam)&&(Gt(W),Ee(!0),e(!1))},[Dr]),ns=i.useCallback((W,$)=>{const J=q();let oe=J.getRoomInstanceVariable(J.activeRoomId,te.ROOM_WALL_TYPE),ke=J.getRoomInstanceVariable(J.activeRoomId,te.ROOM_FLOOR_TYPE),Ke=J.getRoomInstanceVariable(J.activeRoomId,te.ROOM_LANDSCAPE_TYPE);switch(oe=oe&&oe.length?oe:"101",ke=ke&&ke.length?ke:"101",Ke=Ke&&Ke.length?Ke:"1.1",W){case"floor":J.updateRoomInstancePlaneType(J.activeRoomId,$,oe,Ke,!0);return;case"wallpaper":J.updateRoomInstancePlaneType(J.activeRoomId,ke,$,Ke,!0);return;case"landscape":J.updateRoomInstancePlaneType(J.activeRoomId,ke,oe,$,!0);return;default:J.updateRoomInstancePlaneType(J.activeRoomId,ke,oe,Ke,!0);return}},[]),ys=i.useCallback(()=>{Ze&&(q().cancelRoomObjectInsert(),Ee(!1),Gt(null))},[Ze]),br=i.useCallback((W=!0)=>{Ee($=>($&&W&&ee("catalog/open"),!1))},[]),Lr=i.useCallback((W=!1)=>{W||br(),Yt($=>{if($)switch($.category){case Q.FLOOR:q().removeRoomObjectFloor($.roomId,$.objectId);break;case Q.WALL:{switch($.furniData.className){case"floor":case"wallpaper":case"landscape":ns("reset","");break;default:q().removeRoomObjectWall($.roomId,$.objectId);break}break}default:q().deleteRoomObject($.objectId,$.category);break}return null})},[br,ns]),Bt=i.useCallback((W,$)=>{if($.pageId===W&&$!==g)return $;for(const J of $.children){const oe=Bt(W,J);if(oe)return oe}return null},[g]),zn=i.useCallback((W,$)=>{if($.pageName===W&&$!==g)return $;for(const J of $.children){const oe=zn(W,J);if(oe)return oe}return null},[g]),rs=i.useCallback((W,$=!1)=>{if(!_||!_.size)return null;if($){const J=[],oe=_.get(W);if(oe&&oe.length)for(const ke of oe)ke.isVisible&&J.push(ke);if(J.length)return J}return _.get(W)},[_]),$n=i.useCallback((W,$)=>{W<0||(r(!0),s(W),W>-1&&M(new Dg(W,$,m)))},[m]),Sm=i.useCallback((W,$,J,oe,ke,Ke)=>{const At=new Bi(W,$,J,oe,Ke);if(C(At),u(Ce=>W!==-1?W:Ce),k(!1),ke>-1&&At.offers.length){for(const Ce of At.offers)if(Ce.offerId===ke){b(Ce);break}}},[]),or=i.useCallback((W,$=-1)=>{if(ys(),W.parent.pageName==="root"&&W.children.length){for(const ke of W.children)if(ke.isVisible){W=ke;break}}const J=[];let oe=W;for(;oe&&oe.pageName!=="root";)J.push(oe),oe=oe.parent;J.reverse(),v(ke=>{const Ke=ke.indexOf(W)>=0,At=W.isOpen;for(const Ce of ke)Ce.deactivate(),J.indexOf(Ce)===-1&&Ce.close();for(const Ce of J)Ce.activate(),Ce.parent&&Ce.open(),Ce===W.parent&&Ce.children.length&&Ce.open();return Ke&&At?W.close():W.open(),J}),W.pageId>-1&&$n(W.pageId,$)},[v,$n,ys]),Os=i.useCallback(W=>{if(W!==-1&&R(null),!a)tn.current.requestById=W,e(!0);else{const $=Bt(W,g);$&&or($)}},[a,g,Bt,or]),So=i.useCallback(W=>{if(R(null),!a)tn.current.requestByName=W,e(!0);else{const $=zn(W,g);$&&or($)}},[a,g,zn,or]),No=i.useCallback(W=>{if(R(null),!a)tn.current.requestedByOfferId=W,e(!0);else{const $=rs(W);if(!$||!$.length)return;or($[0],W)}},[a,rs,or]),ml=i.useCallback(()=>{},[]);return x(Mg,W=>{const $=W.getParser(),J=new Map,oe=(ke,Ke,At)=>{const Ce=new bC(ke,Ke,At);for(const vn of Ce.offerIds)J.has(vn)?J.get(vn).push(Ce):J.set(vn,[Ce]);Ke++;for(const vn of ke.children)Ce.addChild(oe(vn,Ke,Ce));return Ce};f(oe($.root,0,null)),E(J)}),x(Lg,W=>{const $=W.getParser();if($.catalogType!==m)return;const J=[];for(const oe of $.offers){const ke=[],Ke=hs(oe.localizationId);for(const Ce of oe.products){const vn=fi(Ce.furniClassId,Ce.productType);ke.push(new Yr(Ce.productType,Ce.furniClassId,Ce.extraParam,Ce.productCount,Ke,vn,Ce.uniqueLimitedItem,Ce.uniqueLimitedSeriesSize,Ce.uniqueLimitedItemsLeft))}if(!ke.length)continue;const At=new it(oe.offerId,oe.localizationId,oe.rent,oe.priceCredits,oe.priceActivityPoints,oe.priceActivityPointsType,oe.giftable,oe.clubLevel,ke,oe.bundlePurchaseAllowed);(m===On.NORMAL||At.pricingModel!==it.PRICING_MODEL_BUNDLE&&At.pricingModel!==it.PRICING_MODEL_MULTI)&&J.push(At)}$.frontPageItems&&$.frontPageItems.length&&F($.frontPageItems),r(!1),o===$.pageId&&Sm($.pageId,$.layoutCode,new ed($.localization.images.concat(),$.localization.texts.concat()),J,$.offerId,$.acceptSeasonCurrencyAsCredits)}),x(Ug,W=>{const $=W.getParser();St(new pr($.offer))}),x(xg,W=>{const $=W.getParser();St(new Kr($.code))}),x(Fg,W=>{const $=W.getParser();St(new eo($.code))}),x(Gg,W=>{W.getParser(),St(new to)}),x(Bg,W=>{const J=W.getParser().offer;if(!J||!J.products.length)return;J.products[0].uniqueLimitedItem;const ke=[],Ke=hs(J.localizationId);for(const Ce of J.products){const vn=fi(Ce.furniClassId,Ce.productType);ke.push(new Yr(Ce.productType,Ce.furniClassId,Ce.extraParam,Ce.productCount,Ke,vn,Ce.uniqueLimitedItem,Ce.uniqueLimitedSeriesSize,Ce.uniqueLimitedItemsLeft))}const At=new it(J.offerId,J.localizationId,J.rent,J.priceCredits,J.priceActivityPoints,J.priceActivityPointsType,J.giftable,J.clubLevel,ke,J.bundlePurchaseAllowed);(m===On.NORMAL||At.pricingModel!==it.PRICING_MODEL_BUNDLE&&At.pricingModel!==it.PRICING_MODEL_MULTI)&&(At.page=I,b(At),At.product&&At.product.productType===ue.WALL&&G(Ce=>{const vn={...Ce};return vn.extraData=At.product.extraParam||null,vn}))}),x(Vg,W=>{const $=W.getParser(),J=new SC($.productCode,$.palettes.slice());X(oe=>{const ke=[];oe.petPalettes&&ke.push(...oe.petPalettes);for(let Ke=0;Ke<ke.length;Ke++)if(ke[Ke].breed===J.breed){ke.splice(Ke,1);break}return ke.push(J),{...oe,petPalettes:ke}})}),x(Hg,W=>{const $=W.getParser();X(J=>{const oe=$.offers;return{...J,clubOffers:oe}})}),x(Wg,W=>{const $=W.getParser();X(J=>{const oe=$.groups;return{...J,groups:oe}})}),x(jg,W=>{const $=W.getParser();X(J=>{const oe=new OC($);return{...J,giftConfiguration:oe}})}),x(qg,W=>{const $=W.getParser();if(!$)return;let J="";$.result===1?J=d("inventory.marketplace.result.title.success"):J=d("inventory.marketplace.result.title.failure");const oe=d(`inventory.marketplace.result.${$.result}`);Pr(oe,de.DEFAULT,null,null,J)}),x(_u,W=>{const $=W.getParser();X(J=>({...J,clubGifts:$}))}),x(Yg,W=>{const $=a;ia(),$&&Pr(d("catalog.alert.published.description"),de.ALERT,null,null,d("catalog.alert.published.title"))}),x(zg,W=>{const $=W.getParser();Fe($.furniCount),ml()}),x($g,W=>{const $=W.getParser();ze($.furniLimit),me($.maxFurniLimit),at($.secondsLeft),pe(Rn()),Tn($.secondsLeftWithGrace),ml()}),ct(pr.PURCHASE_SUCCESS,W=>rr(dn.CREDITS)),Te(fl.PLACED,W=>{if(!Y||W.type!==fl.PLACED)return;if(Lr(!0),!Ze){br();return}let $=!1;const J=Ze.product;if(W.category===Q.WALL)switch(J.furnitureData.className){case"floor":case"wallpaper":case"landscape":$=W.placedOnFloor||W.placedOnWall;break;default:$=W.placedInRoom;break}else $=W.placedInRoom;if(!$){br();return}switch(Yt(new AC(W.roomId,W.objectId,W.category,W.wallLocation,W.x,W.y,W.direction,Ze)),m){case On.NORMAL:{switch(W.category){case Q.FLOOR:q().addFurnitureFloor(W.roomId,W.objectId,J.productClassId,new Rt(W.x,W.y,W.z),new Rt(W.direction),0,new Qg);break;case Q.WALL:switch(J.furnitureData.className){case"floor":case"wallpaper":case"landscape":ns(J.furnitureData.className,J.extraParam);break;default:q().addFurnitureWall(W.roomId,W.objectId,J.productClassId,new Rt(W.x,W.y,W.z),new Rt(W.direction*45),0,W.instanceData,0);break}}const oe=q().getRoomObject(W.roomId,W.objectId,W.category);oe&&oe.model.setValue(te.FURNITURE_ALPHA_MULTIPLIER,.5),Qe&&M(new ao(o,Ze.offerId,J.extraParam,1)),le&&Mr(Ze);break}case On.BUILDER:{let oe=Ze.page.pageId;switch(oe===rS&&(oe=-1),W.category){case Q.FLOOR:M(new Xg(oe,Ze.offerId,J.extraParam,W.x,W.y,W.direction));break;case Q.WALL:M(new Kg(oe,Ze.offerId,J.extraParam,W.wallLocation));break}le&&Mr(Ze);break}}}),ct(ro.FURNI_ADDED,W=>{const $=q();if(!(!We||We.productClassId!==W.spriteId||We.roomId!==$.activeRoomId)){switch(W.category){case Z.FLOOR:{const J=$.getRoomInstanceVariable($.activeRoomId,te.ROOM_FLOOR_TYPE);We.extraParam!==J&&M(new xa(W.id));break}case Z.WALL_PAPER:{const J=$.getRoomInstanceVariable($.activeRoomId,te.ROOM_WALL_TYPE);We.extraParam!==J&&M(new xa(W.id));break}case Z.LANDSCAPE:{const J=$.getRoomInstanceVariable($.activeRoomId,te.ROOM_LANDSCAPE_TYPE);We.extraParam!==J&&M(new xa(W.id));break}default:M(new Jg(W.id,We.category,We.wallLocation,We.x,We.y,We.direction))}le||Lr()}}),i.useEffect(()=>()=>b(null),[I]),i.useEffect(()=>{if(!(!a||!g||!_||!tn.current))switch(tn.current.requestType){case hr.REQUEST_TYPE_NONE:if(I)return;if(g.isBranch){for(const W of g.children)if(W&&W.isVisible){or(W);return}}return;case hr.REQUEST_TYPE_ID:Os(tn.current.requestById),tn.current.resetRequest();return;case hr.REQUEST_TYPE_OFFER:No(tn.current.requestedByOfferId),tn.current.resetRequest();return;case hr.REQUEST_TYPE_NAME:So(tn.current.requestByName),tn.current.resetRequest();return}},[a,g,_,I,or,Os,No,So]),i.useEffect(()=>{!O&&I&&I.pageId===-1&&Os(c)},[O,I,c,Os]),i.useEffect(()=>{p&&G({quantity:1,extraData:null,extraParamRequired:!1,previewStuffData:null})},[p]),i.useEffect(()=>{!a||g||(M(new Zg),M(new Cu),M(new eh(m)),M(new th))},[a,g,m]),i.useEffect(()=>(D(new ja(q(),++ja.PREVIEW_COUNTER)),()=>{D(W=>(W.dispose(),null))}),[]),{isVisible:a,setIsVisible:e,isBusy:n,pageId:o,previousPageId:c,currentType:m,rootNode:g,offersToNodes:_,currentPage:I,setCurrentPage:C,currentOffer:p,setCurrentOffer:b,activeNodes:N,searchResult:O,setSearchResult:R,frontPageItems:y,roomPreviewer:P,navigationHidden:A,setNavigationHidden:k,purchaseOptions:B,setPurchaseOptions:G,catalogOptions:z,setCatalogOptions:X,getNodeById:Bt,getNodeByName:zn,activateNode:or,openPageById:Os,openPageByName:So,openPageByOfferId:No,requestOfferToMover:Mr}},xe=()=>ot(sS),aS=1e3,oS=10,iS=1e3;let lS=0,cS=0;const uS=()=>{const[a,e]=i.useState([]),[n,r]=i.useState([]),[o,s]=i.useState([]),[c,u]=i.useState(!1),m=f=>{f.id=lS++,e(_=>{const E=[..._];return E.push(f),E.length>aS&&E.shift(),E})},h=f=>{r(_=>{const E=[..._];return E.push(f),E.length>oS&&E.shift(),E})},g=f=>{f.id=cS++,s(_=>{const E=[..._];return E.push(f),E.length>iS&&E.shift(),E})};return Ye(qt.STARTED,f=>u(!0)),x(vs,f=>{if(!c)return;const _=f.getParser();n.length&&n[n.length-1].id===_.data.roomId||(m({id:-1,webId:-1,entityId:-1,name:_.data.roomName,timestamp:cd(),type:Pn.TYPE_ROOM_INFO,roomId:_.data.roomId}),h({id:_.data.roomId,name:_.data.roomName}),u(!1))}),x(bu,f=>{const _=f.getParser();g({id:-1,webId:_.senderId,entityId:-1,name:"",message:_.messageText,roomId:-1,timestamp:ql(_.secondsSinceSent),type:Pn.TYPE_IM})}),x(Su,f=>{const _=f.getParser();g({id:-1,webId:_.senderId,entityId:-1,name:"",message:_.messageText,roomId:-1,timestamp:ql(),type:Pn.TYPE_IM})}),{addChatEntry:m,chatHistory:a,roomHistory:n,messengerHistory:o}},po=()=>ot(uS),dS=()=>{const[a,e]=i.useState([]),[n,r]=i.useState([]),[o,s]=i.useState([]),[c,u]=i.useState([]),[m,h]=i.useState(null),g=i.useMemo(()=>{const N=a.filter(v=>v.online);return N.sort((v,O)=>v.name<O.name?-1:v.name>O.name?1:0),N},[a]),f=i.useMemo(()=>{const N=a.filter(v=>!v.online);return N.sort((v,O)=>v.name<O.name?-1:v.name>O.name?1:0),N},[a]),_=N=>M(new xi(N.id)),E=(N,v)=>v!==N.relationshipStatus&&M(new Ps(N.id,v)),I=N=>{for(const v of a)if(v.id===N)return v;return null},C=N=>!(N===H().userId||I(N)||n.find(v=>v.requesterUserId===N)||o.indexOf(N)>=0),p=(N,v)=>{if(!C(N))return!1;s(O=>{const R=[...O];return R.push(N),R}),M(new Nu(v))},b=(N,v)=>{N===-1&&!v?(M(new pl(!0)),r([])):r(O=>{const R=[...O],y=R.findIndex(F=>F.id===N);return y===-1?O:(M(v?new uh(R[y].id):new pl(!1,R[y].id)),R.splice(y,1),R)})};return x(rh,N=>{const v=N.getParser();h(new db(v.userFriendLimit,v.normalFriendLimit,v.extendedFriendLimit,v.categories)),M(new nh)}),x(sh,N=>{const v=N.getParser();e(O=>{const R=[...O];for(const y of v.fragment){const F=R.findIndex(D=>D.id===y.id),P=new jt;P.populate(y),F>-1?R[F]=P:R.push(P)}return R})}),x(ah,N=>{const v=N.getParser();e(O=>{const R=[...O],y=F=>{const P=R.findIndex(D=>D.id===F.id);if(P===-1){const D=new jt;D.populate(F),R.unshift(D)}else R[P].populate(F)};for(const F of v.addedFriends)y(F);for(const F of v.updatedFriends)y(F);for(const F of v.removedFriendIds){const P=R.findIndex(D=>D.id===F);P>-1&&R.splice(P,1)}return R})}),x(oh,N=>{const v=N.getParser();r(O=>{const R=[...O];for(const y of v.requests){const F=R.findIndex(P=>P.requesterUserId===y.requesterUserId);if(F>0)R[F]=Kt(R[F]),R[F].populate(y);else{const P=new Yl;P.populate(y),R.push(P)}}return R})}),x(ih,N=>{const O=N.getParser().request;r(R=>{const y=[...R];if(y.findIndex(P=>P.requesterUserId===O.requesterUserId)===-1){const P=new Yl;P.populate(O),y.push(P)}return y})}),i.useEffect(()=>{M(new lh);const N=setInterval(()=>M(new ch),12e4);return()=>{clearInterval(N)}},[]),{friends:a,requests:n,sentRequests:o,dismissedRequestIds:c,setDismissedRequestIds:u,settings:m,onlineFriends:g,offlineFriends:f,getFriend:I,canRequestFriend:C,requestFriend:p,requestResponse:b,followFriend:_,updateRelationship:E}},gn=()=>ot(dS),mS=()=>{const[a,e]=i.useState([]),[n,r]=i.useState(-1),[o,s]=i.useState([]),[c,u]=i.useState(Wn.HIDDEN),{getFriend:m=null}=gn(),{simpleAlert:h=null}=Xe(),g=i.useMemo(()=>a.filter(C=>o.indexOf(C.threadId)===-1),[a,o]),f=i.useMemo(()=>n>0&&g.find(C=>C.threadId===n||null),[n,g]),_=C=>{let p=a.find(b=>b.participant&&b.participant.id===C);if(p){const b=o.indexOf(p.threadId);b>=0&&s(N=>{const v=[...N];return v.splice(b,1),v})}else{const b=m(C);if(!b)return null;p=new zi(b),p.addMessage(null,d("messenger.moderationinfo"),0,null,jn.SECURITY_NOTIFICATION),p.setRead(),e(N=>{const v=[...N];return v.push(p),v})}return p},E=C=>{s(p=>{const b=[...p];return b.indexOf(C)>=0?p:(b.push(C),b)}),n===C&&r(-1)},I=(C,p,b,N=0,v=null,O=jn.CHAT)=>{if(!C||!b||!b.length)return;const R=p===H().userId;R&&b.length<=255&&M(new mh(C.participant.id,b)),e(y=>{const F=[...y],P=F.findIndex(D=>D.threadId===C.threadId);return P===-1?y:(C=Kt(F[P]),R&&C.groups.length===1&&rr(dn.MESSENGER_NEW_THREAD),C.addMessage(O===jn.ROOM_INVITE?null:p,b,N,v,O),n===C.threadId&&C.setRead(),F[P]=C,!R&&C.unread&&rr(dn.MESSENGER_MESSAGE_RECEIVED),F)})};return x(bu,C=>{const p=C.getParser(),b=_(p.senderId);b&&I(b,p.senderId,p.messageText,p.secondsSinceSent,p.extraData)}),x(Su,C=>{const p=C.getParser(),b=_(p.senderId);b&&I(b,p.senderId,p.messageText,0,null,jn.ROOM_INVITE)}),x(dh,C=>{const p=C.getParser();h(`Received room invite error: ${p.errorCode},recipients: ${p.failedRecipients}`,de.DEFAULT,null,null,d("friendlist.alert.title"))}),i.useEffect(()=>{n<=0||e(C=>{const p=[...C],b=p.findIndex(N=>N.threadId===n);return b>=0&&(p[b]=Kt(p[b]),p[b].setRead()),p})},[n]),i.useEffect(()=>{u(C=>{if(!g.length)return Wn.HIDDEN;let p=!1;for(const b of g)if(b.unreadCount>0){p=!0;break}return p?Wn.UNREAD:Wn.SHOW})},[g]),{messageThreads:a,activeThread:f,iconState:c,visibleThreads:g,getMessageThread:_,setActiveThreadId:r,closeThread:E,sendMessage:I}},Vd=()=>ot(mS),gS=()=>{const[a,e]=i.useState(!1),[n,r]=i.useState(null),[o,s]=i.useState(null),[c,u]=i.useState(null),[m,h]=i.useState(!1),[g,f]=i.useState(null);return x(gh,_=>{let E=_.getParser();!E||E&&!E.games.length||(s(E.games[0]),r(E.games))}),x(hh,_=>{let E=_.getParser();E&&u(E)}),x(fh,_=>{let E=_.getParser();E&&h(E.isInMaintenance)}),x(ph,_=>{let E=_.getParser();if(E)switch(E.gameTypeId){case 2:return console.log("snowwar");default:return f(E.url)}}),i.useEffect(()=>{a&&(M(new Ih),Vi())},[a]),{isVisible:a,setIsVisible:e,games:n,accountStatus:c,selectedGame:o,setSelectedGame:s,gameOffline:m,gameURL:g,setGameURL:f}},Io=()=>ot(gS),hS=()=>{const[a,e]=i.useState(null);return x(Eh,n=>{const r=n.getParser(),o={badgeBases:[],badgeSymbols:[],badgePartColors:[],groupColorsA:[],groupColorsB:[]};r.bases.forEach((c,u)=>o.badgeBases.push({id:u,images:c})),r.symbols.forEach((c,u)=>o.badgeSymbols.push({id:u,images:c})),r.partColors.forEach((c,u)=>o.badgePartColors.push({id:u,color:c})),r.colorsA.forEach((c,u)=>o.groupColorsA.push({id:u,color:c})),r.colorsB.forEach((c,u)=>o.groupColorsB.push({id:u,color:c}));const s=(c,u)=>c.id<u.id?-1:c.id>u.id?1:0;o.badgeBases.sort(s),o.badgeSymbols.sort(s),o.badgePartColors.sort(s),o.groupColorsA.sort(s),o.groupColorsB.sort(s),e(o)}),i.useEffect(()=>{M(new _h)},[]),{groupCustomize:a}},aa=()=>ot(hS),fS=()=>{const[a,e]=i.useState(null),[n,r]=i.useState(null),{simpleAlert:o=null,showConfirm:s=null}=Xe(),c=(u,m)=>{const h={reportType:u,reportedUserId:-1,reportedChats:[],cfhCategory:-1,cfhTopic:-1,roomId:-1,roomName:"",messageId:-1,threadId:-1,groupId:-1,extraData:"",roomObjectId:-1,message:"",currentStep:0};switch(u){case Ve.BULLY:case Ve.EMERGENCY:case Ve.IM:h.reportedUserId=m.reportedUserId,h.currentStep=kt.SELECT_CHATS;break;case Ve.ROOM:h.roomId=m.roomId,h.roomName=m.roomName,h.currentStep=kt.SELECT_TOPICS;break;case Ve.THREAD:h.groupId=m.groupId,h.threadId=m.threadId,h.currentStep=kt.SELECT_TOPICS;break;case Ve.MESSAGE:h.groupId=m.groupId,h.threadId=m.threadId,h.messageId=m.messageId,h.currentStep=kt.SELECT_TOPICS;break;case Ve.PHOTO:h.extraData=m.extraData,h.roomId=m.roomId,h.reportedUserId=m.reportedUserId,h.roomObjectId=m.roomObjectId,h.currentStep=kt.SELECT_TOPICS;break}e(h)};return x(bh,u=>{const m=u.getParser();let h=m.messageText;switch(m.resultType){case Ka.TOO_MANY_PENDING_CALLS_CODE:M(new Ch),o(d("help.cfh.error.pending"),de.MODERATION,null,null,d("help.cfh.error.title"));break;case Ka.HAS_ABUSIVE_CALL_CODE:o(d("help.cfh.error.abusive"),de.MODERATION,null,null,d("help.cfh.error.title"));break;default:h.trim().length===0&&(h=d("help.cfh.sent.text")),o(h,de.MODERATION,null,null,d("help.cfh.sent.title"))}}),x(Sh,u=>{const m=u.getParser(),h=m.messageText.length===0?d("help.cfh.closed."+Eb(m.closeReason)):m.messageText;o(h,de.MODERATION,null,null,d("mod.alert.title"))}),x(Th,u=>{const m=u.getParser();m.count>0&&s(d("help.emergency.pending.title")+`
`+m.pendingCalls[0].message,()=>{M(new Nh)},null,d("help.emergency.pending.button.discard"),d("help.emergency.pending.button.keep"),d("help.emergency.pending.message.subtitle"))}),x(vh,u=>{o("Your pending calls were deleted",de.MODERATION,null,null,d("mod.alert.title"))}),x(wh,u=>{const m=u.getParser();o(m.message,de.MODERATION,null,null,d("help.cfh.reply.title"))}),x(Rh,u=>{const m=u.getParser();o(d("help.emergency.global_mute.message"),de.MODERATION,m.infoUrl,d("help.emergency.global_mute.link"),d("help.emergency.global_mute.subtitle"))}),x(yh,u=>{const m=u.getParser();r(m)}),{activeReport:a,setActiveReport:e,sanctionInfo:n,setSanctionInfo:r,report:c}},Mn=()=>ot(fS),Eo=()=>{const[a,e]=i.useState([]),n=i.useMemo(()=>!!a.length,[a]),r=i.useCallback(()=>{let s=-1;return e(c=>{const u=[...c];return s=u.length?u[u.length-1]+1:0,u.push(s),u}),s},[]),o=i.useCallback(s=>{e(c=>{const u=[...c],m=u.indexOf(s);return m===-1?c:(u.splice(m,1),u)})},[]);return{isVisible:n,activate:r,deactivate:o}},pS=a=>M(new Ah(a)),IS=(a,e)=>M(new kh(a,...e)),ES=()=>{const[a,e]=i.useState(new Map),n=i.useCallback(m=>{var h;return((h=a.get(m))==null?void 0:h.length)||0},[a]),r=i.useMemo(()=>{let m=0;for(const h of a.keys())m+=n(h);return m},[a,n]),o=i.useCallback(m=>{let h=!0;return e(g=>{if(!g.has(m))return h=!1,g;const f=new Map(g);return f.delete(m),pS(m),f}),h},[]),s=i.useCallback((m,h)=>{let g=!0;return e(f=>{if(!f.has(m))return g=!1,f;const _=new Map(f),E=_.get(m);if(E)for(const I of h)E.splice(E.indexOf(I),1);return IS(m,h),_}),g},[]),c=i.useCallback((m,h)=>a.has(m)?a.get(m).indexOf(h)>=0:!1,[a]),u=i.useCallback((m,h)=>{e(g=>{if(!g.has(m))return g;const f=new Map(g),_=f.get(m),E=_.indexOf(h);return E>=0&&_.splice(E,1),f})},[]);return x(Oh,m=>{const h=m.getParser();e(g=>{const f=new Map(g);for(const _ of h.categories){let E=f.get(_);E||(E=[],f.set(_,E));const I=h.getItemsByCategory(_);for(const C of I)E.indexOf(C)===-1&&E.push(C)}return f})}),{getCount:n,getFullCount:r,resetCategory:o,resetItems:s,isUnseen:c,removeUnseen:u}},bn=()=>ot(ES),_S=()=>{const[a,e]=i.useState(!0),[n,r]=i.useState([]),[o,s]=i.useState(new Map),[c,u]=i.useState([]),[m,h]=i.useState(null),{isVisible:g=!1,activate:f=null,deactivate:_=null}=Eo(),{isUnseen:E=null,resetCategory:I=null}=bn(),C=K("user.badges.max.slots",5),p=O=>c.indexOf(O)>=0,b=()=>c.length<C,N=O=>{u(R=>{const y=[...R],F=y.indexOf(O);if(F===-1){if(!b())return R;y.push(O)}else y.splice(F,1);const P=new Lh;for(let D=0;D<C;D++)P.addActivatedBadge(y[D]??"");return M(P),y})},v=O=>n.indexOf(O)===-1?0:o.get(O)??0;return x(Ph,O=>{const R=O.getParser(),y=[];s(F=>{const P=new Map(F);return R.getAllBadgeCodes().forEach(D=>{const A=n.indexOf(D)>=0,k=R.getBadgeId(D);P.set(D,k),!A&&y.push(D)}),P}),u(R.getActiveBadgeCodes()),r(F=>[...F,...y])}),x(Dh,O=>{const R=O.getParser(),y=E(qe.BADGE,R.badgeId);r(F=>{const P=[...F];return y?P.unshift(R.badgeCode):P.push(R.badgeCode),P}),s(F=>{const P=new Map(F);return P.set(R.badgeCode,R.badgeId),P})}),i.useEffect(()=>{!n||!n.length||h(O=>{let R=O;return R&&n.indexOf(R)===-1&&(R=null),R||(R=n[0]),R})},[n]),i.useEffect(()=>{if(g)return()=>{I(qe.BADGE)}},[g,I]),i.useEffect(()=>{!g||!a||(M(new Mh),e(!1))},[g,a]),{badgeCodes:n,activeBadgeCodes:c,selectedBadgeCode:m,setSelectedBadgeCode:h,isWearingBadge:p,canWearBadges:b,toggleBadge:N,getBadgeId:v,activate:f,deactivate:_}},_o=()=>ot(_S),CS=()=>{const[a,e]=i.useState(!0),[n,r]=i.useState([]),[o,s]=i.useState(null),{isVisible:c=!1,activate:u=null,deactivate:m=null}=Eo(),{isUnseen:h=null,resetCategory:g=null}=bn();return x(Uh,f=>{const _=f.getParser();r(E=>{const I=[...E],C=I.map(b=>b.botData.id),p=[];for(const b of _.items.values())C.indexOf(b.id)===-1&&p.push(b);for(const b of C){let N=!0;for(const R of _.items.values())if(R.id===b){N=!1;break}if(!N)continue;const v=I.findIndex(R=>R.botData.id===b),O=I[v];v===-1||!O||(_s()===O.botData.id&&(js(),ee("inventory/open")),I.splice(v,1))}for(const b of p){const N={botData:b};h(qe.BOT,b.id)?I.unshift(N):I.push(N)}return I})}),x(xh,f=>{const _=f.getParser();r(E=>{const I=[...E];if(I.findIndex(N=>N.botData.id===_.item.id)>=0)return E;const p={botData:_.item};return h(qe.BOT,p.botData.id)?I.unshift(p):I.push(p),I})}),x(Fh,f=>{const _=f.getParser();r(E=>{const I=[...E],C=I.findIndex(p=>p.botData.id===_.itemId);return C===-1?E:(I.splice(C,1),_s()===_.itemId&&(js(),ee("inventory/show")),I)})}),i.useEffect(()=>{!n||!n.length||s(f=>{let _=f;return _&&n.indexOf(_)===-1&&(_=null),_||(_=n[0]),_})},[n]),i.useEffect(()=>{if(c)return()=>{g(qe.BOT)}},[c,g]),i.useEffect(()=>{!c||!a||(M(new Gh),e(!1))},[c,a]),{botItems:n,selectedBot:o,setSelectedBot:s,activate:u,deactivate:m}},Hd=()=>ot(CS);let Sa=null;const bS=()=>{const[a,e]=i.useState(!0),[n,r]=i.useState([]),[o,s]=i.useState(null),{isVisible:c=!1,activate:u=null,deactivate:m=null}=Eo(),{isUnseen:h=null,resetCategory:g=null}=bn(),f=I=>{if(!(!n||!n.length))return n.filter(C=>C.type===I)},_=I=>{if(!(!n||!n.length)){for(const C of n){const p=C.getItemById(I);if(p&&p.isWallItem)return C}return null}},E=I=>{if(!(!n||!n.length)){for(const C of n){const p=C.getItemById(I);if(p&&!p.isWallItem)return C}return null}};return x(Tu,I=>{const C=I.getParser();r(p=>{const b=[...p];for(const N of C.items){let v=0,O=null;for(;v<b.length;){const R=b[v];let y=0;for(;y<R.items.length;){const F=R.items[y];if(F.id===N.itemId){F.update(N);const P=[...R.items];P[y]=F,R.items=P,O=R;break}y++}if(O)break;v++}if(O)O.hasUnseenItems=!0,b[v]=Kt(O);else{const R=new Ws(N);Vl(b,R,h(qe.FURNI,N.itemId)),St(new ro(R.id,R.type,R.category))}}return b})}),x(ui,I=>{const C=I.getParser();Sa||(Sa=new Array(C.totalFragments));const p=jC(C.fragment,C.totalFragments,C.fragmentNumber,Sa);p&&(r(b=>{const N=[...b],v=qC(N);for(const O of v){if(p.get(O))continue;let R=0;for(;R<N.length;){const y=N[R],F=y.remove(O);if(!F){R++;continue}_s()===F.ref&&(js(),Cs(y)||ee("inventory/show")),y.getTotalCount()<=0&&(N.splice(R,1),y.dispose());break}}for(const O of p.keys()){if(v.indexOf(O)>=0)continue;const R=p.get(O);if(!R)continue;const y=new Ws(R);Vl(N,y,h(qe.FURNI,O)),St(new ro(y.id,y.type,y.category))}return N}),Sa=null)}),x(Bh,I=>{e(!0)}),x(vu,I=>{const C=I.getParser();r(p=>{const b=[...p];let N=0;for(;N<b.length;){const v=b[N],O=v.remove(C.itemId);if(!O){N++;continue}_s()===O.ref&&(js(),Cs(v)||ee("inventory/show")),v.getTotalCount()<=0&&(b.splice(N,1),v.dispose());break}return b})}),x(Vh,I=>{}),i.useEffect(()=>{!n||!n.length||s(I=>{let C=I;return C&&n.indexOf(C)===-1&&(C=null),C||(C=n[0]),C})},[n]),i.useEffect(()=>{if(c)return()=>{g(qe.FURNI)&&r(I=>{const C=[...I];for(const p of C)p.hasUnseenItems=!1;return C})}},[c,g]),i.useEffect(()=>{!c||!a||(M(new Hh),e(!1))},[c,a]),{isVisible:c,groupItems:n,setGroupItems:r,selectedItem:o,setSelectedItem:s,activate:u,deactivate:m,getWallItemById:_,getFloorItemById:E,getItemsByType:f}},es=()=>ot(bS);let Na=null;const SS=()=>{const[a,e]=i.useState(!0),[n,r]=i.useState([]),[o,s]=i.useState(null),{isVisible:c=!1,activate:u=null,deactivate:m=null}=Eo(),{isUnseen:h=null,resetCategory:g=null}=bn();return x(Wh,f=>{const _=f.getParser();Na||(Na=new Array(_.totalFragments));const E=KC(_.fragment,_.totalFragments,_.fragmentNumber,Na);E&&(r(I=>{const C=[...I];return $C(C,E,h),C}),Na=null)}),x(jh,f=>{const _=f.getParser();r(E=>{const I=[...E];return od(_.pet,I,h(qe.PET,_.pet.id)),I})}),x(qh,f=>{const _=f.getParser();r(E=>{const I=[...E];return id(_.petId,I),I})}),i.useEffect(()=>{!n||!n.length||s(f=>{let _=f;return _&&n.indexOf(_)===-1&&(_=null),_||(_=n[0]),_})},[n]),i.useEffect(()=>{if(c)return()=>{g(qe.PET)}},[c,g]),i.useEffect(()=>{!c||!a||(M(new Yh),e(!1))},[c,a]),{petItems:n,selectedPet:o,setSelectedPet:s,activate:u,deactivate:m}},Wd=()=>ot(SS),NS=()=>{const[a,e]=i.useState(null),[n,r]=i.useState(null),[o,s]=i.useState(nt.TRADING_STATE_READY),{groupItems:c=[],setGroupItems:u=null,activate:m=null,deactivate:h=null}=es(),{simpleAlert:g=null,showTradeAlert:f=null}=Xe(),_=o>=nt.TRADING_STATE_RUNNING,E=()=>{switch(o){case nt.TRADING_STATE_RUNNING:!n.itemCount&&!a.accepts&&g(d("inventory.trading.warning.other_not_offering"),null,null,null),a.accepts?M(new af):M(new of);return;case nt.TRADING_STATE_CONFIRMING:M(new sf),s(nt.TRADING_STATE_CONFIRMED);return}},I=p=>{const b=p.getLastItem();b&&M(new lf(b.id))},C=()=>{if(_)switch(o){case nt.TRADING_STATE_RUNNING:M(new uf);return;default:M(new cf);return}};return x(zh,p=>{const b=p.getParser();!a||!n||(a.userId===b.userID?e(N=>{const v=Kt(N);return v.accepts=b.userAccepts,v}):n.userId===b.userID&&r(N=>{const v=Kt(N);return v.accepts=b.userAccepts,v}))}),x(Kh,p=>{const b=p.getParser();b.reason===$h.ERROR_WHILE_COMMIT?f(bt.ERROR_WHILE_COMMIT):a&&b.userID!==a.userId&&f(bt.THEY_CANCELLED),e(null),r(null),s(nt.TRADING_STATE_READY)}),x(Xh,p=>{p.getParser(),e(null),r(null),s(nt.TRADING_STATE_READY)}),x(Qh,p=>{p.getParser(),s(nt.TRADING_STATE_COUNTDOWN)}),x(Jh,p=>{const b=p.getParser(),N=jl(b.firstUserItemArray),v=jl(b.secondUserItemArray);e(O=>{const R=Kt(O);R.userId===b.firstUserID?(R.creditsCount=b.firstUserNumCredits,R.itemCount=b.firstUserNumItems,R.userItems=N):(R.creditsCount=b.secondUserNumCredits,R.itemCount=b.secondUserNumItems,R.userItems=v);const y=[];for(const F of R.userItems.getValues()){let P=0;for(;P<F.getTotalCount();){const D=F.getItemByIndex(P);D&&y.push(D.ref),P++}}return u(F=>{const P=[...F];for(const D of P)D.lockItemIds(y);return P}),R}),r(O=>{const R=Kt(O);return R.userId===b.firstUserID?(R.creditsCount=b.firstUserNumCredits,R.itemCount=b.firstUserNumItems,R.userItems=N):(R.creditsCount=b.secondUserNumCredits,R.itemCount=b.secondUserNumItems,R.userItems=v),R})}),x(Zh,p=>{p.getParser()}),x(ef,p=>{const b=p.getParser(),N=new Hl,v=Oe().userDataManager.getUserData(b.userID);N.userItems=new xs;const O=new Hl,R=Oe().userDataManager.getUserData(b.otherUserID);O.userItems=new xs,v.webID===H().userId?(N.userId=v.webID,N.userName=v.name,N.canTrade=b.userCanTrade,O.userId=R.webID,O.userName=R.name,O.canTrade=b.otherUserCanTrade):R.webID===H().userId&&(N.userId=R.webID,N.userName=R.name,N.canTrade=b.otherUserCanTrade,O.userId=v.webID,O.userName=v.name,O.canTrade=b.userCanTrade),e(N),r(O),s(nt.TRADING_STATE_RUNNING)}),x(tf,p=>{const b=p.getParser();f(b.reason,b.otherUserName)}),x(nf,p=>{p.getParser(),f(bt.THEY_NOT_ALLOWED)}),x(rf,p=>{p.getParser(),f(bt.YOU_NOT_ALLOWED)}),i.useEffect(()=>{if(o===nt.TRADING_STATE_READY)return;const p=m();return()=>h(p)},[o,m,h]),{ownUser:a,otherUser:n,tradeState:o,setTradeState:s,isTrading:_,groupItems:c,progressTrade:E,removeItem:I,stopTrading:C}},jd=()=>ot(NS),TS=()=>{const[a,e]=i.useState(null),[n,r]=i.useState([]),[o,s]=i.useState([]),[c,u]=i.useState([]),[m,h]=i.useState([]),[g,f]=i.useState([]),[_,E]=i.useState([]),{simpleAlert:I=null}=Xe(),C=k=>{n.indexOf(k)>=0||r(B=>[...B,k])},p=k=>{r(B=>{const G=[...B],z=G.indexOf(k);return z>=0&&G.splice(z),G})},b=k=>{n.indexOf(k)>=0?p(k):C(k)},N=k=>{o.indexOf(k)>=0||s(B=>[...B,k])},v=k=>{s(B=>{const G=[...B],z=G.indexOf(k);return z>=0&&G.splice(z),G})},O=k=>{o.indexOf(k)>=0?v(k):N(k)},R=k=>{c.indexOf(k)>=0||u(B=>[...B,k])},y=k=>{u(B=>{const G=[...B],z=G.indexOf(k);return z>=0&&G.splice(z),G})},F=k=>{c.indexOf(k)>=0?y(k):R(k)},P=k=>{m.indexOf(k)>=0||h(B=>[...B,k])},D=k=>{h(B=>{const G=[...B],z=G.indexOf(k);return z>=0&&G.splice(z),G})},A=k=>{o.indexOf(k)>=0?D(k):P(k)};return x(df,k=>{const G=k.getParser().data;e(G),f(G.issues)}),x(mf,k=>{const B=k.getParser();f(G=>{const z=[...G],X=z.findIndex(Y=>Y.issueId===B.issueData.issueId);return X>=0?z[X]=B.issueData:(z.push(B.issueData),rr(dn.MODTOOLS_NEW_TICKET)),z})}),x(gf,k=>{k.getParser()}),x(hf,k=>{k.getParser()&&I("Failed to pick issue",de.DEFAULT,null,null,"Error")}),x(ff,k=>{const B=k.getParser();f(G=>{const z=[...G],X=z.findIndex(Y=>Y.issueId===B.issueId);return X>=0&&z.splice(X,1),z})}),x(pf,k=>{k.getParser().success?I("Moderation action was successfull",de.MODERATION,null,null,"Success"):I("There was a problem applying tht moderation action",de.MODERATION,null,null,"Error")}),x(If,k=>{const B=k.getParser();E(B.callForHelpCategories)}),x(Ef,k=>{k.getParser()}),{settings:a,openRooms:n,openRoomChatlogs:o,openUserChatlogs:m,openUserInfos:c,cfhCategories:_,tickets:g,openRoomInfo:C,closeRoomInfo:p,toggleRoomInfo:b,openRoomChatlog:N,closeRoomChatlog:v,toggleRoomChatlog:O,openUserInfo:R,closeUserInfo:y,toggleUserInfo:F,openUserChatlog:P,closeUserChatlog:D,toggleUserChatlog:A}},ws=()=>ot(TS),vS=()=>{const[a,e]=i.useState(null),[n,r]=i.useState(null),[o,s]=i.useState(null),[c,u]=i.useState(null),[m,h]=i.useState({roomInfo:null,state:Pe.NONE}),[g,f]=i.useState(null),[_,E]=i.useState({settingsReceived:!1,homeRoomId:0,enteredGuestRoom:null,currentRoomOwner:!1,currentRoomId:0,currentRoomIsStaffPick:!1,createdFlatId:0,avatarId:0,roomPicker:!1,eventMod:!1,currentRoomRating:0,canRate:!0}),{simpleAlert:I=null}=Xe();return x(_f,C=>{const p=C.getParser();M(new Wa(p.roomId,!1,!1))}),x(Cf,C=>{const p=C.getParser();p.canCreate||I(d(`navigator.cannotcreateevent.error.${p.errorCode}`),null,null,null,d("navigator.cannotcreateevent.title"))}),x(Ru,C=>{M(new bf),M(new wu)}),x(Sf,C=>{const p=C.getParser();E(b=>{const N={...b};return N.eventMod=p.securityLevel>=qa.MODERATOR,N.roomPicker=p.securityLevel>=qa.COMMUNITY,N})}),x(Nf,C=>{const p=C.getParser();En(p.roomId)}),x(yu,C=>{const p=C.getParser();E(b=>{const N={...b};return N.enteredGuestRoom=null,N.currentRoomOwner=p.isOwner,N.currentRoomId=p.roomId,N}),M(new Wa(p.roomId,!0,!1)),Gs.available&&Gs.call("legacyTrack","navigator","private",[p.roomId])}),x(vs,C=>{const p=C.getParser();if(p.roomEnter)h({roomInfo:null,state:Pe.NONE}),E(b=>{const N={...b};return N.enteredGuestRoom=p.data,N.currentRoomIsStaffPick=p.staffPick,!(N.createdFlatId===p.data.roomId)&&p.data.displayRoomEntryAd&&K("roomenterad.habblet.enabled",!1)&&$s.openRoomEnterAd(),N.createdFlatId=0,N.enteredGuestRoom&&N.enteredGuestRoom.habboGroupId>0,N});else if(p.roomForward){if(p.data.ownerName!==H().userName&&!p.isGroupMember)switch(p.data.doorMode){case rt.DOORBELL_STATE:h(b=>{const N={...b};return N.roomInfo=p.data,N.state=Pe.START_DOORBELL,N});return;case rt.PASSWORD_STATE:h(b=>{const N={...b};return N.roomInfo=p.data,N.state=Pe.START_PASSWORD,N});return}if(p.data.doorMode===rt.NOOB_STATE&&!H().isAmbassador&&!H().isRealNoob&&!H().isModerator)return;jr(p.data.roomId)}else E(b=>{const N={...b};return N.enteredGuestRoom=p.data,N.currentRoomIsStaffPick=p.staffPick,N})}),x(Tf,C=>{const p=C.getParser();E(b=>{const N={...b};return N.currentRoomRating=p.totalLikes,N.canRate=p.canLike,N})}),x(vf,C=>{const p=C.getParser();(!p.userName||p.userName.length===0)&&h(b=>{const N={...b};return N.state=Pe.STATE_WAITING,N})}),x(wf,C=>{const p=C.getParser();(!p.userName||p.userName.length===0)&&h(b=>{const N={...b};return N.state=Pe.STATE_ACCEPTED,N})}),x(Rf,C=>{const p=C.getParser();(!p.userName||p.userName.length===0)&&h(b=>{const N={...b};return N.state=Pe.STATE_NO_ANSWER,N})}),x(yf,C=>{switch(C.getParser().errorCode){case-100002:h(b=>{const N={...b};return N.state=Pe.STATE_WRONG_PASSWORD,N});return;case 4009:I(d("navigator.alert.need.to.be.vip"),de.DEFAULT,null,null,d("generic.alert.title"));return;case 4010:I(d("navigator.alert.invalid_room_name"),de.DEFAULT,null,null,d("generic.alert.title"));return;case 4011:I(d("navigator.alert.cannot_perm_ban"),de.DEFAULT,null,null,d("generic.alert.title"));return;case 4013:I(d("navigator.alert.room_in_maintenance"),de.DEFAULT,null,null,d("generic.alert.title"));return}}),x(Of,C=>{const p=C.getParser();u(p.topLevelContexts),s(p.topLevelContexts.length?p.topLevelContexts[0]:null)}),x(Af,C=>{const p=C.getParser();s(b=>{let N=b;if(N||(N=c&&c.length&&c[0]||null),!N)return null;if(p.result.code!==N.code&&c&&c.length)for(const v of c)v.code===p.result.code&&(N=v);for(const v of c)v.code===p.result.code&&(N=v);return N}),f(p.result)}),x(kf,C=>{const p=C.getParser();e(p.categories)}),x(Pf,C=>{const p=C.getParser();r(p.categories)}),x(Df,C=>{const p=C.getParser();jr(p.roomId)}),x(Mf,C=>{const p=C.getParser();let b=!1;if(E(O=>{b=O.settingsReceived;const R={...O};return R.homeRoomId=p.homeRoomId,R.settingsReceived=!0,R}),b)return;let N=-1,v=-1;K("friend.id")!==void 0&&parseInt(K("friend.id"))>0&&(N=0,M(new xi(parseInt(K("friend.id"))))),K("forward.type")!==void 0&&K("forward.id")!==void 0&&(N=parseInt(K("forward.type")),v=parseInt(K("forward.id"))),N===2?En(v):N===-1&&p.roomIdToEnter>0&&(ee("navigator/close"),p.roomIdToEnter!==p.homeRoomId?jr(p.roomIdToEnter):jr(p.homeRoomId))}),x(Lf,C=>{const p=C.getParser();switch(p.reason){case Oo.REASON_FULL:I(d("navigator.guestroomfull.text"),de.DEFAULT,null,null,d("navigator.guestroomfull.title"));break;case Oo.REASON_QUEUE_ERROR:I(d(`room.queue.error.${p.parameter}`),de.DEFAULT,null,null,d("room.queue.error.title"));break;case Oo.REASON_BANNED:I(d("navigator.banned.text"),de.DEFAULT,null,null,d("navigator.banned.title"));break;default:I(d("room.queue.error.title"),de.DEFAULT,null,null,d("room.queue.error.title"));break}Vi()}),x(Uf,C=>ee("navigator/show")),{categories:a,doorData:m,setDoorData:h,topLevelContext:o,topLevelContexts:c,searchResult:g,navigatorData:_}},Ln=()=>ot(vS),wS=()=>{const[a,e]=i.useState(new Ki),n=i.useMemo(()=>K("hc.disabled",!1),[]),r=i.useMemo(()=>n||a.clubDays>0?Bn.ACTIVE:a.pastVipDays>0||a.pastVipDays>0?Bn.EXPIRED:Bn.NONE,[a,n]),o=s=>{if(s===-1)return a.credits;for(const[c,u]of a.activityPoints.entries())if(c===s)return u;return 0};return x(xf,s=>{const c=s.getParser();e(u=>{const m=Kt(u);return m.credits=parseFloat(c.credits),u.credits!==m.credits&&rr(dn.CREDITS),m})}),x(Ff,s=>{const c=s.getParser();e(u=>{const m=Kt(u);return m.activityPoints=c.currencies,m})}),x(Iu,s=>{const c=s.getParser();e(u=>{const m=Kt(u);return m.activityPoints=new Map(m.activityPoints),m.activityPoints.set(c.type,c.amount),c.type===0&&rr(dn.DUCKETS),m})}),x(Bf,s=>{const c=s.getParser(),u=c.productName;u!=="club_habbo"&&u!=="habbo_club"||e(m=>{const h=Kt(m);return h.clubDays=Math.max(0,c.daysToPeriodEnd),h.clubPeriods=Math.max(0,c.periodsSubscribedAhead),h.isVip=c.isVip,h.pastClubDays=c.pastClubDays,h.pastVipDays=c.pastVipDays,h.isExpiring=c.responseType===Gf.RESPONSE_TYPE_DISCOUNT_AVAILABLE,h.minutesUntilExpiration=c.minutesUntilExpiration,h.minutesSinceLastModified=c.minutesSinceLastModified,h})}),i.useEffect(()=>{if(n)return;M(new Il("habbo_club"));const s=setInterval(()=>M(new Il("habbo_club")),5e4);return()=>clearInterval(s)},[n]),i.useEffect(()=>{M(new Vf)},[]),{purse:a,hcDisabled:n,clubStatus:r,getCurrencyAmount:o}},ts=()=>ot(wS),RS=(a,e)=>{i.useEffect(()=>{if(!a)return;const n=r=>e(r);return nr.addEventListener(Re.FURNI_ADDED,n),()=>{nr.removeEventListener(Re.FURNI_ADDED,n)}},[a,e])},Sn=(a,e)=>{i.useEffect(()=>{if(!a)return;const n=r=>e(r);return nr.addEventListener(Re.FURNI_REMOVED,n),()=>{nr.removeEventListener(Re.FURNI_REMOVED,n)}},[a,e])},yS=a=>{ct(Re.OBJECT_DESELECTED,a)},OS=a=>{ct(Re.OBJECT_ROLL_OUT,a)},AS=a=>{ct(Re.OBJECT_ROLL_OVER,a)},rl=a=>{ct(Re.OBJECT_SELECTED,a)},qd=(a,e)=>{i.useEffect(()=>{if(!a)return;const n=r=>e(r);return nr.addEventListener(Re.USER_ADDED,n),()=>{nr.removeEventListener(Re.USER_ADDED,n)}},[a,e])},Yd=(a,e)=>{i.useEffect(()=>{if(!a)return;const n=r=>e(r);return nr.addEventListener(Re.USER_REMOVED,n),()=>{nr.removeEventListener(Re.USER_REMOVED,n)}},[a,e])},kS=()=>{const[a,e]=i.useState(null),[n,r]=i.useState(!1);return x(Hf,o=>{const s=o.getParser();s&&e(s)}),{promoteInformation:a,isExtended:n,setPromoteInformation:e,setIsExtended:r}},sl=()=>ot(kS),PS=()=>{const[a,e]=i.useState(null),[n,r]=i.useState(null),[o,s]=i.useState(null),[c,u]=i.useState(0),m=(g,f,_,E=!1)=>{if(!n)return;const I=ln.hslToRGB(((g&255)<<16)+((f&255)<<8)+(_&255));E&&u(I),!g&&!f&&!_?n.tint=0:n.tint=I},h=g=>{if(!o)return;const f=g>>16&255,_=g>>8&255,E=g&255;o.red=f/255,o.green=_/255,o.blue=E/255};return ct(Tr.PREVIEW,g=>m(g.hue,g.saturation,g.lightness)),ct(Tr.CLEAR_PREVIEW,g=>{n&&(n.tint=c)}),Te(Wf.ROOM_BACKGROUND_COLOR,g=>{Wr.isRoomPreviewerId(g.roomId)||(g.enable?m(g.hue,g.saturation,g.lightness,!0):m(0,0,0,!0))}),Te(jf.ROOM_COLOR,g=>{if(Wr.isRoomPreviewerId(g.roomId))return;let f=0,_=255;g.bgOnly||(f=g.color,_=g.brightness),h(ln.hslToRGB((ln.rgbToHSL(f)&16776960)+_))}),Te([pn.INITIALIZED,pn.DISPOSED],g=>{if(Wr.isRoomPreviewerId(g.roomId))return;const f=Oe();if(f)switch(g.type){case pn.INITIALIZED:Fl(g.roomId),e(f);return;case pn.DISPOSED:e(null);return}}),Ye([qt.CREATED,qt.ENDED],g=>{switch(g.type){case qt.CREATED:LC(g.session);return;case qt.ENDED:e(null);return}}),Te([pt.SELECTED,pt.DESELECTED,pt.ADDED,pt.REMOVED,pt.PLACED,pt.REQUEST_MOVE,pt.REQUEST_ROTATE,pt.MOUSE_ENTER,pt.MOUSE_LEAVE,pt.DOUBLE_CLICK],g=>{if(Wr.isRoomPreviewerId(g.roomId))return;let f=null;switch(g.type){case pt.SELECTED:xC(g)||(f=new Re(Re.OBJECT_SELECTED,g.objectId,g.category,g.roomId));break;case pt.DESELECTED:f=new Re(Re.OBJECT_DESELECTED,g.objectId,g.category,g.roomId);break;case pt.ADDED:{let _=null;switch(g.category){case Q.FLOOR:case Q.WALL:_=Re.FURNI_ADDED;break;case Q.UNIT:_=Re.USER_ADDED;break}_&&(f=new Re(_,g.objectId,g.category,g.roomId));break}case pt.REMOVED:{let _=null;switch(g.category){case Q.FLOOR:case Q.WALL:_=Re.FURNI_REMOVED;break;case Q.UNIT:_=Re.USER_REMOVED;break}_&&(f=new Re(_,g.objectId,g.category,g.roomId));break}case pt.REQUEST_MOVE:Vs(a,g.objectId,g.category)&&ds(g.objectId,g.category,Gn.OBJECT_MOVE);break;case pt.REQUEST_ROTATE:Vs(a,g.objectId,g.category)&&ds(g.objectId,g.category,Gn.OBJECT_ROTATE_POSITIVE);break;case pt.MOUSE_ENTER:f=new Re(Re.OBJECT_ROLL_OVER,g.objectId,g.category,g.roomId);break;case pt.MOUSE_LEAVE:f=new Re(Re.OBJECT_ROLL_OUT,g.objectId,g.category,g.roomId);break;case pt.DOUBLE_CLICK:f=new Re(Re.OBJECT_DOUBLE_CLICKED,g.objectId,g.category,g.roomId);break}f&&St(f)}),i.useEffect(()=>{if(!a)return;const g=_e(),f=q(),_=a.roomId,E=1,I=Math.floor(window.innerWidth),C=Math.floor(window.innerHeight),p=g.application.renderer;p&&(p.view.style.width=`${I}px`,p.view.style.height=`${C}px`,p.resolution=window.devicePixelRatio,p.resize(I,C));const b=f.getRoomInstanceDisplay(_,E,I,C,qf.SCALE_ZOOMED_IN),N=q().getRoomInstanceRenderingCanvas(_,E);if(!b||!N)return;const v=new Va(Yf.WHITE),O=new zf,R=N.master;v.tint=0,v.width=I,v.height=C,R.addChildAt(v,0),R.filters=[O],r(v),s(O);const y=f.getRoomInstanceGeometry(_,E);if(y){const D=f.getRoomInstanceVariable(_,la.ROOM_MIN_X)||0,A=f.getRoomInstanceVariable(_,la.ROOM_MAX_X)||0,k=f.getRoomInstanceVariable(_,la.ROOM_MIN_Y)||0,B=f.getRoomInstanceVariable(_,la.ROOM_MAX_Y)||0;let G=(D+A)/2,z=(k+B)/2;const X=20;G=G+(X-1),z=z+(X-1);const Y=Math.sqrt(X*X+X*X)*Math.tan(30/180*Math.PI);y.location=new Rt(G,z,Y)}const F=g.application.stage;if(!F)return;F.addChild(b),Fl(a.roomId);const P=D=>{const A=Math.floor(window.innerWidth),k=Math.floor(window.innerHeight);p.view.style.width=`${A}px`,p.view.style.height=`${k}px`,p.resolution=window.devicePixelRatio,p.resize(A,k),v.width=A,v.height=k,UC(A,k,1),g.application.render()};return window.addEventListener("resize",P),()=>{r(null),s(null),u(0),window.removeEventListener("resize",P)}},[a]),{roomSession:a}},Ge=()=>ot(PS),DS=()=>{const[a,e]=i.useState(-1),[n,r]=i.useState(-1),[o,s]=i.useState(0),{roomSession:c=null}=Ge(),u=()=>{const g=ln.rgbToHSL(o),[f,_,E,I]=Qt.int_to_8BitVals(g);M(new $f(a,_,E,I))},m=()=>c.useMultistateItem(a),h=()=>{St(new Tr(Tr.CLEAR_PREVIEW)),e(-1),r(-1),s(0)};return Te(we.REQUEST_BACKGROUND_COLOR,g=>{if(!Vs(c,g.objectId,g.category))return;const _=q().getRoomObject(g.roomId,g.objectId,g.category).model;e(g.objectId),r(g.category);const E=parseInt(_.getValue(te.FURNITURE_ROOM_BACKGROUND_COLOR_HUE)),I=parseInt(_.getValue(te.FURNITURE_ROOM_BACKGROUND_COLOR_SATURATION)),C=parseInt(_.getValue(te.FURNITURE_ROOM_BACKGROUND_COLOR_LIGHTNESS)),p=Qt.eight_bitVals_to_int(0,E,I,C),b=ln.hslToRGB(p);s(b)}),Sn(a!==-1&&n!==-1,g=>{g.id!==a||g.category!==n||h()}),i.useEffect(()=>{if(a===-1||n===-1)return;const g=ln.rgbToHSL(o),[f,_,E,I]=Qt.int_to_8BitVals(g);St(new Tr(Tr.PREVIEW,_,E,I))},[a,n,o]),{objectId:a,color:o,setColor:s,applyToner:u,toggleToner:m,onClose:h}},MS=DS,LS=()=>{const[a,e]=i.useState(-1),[n,r]=i.useState(-1),[o,s]=i.useState("1"),[c,u]=i.useState(""),[m,h]=i.useState(""),[g,f]=i.useState(""),[_,E]=i.useState(""),{simpleAlert:I=null}=Xe(),C=()=>{e(-1),r(-1),s("1"),u(""),h(""),f(""),E("")};return Te([we.REQUEST_BADGE_DISPLAY_ENGRAVING,we.REQUEST_ACHIEVEMENT_RESOLUTION_ENGRAVING],p=>{const b=q().getRoomObject(p.roomId,p.objectId,p.category);if(!b)return;const N=new Ks;N.initializeFromRoomObjectModel(b.model),e(p.objectId),r(p.category),s("1"),u(Js(N.getValue(1))),h(ji(N.getValue(1))),f(N.getValue(2)),E(N.getValue(3))}),Te(we.REQUEST_ACHIEVEMENT_RESOLUTION_FAILED,p=>{const b=q().getRoomObject(p.roomId,p.objectId,p.category);!b||b.model.getValue(te.FURNITURE_OWNER_ID)!==H().userId||I(`${d("resolution.failed.subtitle")} ${d("resolution.failed.text")}`,null,null,null,d("resolution.failed.title"))}),Sn(a!==-1&&n!==-1,p=>{p.id!==a||p.category!==n||C()}),{objectId:a,category:n,color:o,badgeName:c,badgeDesc:m,date:g,senderName:_,onClose:C}},US=LS,vi="MONSTERPLANT_SEED_CONFIRMATION",wi="PURCHASABLE_CLOTHING_CONFIRMATION",zd="GROUP_FURNITURE",$d="EFFECTBOX_OPEN",Ri="MYSTERYTROPHY_OPEN_DIALOG",xS=()=>{const[a,e]=i.useState(-1),[n,r]=i.useState(null),[o,s]=i.useState(null),[c,u]=i.useState(-1),[m,h]=i.useState(null),[g,f]=i.useState(!1),[_,E]=i.useState(-1),{roomSession:I=null}=Ge(),C=()=>{e(-1),h(null),f(!1),r(null)},p=()=>{s(null),u(-1)},b=N=>{if(N)switch(N){case"use_friend_furni":I.useMultistateItem(a);break;case"use_monsterplant_seed":s(vi),u(a);break;case"use_random_teleport":q().useRoomObject(a,Q.FLOOR);break;case"use_purchaseable_clothing":s(wi),u(a);break;case"use_mystery_box":I.useMultistateItem(a);break;case"use_mystery_trophy":s(Ri),u(a);break;case"join_group":$i(m.guildId),f(!0);return;case"go_to_group_homeroom":m&&En(m.guildHomeRoomId);break}C()};return Te([we.OPEN_FURNI_CONTEXT_MENU,we.CLOSE_FURNI_CONTEXT_MENU,we.REQUEST_MONSTERPLANT_SEED_PLANT_CONFIRMATION_DIALOG,we.REQUEST_PURCHASABLE_CLOTHING_CONFIRMATION_DIALOG,we.REQUEST_EFFECTBOX_OPEN_DIALOG,we.REQUEST_MYSTERYBOX_OPEN_DIALOG,we.REQUEST_MYSTERYTROPHY_OPEN_DIALOG],N=>{const v=q().getRoomObject(I.roomId,N.objectId,N.category);if(v)switch(E(v.model.getValue(te.FURNITURE_OWNER_ID)),N.type){case we.REQUEST_MONSTERPLANT_SEED_PLANT_CONFIRMATION_DIALOG:if(!Wt(v))return;u(v.id),s(vi),C();return;case we.REQUEST_EFFECTBOX_OPEN_DIALOG:if(!Wt(v))return;u(v.id),s($d),C();return;case we.REQUEST_PURCHASABLE_CLOTHING_CONFIRMATION_DIALOG:if(!Wt(v))return;u(v.id),s(wi),C();return;case we.REQUEST_MYSTERYBOX_OPEN_DIALOG:I.useMultistateItem(v.id),C();return;case we.REQUEST_MYSTERYTROPHY_OPEN_DIALOG:if(!Wt(v))return;u(v.id),s(Ri),C();return;case we.OPEN_FURNI_CONTEXT_MENU:switch(e(v.id),N.contextMenu){case Lt.FRIEND_FURNITURE:r(Lt.FRIEND_FURNITURE);return;case Lt.MONSTERPLANT_SEED:Wt(v)&&r(Lt.MONSTERPLANT_SEED);return;case Lt.MYSTERY_BOX:r(Lt.MYSTERY_BOX);return;case Lt.MYSTERY_TROPHY:Wt(v)&&r(Lt.MYSTERY_TROPHY);return;case Lt.RANDOM_TELEPORT:r(Lt.RANDOM_TELEPORT);return;case Lt.PURCHASABLE_CLOTHING:Wt(v)&&r(Lt.PURCHASABLE_CLOTHING);return}return;case we.CLOSE_FURNI_CONTEXT_MENU:v.id===a&&C();return}}),x(Kf,N=>{const v=N.getParser();e(v.objectId),h(v),f(v.userIsMember),r(zd)}),{objectId:a,mode:n,confirmMode:o,confirmingObjectId:c,groupData:m,isGroupMember:g,objectOwnerId:_,closeConfirm:p,processAction:b,onClose:C}},FS=xS,GS=()=>{const[a,e]=i.useState(-1),[n,r]=i.useState([]),[o,s]=i.useState(null),[c,u]=i.useState([]),[m,h]=i.useState(null),[g,f]=i.useState(new Map),[_,E]=i.useState(!1),{groupItems:I=[],getItemsByType:C=null,activate:p=null,deactivate:b=null}=es(),{simpleAlert:N=null}=Xe(),v=o&&g.get(o.name)||null,O=()=>{r([]),s(null),u([]),f(new Map)},R=()=>{e(-1),O()},y=()=>{E(!0),M(new np(a,o.name))},F=P=>{s(P),g.get(P.name)||M(new rp(P.name))};return Te(we.OPEN_WIDGET,P=>{P.widget===Xf.CRAFTING&&(e(P.objectId),O(),M(new Qf(P.objectId)))}),x(Jf,P=>{const D=P.getParser();if(!D.isActive()){e(-1);return}r(A=>{const k=[];for(const B of D.recipes){const G=q().roomContentLoader._activeObjectTypeIds.get(B.itemName),z=q().getFurnitureFloorIconUrl(G);k.push({name:B.recipeName,localizedName:d("roomItem.name."+G),iconUrl:z})}return k}),h(D.ingredients)}),x(Zf,P=>{const D=P.getParser();f(A=>{const k=new Map(A);return k.set(o.name,D.ingredients),k})}),x(ep,P=>{s(null),E(!1),P.getParser().result&&N(d("crafting.info.result.ok"))}),x(tp,P=>{}),i.useEffect(()=>{!m||!m.length||u(P=>{const D=[];for(const A of m){const k=q().roomContentLoader._activeObjectTypeIds.get(A),B=q().getFurnitureFloorIconUrl(k),G=C(k);let z=0;if(G)for(const X of G)z+=X.items.length;D.push({name:A,iconUrl:B,count:z})}return D})},[I,m,C]),i.useEffect(()=>{if(a===-1)return;const P=p();return()=>b(P)},[a,p,b]),{objectId:a,recipes:n,ingredients:c,selectedRecipe:o,requiredIngredients:v,isCrafting:_,selectRecipe:F,craft:y,onClose:R}},BS=GS,VS=()=>{const[a,e]=i.useState([]),[n,r]=i.useState(0),[o,s]=i.useState(0),[c,u]=i.useState(0),[m,h]=i.useState(0),[g,f]=i.useState(16777215),[_,E]=i.useState(255),[I,C]=i.useState(0),[p,b]=i.useState(0),[N,v]=i.useState(0),{roomSession:O=null}=Ge(),R=()=>O.isRoomOwner||O.controllerLevel>=tt.GUEST||H().isModerator,y=P=>{const D=a[P-1];D&&(r(D.id),C(D.type),b(D.color),v(D.light))},F=()=>{if(o===0)return;const P=n-1;if(n<1||n>a.length)return;const D=a[P];!D||I===D.type&&p===D.color&&N===D.light||(e(A=>{const k=[...A];return k[P]=new Ql(D.id,I,p,N),k}),nn.savePreset(D.id,I,p,N,!0))};return Te(we.REQUEST_DIMMER,P=>{R()&&O.requestMoodlightSettings()}),Ye(sp.ROOM_DIMMER_PRESETS,P=>{const D=[];let A=0;for(;A<P.presetCount;){const k=P.getPreset(A);k&&D.push(new Ql(k.id,k.type,k.color,k.brightness)),A++}e(D),r(P.selectedPresetId)}),Te(ap.ROOM_COLOR,P=>{Wr.isRoomPreviewerId(P.roomId)||(u(o),s(P.state),r(P.presetId),h(P.effectId),C(P.effectId),f(P.color),b(P.color),E(P.brightness),v(P.brightness))}),i.useEffect(()=>{o===0&&c===0||nn.previewDimmer(p,N,I===2)},[o,c,p,N,I]),{presets:a,selectedPresetId:n,dimmerState:o,lastDimmerState:c,effectId:m,color:g,brightness:_,selectedEffectId:I,setSelectedEffectId:C,selectedColor:p,setSelectedColor:b,selectedBrightness:N,setSelectedBrightness:v,selectPresetId:y,applyChanges:F}},HS=VS,WS=()=>{const[a,e]=i.useState(-1),[n,r]=i.useState(-1),[o,s]=i.useState(0),c=()=>{e(-1),r(-1),s(0)},u=()=>{Oe().connection.send(new op(a)),c()};return Te(we.REQUEST_CREDITFURNI,m=>{const h=q().getRoomObject(m.roomId,m.objectId,m.category);!h||!Wt(h)||(e(m.objectId),r(m.category),s(h.model.getValue(te.FURNITURE_CREDIT_VALUE)||0))}),Sn(a!==-1&&n!==-1,m=>{m.id!==a||m.category!==n||c()}),{objectId:a,value:o,redeem:u,onClose:c}},jS=WS,qS=()=>{const[a,e]=i.useState(-1),[n,r]=i.useState(-1),[o,s]=i.useState(-1),[c,u]=i.useState([]),{roomSession:m=null}=Ge(),h=()=>{e(-1),r(-1),s(-1),u([])};return Te(we.REQUEST_EXTERNAL_IMAGE,g=>{const f=q().getRoomObject(g.roomId,g.objectId,g.category),_=q().getRoomObjects(m==null?void 0:m.roomId,Q.WALL);if(!f)return;const E=[];_.forEach(C=>{if(C.type!=="external_image_wallitem_poster_small")return null;const p=C.model.getValue(te.FURNITURE_DATA),b=JSON.parse(p);E.push(b)}),e(g.objectId),r(g.category),u(E);const I=JSON.parse(f.model.getValue(te.FURNITURE_DATA));s(C=>{let p=0;return I&&(p=E.findIndex(b=>b.u===I.u)),p<0&&(p=0),p})}),Sn(a!==-1&&n!==-1,g=>{g.id!==a||g.category!==n||h()}),{objectId:a,currentPhotoIndex:o,currentPhotos:c,onClose:h}},YS=qS,zS=()=>{const[a,e]=i.useState(-1),[n,r]=i.useState(-1),[o,s]=i.useState(0),[c,u]=i.useState([]),[m,h]=i.useState([]),[g,f]=i.useState(null),[_,E]=i.useState(0),I=()=>{e(-1),r(-1),s(0),u([]),h([]),f(null)},C=p=>{Oe().connection.send(new up(a,p)),I()};return x(ip,p=>{const b=p.getParser();e(b.furniId),E(b.start?1:2)}),x(lp,p=>I()),x(cp,p=>I()),Te(we.REQUEST_FRIEND_FURNITURE_ENGRAVING,p=>{const b=q().getRoomObject(p.roomId,p.objectId,p.category);if(!b)return;const N=b.model.getValue(te.FURNITURE_DATA),v=b.model.getValue(te.FURNITURE_FRIENDFURNI_ENGRAVING);N[0]!=="1"||N.length!==6||(e(p.objectId),r(p.category),s(v),u([N[1],N[2]]),h([N[3],N[4]]),f(N[5]),E(0))}),Sn(a!==-1&&n!==-1,p=>{p.id!==a||p.category!==n||I()}),{objectId:a,type:o,usernames:c,figures:m,date:g,stage:_,onClose:I,respond:C}},$S=zS,KS=["perteam","mostwins","classic"],XS=["alltime","daily","weekly","monthly"],QS=()=>{const[a,e]=i.useState(new Map),{roomSession:n=null}=Ge(),r=s=>KS[s],o=s=>XS[s];return Te(we.REQUEST_HIGH_SCORE_DISPLAY,s=>{const c=q().getRoomObject(s.roomId,s.objectId,s.category);if(!c)return;const u=c.model.getValue(te.FURNITURE_DATA_FORMAT),m=fu.getData(u);m.initializeFromRoomObjectModel(c.model),e(h=>{const g=new Map(h);return g.set(c.id,m),g})}),Te(we.REQUEST_HIDE_HIGH_SCORE_DISPLAY,s=>{s.roomId===n.roomId&&e(c=>{const u=new Map(c);return u.delete(s.objectId),u})}),{stuffDatas:a,getScoreType:r,getClearType:o}},JS=QS,ZS="internalLink",eN=()=>(Te(we.REQUEST_INTERNAL_LINK,a=>{const e=q().getRoomObject(a.roomId,a.objectId,a.category);if(!e)return;let r=e.model.getValue(te.FURNITURE_DATA)[ZS];(!r||!r.length)&&(r=e.model.getValue(te.FURNITURE_INTERNAL_LINK)),r&&r.length&&ee(r)}),{}),tN=eN,nN=()=>{const[a,e]=i.useState(-1),[n,r]=i.useState(-1),[o,s]=i.useState(null),[c,u]=i.useState(null),[m,h]=i.useState(un.NO_CLUB),[g,f]=i.useState(null),_=()=>{e(-1),r(-1),s(null),u(null),f(null)},E=()=>{a!==-1&&(M(new dp(a)),_())},I=()=>{a!==-1&&(M(new di(a)),_())},C=()=>{a!==-1&&M(new mp(a,g))};return Te(we.REQUEST_MANNEQUIN,p=>{const b=q().getRoomObject(p.roomId,p.objectId,p.category);if(!b)return;const N=b.model,v=N.getValue(te.FURNITURE_MANNEQUIN_FIGURE)||null,O=N.getValue(te.FURNITURE_MANNEQUIN_GENDER)||null,R=Nt().createFigureContainer(v),y=Nt().getFigureClubLevel(R,O,fs.MANNEQUIN_CLOTHING_PART_TYPES);e(p.objectId),r(p.category),s(v),u(O),h(y),f(N.getValue(te.FURNITURE_MANNEQUIN_NAME)||null)}),Sn(a!==-1&&n!==-1,p=>{p.id!==a||p.category!==n||_()}),{objectId:a,figure:o,gender:c,clubLevel:m,name:g,setName:f,saveFigure:E,wearFigure:I,saveName:C,onClose:_}},rN=nN,sN=()=>{const[a,e]=i.useState(-1),[n,r]=i.useState(-1),[o,s]=i.useState(-1),[c,u]=i.useState(new xs),[m,h]=i.useState([]),{roomSession:g=null}=Ge(),{showSingleBubble:f=null,simpleAlert:_=null}=Xe(),E=()=>{e(-1),r(-1)},I=i.useCallback((N,v)=>M(new gp(N,v)),[]),C=i.useCallback(N=>M(new hp(N)),[]),p=i.useCallback((N,v)=>M(new di(N,v)),[]);Te(we.REQUEST_PLAYLIST_EDITOR,N=>{var O,R,y;const v=q().getRoomObject(N.roomId,N.objectId,N.category);if(v){if(Wt(v)){e(N.objectId),r(N.category),(O=_e().soundManager.musicController)==null||O.requestUserSongDisks(),(y=(R=_e().soundManager.musicController)==null?void 0:R.getRoomItemPlaylist())==null||y.requestPlayList();return}(g.isRoomOwner||g.controllerLevel>=tt.GUEST||H().isModerator)&&M(new di(N.objectId,-2))}}),Sn(a!==-1&&n!==-1,N=>{N.id!==a||N.category!==n||E()}),Hr(Ou.NPE_SONG_CHANGED,N=>{s(N.position)}),Hr(fp.NOTIFY_PLAYED_SONG,N=>{f(d("soundmachine.notification.playing",["songname","songauthor"],[N.name,N.creator]),$e.SOUNDMACHINE)}),Hr(pp.SDIR_SONG_DISK_INVENTORY_RECEIVENT_EVENT,N=>{var v;u((v=_e().soundManager.musicController)==null?void 0:v.songDiskInventory.clone())}),Hr(El.PLUE_PLAY_LIST_UPDATED,N=>{var v,O;h((O=(v=_e().soundManager.musicController)==null?void 0:v.getRoomItemPlaylist())==null?void 0:O.entries.concat())}),Hr(El.PLUE_PLAY_LIST_FULL,N=>{_(d("playlist.editor.alert.playlist.full"),de.ALERT,"","",d("playlist.editor.alert.playlist.full.title"))});const b=N=>{var v,O;a!==-1&&(N instanceof ui?N.getParser().fragmentNumber===0&&((v=_e().soundManager.musicController)==null||v.requestUserSongDisks()):(O=_e().soundManager.musicController)==null||O.requestUserSongDisks())};return x(ui,b),x(vu,b),x(Tu,b),{objectId:a,diskInventory:c,playlist:m,currentPlayingIndex:o,onClose:E,addToPlaylist:I,removeFromPlaylist:C,togglePlayPause:p}},aN=sN,sc="floor",oN="wallpaper",ac="landscape",iN="poster",lN=()=>{const[a,e]=i.useState(-1),[n,r]=i.useState(-1),[o,s]=i.useState(null),[c,u]=i.useState(null),[m,h]=i.useState(!1),[g,f]=i.useState(null),[_,E]=i.useState(null),[I,C]=i.useState(-1),[p,b]=i.useState(null),[N,v]=i.useState(!1),[O,R]=i.useState(null),{roomSession:y=null}=Ge(),F=()=>{e(-1),r(-1),s(null),u(null),h(!1),f(null),E(null),C(-1),b(null),v(!1),R(null)},P=()=>{a!==-1&&(y.openGift(a),q().changeObjectModelData(q().activeRoomId,a,Q.FLOOR,te.FURNITURE_DISABLE_PICKING_ANIMATION,1))},D=i.useMemo(()=>({imageReady:(A,k,B)=>{!B&&k&&(B=tr.generateImage(k)),R(B.src)},imageFailed:null}),[]);return Ye(Ip.RSPE_PRESENT_OPENED,A=>{let k=null;A.itemType===ue.FLOOR?k=H().getFloorItemData(A.classId):A.itemType===ue.WALL&&(k=H().getWallItemData(A.classId));let B=!1;if(A.placedInRoom){const G=q().getRoomObject(y.roomId,A.placedItemId,Q.FLOOR);G&&(B=Wt(G))}switch(A.itemType){case ue.WALL:{if(k)switch(k.className){case sc:case ac:case oN:let G=null;k.className===sc?G=d("inventory.furni.item.floor.name"):k.className===ac?G=d("inventory.furni.item.landscape.name"):G=d("inventory.furni.item.wallpaper.name"),u(G);break;case iN:{const z=A.productCode;let X=null;z.indexOf("poster")===0&&(X=z.replace("poster",""));const Y=H().getProductData(z);let Ee=null;Y?Ee=Y.name:k&&(Ee=k.name),u(Ee),R(q().getFurnitureWallIconUrl(A.classId,X));break}default:{u(k.name||null),R(q().getFurnitureWallIconUrl(A.classId));break}}break}case ue.HABBO_CLUB:u(d("widget.furni.present.hc"));break;default:{if(A.placedItemType===ue.PET){const z=A.petFigureString;if(z&&z.length){const X=new Is(z),Y=q().getRoomObjectPetImage(X.typeId,X.paletteId,X.color,new Rt(90),64,D,!0,0,X.customParts);Y&&R(Y.getImage().src)}}else{const z=q().getFurnitureFloorImage(A.classId,new Rt(90),64,D);z&&R(z.getImage().src)}const G=H().getProductData(A.productCode);u(G&&G.name||k.name);break}}e(0),r(A.classId),s(A.itemType),h(B),C(A.placedItemId),b(A.placedItemType),v(A.placedInRoom)}),Te(we.REQUEST_PRESENT,A=>{const k=q().getRoomObject(A.roomId,A.objectId,A.category);if(!k)return null;F(),e(A.objectId),r(-1),u(k.model.getValue(te.FURNITURE_DATA)||""),h(Wt(k)),f(k.model.getValue(te.FURNITURE_PURCHASER_NAME)||null),E(k.model.getValue(te.FURNITURE_PURCHASER_FIGURE)||null)}),Sn(a!==-1,A=>{A.id===a&&F(),A.id===I&&N&&v(!1)}),{objectId:a,classId:n,itemType:o,text:c,isOwnerOfFurniture:m,senderName:g,senderFigure:_,placedItemId:I,placedItemType:p,placedInRoom:N,imageUrl:O,openPresent:P,onClose:F}},cN=lN,uN="internalLink",dN=()=>{const[a,e]=i.useState(0);return Te(we.REQUEST_ROOM_LINK,n=>{const r=q().getRoomObject(n.roomId,n.objectId,n.category);if(!r)return;let s=r.model.getValue(te.FURNITURE_DATA)[uN];(!s||!s.length)&&(s=r.model.getValue(te.FURNITURE_INTERNAL_LINK)),!(!s||!s.length)&&(s=parseInt(s,10),!isNaN(s)&&(e(s),M(new Wa(s,!1,!1))))}),x(vs,n=>{!a||n.getParser().data.roomId!==a||e(0)}),{}},mN=dN,gN=()=>{const[a,e]=i.useState(-1),[n,r]=i.useState(-1),[o,s]=i.useState(""),[c,u]=i.useState(""),[m,h]=i.useState("0"),[g,f]=i.useState(""),[_,E]=i.useState(!1),{getWallItemById:I=null}=es(),C=()=>{M(new _p(a,c,m,g)),e(-1),r(-1),s(""),u(""),h("0"),f(""),E(!1)};return x(Ep,p=>{const b=p.getParser();e(b.itemId),r(Q.WALL);const N=I(b.itemId);let v="post_it";if(N){const O=q().getFurnitureWallName(N.type);O.match("post_it_")&&(v=O)}s(v),u(b.location),h("FFFF33"),f(""),E(!0)}),{objectId:a,color:m,setColor:h,text:g,setText:f,canModify:_,onClose:C}},hN=gN,Vo=40,fN=()=>{const[a,e]=i.useState(-1),[n,r]=i.useState(-1),[o,s]=i.useState(0),[c,u]=i.useState(-1),m=()=>{e(-1),r(-1),s(0),u(-1)},h=(g,f=!1)=>{g||(g=0),g=Math.abs(g),f||g>Vo&&(g=Vo),s(parseFloat(g.toFixed(2))),f||u(g*100)};return x(Cp,g=>{const f=g.getParser();a===f.furniId&&h(f.height,!0)}),Te(we.REQUEST_STACK_HEIGHT,g=>{if(!Vs(Oe(),g.objectId,g.category))return;const f=q().getRoomObject(g.roomId,g.objectId,g.category);f&&(e(g.objectId),r(g.category),s(f.getLocation().z),u(-1))}),Sn(a!==-1&&n!==-1,g=>{g.id!==a||g.category!==n||m()}),i.useEffect(()=>{if(a===-1||c===-1)return;const g=setTimeout(()=>M(new mi(a,~~c)),10);return()=>clearTimeout(g)},[a,c]),{objectId:a,height:o,maxHeight:Vo,onClose:m,updateHeight:h}},pN=fN,IN=()=>{const[a,e]=i.useState(-1),[n,r]=i.useState(-1),[o,s]=i.useState("0"),[c,u]=i.useState(""),[m,h]=i.useState(""),[g,f]=i.useState(!1),_=()=>{e(-1),r(-1),s("0"),u(""),h(""),f(!1)},E=p=>{p!==o&&(s(p),q().modifyRoomObjectData(a,n,p,c))},I=p=>{u(p),q().modifyRoomObjectData(a,n,o,p)},C=()=>q().deleteRoomObject(a,n);return Te(we.REQUEST_STICKIE,p=>{const b=q().getRoomObject(p.roomId,p.objectId,p.category);if(!b)return;const N=b.model.getValue(te.FURNITURE_ITEMDATA);if(N.length<6)return;let v=null,O=null;N.indexOf(" ")>0?(v=N.slice(0,N.indexOf(" ")),O=N.slice(N.indexOf(" ")+1,N.length)):v=N,e(p.objectId),r(p.category),s(v||"0"),u(O||""),h(b.type||"post_it"),f(Oe().isRoomOwner||H().isModerator||Wt(b))}),Sn(a!==-1&&n!==-1,p=>{p.id!==a||p.category!==n||_()}),{objectId:a,color:o,text:c,type:m,canModify:g,updateColor:E,updateText:I,trash:C,onClose:_}},EN=IN,_N=()=>{const[a,e]=i.useState(-1),[n,r]=i.useState(-1),[o,s]=i.useState("1"),[c,u]=i.useState(""),[m,h]=i.useState(""),[g,f]=i.useState(""),_=()=>{e(-1),r(-1),s("1"),u(""),h(""),f("")};return Te(we.REQUEST_TROPHY,E=>{const I=q().getRoomObject(E.roomId,E.objectId,E.category);if(!I)return;let C=I.model.getValue(te.FURNITURE_DATA);I.model.getValue(te.FURNITURE_EXTRAS),e(E.objectId),r(E.category),s(I.model.getValue(te.FURNITURE_COLOR)||"1");const p=C.substring(0,C.indexOf("	"));C=C.substring(p.length+1,C.length);const b=C.substring(0,C.indexOf("	")),N=C.substr(b.length+1,C.length);u(p),h(b),f(N)}),Sn(a!==-1&&n!==-1,E=>{E.id!==a||E.category!==n||_()}),{objectId:a,color:o,senderName:c,date:m,message:g,onClose:_}},CN=_N,bN=0,SN=1,NN=2,TN=3,vN=()=>{const[a,e]=i.useState(-1),[n,r]=i.useState(-1),[o,s]=i.useState(null),[c,u]=i.useState(null),[m,h]=i.useState(null),[g,f]=i.useState(-1),[_,E]=i.useState(null),[I,C]=i.useState(null),[p,b]=i.useState(!1),N=()=>{e(-1),r(-1),s(null),u(null),h(null),f(-1),E(null),C(null),b(!1)},v=()=>M(new ca(a,bN)),O=()=>M(new ca(a,SN)),R=()=>p&&o&&o.length&&M(new ca(a,NN)),y=()=>p&&o&&o.length&&M(new ca(a,TN)),F=P=>{if(_===P){E(null),M(new _l(a,""));return}E(P),M(new _l(a,P))};return Te(we.REQUEST_YOUTUBE,P=>{if(Wr.isRoomPreviewerId(P.roomId))return;const D=q().getRoomObject(P.roomId,P.objectId,P.category);D&&(e(P.objectId),r(P.category),b(H().hasSecurity(qa.EMPLOYEE)||Wt(D)),M(new bp(P.objectId)))}),x(Sp,P=>{const D=P.getParser();a===-1||a!==D.furniId||(s(D.videoId),u(D.startAtSeconds),h(D.endAtSeconds),f(D.state))}),x(Np,P=>{const D=P.getParser();a===-1||a!==D.furniId||(C(D.playlists),E(D.selectedPlaylistId),s(null),f(-1),h(null),u(null))}),x(Tp,P=>{const D=P.getParser();if(!(a===-1||a!==D.furniId))switch(D.commandId){case 1:f(An.PLAYING);break;case 2:f(An.PAUSED);break}}),Sn(a!==-1&&n!==-1,P=>{P.id!==a||P.category!==n||N()}),{objectId:a,videoId:o,videoStart:c,videoEnd:m,currentVideoState:g,selectedVideo:_,playlists:I,onClose:N,previous:v,next:O,pause:R,play:y,selectVideo:F}},wN=vN,RN=()=>{const[a,e]=i.useState(null),[n,r]=i.useState([]),[o,s]=i.useState(""),[c,u]=i.useState([]),[m,h]=i.useState(0),[g,f]=i.useState(ie.STUFF_SELECTION_OPTION_NONE),{showConfirm:_=null}=Xe(),E=()=>{const C=p=>{p&&(p instanceof Au?M(new Op(p.id,n,o,c,m,p.stuffTypeSelectionCode)):p instanceof ku?M(new Ap(p.id,n,o,c,p.stuffTypeSelectionCode)):p instanceof Pu&&M(new kp(p.id,n,o,c,p.stuffTypeSelectionCode)))};DC(a.id)?C(a):_(d("wiredfurni.nonowner.change.confirm.body"),()=>{C(a)},null,null,null,d("wiredfurni.nonowner.change.confirm.title"))},I=(C,p)=>{!a||!g||C<=0||u(b=>{const N=[...b],v=b.indexOf(C);return v>=0?(N.splice(v,1),ps.hide(C)):N.length<a.maximumItemSelectionCount&&(N.push(C),ps.show(C)),N})};return x(vp,C=>{C.getParser(),e(null)}),x(wp,C=>{const p=C.getParser();e(p.definition)}),x(Rp,C=>{const p=C.getParser();e(p.definition)}),x(yp,C=>{const p=C.getParser();e(p.definition)}),i.useEffect(()=>{if(a)return()=>{r([]),s(""),h(0),u(C=>(C&&C.length&&ps.clearSelectionShaderFromFurni(C),[])),f(ie.STUFF_SELECTION_OPTION_NONE)}},[a]),{trigger:a,setTrigger:e,intParams:n,setIntParams:r,stringParam:o,setStringParam:s,furniIds:c,setFurniIds:u,actionDelay:m,setActionDelay:h,setAllowsFurni:f,saveWired:E,selectObjectForWired:I}},ve=()=>ot(RN),yN=()=>{const[a,e]=i.useState(null),[n,r]=i.useState(null),[o,s]=i.useState([]),[c,u]=i.useState([]),[m,h]=i.useState(null),[g,f]=i.useState(-1),[_,E]=i.useState(!1),{friends:I=[]}=gn(),{selectObjectForWired:C=null}=ve(),{roomSession:p=null}=Ge(),b=y=>{s(F=>{const P=[...F];return P.splice(y,1),P})},N=y=>{u(F=>{const P=[...F],D=P.splice(y,1)[0];return m===D&&h(null),P})},v=y=>{h(y),u([])},O=(y,F)=>{const P=as.getObjectName(y,F);P&&(r(P),F!==Q.UNIT&&u([]))},R=(y,F)=>{let P=null;switch(F){case Q.FLOOR:case Q.WALL:P=as.getFurniInfo(y,F),P&&C(y,F);break;case Q.UNIT:{const D=p.userDataManager.getUserDataByIndex(y);if(!D)break;switch(D.type){case ht.PET:p.userDataManager.requestPetInfo(D.webID),f(D.webID);break;case ht.USER:P=as.getUserInfo(F,D);break;case ht.BOT:P=as.getBotInfo(F,D);break;case ht.RENTABLE_BOT:P=as.getRentableBotInfo(F,D);break}}}P&&e(P)};return Ye(Pp.USER_DATA_UPDATED,y=>{if(!y.addedUsers.length)return;let F=[];y.addedUsers.forEach(P=>{P.webID!==H().userId&&I.find(D=>D.id===P.webID)&&F.push(new Ed(P.roomIndex,Q.UNIT,P.webID,P.name,P.type,!0))}),F.length&&s(P=>{const D=[...P];return F.forEach(A=>{const k=D.findIndex(B=>B.id===A.id);k>-1&&D.splice(k,1),D.push(A)}),D})}),Ye(Dp.PET_INFO,y=>{const F=y.petInfo;if(!F||F.id!==g)return;const P=as.getPetInfo(F);P&&(e(P),f(-1))}),Ye(Mp.PET_STATUS_UPDATE,y=>{}),Te(Cl.USE_PRODUCT_FROM_INVENTORY,y=>{}),Te(Cl.USE_PRODUCT_FROM_ROOM,y=>{const F=q().getRoomObject(p.roomId,y.objectId,Q.FLOOR);if(!F||!Wt(F))return;const P=F.model.getValue(te.FURNITURE_OWNER_ID),D=F.model.getValue(te.FURNITURE_TYPE_ID),A=H().getFloorItemData(D),k=A.customParams.split(" "),B=k.length?parseInt(k[0]):-1;if(B===-1)return;const G=[],z=q().getRoomObjects(p.roomId,Q.UNIT);for(const X of z){const Y=p.userDataManager.getUserDataByIndex(X.id);let Ee=!1;if(!(!Y||Y.type!==ht.PET)){if(Y.ownerId===P){Y.hasSaddle&&A.specialType===Z.PET_SADDLE&&(Ee=!0);const le=Y.figure.split(" ");if((le.length?parseInt(le[0]):-1)===B){if(A.specialType===Z.MONSTERPLANT_REVIVAL&&!Y.canRevive||A.specialType===Z.MONSTERPLANT_REBREED&&(Y.petLevel<7||Y.canRevive||Y.canBreed)||A.specialType===Z.MONSTERPLANT_FERTILIZE&&(Y.petLevel>=7||Y.canRevive))continue;G.push(new yb(Y.roomIndex,Q.UNIT,Y.name,y.objectId,X.id,-1,Ee))}}}}h(null),G.length&&u(G)}),Te(pt.REQUEST_MANIPULATION,y=>{Vs(p,y.objectId,y.category)&&E(!0)}),rl(y=>{R(y.id,y.category)}),yS(y=>{e(null),u([])}),AS(y=>{a||y.category!==Q.UNIT||O(y.id,y.category)}),OS(y=>{!n||y.category!==Q.UNIT||n.roomIndex!==y.id||r(null)}),ct([Re.FURNI_REMOVED,Re.USER_REMOVED],y=>{if(n&&n.category===y.category&&n.roomIndex===y.id&&r(null),y.category===Q.UNIT){let F=o.findIndex(P=>P.roomIndex===y.id);F>-1&&s(P=>P.filter(D=>D.roomIndex===y.id)),F=c.findIndex(P=>P.id===y.id),F>-1&&u(P=>P.filter(D=>D.id!==y.id))}else y.category===Q.FLOOR&&c.findIndex(P=>P.id===y.id)>-1&&u(P=>P.filter(D=>D.requestRoomObjectId!==y.id));a&&(a instanceof bs?a.id===y.id&&e(null):(a instanceof et||a instanceof Ns||a instanceof Ss)&&a.roomIndex===y.id&&e(null))}),i.useEffect(()=>{a&&(r(null),s([]),u([]))},[a]),i.useEffect(()=>{n&&s([])},[n]),i.useEffect(()=>{p.isDecorating=_},[p,_]),{avatarInfo:a,setAvatarInfo:e,activeNameBubble:n,setActiveNameBubble:r,nameBubbles:o,productBubbles:c,confirmingProduct:m,isDecorating:_,setIsDecorating:E,removeNameBubble:b,removeProductBubble:N,updateConfirmingProduct:v,getObjectName:O}},ON=yN,AN=()=>{const[a,e]=i.useState(""),[n,r]=i.useState(!1),[o,s]=i.useState(!1),[c,u]=i.useState(!1),[m,h]=i.useState(!1),[g,f]=i.useState(0),{showNitroAlert:_=null,showConfirm:E=null}=Xe(),{roomSession:I=null}=Ge(),C=(p,b,N="",v=0)=>{if(p==="")return null;const O=p.split(" ");if(O.length>0){const R=O[0];let y="";if(O.length>1&&(y=O[1]),R.charAt(0)===":"&&y==="x"){const F=q().selectedAvatarId;if(F>-1){const P=I.userDataManager.getUserDataByIndex(F);P&&(y=P.name,p=p.replace(" x"," "+P.name))}}switch(R.toLowerCase()){case":shake":return Sl.init(2500,5e3),Sl.turnVisualizationOn(),null;case":rotate":return bl.init(2500,5e3),bl.turnVisualizationOn(),null;case":d":case";d":In()===un.VIP&&I.sendExpressionMessage(Jn.LAUGH.ordinal);break;case"o/":case"_o/":return I.sendExpressionMessage(Jn.WAVE.ordinal),null;case":kiss":if(In()===un.VIP)return I.sendExpressionMessage(Jn.BLOW.ordinal),null;break;case":jump":if(In()===un.VIP)return I.sendExpressionMessage(Jn.JUMP.ordinal),null;break;case":idle":return I.sendExpressionMessage(Jn.IDLE.ordinal),null;case"_b":return I.sendExpressionMessage(Jn.RESPECT.ordinal),null;case":sign":return I.sendSignMessage(parseInt(y)),null;case":iddqd":case":flip":return q().events.dispatchEvent(new gi(I.roomId,-1,!0)),null;case":zoom":return q().events.dispatchEvent(new gi(I.roomId,parseFloat(y),!1)),null;case":screenshot":const F=q().createTextureFromRoom(I.roomId,1),P=new Image;return P.src=tr.generateImageUrl(F),window.open("").document.write(P.outerHTML),null;case":pickall":return(I.isRoomOwner||H().isModerator)&&E(d("room.confirm.pick_all"),()=>{H().sendSpecialCommandMessage(":pickall")},null,null,null,d("generic.alert.title")),null;case":ejectall":return(I.isRoomOwner||H().isModerator||I.controllerLevel>=tt.GUEST)&&E(d("room.confirm.eject_all"),()=>{H().sendSpecialCommandMessage(":ejectall")},null,null,null,d("generic.alert.title")),null;case":furni":return ee("furni-chooser/"),null;case":chooser":return ee("user-chooser/"),null;case":floor":case":bcfloor":return I.controllerLevel>=tt.ROOM_OWNER&&ee("floor-editor/show"),null;case":togglefps":return fr().maxFPS>0?fr().maxFPS=0:fr().maxFPS=K("system.animation.fps"),null;case":client":case":nitro":case":billsonnn":return _(),null;case":settings":return(I.isRoomOwner||H().isModerator)&&M(new Du(I.roomId)),null}}switch(b){case Vn.CHAT_DEFAULT:I.sendChatMessage(p,v);break;case Vn.CHAT_SHOUT:I.sendShoutMessage(p,v);break;case Vn.CHAT_WHISPER:I.sendWhisperMessage(N,p,v);break}};return Ye(wn.FLOOD_EVENT,p=>{h(!0),f(parseFloat(p.message))}),rl(p=>{if(p.category!==Q.UNIT)return;const b=I.userDataManager.getUserDataByIndex(p.id);b&&e(b.name)}),Te(pt.DESELECTED,p=>e("")),i.useEffect(()=>{if(!m)return;let p=0;const b=setInterval(()=>{f(N=>(p=(N||0)-1,p)),p<0&&(clearInterval(b),h(!1))},1e3);return()=>clearInterval(b)},[m]),i.useEffect(()=>{if(!c)return;let p=null;return c&&(p=setTimeout(()=>{u(!1),r(!1)},1e4)),()=>clearTimeout(p)},[c]),i.useEffect(()=>{n?o||(s(!0),I.sendChatTypingMessage(n)):o&&(s(!1),I.sendChatTypingMessage(n))},[I,n,o]),{selectedUsername:a,floodBlocked:m,floodBlockedSeconds:g,setIsTyping:r,setIsIdle:u,sendChat:C}},kN=AN,oc=new Map,ic=new Map,lc=new Map,PN=()=>{const[a,e]=Kd(),[n,r]=i.useState([]),[o,s]=i.useState({mode:It.CHAT_MODE_FREE_FLOW,weight:It.CHAT_BUBBLE_WIDTH_NORMAL,speed:It.CHAT_SCROLL_SPEED_NORMAL,distance:50,protection:It.FLOOD_FILTER_NORMAL}),{roomSession:c=null}=Ge(),{addChatEntry:u}=po(),m=i.useRef(!1),h=i.useMemo(()=>{if(!o)return 6e3;switch(o.speed){case It.CHAT_SCROLL_SPEED_FAST:return 3e3;case It.CHAT_SCROLL_SPEED_NORMAL:return 6e3;case It.CHAT_SCROLL_SPEED_SLOW:return 12e3}},[o]),g=E=>{const I=Nt().createAvatarImage(E,Ui.LARGE,null,{resetFigure:b=>{m.current||g(b)},dispose:()=>{},disposed:!1});if(!I)return;const C=I.getCroppedImage(Ha.HEAD),p=I.getPartColor(He.CHEST);return oc.set(E,p&&p.rgb||16777215),I.dispose(),ic.set(E,C.src),C.src},f=E=>{let I=ic.get(E);return I||(I=g(E)),I},_=(E,I,C,p=64,b=null)=>{let N=lc.get(E+b);if(N)return N;const v=new Is(E),O=v.typeId,R=q().getRoomObjectPetImage(O,v.paletteId,v.color,new Rt(I*45),p,null,!1,0,v.customParts,b);return R&&(N=tr.generateImageUrl(R.data),lc.set(E+b,N)),N};return Ye(wn.CHAT_EVENT,async E=>{const I=q().getRoomObject(c.roomId,E.objectId,Q.UNIT),C=I?td(c.roomId,I==null?void 0:I.id,Q.UNIT):new vr,p=I?c.userDataManager.getUserDataByIndex(E.objectId):new Lp(-1);let b="",N=0,v=null,O=E.chatType,R=E.style,y=0,F=E.message;if(p){y=p.type;const k=p.figure;switch(y){case ht.PET:v=_(k,2,!0,64,I.model.getValue(te.FIGURE_POSTURE)),new Is(k).typeId;break;case ht.USER:v=f(k);break;case ht.RENTABLE_BOT:case ht.BOT:R=Fp.BOT;break}N=oc.get(k),b=p.name}switch(O){case wn.CHAT_TYPE_RESPECT:F=d("widgets.chatbubble.respect",["username"],[b]),K("respect.options").enabled&&rr(K("respect.options").sound);break;case wn.CHAT_TYPE_PETREVIVE:case wn.CHAT_TYPE_PET_REBREED_FERTILIZE:case wn.CHAT_TYPE_PET_SPEED_FERTILIZE:{let k="widget.chatbubble.petrevived";O===wn.CHAT_TYPE_PET_REBREED_FERTILIZE?k="widget.chatbubble.petrefertilized;":O===wn.CHAT_TYPE_PET_SPEED_FERTILIZE&&(k="widget.chatbubble.petspeedfertilized");let B=null;if(q().getRoomObject(c.roomId,E.extraParam,Q.UNIT)){const z=c.userDataManager.getUserDataByIndex(I.id);z&&(B=z.name)}F=d(k,["petName","userName"],[b,B]);break}case wn.CHAT_TYPE_PETRESPECT:F=d("widget.chatbubble.petrespect",["petname"],[b]);break;case wn.CHAT_TYPE_PETTREAT:F=d("widget.chatbubble.pettreat",["petname"],[b]);break;case wn.CHAT_TYPE_HAND_ITEM_RECEIVED:F=d("widget.chatbubble.handitem",["username","handitem"],[b,d("handitem"+E.extraParam)]);break;case wn.CHAT_TYPE_MUTE_REMAINING:{const k=(E.extraParam>0?Math.floor(E.extraParam/3600):0).toString(),B=(E.extraParam>0?Math.floor(E.extraParam%3600/60):0).toString(),G=(E.extraParam%60).toString();F=d("widget.chatbubble.mutetime",["hours","minutes","seconds"],[k,B,G]);break}}const P=N&&("#"+N.toString(16).padStart(6,"0")||null);let D=JC(F);if(a===!0){const k=await ZC(D);k===null?e(!1):k.detectedLanguage.language!==navigator.language&&k.detectedLanguage.language!=="en"&&(D=k.translatedText)}const A=new bd(p.roomIndex,Q.UNIT,c.roomId,F,D,b,new vr(C.x,C.y),O,R,v,P);r(k=>[...k,A]),u({id:-1,webId:p.webID,entityId:p.roomIndex,name:b,imageUrl:v,style:R,chatType:O,entityType:p.type,message:D,timestamp:cd(),type:Pn.TYPE_CHAT,roomId:c.roomId,color:P})}),Te(Up.ROOM_DRAG,E=>{if(!n.length||E.roomId!==c.roomId)return;const I=E.offsetX;n.forEach(C=>C.elementRef&&(C.left+=I))}),x(vs,E=>{const I=E.getParser();I.roomEnter&&s(I.chat)}),x(xp,E=>{const I=E.getParser();s(I.chat)}),i.useEffect(()=>(m.current=!1,()=>{m.current=!0}),[]),{chatMessages:n,setChatMessages:r,chatSettings:o,getScrollSpeed:h}},DN=PN,MN=()=>{const[a,e]=i.useState([]),n=s=>{a.indexOf(s)>=0||e([...a,s])},r=s=>{const c=a.indexOf(s);if(c===-1)return;const u=[...a];u.splice(c,1),e(u)},o=(s,c)=>{Oe().sendDoorbellApprovalMessage(s,c),r(s)};return Ye(Ao.DOORBELL,s=>n(s.userName)),Ye(Ao.RSDE_REJECTED,s=>r(s.userName)),Ye(Ao.RSDE_ACCEPTED,s=>r(s.userName)),{users:a,addUser:n,removeUser:r,answer:o}},LN=MN,UN=()=>{const[a,e]=i.useState(null),[n,r]=i.useState(!1),o=()=>r(!1);return x(Gp,s=>{const c=s.getParser();r(!0),e(c.words)}),{wordsFilter:a,isVisible:n,setWordsFilter:e,onClose:o}},xN=UN,FN=()=>{const[a,e]=i.useState([]),{requests:n=[],dismissedRequestIds:r=[],setDismissedRequestIds:o=null}=gn(),s=i.useMemo(()=>a.filter(u=>r.indexOf(u.request.requesterUserId)===-1),[a,r]),c=u=>{o(m=>{if(m.indexOf(u)>=0)return m;const h=[...m];return h.push(u),h})};return qd(!0,u=>{if(u.category!==Q.UNIT)return;const m=Oe().userDataManager.getUserDataByIndex(u.id);if(!m||m.type!==Nl.getTypeNumber(Nl.USER))return;const h=n.find(f=>f.requesterUserId===m.webID);if(!h||a.find(f=>f.request.requesterUserId===m.webID))return;const g=[...a];g.push({roomIndex:m.roomIndex,request:h}),e(g)}),Yd(!0,u=>{if(u.category!==Q.UNIT)return;const m=a.findIndex(g=>g.roomIndex===u.id);if(m===-1)return;const h=[...a];h.splice(m,1),e(h)}),i.useEffect(()=>{const u=[];for(const m of n){const h=Oe().userDataManager.getUserData(m.requesterUserId);h&&u.push({roomIndex:h.roomIndex,request:m})}e(u)},[n]),{displayedRequests:s,hideFriendRequest:c}},GN=FN,BN=()=>{const[a,e]=i.useState(null),{roomSession:n=null}=Ge(),r=()=>e(null),o=c=>c&&q().selectRoomObject(Oe().roomId,c.id,c.category),s=()=>{const c=H(),u=q().getRoomObjects(n.roomId,Q.WALL),m=q().getRoomObjects(n.roomId,Q.FLOOR),h=u.map(f=>{if(f.id<0)return null;let _=f.type;if(_.startsWith("poster"))_=d(`poster_${_.replace("poster","")}_name`);else{const E=f.model.getValue(te.FURNITURE_TYPE_ID),I=c.getWallItemData(E);I&&I.name.length&&(_=I.name)}return new ms(f.id,Q.WALL,_)}),g=m.map(f=>{if(f.id<0)return null;let _=f.type;const E=f.model.getValue(te.FURNITURE_TYPE_ID),I=c.getFloorItemData(E);return I&&I.name.length&&(_=I.name),new ms(f.id,Q.FLOOR,_)});e([...h,...g].sort((f,_)=>f.name<_.name?-1:1))};return RS(!!a,c=>{if(c.id<0)return;const u=q().getRoomObject(Oe().roomId,c.id,c.category);if(!u)return;let m=null;switch(c.category){case Q.WALL:{let h=u.type;if(h.startsWith("poster"))h=d(`poster_${h.replace("poster","")}_name`);else{const g=u.model.getValue(te.FURNITURE_TYPE_ID),f=H().getWallItemData(g);f&&f.name.length&&(h=f.name)}m=new ms(u.id,Q.WALL,h);break}case Q.FLOOR:{let h=u.type;const g=u.model.getValue(te.FURNITURE_TYPE_ID),f=H().getFloorItemData(g);f&&f.name.length&&(h=f.name),m=new ms(u.id,Q.FLOOR,h)}}e(h=>[...h,m].sort((g,f)=>g.name<f.name?-1:1))}),Sn(!!a,c=>{c.id<0||e(u=>{const m=[...u];for(let h=0;h<m.length;h++){const g=m[h];if(!(g.id!==c.id||g.category!==c.category)){m.splice(h,1);break}}return m})}),{items:a,onClose:r,selectItem:o,populateChooser:s}},VN=BN,HN=()=>{const[a,e]=i.useState(!1),[n,r]=i.useState(-1),[o,s]=i.useState(""),[c,u]=i.useState(""),[m,h]=i.useState(""),g=()=>{h(""),u(""),s(""),r(-1),e(!1)},f=()=>{M(new Bp(n,c))},_=I=>{u(I),m.length>0&&h("")},E=I=>{if(!(!I||I===0))switch(I){case 1:return d("catalog.alert.petname.long");case 2:return d("catalog.alert.petname.short");case 3:return d("catalog.alert.petname.chars");case 4:default:return d("catalog.alert.petname.bobba")}};return Ye(Tl.RSOPPE_OPEN_PET_PACKAGE_REQUESTED,I=>{if(!I)return;const C=q().getRoomObject(I.session.roomId,I.objectId,Q.FLOOR);r(I.objectId),s(C.type),e(!0)}),Ye(Tl.RSOPPE_OPEN_PET_PACKAGE_RESULT,I=>{I&&(I.nameValidationStatus===0&&g(),I.nameValidationStatus!==0&&h(E(I.nameValidationStatus)))}),{isVisible:a,errorResult:m,petName:c,objectType:o,onChangePetName:_,onConfirm:f,onClose:g}},WN=HN,jN=()=>{const{roomSession:a=null}=Ge(),e=o=>a.sendPollStartMessage(o),n=o=>a.sendPollRejectMessage(o),r=(o,s,c)=>a.sendPollAnswerMessage(o,s,c);return Ye(ko.OFFER,o=>{const s=new mr(mr.OFFER,o.id);s.summary=o.summary,s.headline=o.headline,St(s)}),Ye(ko.ERROR,o=>{const s=new mr(mr.ERROR,o.id);s.summary=o.summary,s.headline=o.headline,St(s)}),Ye(ko.CONTENT,o=>{const s=new mr(mr.CONTENT,o.id);s.startMessage=o.startMessage,s.endMessage=o.endMessage,s.numQuestions=o.numQuestions,s.questionArray=o.questionArray,s.npsPoll=o.npsPoll,St(s)}),{startPoll:e,rejectPoll:n,answerPoll:r}},qN=jN,YN=()=>sa(Zr.TRANSLATE_CHAT_MESSAGE_TO_ENGLISH,!1),Kd=()=>ot(YN),zN=()=>{const[a,e]=i.useState(null);Ge();const n=()=>e(null),r=s=>s&&q().selectRoomObject(Oe().roomId,s.id,s.category),o=()=>{const s=Oe(),c=q().getRoomObjects(s.roomId,Q.UNIT);e(c.map(u=>{if(u.id<0)return null;const m=s.userDataManager.getUserDataByIndex(u.id);return m?new ms(m.roomIndex,Q.UNIT,m.name):null}).sort((u,m)=>u.name<m.name?-1:1))};return qd(!!a,s=>{if(s.id<0)return;const c=Oe().userDataManager.getUserDataByIndex(s.id);c&&e(u=>{const m=[...u];return m.push(new ms(c.roomIndex,Q.UNIT,c.name)),m.sort((h,g)=>h.name<g.name?-1:1),m})}),Yd(!!a,s=>{s.id<0||e(c=>{const u=[...c];for(let m=0;m<u.length;m++){const h=u[m];if(!(h.id!==s.id||h.category!==s.category)){u.splice(m,1);break}}return u})}),{items:a,onClose:n,selectItem:r,populateChooser:o}},$N=zN,cc=4e3,KN=3,XN=()=>{const[a,e]=i.useState(-1),[n,r]=i.useState(null),[o,s]=i.useState(!1),[c,u]=i.useState(null),[m,h]=i.useState(new Map),[g,f]=i.useState(new Map),{answerPoll:_=null}=qN(),{roomSession:E=null}=Ge(),I=()=>{e(-1),r(null)},C=p=>{o||!n||(_(a,n.id,[p]),s(!0))};return Ye(Po.ANSWERED,p=>{const b=E.userDataManager.getUserData(p.userId);b&&(h(p.answerCounts),f(N=>{if(!N.has(b.roomIndex)){const v=new Map(g);return v.set(b.roomIndex,{value:p.value,secondsLeft:KN}),v}return N}),q().updateRoomObjectUserGesture(E.roomId,b.roomIndex,gs.getGestureId(p.value==="0"?gs.GESTURE_SAD:gs.GESTURE_SMILE)))}),Ye(Po.FINISHED,p=>{n&&n.id===p.questionId&&(h(p.answerCounts),s(!0),u(b=>(b&&clearTimeout(b),setTimeout(()=>I(),cc)))),f(new Map)}),Ye(Po.QUESTION,p=>{e(p.id),r(p.question),s(!1),h(new Map),f(new Map),u(b=>{if(b&&clearTimeout(b),p.duration>0){const N=p.duration<1e3?cc:p.duration;return setTimeout(()=>I(),N)}return null})}),i.useEffect(()=>{const p=()=>{f(N=>{const v=[];if(N.forEach((R,y)=>{R.secondsLeft--,R.secondsLeft<=0&&v.push(y)}),v.length===0)return N;const O=new Map(N);return v.forEach(R=>O.delete(R)),O})},b=setInterval(()=>p(),1e3);return()=>clearInterval(b)},[]),i.useEffect(()=>()=>{u(p=>(p&&clearTimeout(p),null))},[]),{question:n,answerSent:o,answerCounts:m,userAnswers:g,vote:C}},QN=XN,JN=()=>{const[a,e]=i.useState(null),[n,r]=i.useState(null),[o,s]=i.useState(0),[c,u]=i.useState(0),[m,h]=i.useState(0),[g,f]=sa("nitro.screensize",{width:window.innerWidth,height:window.innerHeight}),_=C=>{s(C),M(new Hp(C))},E=C=>{H().giveRespect(C),u(H().respectsLeft)},I=C=>{H().givePetRespect(C),h(H().respectsPetLeft)};return x(Ru,C=>{const p=C.getParser();e(p.userInfo),r(p.userInfo.figure),u(p.userInfo.respectsRemaining),h(p.userInfo.respectsPetRemaining)}),x(Vp,C=>{const p=C.getParser();r(p.figure)}),x(Mu,C=>{const p=C.getParser();s(p.chatType)}),i.useEffect(()=>{const C=Ya("nitro.screensize");if(C&&(C.width!==window.innerWidth||C.height!==window.innerHeight)){let b=window.localStorage.length;for(;b>0;){const N=window.localStorage.key(b);N&&N.startsWith("nitro.window")&&window.localStorage.removeItem(N),b--}}const p=b=>f({width:window.innerWidth,height:window.innerHeight});return window.addEventListener("resize",p),()=>{window.removeEventListener("resize",p)}},[f]),{userInfo:a,userFigure:n,chatStyleId:o,userRespectRemaining:c,petRespectRemaining:m,respectUser:E,respectPet:I,updateChatStyleId:_}},_r=()=>ot(JN),ZN=a=>i.useEffect(a,[]),Xd=a=>ZN(()=>a()),Qd=a=>{const{achievement:e=null,scale:n=1,...r}=a;return e?t(je,{badgeCode:cn.getAchievementBadgeCode(e),isGrayscale:!cn.getAchievementHasStarted(e),scale:n,...r}):null},eT=a=>{const{achievement:e=null}=a,{selectedAchievement:n=null,setSelectedAchievementId:r=null}=fo();return e?t(be,{itemActive:n===e,itemUnseen:e.unseen>0,onClick:o=>r(e.achievementId),children:t(Qd,{achievement:e})}):null},tT=a=>{const{achievements:e=null}=a;return t(Ue,{columnCount:6,columnMinWidth:50,columnMinHeight:50,children:e&&e.length>0&&e.map((n,r)=>t(eT,{achievement:n},r))})},nT=a=>{const{achievement:e=null}=a;return e?l(w,{shrink:!0,className:"bg-muted rounded p-2 text-black",gap:2,overflow:"hidden",children:[l(T,{center:!0,gap:1,children:[t(Qd,{className:"nitro-achievements-badge-image",achievement:e,scale:2}),t(S,{fontWeight:"bold",children:d("achievements.details.level",["level","limit"],[cn.getAchievementLevel(e).toString(),e.levelCount.toString()])})]}),l(T,{fullWidth:!0,justifyContent:"center",overflow:"hidden",children:[l(T,{gap:1,children:[t(S,{fontWeight:"bold",truncate:!0,children:Js(cn.getAchievementBadgeCode(e))}),t(S,{textBreak:!0,children:ji(cn.getAchievementBadgeCode(e))})]}),(e.levelRewardPoints>0||e.scoreLimit>0)&&l(T,{gap:1,children:[e.levelRewardPoints>0&&l(w,{alignItems:"center",gap:1,children:[t(S,{truncate:!0,className:"small",children:d("achievements.details.reward")}),l(w,{center:!0,className:"fw-bold small",gap:1,children:[e.levelRewardPoints,t(lt,{type:e.levelRewardPointType})]})]}),e.scoreLimit>0&&t(el,{text:d("achievements.details.progress",["progress","limit"],[(e.currentPoints+e.scoreAtStartOfLevel).toString(),(e.scoreLimit+e.scoreAtStartOfLevel).toString()]),progress:e.currentPoints+e.scoreAtStartOfLevel,maxProgress:e.scoreLimit+e.scoreAtStartOfLevel})]})]})]}):null},rT=a=>{const{category:e=null}=a,{selectedAchievement:n=null,setSelectedAchievementId:r=null}=fo();return i.useEffect(()=>{var o,s;e&&(n||r((s=(o=e==null?void 0:e.achievements)==null?void 0:o[0])==null?void 0:s.achievementId))},[e,n,r]),e?l(T,{fullHeight:!0,justifyContent:"between",children:[t(tT,{achievements:e.achievements}),!!n&&t(nT,{achievement:n})]}):null},sT=a=>{const{category:e=null,selectedCategoryCode:n=null,setSelectedCategoryCode:r=null}=a;if(!e)return null;const o=cn.getAchievementCategoryProgress(e),s=cn.getAchievementCategoryMaxProgress(e),c=cn.getAchievementCategoryImageUrl(e,o),u=cn.getAchievementCategoryTotalUnseen(e);return l(be,{itemActive:n===e.code,itemCount:u,itemCountMinimum:0,gap:1,onClick:m=>r(e.code),children:[t(S,{fullWidth:!0,center:!0,small:!0,className:"pt-1",children:d(`quests.${e.code}.name`)}),t(Rd,{position:"relative",imageUrl:c,children:l(S,{fullWidth:!0,center:!0,position:"absolute",variant:"white",style:{fontSize:12,bottom:9},children:[o," / ",s]})})]})},aT=a=>{const{categories:e=null,selectedCategoryCode:n=null,setSelectedCategoryCode:r=null}=a;return t(Ue,{columnCount:3,columnMinWidth:90,columnMinHeight:100,children:e&&e.length>0&&e.map((o,s)=>t(sT,{category:o,selectedCategoryCode:n,setSelectedCategoryCode:r},s))})},oT=a=>{const[e,n]=i.useState(!1),{achievementCategories:r=[],selectedCategoryCode:o=null,setSelectedCategoryCode:s=null,achievementScore:c=0,getProgress:u=0,getMaxProgress:m=0,selectedCategory:h=null}=fo();return i.useEffect(()=>{const g={linkReceived:f=>{const _=f.split("/");if(!(_.length<2))switch(_[1]){case"show":n(!0);return;case"hide":n(!1);return;case"toggle":n(E=>!E);return}},eventUrlPrefix:"achievements/"};return _t(g),()=>Ct(g)},[]),e?l(ae,{uniqueKey:"achievements",className:"nitro-achievements",theme:"primary-slim",children:[t(se,{headerText:d("inventory.achievements"),onCloseClick:g=>n(!1)}),h&&l(wd,{position:"relative",className:"justify-content-center align-items-center cursor-pointer",gap:3,children:[t(U,{onClick:g=>s(null),className:"nitro-achievements-back-arrow"}),l(T,{grow:!0,gap:0,children:[t(S,{fontSize:4,fontWeight:"bold",className:"text-small",children:d(`quests.${h.code}.name`)}),t(S,{children:d("achievements.details.categoryprogress",["progress","limit"],[h.getProgress().toString(),h.getMaxProgress().toString()])})]}),t(sr,{imageUrl:cn.getAchievementCategoryImageUrl(h,null,!0)})]}),l(re,{gap:1,children:[!h&&l(V,{children:[t(aT,{categories:r,selectedCategoryCode:o,setSelectedCategoryCode:s}),l(T,{grow:!0,justifyContent:"end",gap:1,children:[t(S,{small:!0,center:!0,children:d("achievements.categories.score",["score"],[c.toString()])}),t(el,{text:d("achievements.categories.totalprogress",["progress","limit"],[u.toString(),m.toString()]),progress:u,maxProgress:m})]})]}),h&&t(rT,{category:h})]})]}):null},yr=a=>{const{icon:e=null,selected:n=!1,classNames:r=[],children:o=null,...s}=a,c=i.useMemo(()=>{const u=["nitro-avatar-editor-spritesheet"];return e&&e.length&&u.push(e+"-icon"),n&&u.push("selected"),r.length&&u.push(...r),u},[e,n,r]);return t(U,{classNames:c,...s})},iT=a=>{const{figureData:e=null}=a,[n,r]=i.useState(-1),o=s=>{s<ua.MIN_DIRECTION&&(s=ua.MAX_DIRECTION+(s+1)),s>ua.MAX_DIRECTION&&(s=s-(ua.MAX_DIRECTION+1)),e.direction=s};return i.useEffect(()=>{if(e)return e.notify=()=>r(s=>s+1),()=>{e.notify=null}},[e]),l(T,{className:"figure-preview-container",overflow:"hidden",position:"relative",children:[t(st,{figure:e.getFigureString(),direction:e.direction,scale:2}),t(yr,{className:"avatar-spotlight",icon:"spotlight"}),t(U,{className:"avatar-shadow"}),l(U,{className:"arrow-container",children:[t(yr,{pointer:!0,icon:"arrow-left",onClick:s=>o(e.direction+1)}),t(yr,{pointer:!0,icon:"arrow-right",onClick:s=>o(e.direction-1)})]})]})},lT=a=>{const{partItem:e=null,children:n=null,...r}=a,[o,s]=i.useState(-1),c=K("hc.disabled",!1);return i.useEffect(()=>{const u=()=>s(m=>m+1);return e.notify=u,()=>e.notify=null},[e]),l(be,{itemImage:e.isClear?void 0:e.imageUrl,itemActive:e.isSelected,...r,children:[!c&&e.isHC&&t(lt,{className:"position-absolute end-1 bottom-1",type:"hc"}),e.isClear&&t(yr,{icon:"clear"}),e.isSellable&&t(yr,{icon:"sellable",position:"absolute",className:"end-1 bottom-1"}),n]})},cT=a=>{const{model:e=null,category:n=null,setMaxPaletteCount:r=null}=a,o=i.useRef(null),s=i.useCallback(c=>{const u=n.parts.indexOf(c);if(u===-1)return;e.selectPart(n.name,u);const m=n.getCurrentPart();r(m.maxColorIndex||1)},[e,n,r]);return i.useEffect(()=>{!e||!n||!o||!o.current||(o.current.scrollTop=0)},[e,n]),t(Ue,{innerRef:o,columnCount:3,columnMinHeight:50,children:n.parts.length>0&&n.parts.map((c,u)=>t(lT,{partItem:c,onClick:m=>s(c)},u))})},uT=a=>{const{colorItem:e=null,children:n=null,...r}=a,[o,s]=i.useState(-1),c=K("hc.disabled",!1);return i.useEffect(()=>{const u=()=>s(m=>m+1);return e.notify=u,()=>e.notify=null},[e]),l(be,{itemHighlight:!0,itemColor:e.color,itemActive:e.isSelected,className:"clear-bg",...r,children:[!c&&e.isHC&&t(lt,{className:"position-absolute end-1 bottom-1",type:"hc"}),n]})},uc=a=>{const{model:e=null,category:n=null,paletteSet:r=[],paletteIndex:o=-1}=a,s=i.useRef(null),c=i.useCallback(u=>{const m=r.indexOf(u);m!==-1&&e.selectColor(n.name,m,o)},[e,n,r,o]);return i.useEffect(()=>{!e||!n||!s||!s.current||(s.current.scrollTop=0)},[e,n]),t(Ue,{innerRef:s,gap:1,columnCount:5,columnMinWidth:30,children:r.length>0&&r.map((u,m)=>t(uT,{colorItem:u,onClick:h=>c(u)},m))})},dT=a=>{const{model:e=null,gender:n=null,setGender:r=null}=a,[o,s]=i.useState(null),[c,u]=i.useState(1),m=i.useCallback(h=>{const g=e.categories.get(h);if(g){g.init(),s(g);for(const f of g.parts)if(!(!f||!f.isSelected)){u(f.maxColorIndex||1);break}}},[e]);return i.useEffect(()=>{e.init();for(const h of e.categories.keys()){m(h);break}},[e,m]),!e||!o?null:l(ne,{children:[l(T,{size:2,children:[e.canSetGender&&l(V,{children:[t(w,{center:!0,pointer:!0,className:"category-item",onClick:h=>r(ce.MALE),children:t(yr,{icon:"male",selected:n===ce.MALE})}),t(w,{center:!0,pointer:!0,className:"category-item",onClick:h=>r(ce.FEMALE),children:t(yr,{icon:"female",selected:n===ce.FEMALE})})]}),!e.canSetGender&&e.categories&&e.categories.size>0&&Array.from(e.categories.keys()).map(h=>{const g=e.categories.get(h);return t(w,{center:!0,pointer:!0,className:"category-item",onClick:f=>m(h),children:t(yr,{icon:g.name,selected:o===g})},h)})]}),t(T,{size:5,overflow:"hidden",children:t(cT,{model:e,category:o,setMaxPaletteCount:u})}),l(T,{size:5,overflow:"hidden",children:[c>=1&&t(uc,{model:e,category:o,paletteSet:o.getPalette(0),paletteIndex:0}),c===2&&t(uc,{model:e,category:o,paletteSet:o.getPalette(1),paletteIndex:1})]})]})},mT=a=>{const{figureData:e=null,savedFigures:n=[],setSavedFigures:r=null,loadAvatarInEditor:o=null}=a,s=K("hc.disabled",!1),c=i.useCallback(h=>{if(h>=n.length||h<0)return;const[g,f]=n[h];o(g.getFigureString(),f)},[n,o]),u=i.useCallback(h=>{if(!e||h>=n.length||h<0)return;const g=[...n],f=e.getFigureString(),_=e.gender;g[h]=[Nt().createFigureContainer(f),_],r(g),M(new Wp(h+1,f,_))},[e,n,r]),m=i.useMemo(()=>{if(!n||!n.length)return[];const h=[];return n.forEach(([g,f],_)=>{let E=0;g&&(E=Nt().getFigureClubLevel(g,f)),h.push(l(be,{position:"relative",overflow:"hidden",className:"nitro-avatar-editor-wardrobe-figure-preview",children:[g&&t(st,{figure:g.getFigureString(),gender:f,direction:2}),t(U,{className:"avatar-shadow"}),!s&&E>0&&t(lt,{className:"position-absolute top-1 start-1",type:"hc"}),l(w,{gap:1,className:"button-container",children:[t(L,{variant:"link",fullWidth:!0,onClick:I=>u(_),children:d("avatareditor.wardrobe.save")}),g&&t(L,{variant:"link",fullWidth:!0,onClick:I=>c(_),disabled:E>In(),children:d("generic_usable.button.use")})]})]},_))}),h},[n,s,u,c]);return t(Ue,{columnCount:5,columnMinWidth:80,columnMinHeight:140,children:m})},gT="hr-100.hd-180-7.ch-215-66.lg-270-79.sh-305-62.ha-1002-70.wa-2007",hT="hr-515-33.hd-600-1.ch-635-70.lg-716-66-62.sh-735-68",fT=a=>{const[e,n]=i.useState(!1),[r,o]=i.useState(null),[s,c]=i.useState(null),[u,m]=i.useState(null),[h,g]=i.useState(null),[f,_]=i.useState([]),[E,I]=i.useState([]),[C,p]=i.useState([]),[b,N]=i.useState(!1),[v,O]=i.useState(null),[R,y]=i.useState(null),[F,P]=i.useState(!0),[D,A]=i.useState(!1),k=i.useMemo(()=>K("avatar.wardrobe.max.slots",10),[]);x(jp,le=>{const De=le.getParser();_(De.figureSetIds),I(De.boundsFurnitureNames)}),x(qp,le=>{const De=le.getParser(),Qe=[];let ft=0;for(;ft<k;)Qe.push([null,null]),ft++;for(let[Ze,[Gt,We]]of De.looks.entries()){const Yt=Nt().createFigureContainer(Gt);Qe[Ze-1]=[Yt,We]}p(Qe)});const B=i.useCallback(le=>{u&&g(u.get(le))},[u]),G=i.useCallback(()=>{const le=new Map;le.set(gr.GENERIC,new GC),le.set(gr.HEAD,new ab),le.set(gr.TORSO,new ib),le.set(gr.LEGS,new ob),m(le)},[]),z=i.useCallback(()=>{const le=new Map,De=new ce,Qe=new ce;De.loadAvatarData(gT,ce.MALE),Qe.loadAvatarData(hT,ce.FEMALE),le.set(ce.MALE,De),le.set(ce.FEMALE,Qe),o(le),c(le.get(ce.MALE))},[]),X=i.useCallback((le,De,Qe=!0)=>{De=gt.getGender(De);let ft=s;De!==ft.gender&&(ft=r.get(De)),le!==ft.getFigureString()&&ft.loadAvatarData(le,De),ft!==s&&c(ft),Qe&&(O(s.getFigureString()),y(s.gender))},[r,s]),Y=i.useCallback(le=>{switch(le){case yn.ACTION_CLEAR:X(s.getFigureStringWithFace(0,!1),s.gender,!1),G();return;case yn.ACTION_RESET:X(v,R),G();return;case yn.ACTION_RANDOMIZE:const De=sb(s,s.gender,In(),f,[ce.FACE]);X(De,s.gender,!1),G();return;case yn.ACTION_SAVE:M(new Lu(s.gender,s.getFigureString())),n(!1);return}},[s,v,R,f,X,G]),Ee=i.useCallback(le=>{le=gt.getGender(le),c(r.get(le))},[r]);return i.useEffect(()=>{const le={linkReceived:De=>{const Qe=De.split("/");if(!(Qe.length<2))switch(Qe[1]){case"show":n(!0);return;case"hide":n(!1);return;case"toggle":n(ft=>!ft);return}},eventUrlPrefix:"avatar-editor/"};return _t(le),()=>Ct(le)},[]),i.useEffect(()=>{p(new Array(k))},[k]),i.useEffect(()=>{b&&(g(null),M(new Yp))},[b]),i.useEffect(()=>{h&&N(!1)},[h]),i.useEffect(()=>{u&&B(gr.GENERIC)},[u,B]),i.useEffect(()=>{if(s)return gt.CURRENT_FIGURE=s,G(),()=>gt.CURRENT_FIGURE=null},[s,G]),i.useEffect(()=>(gt.FIGURE_SET_IDS=f,gt.BOUND_FURNITURE_NAMES=E,G(),()=>{gt.FIGURE_SET_IDS=null,gt.BOUND_FURNITURE_NAMES=null}),[f,E,G]),i.useEffect(()=>{if(e&&!r){z(),A(!0);return}},[e,r,z]),i.useEffect(()=>{!e||!D||!F||(X(H().figure,H().gender),P(!1))},[e,D,F,X]),i.useEffect(()=>{if(!e)return()=>{P(!0)}},[e]),!e||!s?null:l(ae,{uniqueKey:"avatar-editor",className:"nitro-avatar-editor",children:[t(se,{headerText:d("avatareditor.title"),onCloseClick:le=>n(!1)}),l(Ir,{children:[u&&u.size>0&&Array.from(u.keys()).map(le=>{const De=h&&h.name===le;return t(qn,{isActive:De,onClick:Qe=>B(le),children:d(`avatareditor.category.${le}`)},le)}),t(qn,{isActive:b,onClick:le=>N(!0),children:d("avatareditor.category.wardrobe")})]}),t(re,{children:l(ne,{children:[l(T,{size:9,overflow:"hidden",children:[h&&!b&&t(dT,{model:h,gender:s.gender,setGender:Ee}),b&&t(mT,{figureData:s,savedFigures:C,setSavedFigures:p,loadAvatarInEditor:X})]}),l(T,{size:3,overflow:"hidden",children:[t(iT,{figureData:s}),l(T,{grow:!0,gap:1,children:[l(er,{children:[t(L,{variant:"secondary",onClick:le=>Y(yn.ACTION_RESET),children:t(wm,{className:"fa-icon"})}),t(L,{variant:"secondary",onClick:le=>Y(yn.ACTION_CLEAR),children:t(Pi,{className:"fa-icon"})}),t(L,{variant:"secondary",onClick:le=>Y(yn.ACTION_RANDOMIZE),children:t(Rm,{className:"fa-icon"})})]}),t(L,{className:"w-100",variant:"success",onClick:le=>Y(yn.ACTION_SAVE),children:d("avatareditor.save")})]})]})]})})]})},pT=5,IT=a=>{const{onClose:e=null,onEdit:n=null,onDelete:r=null}=a,{cameraRoll:o=null,setCameraRoll:s=null,selectedPictureIndex:c=-1,setSelectedPictureIndex:u=null}=kd(),{simpleAlert:m=null}=Xe(),h=i.useRef(),g=c>-1?o[c]:null,f=()=>{if(!h||!h.current)return null;const E=h.current.getBoundingClientRect();return new pu(Math.floor(E.x),Math.floor(E.y),Math.floor(E.width),Math.floor(E.height))},_=()=>{if(c>-1){u(-1);return}const E=q().createTextureFromRoom(Oe().roomId,1,f()),I=[...o];I.length>=pT&&(m(d("camera.full.body")),I.pop()),rr(dn.CAMERA_SHUTTER),I.push(new lb(E,tr.generateImageUrl(E))),s(I)};return t(Ar,{uniqueKey:"nitro-camera-capture",children:l(T,{center:!0,className:"nitro-camera-capture",gap:0,children:[g&&t("img",{alt:"",className:"camera-area",src:g.imageUrl}),l("div",{className:"camera-canvas drag-handler",children:[t("div",{className:"position-absolute header-close",onClick:e,children:t(Cn,{className:"fa-icon"})}),!g&&t("div",{ref:h,className:"camera-area camera-view-finder"}),g&&t("div",{className:"camera-area camera-frame",children:l("div",{className:"camera-frame-preview-actions w-100 position-absolute bottom-0 py-2 text-center",children:[t("button",{className:"btn btn-success me-3",title:d("camera.editor.button.tooltip"),onClick:n,children:d("camera.editor.button.text")}),t("button",{className:"btn btn-danger",onClick:r,children:d("camera.delete.button.text")})]})}),t("div",{className:"d-flex justify-content-center",children:t("div",{className:"camera-button",title:d("camera.take.photo.button.tooltip"),onClick:_})})]}),o.length>0&&t(w,{gap:2,justifyContent:"center",className:"camera-roll d-flex justify-content-center py-2",children:o.map((E,I)=>t("img",{alt:"",src:E.imageUrl,onClick:C=>u(I)},I))})]})})},ET=a=>{const{base64Url:e=null,onCloseClick:n=null,onCancelClick:r=null,price:o=null}=a,[s,c]=i.useState(null),[u,m]=i.useState(null),[h,g]=i.useState(0),[f,_]=i.useState(!1),[E,I]=i.useState(!1),[C,p]=i.useState(0),b=i.useMemo(()=>K("camera.publish.disabled",!1),[]);x(zp,v=>{g(O=>O+1),I(!1)}),x($p,v=>{const O=v.getParser();m(O.extraDataId),p(O.secondsToWait),_(O.ok),I(!1)}),x(Kp,v=>{const O=v.getParser();c(K("camera.url")+"/"+O.url)});const N=(v,O=null)=>{switch(v){case"close":n();return;case"buy":if(E)return;I(!0),M(new Qp(""));return;case"publish":if(E)return;I(!0),M(new Xp);return;case"cancel":r();return}};return i.useEffect(()=>{e&&q().saveBase64AsScreenshot(e)},[e]),o?l(ae,{className:"nitro-camera-checkout",theme:"primary-slim",children:[t(se,{headerText:d("camera.confirm_phase.title"),onCloseClick:v=>N("close")}),l(re,{children:[l(w,{center:!0,children:[s&&s.length&&t(sr,{className:"picture-preview border",imageUrl:s}),(!s||!s.length)&&t(w,{center:!0,className:"picture-preview border",children:t(S,{bold:!0,children:d("camera.loading")})})]}),l(w,{justifyContent:"between",alignItems:"center",className:"bg-muted rounded p-2",children:[l(T,{size:b?10:6,gap:1,children:[t(S,{bold:!0,children:d("camera.purchase.header")}),(o.credits>0||o.duckets>0)&&l(w,{gap:1,children:[t(S,{children:d("catalog.purchase.confirmation.dialog.cost")}),o.credits>0&&l(w,{gap:1,children:[t(S,{bold:!0,children:o.credits}),t(lt,{type:-1})]}),o.duckets>0&&l(w,{gap:1,children:[t(S,{bold:!0,children:o.duckets}),t(lt,{type:5})]})]}),h>0&&l(S,{children:[t(S,{bold:!0,children:d("camera.purchase.count.info")})," ",h,t("u",{className:"ms-1 cursor-pointer",onClick:()=>ee("inventory/toggle"),children:d("camera.open.inventory")})]})]}),t(w,{alignItems:"center",children:t(L,{variant:"success",disabled:E,onClick:v=>N("buy"),children:d(h?"camera.buy.another.button.text":"buy")})})]}),!b&&l(w,{justifyContent:"between",alignItems:"center",className:"bg-muted rounded p-2",children:[l(T,{gap:1,children:[t(S,{bold:!0,children:d(f?"camera.publish.successful":"camera.publish.explanation")}),t(S,{children:d(f?"camera.publish.success.short.info":"camera.publish.detailed.explanation")}),f&&t("a",{href:u,rel:"noreferrer",target:"_blank",children:d("camera.link.to.published")}),!f&&o.publishDucketPrice>0&&l(w,{gap:1,children:[t(S,{children:d("catalog.purchase.confirmation.dialog.cost")}),l(w,{gap:1,children:[t(S,{bold:!0,children:o.publishDucketPrice}),t(lt,{type:5})]})]}),C>0&&t("div",{className:"mt-1 text-center fw-bold",children:d("camera.publish.wait",["minutes"],[Math.ceil(C/60).toString()])})]}),!f&&t(w,{className:"d-flex align-items-end",children:t(L,{variant:"success",disabled:E||C>0,onClick:v=>N("publish"),children:d("camera.publish.button.text")})})]}),t(S,{center:!0,children:d("camera.warning.disclaimer")}),t(w,{justifyContent:"end",children:t(L,{onClick:v=>N("cancel"),children:d("generic.cancel")})})]})]}):null},_T=a=>{const{effect:e=null,thumbnailUrl:n=null,isActive:r=!1,isLocked:o=!1,selectEffect:s=null,removeEffect:c=null}=a;return l(be,{title:d(o?`camera.effect.required.level ${e.minLevel}`:`camera.effect.name.${e.name}`),itemActive:r,onClick:u=>!r&&s(),children:[r&&t(L,{variant:"danger",className:"rounded-circle remove-effect",onClick:c,children:t(Cn,{className:"fa-icon"})}),!o&&n&&n.length>0&&t("div",{className:"effect-thumbnail-image border",children:t("img",{alt:"",src:n})}),o&&l(S,{center:!0,bold:!0,children:[t("div",{children:t(ou,{className:"fa-icon"})}),e.minLevel]})]})},CT=a=>{const{myLevel:e=0,selectedEffects:n=[],effects:r=[],thumbnails:o=[],processAction:s=null}=a;return t(ne,{columnCount:3,overflow:"auto",children:r&&r.length>0&&r.map((c,u)=>{const m=o.find(g=>g.effectName===c.name),h=n.findIndex(g=>g.effect.name===c.name)>-1;return t(_T,{effect:c,thumbnailUrl:m&&m.thumbnailUrl||null,isActive:h,isLocked:c.minLevel>e,selectEffect:()=>s("select_effect",c.name),removeEffect:()=>s("remove_effect",c.name)},u)})})},dc=[qs.COLORMATRIX,qs.COMPOSITE],bT=a=>{const{picture:e=null,availableEffects:n=null,myLevel:r=1,onClose:o=null,onCancel:s=null,onCheckout:c=null}=a,[u,m]=i.useState(dc[0]),[h,g]=i.useState(null),[f,_]=i.useState([]),[E,I]=i.useState([]),[C,p]=i.useState(!1),b=i.useMemo(()=>n.filter(A=>A.colorMatrix),[n]),N=i.useMemo(()=>n.filter(A=>A.texture),[n]),v=i.useCallback(()=>u===qs.COLORMATRIX?b:N,[u,b,N]),O=i.useCallback(A=>!A||!A.length||!f||!f.length?-1:f.findIndex(k=>k.effect.name===A),[f]),R=i.useMemo(()=>O(h),[h,O]),y=i.useMemo(()=>h&&f[R]||null,[h,R,f]),F=i.useCallback(A=>{const k=R;k!==-1&&_(B=>{const G=[...B],z=G[k];return G[R]=new Do(z.effect,A),G})},[R,_]),P=i.useMemo(()=>Ms().applyEffects(e.texture,f,C).src,[e,f,C]),D=i.useCallback((A,k=null)=>{switch(A){case"close":o();return;case"cancel":s();return;case"checkout":c(P);return;case"change_tab":m(String(k));return;case"select_effect":{if(O(k)>=0)return;const G=n.find(z=>z.name===k);if(!G)return;_(z=>[...z,new Do(G,1)]),g(G.name);return}case"remove_effect":{let B=O(k);if(B===-1)return;_(G=>{const z=[...G];return z.splice(B,1),z}),h===k&&g(null);return}case"clear_effects":g(null),_([]);return;case"download":{const B=new Image;B.src=P,window.open("").document.write(B.outerHTML);return}case"zoom":p(!C);return}},[C,n,h,P,O,s,c,o,p,_]);return i.useEffect(()=>{const A=[];for(const k of n)A.push(new cb(k.name,Ms().applyEffects(e.texture,[new Do(k,1)],!1).src));I(A)},[e,n]),l(ae,{className:"nitro-camera-editor",children:[t(se,{headerText:d("camera.editor.button.text"),onCloseClick:A=>D("close")}),t(Ir,{children:dc.map(A=>t(qn,{isActive:u===A,onClick:k=>D("change_tab",A),children:t("i",{className:"icon icon-camera-"+A})},A))}),t(re,{children:l(ne,{children:[t(T,{size:5,overflow:"hidden",children:t(CT,{myLevel:r,selectedEffects:f,effects:v(),thumbnails:E,processAction:D})}),l(T,{size:7,justifyContent:"between",overflow:"hidden",children:[l(T,{center:!0,children:[t(sr,{imageUrl:P,className:"picture-preview"}),h&&l(T,{center:!0,fullWidth:!0,gap:1,children:[t(S,{children:d("camera.effect.name."+h)}),t(Dt,{className:"nitro-slider",min:0,max:1,step:.01,value:y.alpha,onChange:A=>F(A),renderThumb:(A,k)=>t("div",{...A,children:k.valueNow})})]})]}),l(w,{justifyContent:"between",children:[l(er,{children:[t(L,{onClick:A=>D("clear_effects"),children:t(Pi,{className:"fa-icon"})}),t(L,{onClick:A=>D("download"),children:t(ym,{className:"fa-icon"})}),l(L,{onClick:A=>D("zoom"),children:[C&&t(Om,{className:"fa-icon"}),!C&&t(Am,{className:"fa-icon"})]})]}),l(w,{gap:1,children:[t(L,{onClick:A=>D("cancel"),children:d("generic.cancel")}),t(L,{onClick:A=>D("checkout"),children:d("camera.preview.button.text")})]})]})]})]})})]})},os=0,Ta=1,mc=2,gc=3,ST=a=>{const[e,n]=i.useState(os),[r,o]=i.useState(null),{availableEffects:s=[],selectedPictureIndex:c=-1,cameraRoll:u=[],setCameraRoll:m=null,myLevel:h=0,price:g={credits:0,duckets:0,publishDucketPrice:0}}=kd(),f=E=>{switch(E){case"close":n(os);return;case"edit":n(mc);return;case"delete":m(I=>{const C=[...I];return C.splice(c,1),C});return;case"editor_cancel":n(Ta);return}},_=E=>{o(E),n(gc)};return Ye(qt.ENDED,E=>n(os)),i.useEffect(()=>{const E={linkReceived:I=>{const C=I.split("/");if(!(C.length<2))switch(C[1]){case"show":n(Ta);return;case"hide":n(os);return;case"toggle":n(p=>p?os:Ta);return}},eventUrlPrefix:"camera/"};return _t(E),()=>Ct(E)},[]),e===os?null:l(V,{children:[e===Ta&&t(IT,{onClose:()=>f("close"),onEdit:()=>f("edit"),onDelete:()=>f("delete")}),e===mc&&t(bT,{picture:u[c],myLevel:h,onClose:()=>f("close"),onCancel:()=>f("editor_cancel"),onCheckout:_,availableEffects:s}),e===gc&&t(ET,{base64Url:r,onCloseClick:()=>f("close"),onCancelClick:()=>f("editor_cancel"),price:g})]})},NT=a=>{const{itemId:e=-1,state:n=null,product:r=null,active:o=!1,onClick:s=null}=a,c=u=>{let m=H().getFloorItemDataByName(u),h=null;return m?h=q().getFurnitureFloorIconUrl(m.id):(m=H().getWallItemDataByName(u),m&&(h=q().getFurnitureWallIconUrl(m.id))),h};return l(T,{fit:!0,center:!0,pointer:!0,className:`campaign-spritesheet campaign-day-generic-bg rounded calendar-item ${o?"active":""}`,onClick:()=>s(e),children:[n===Ft.STATE_UNLOCKED&&t(w,{center:!0,className:"campaign-spritesheet unlocked-bg",children:t(w,{center:!0,className:"campaign-spritesheet campaign-opened",children:r&&t(sr,{imageUrl:r.customImage?K("image.library.url")+r.customImage:c(r.productName)})})}),n!==Ft.STATE_UNLOCKED&&l(w,{center:!0,className:"campaign-spritesheet locked-bg",children:[n===Ft.STATE_LOCKED_AVAILABLE&&t(U,{className:"campaign-spritesheet available"}),(n===Ft.STATE_LOCKED_EXPIRED||n===Ft.STATE_LOCKED_FUTURE)&&t(U,{className:"campaign-spritesheet unavailable"})]})]})},Ho=5,TT=a=>{const{onClose:e=null,campaignName:n=null,currentDay:r=null,numDays:o=null,missedDays:s=null,openedDays:c=null,openPackage:u=null,receivedProducts:m=null}=a,[h,g]=i.useState(r),[f,_]=i.useState(Math.max(0,h-1)),E=v=>c.includes(v)?Ft.STATE_UNLOCKED:v>r?Ft.STATE_LOCKED_FUTURE:s.includes(v)?Ft.STATE_LOCKED_EXPIRED:Ft.STATE_LOCKED_AVAILABLE,I=v=>{switch(E(v)){case Ft.STATE_UNLOCKED:return d("campaign.calendar.info.unlocked");case Ft.STATE_LOCKED_FUTURE:return d("campaign.calendar.info.future");case Ft.STATE_LOCKED_EXPIRED:return d("campaign.calendar.info.expired");default:return d("campaign.calendar.info.available.desktop")}},C=()=>{const v=h+1;v!==o&&(g(v),f+Ho<v+1&&_(f+1))},p=()=>{const v=h-1;v<0||(g(v),f>v&&_(f-1))},b=v=>{if(h===v){E(v)===Ft.STATE_LOCKED_AVAILABLE&&u(v,!1);return}g(v)},N=()=>{const v=h;E(v)!==Ft.STATE_UNLOCKED&&u(v,!0)};return l(ae,{className:"nitro-campaign-calendar",theme:"primary-slim",children:[t(se,{headerText:d(`campaign.calendar.${n}.title`),onCloseClick:e}),l(re,{children:[l(ne,{fullHeight:!1,justifyContent:"between",alignItems:"center",children:[t(T,{size:1}),t(T,{size:10,children:l(w,{justifyContent:"between",alignItems:"center",gap:1,children:[l(T,{gap:1,children:[t(S,{fontSize:3,children:d("campaign.calendar.heading.day",["number"],[(h+1).toString()])}),t(S,{children:I(h)})]}),t("div",{children:H().isModerator&&t(L,{variant:"danger",onClick:N,children:"Force open"})})]})}),t(T,{size:1})]}),l(w,{fullHeight:!0,gap:2,children:[t(w,{center:!0,children:t(U,{pointer:!0,className:"campaign-spritesheet prev",onClick:p})}),t(T,{center:!0,fullWidth:!0,children:t(ne,{fit:!0,columnCount:Ho,gap:1,children:[...Array(Ho)].map((v,O)=>{const R=f+O;return t(T,{overflow:"hidden",children:t(NT,{itemId:R,state:E(R),active:h===R,product:m.has(R)?m.get(R):null,onClick:b})},O)})})}),t(w,{center:!0,children:t(U,{pointer:!0,className:"campaign-spritesheet next",onClick:C})})]})]})]})},vT=a=>{const[e,n]=i.useState(null),[r,o]=i.useState(-1),[s,c]=i.useState(new Map),[u,m]=i.useState(!1),h=(g,f=!1)=>{e&&(o(g),M(f?new Jp(e.campaignName,g):new Zp(e.campaignName,g)))};return x(eI,g=>{const f=g.getParser();f&&n(f.calendarData)}),x(tI,g=>{const f=g.getParser();if(!f)return;const _=r;f.doorOpened&&(n(E=>{const I=E.clone();return I.openedDays.push(r),I}),c(E=>{const I=new Map(E);return I.set(_,new ub(f.productName,f.customImage,f.furnitureClassName)),I})),o(-1)}),i.useEffect(()=>{const g={linkReceived:f=>{const _=f.split("/");if(!(_.length<2))switch(_[1]){case"calendar":m(!0);break}},eventUrlPrefix:"openView/"};return _t(g),()=>Ct(g)},[]),t(V,{children:e&&u&&t(TT,{onClose:()=>m(!1),campaignName:e.campaignName,currentDay:e.currentDay,numDays:e.campaignDays,openedDays:e.openedDays,missedDays:e.missedDays,openPackage:h,receivedProducts:s})})},Jd=a=>{const{icon:e=0}=a,n=i.useMemo(()=>K("catalog.asset.icon.url").replace("%name%",e.toString()),[e]);return t(sr,{imageUrl:n,style:{width:20,height:20}})},wT=a=>{const[e,n]=i.useState(!1),[r,o]=i.useState(0),[s,c]=i.useState(0),[u,m]=i.useState(""),[h,g]=i.useState(""),[f,_]=i.useState(!0),[E,I]=i.useState(""),[C,p]=i.useState([]),[b,N]=i.useState(0),[v,O]=i.useState(0),[R,y]=i.useState(0),[F,P]=i.useState(0),[D,A]=i.useState(0),[k,B]=i.useState(!1),{catalogOptions:G=null}=xe(),{friends:z}=gn(),{giftConfiguration:X=null}=G,[Y,Ee]=i.useState([]),[le,De]=i.useState([]),[Qe,ft]=i.useState(!0),Ze=i.useCallback(()=>{n(!1),o(0),c(0),m(""),g(""),_(!0),I(""),N(0),O(0),ft(!1),De([]),C.length&&y(C[0].id)},[C]),Gt=i.useMemo(()=>X?X.defaultStuffTypes.findIndex(pe=>pe===Y[b])>-1:!1,[Y,X,b]),We=i.useMemo(()=>X?(Y[b]*1e3+X.ribbonTypes[v]).toString():"",[X,b,v,Y]),Yt=i.useMemo(()=>{if(!X||Gt)return!1;const pe=Y[b];return!(pe===8||pe>=3&&pe<=6)},[X,b,Gt,Y]),Nn=i.useMemo(()=>Gt?Y[b]:R,[Gt,Y,b,R]),Fe=z.filter(pe=>pe.id!==-1),Ie=pe=>{const Me=pe.target.value;let Tn=[];Me.length>0&&(Tn=Fe.sort().filter(Pr=>Pr.name.includes(Me))),g(Me),ft(!0),De(Tn)},ze=pe=>{g(pe),ft(!1)},Ot=i.useCallback(pe=>{switch(pe){case"prev_box":N(Me=>Me===0?F:Me-1);return;case"next_box":N(Me=>Me===F?0:Me+1);return;case"prev_ribbon":O(Me=>Me===0?D:Me-1);return;case"next_ribbon":O(Me=>Me===D?0:Me+1);return;case"buy":if(!h||h.length===0){B(!0);return}M(new nI(r,s,u,h,E,Nn,b,v,f));return}},[Nn,u,F,D,E,s,r,h,b,v,f]);x(rI,pe=>B(!0)),ct([pr.PURCHASE_SUCCESS,mn.INIT_GIFT],pe=>{switch(pe.type){case pr.PURCHASE_SUCCESS:Ze();return;case mn.INIT_GIFT:const Me=pe;Ze(),o(Me.pageId),c(Me.offerId),m(Me.extraData),n(!0);return}}),i.useEffect(()=>{B(!1)},[h]);const me=i.useCallback(()=>{X&&Ee(pe=>{let Me=[...X.boxTypes];return Me.push(X.defaultStuffTypes[Math.floor(Math.random()*(X.defaultStuffTypes.length-1))]),P(Me.length-1),A(Me.length-1),Me})},[X]);if(i.useEffect(()=>{if(!X)return;const pe=[];for(const Me of X.stuffTypes){const Tn=H().getFloorItemData(Me);Tn&&Tn.colors&&Tn.colors.length>0&&pe.push({id:Me,color:Qt.makeColorNumberHex(Tn.colors[0])})}me(),pe.length&&(y(pe[0].id),p(pe))},[X,me]),i.useEffect(()=>{e&&me()},[me,e]),!X||!X.isEnabled||!e)return null;const Ae="catalog.gift_wrapping_new.box."+(Gt?"default":Y[b]),at=`catalog.gift_wrapping_new.ribbon.${v}`,en="catalog.gift_wrapping_new."+(Gt?"freeprice":"price");return l(ae,{uniqueKey:"catalog-gift",className:"nitro-catalog-gift",theme:"primary-slim",children:[t(se,{headerText:d("catalog.gift_wrapping.title"),onCloseClick:Ze}),l(re,{className:"text-black",children:[l(Wb,{column:!0,children:[t(S,{children:d("catalog.gift_wrapping.receiver")}),t("input",{type:"text",className:Vt("form-control form-control-sm",k&&"is-invalid"),value:h,onChange:pe=>Ie(pe)}),le.length>0&&Qe&&t(T,{className:"autocomplete-gift-container",children:le.map(pe=>t(U,{className:"autocomplete-gift-item",onClick:Me=>ze(pe.name),children:pe.name},pe.id))}),k&&t(U,{className:"invalid-feedback",children:d("catalog.gift_wrapping.receiver_not_found.title")})]}),t(yd,{figure:H().figure,userName:H().userName,message:E,editable:!0,onChange:pe=>I(pe)}),l(U,{className:"form-check",children:[t("input",{className:"form-check-input",type:"checkbox",name:"showMyFace",checked:f,onChange:pe=>_(Me=>!Me)}),t("label",{className:"form-check-label",children:d("catalog.gift_wrapping.show_face.title")})]}),l(w,{alignItems:"center",gap:2,children:[R&&t(U,{className:"gift-preview",children:t(Qi,{productType:ue.FLOOR,productClassId:Nn,extraData:We})}),l(T,{gap:1,children:[l(w,{gap:2,children:[l(er,{children:[t(L,{variant:"primary",onClick:()=>Ot("prev_box"),children:t(sn,{className:"fa-icon"})}),t(L,{variant:"primary",onClick:()=>Ot("next_box"),children:t(an,{className:"fa-icon"})})]}),l(T,{gap:1,children:[t(S,{fontWeight:"bold",children:d(Ae)}),l(w,{alignItems:"center",gap:1,children:[d(en,["price"],[X.price.toString()]),t(lt,{type:-1})]})]})]}),l(w,{alignItems:"center",gap:2,className:Yt?"":"opacity-50 pointer-events-none",children:[l(er,{children:[t(L,{variant:"primary",onClick:()=>Ot("prev_ribbon"),children:t(sn,{className:"fa-icon"})}),t(L,{variant:"primary",onClick:()=>Ot("next_ribbon"),children:t(an,{className:"fa-icon"})})]}),t(S,{fontWeight:"bold",children:d(at)})]})]})]}),l(T,{gap:1,className:Yt?"":"opacity-50 pointer-events-none",children:[t(S,{fontWeight:"bold",children:d("catalog.gift_wrapping.pick_color")}),t(er,{fullWidth:!0,children:C.map(pe=>t(L,{variant:"dark",active:pe.id===R,disabled:!Yt,style:{backgroundColor:pe.color},onClick:()=>y(pe.id)},pe.id))})]}),l(w,{justifyContent:"between",alignItems:"center",children:[t(L,{variant:"link",onClick:Ze,className:"text-black",children:d("cancel")}),t(L,{variant:"success",onClick:()=>Ot("buy"),children:d("catalog.gift_wrapping.give_gift")})]})]})]})},RT=a=>{const[e,n]=i.useState(""),{currentType:r=null,rootNode:o=null,offersToNodes:s=null,searchResult:c=null,setSearchResult:u=null,setCurrentPage:m=null}=xe();return i.useEffect(()=>{let h=e==null?void 0:e.toLocaleLowerCase().replace(" ","");if(!h||!h.length){u(null);return}const g=setTimeout(()=>{const f=H().getAllFurnitureData({loadFurnitureData:null});if(!f||!f.length)return;const _=[],E=[];for(const p of f){if(r===On.BUILDER&&!p.availableForBuildersClub||r===On.NORMAL&&p.excludeDynamic)continue;const b=[p.className,p.name,p.description].join(" ").replace(/ /gi,"").toLowerCase();if(r===On.BUILDER&&p.purchaseOfferId===-1&&p.rentOfferId===-1)p.furniLine!==""&&E.indexOf(p.furniLine)<0&&b.indexOf(h)>=0&&E.push(p.furniLine);else if([...xl(s,p.purchaseOfferId),...xl(s,p.rentOfferId)].length&&(b.indexOf(h)>=0&&_.push(p),_.length===250))break}const I=[];for(const p of _)I.push(new RC(p));let C=[];Ju(h,E,o,C),u(new kC(h,I,C.filter(p=>p.isVisible))),m(new Bi(-1,"default_3x3",new ed([],[]),I,!1,1))},300);return()=>clearTimeout(g)},[s,r,o,e,m,u]),l(w,{gap:1,children:[t(w,{fullWidth:!0,alignItems:"center",position:"relative",children:t("input",{type:"text",className:"form-control form-control-sm",placeholder:d("generic.search"),value:e,onChange:h=>n(h.target.value)})}),(!e||!e.length)&&t(L,{variant:"primary",className:"catalog-search-button",children:t(Di,{className:"fa-icon"})}),e&&!!e.length&&t(L,{variant:"primary",className:"catalog-search-button",onClick:h=>n(""),children:t(Cn,{className:"fa-icon"})})]})},Zd=a=>{const{node:e=null,child:n=!1}=a;return t(V,{children:e&&e.children.length>0&&e.children.map((r,o)=>r.isVisible?t(em,{node:r,child:n},o):null)})},em=a=>{const{node:e=null,child:n=!1}=a,{activateNode:r=null}=xe();return l(U,{className:"nitro-catalog-navigation-section",children:[l(be,{gap:1,column:!1,itemActive:e.isActive,onClick:o=>r(e),className:n?"inset":"",children:[t(Jd,{icon:e.iconId}),t(S,{grow:!0,truncate:!0,children:e.localization}),e.isBranch&&l(V,{children:[e.isOpen&&t(Oi,{className:"fa-icon"}),!e.isOpen&&t(Ai,{className:"fa-icon"})]})]}),e.isOpen&&e.isBranch&&t(Zd,{node:e,child:!0})]})},yT=a=>{const{node:e=null}=a,{searchResult:n=null}=xe();return l(V,{children:[t(RT,{}),t(T,{fullHeight:!0,className:"nitro-catalog-navigation-grid-container rounded p-1",overflow:"hidden",children:l(Ue,{id:"nitro-catalog-main-navigation",gap:1,columnCount:1,children:[n&&n.filteredNodes.length>0&&n.filteredNodes.map((r,o)=>t(em,{node:r},o)),!n&&t(Zd,{node:e})]})})]})},OT=a=>{const{columnCount:e=5,...n}=a,[r,o]=i.useState(!1),[s,c]=i.useState(null),{currentOffer:u=null,setPurchaseOptions:m=null}=xe(),{badgeCodes:h=[],activate:g=null,deactivate:f=null}=_o(),_=i.useMemo(()=>{if(!s)return null;const E=new Ks;return E.setValue(["0",s,"",""]),E},[s]);return i.useEffect(()=>{u&&m(E=>{const I={...E};return I.extraParamRequired=!0,I.extraData=_&&_.getValue(1)||null,I.previewStuffData=_,I})},[u,_,m]),i.useEffect(()=>{if(!r)return;const E=g();return()=>f(E)},[r,g,f]),i.useEffect(()=>(o(!0),()=>o(!1)),[]),t(Ue,{columnCount:e,...n,children:h&&h.length>0&&h.map((E,I)=>t(be,{itemActive:s===E,onClick:C=>c(E),children:t(je,{badgeCode:E})},I))})},Co=a=>{const{currentPage:e=null,setCurrentOffer:n=null}=xe();return i.useEffect(()=>{!e||!e.offers.length||n(e.offers[0])},[e,n]),null},al=a=>{const{offer:e=null,selectOffer:n=null,itemActive:r=!1,...o}=a,[s,c]=i.useState(!1),{requestOfferToMover:u=null}=xe(),{isVisible:m=!1}=es(),h=i.useMemo(()=>e.pricingModel===it.PRICING_MODEL_BUNDLE?null:e.product.getIconUrl(e),[e]),g=_=>{switch(_.type){case ye.MOUSE_DOWN:n(e),c(!0);return;case ye.MOUSE_UP:c(!1);return;case ye.ROLL_OUT:if(!s||!r||!m)return;u(e);return}},f=e.product;return f?t(be,{itemImage:h,itemCount:e.pricingModel===it.PRICING_MODEL_MULTI?f.productCount:1,itemUniqueSoldout:f.uniqueLimitedItemSeriesSize&&!f.uniqueLimitedItemsLeft,itemUniqueNumber:f.uniqueLimitedItemSeriesSize,itemActive:r,onMouseDown:g,onMouseUp:g,onMouseOut:g,...o,children:e.product.productType===ue.ROBOT&&t(st,{figure:e.product.extraParam,headOnly:!0,direction:3})}):null},oa=a=>{const{columnCount:e=5,children:n=null,...r}=a,{currentOffer:o=null,setCurrentOffer:s=null,currentPage:c=null,setPurchaseOptions:u=null}=xe(),m=i.useRef();if(i.useEffect(()=>{m&&m.current&&(m.current.scrollTop=0)},[c]),!c)return null;const h=g=>{g.activate(),!g.isLazy&&(s(g),g.product&&g.product.productType===ue.WALL&&u(f=>{const _={...f};return _.extraData=g.product.extraParam||null,_}))};return l(Ue,{innerRef:m,columnCount:e,...r,children:[c.offers&&c.offers.length>0&&c.offers.map((g,f)=>t(al,{itemActive:o&&o.offerId===g.offerId,offer:g,selectOffer:h},f)),n]})},bo=a=>{const{children:e=null,...n}=a,{currentOffer:r=null}=xe();return!r||r.pricingModel!==it.PRICING_MODEL_SINGLE||!r.product.isUniqueLimitedItem?null:l(U,{...n,children:[t(Bb,{className:"mx-auto",uniqueLimitedItemsLeft:r.product.uniqueLimitedItemsLeft,uniqueLimitedSeriesSize:r.product.uniqueLimitedItemSeriesSize}),e]})},Yn=a=>{const{noGiftOption:e=!1,purchaseCallback:n=null}=a;i.useState(!1);const[r,o]=i.useState(Be.NONE);sa(Zr.CATALOG_SKIP_PURCHASE_CONFIRMATION,!1);const{currentOffer:s=null,currentPage:c=null,purchaseOptions:u=null,setPurchaseOptions:m=null}=xe(),{getCurrencyAmount:h=null}=ts(),g=i.useCallback(I=>{switch(I.type){case pr.PURCHASE_SUCCESS:o(Be.NONE);return;case Kr.PURCHASE_FAILED:o(Be.FAILED);return;case eo.NOT_ALLOWED:o(Be.FAILED);return;case to.SOLD_OUT:o(Be.SOLD_OUT);return}},[]);ct(pr.PURCHASE_SUCCESS,g),ct(Kr.PURCHASE_FAILED,g),ct(eo.NOT_ALLOWED,g),ct(to.SOLD_OUT,g);const f=i.useMemo(()=>{if(!s||u.extraParamRequired&&(!u.extraData||!u.extraData.length))return!1;if(s.pricingModel===it.PRICING_MODEL_SINGLE){const I=s.product;if(I&&I.isUniqueLimitedItem)return!I.uniqueLimitedItemsLeft}return!1},[s,u]),_=(I=!1)=>{if(!s)return;if(In()<s.clubLevel){ee("habboUI/open/hccenter");return}if(I){St(new Qb(s.page.pageId,s.offerId,u.extraData));return}if(o(Be.PURCHASE),n){n();return}let C=s.page.pageId;M(new ao(C,s.offerId,u.extraData,u.quantity))};return i.useEffect(()=>{s&&o(Be.NONE)},[s,m]),i.useEffect(()=>{let I=null;return(r===Be.CONFIRM||r===Be.FAILED)&&(I=setTimeout(()=>o(Be.NONE),3e3)),()=>{I&&clearTimeout(I)}},[r]),s?l(V,{children:[t(()=>{const I=s.priceInCredits*u.quantity,C=s.priceInActivityPoints*u.quantity;if(In()<s.clubLevel)return t(L,{variant:"danger",disabled:!0,children:d("catalog.alert.hc.required")});if(f)return t(L,{variant:"danger",disabled:!0,children:d("catalog.alert.limited_edition_sold_out.title")});if(I>h(-1))return t(L,{variant:"danger",disabled:!0,children:d("catalog.alert.notenough.title")});if(C>h(s.activityPointType))return t(L,{variant:"danger",disabled:!0,children:d("catalog.alert.notenough.activitypoints.title."+s.activityPointType)});switch(r){case Be.CONFIRM:return t(L,{variant:"warning",onClick:p=>_(),children:d("catalog.marketplace.confirm_title")});case Be.PURCHASE:return t(L,{disabled:!0,children:t(Ji,{})});case Be.FAILED:return t(L,{variant:"danger",children:d("generic.failed")});case Be.SOLD_OUT:return t(L,{variant:"danger",children:d("generic.failed")+" - "+d("catalog.alert.limited_edition_sold_out.title")});case Be.NONE:default:return t(L,{disabled:u.extraParamRequired&&(!u.extraData||!u.extraData.length),onClick:p=>o(Be.CONFIRM),children:d("catalog.purchase_confirmation."+(s.isRentOffer?"rent":"buy"))})}},{}),!e&&!s.isRentOffer&&t(L,{disabled:u.quantity>1||!s.giftable||f||u.extraParamRequired&&(!u.extraData||!u.extraData.length),onClick:I=>_(!0),children:d("catalog.purchase_confirmation.gift")})]}):null},tm=a=>{const{offer:e=null,separator:n=!1}=a,{purchaseOptions:r=null}=xe(),{quantity:o=1}=r;return e?l(V,{children:[e.priceInCredits>0&&l(w,{alignItems:"center",gap:1,children:[t(S,{bold:!0,children:e.priceInCredits*o}),t(lt,{type:-1})]}),n&&e.priceInCredits>0&&e.priceInActivityPoints>0&&t(zs,{size:"xs",color:"black",className:"fa-icon"}),e.priceInActivityPoints>0&&l(w,{alignItems:"center",gap:1,children:[t(S,{bold:!0,children:e.priceInActivityPoints*o}),t(lt,{type:e.activityPointType})]})]}):null},Cr=a=>{const{gap:e=1,...n}=a,{currentOffer:r=null}=xe();return t(T,{gap:e,...n,children:t(tm,{offer:r})})},kr=a=>{const{currentOffer:e=null,roomPreviewer:n=null,purchaseOptions:r=null}=xe(),{previewStuffData:o=null}=r;return i.useEffect(()=>{if(!e||e.pricingModel===it.PRICING_MODEL_BUNDLE||!n)return;const s=e.product;if(s)switch(n.reset(!1),s.productType){case ue.FLOOR:{if(!s.furnitureData)return;if(s.furnitureData.specialType===Z.FIGURE_PURCHASABLE_SET){const u=H().getFloorItemData(s.furnitureData.id).customParams.split(",").map(g=>parseInt(g)),m=[];for(const g of u)Nt().isValidFigureSetForGender(g,H().gender)&&m.push(g);const h=Nt().getFigureStringWithFigureIds(H().figure,H().gender,m);n.addAvatarIntoRoom(h,s.productClassId)}else n.addFurnitureIntoRoom(s.productClassId,new Rt(90),o,s.extraParam);return}case ue.WALL:{if(!s.furnitureData)return;switch(s.furnitureData.specialType){case Z.FLOOR:n.updateObjectRoom(s.extraParam);return;case Z.WALL_PAPER:n.updateObjectRoom(null,s.extraParam);return;case Z.LANDSCAPE:{n.updateObjectRoom(null,null,s.extraParam);const c=H().getWallItemDataByName("window_double_default");c&&n.addWallItemIntoRoom(c.id,new Rt(90),c.customParams);return}default:n.updateObjectRoom("default","default","default"),n.addWallItemIntoRoom(s.productClassId,new Rt(90),s.extraParam);return}}case ue.ROBOT:n.addAvatarIntoRoom(s.extraParam,0);return;case ue.EFFECT:n.addAvatarIntoRoom(H().figure,s.productClassId);return}},[e,o,n]),e?e.pricingModel===it.PRICING_MODEL_BUNDLE?t(T,{fit:!0,overflow:"hidden",className:"bg-muted p-2 rounded",children:t(Ue,{fullWidth:!0,columnCount:4,className:"nitro-catalog-layout-bundle-grid",children:e.products.length>0&&e.products.map((s,c)=>t(be,{itemImage:s.getIconUrl(e),itemCount:s.productCount},c))})}):t(mo,{roomPreviewer:n,height:140}):null},AT=a=>{const{page:e=null}=a,{currentOffer:n=null}=xe();return l(V,{children:[t(Co,{}),l(ne,{children:[l(T,{size:7,overflow:"hidden",children:[t(oa,{shrink:!0}),l(T,{gap:1,overflow:"hidden",children:[t(S,{truncate:!0,shrink:!0,fontWeight:"bold",children:d("catalog_selectbadge")}),t(OT,{})]})]}),l(T,{center:!n,size:5,overflow:"hidden",children:[!n&&l(V,{children:[!!e.localization.getImage(1)&&t("img",{alt:"",src:e.localization.getImage(1)}),t(S,{center:!0,dangerouslySetInnerHTML:{__html:e.localization.getText(0)}})]}),n&&l(V,{children:[t(U,{position:"relative",overflow:"hidden",children:t(kr,{})}),l(T,{grow:!0,gap:1,children:[t(bo,{fullWidth:!0}),t(S,{grow:!0,truncate:!0,children:n.localizationName}),t(w,{justifyContent:"end",children:t(Cr,{alignItems:"end"})}),t(Yn,{})]})]})]})]})]})},Or=a=>{const{...e}=a,{currentOffer:n=null}=xe();return!n||!n.badgeCode||!n.badgeCode.length?null:t(je,{badgeCode:n.badgeCode,...e})},kT=1,PT=100,ol=a=>{const{currentOffer:e=null,purchaseOptions:n=null,setPurchaseOptions:r=null}=xe(),{quantity:o=1}=n,s=c=>{isNaN(c)&&(c=1),c=Math.max(c,kT),c=Math.min(c,PT),c!==o&&r(u=>{const m={...u};return m.quantity=c,m})};return!e||!e.bundlePurchaseAllowed?null:l(V,{children:[t(S,{children:d("catalog.bundlewidget.spinner.select.amount")}),l(w,{alignItems:"center",gap:1,children:[t(iu,{className:"text-black cursor-pointer fa-icon",onClick:c=>s(o-1)}),t("input",{type:"number",className:"form-control form-control-sm quantity-input",value:o,onChange:c=>s(c.target.valueAsNumber)}),t(lu,{className:"text-black cursor-pointer fa-icon",onClick:c=>s(o+1)})]})]})},DT=a=>{const{page:e=null}=a,[n,r]=i.useState(new Map),{currentOffer:o=null,setCurrentOffer:s=null}=xe(),[c,u]=i.useState(!1),m=(E,I)=>!E.product.furnitureData.colorIndex||!I.product.furnitureData.colorIndex||E.product.furnitureData.colorIndex>I.product.furnitureData.colorIndex?1:E==I?0:-1,h=(E,I)=>E.product.furnitureData.className>I.product.furnitureData.className?1:E==I?0:-1,g=E=>{E.activate(),s(E)},f=(E,I)=>{const C=`${I}*${E}`,p=e.offers.findIndex(b=>b.product.furnitureData.fullName===C);p>-1&&g(e.offers[p])},_=i.useMemo(()=>{const E=[],I=new Map,C=new Map;return e.offers.sort(m),e.offers.forEach(p=>{if(!p.product)return;const b=p.product.furnitureData;if(!b||!b.hasIndexedColor)E.push(p);else{const N=b.className,v=b.colorIndex;C.has(N)||C.set(N,[]);let O=16777215;if(b.colors){for(let R of b.colors)R!==16777215&&(O=R);C.get(N).indexOf(O)===-1&&(C.get(N)[v]=O)}I.has(N)||(E.push(p),I.set(N,!0))}}),E.sort(h),r(C),E},[e.offers]);return l(ne,{children:[t(T,{size:7,overflow:"hidden",children:l(Ue,{columnCount:5,children:[(!c||!o||!n.has(o.product.furnitureData.className))&&_.map((E,I)=>t(al,{itemActive:o&&(o.product.furnitureData.hasIndexedColor?o.product.furnitureData.className===E.product.furnitureData.className:o.offerId===E.offerId),offer:E,selectOffer:g},I)),c&&o&&n.has(o.product.furnitureData.className)&&n.get(o.product.furnitureData.className).map((E,I)=>t(be,{itemHighlight:!0,itemActive:o.product.furnitureData.colorIndex===I,itemColor:ln.int2rgb(E),className:"clear-bg",onClick:C=>f(I,o.product.furnitureData.className)},I))]})}),l(T,{center:!o,size:5,overflow:"hidden",children:[!o&&l(V,{children:[!!e.localization.getImage(1)&&t("img",{alt:"",src:e.localization.getImage(1)}),t(S,{center:!0,dangerouslySetInnerHTML:{__html:e.localization.getText(0)}})]}),o&&l(V,{children:[l(U,{position:"relative",overflow:"hidden",children:[t(kr,{}),t(Or,{position:"absolute",className:"bg-muted rounded bottom-1 end-1"}),o.product.furnitureData.hasIndexedColor&&t(L,{position:"absolute",className:"bottom-1 start-1",onClick:E=>u(I=>!I),children:t(cu,{className:"fa-icon"})})]}),l(T,{grow:!0,gap:1,children:[t(bo,{fullWidth:!0}),t(S,{grow:!0,truncate:!0,children:o.localizationName}),l(w,{justifyContent:"between",children:[t(T,{gap:1,children:t(ol,{})}),t(Cr,{justifyContent:"end",alignItems:"end"})]}),t(Yn,{})]})]})]})]})},nm=a=>{const{imageUrl:e=null}=a,[n,r]=i.useState("");return i.useEffect(()=>{r(e??K("catalog.asset.image.url").replace("%name%","catalog_header_roombuilder"))},[e]),t(w,{center:!0,fullWidth:!0,className:"nitro-catalog-header",children:t("img",{src:n,onError:({currentTarget:o})=>{o.src=K("catalog.asset.image.url").replace("%name%","catalog_header_roombuilder")}})})},MT=a=>{const{page:e=null}=a,{currentOffer:n=null,currentPage:r=null}=xe();return t(V,{children:l(ne,{children:[l(T,{size:7,overflow:"hidden",children:[K("catalog.headers")&&t(nm,{imageUrl:r.localization.getImage(0)}),t(oa,{})]}),l(T,{center:!n,size:5,overflow:"hidden",children:[!n&&l(V,{children:[!!e.localization.getImage(1)&&t(sr,{imageUrl:e.localization.getImage(1)}),t(S,{center:!0,dangerouslySetInnerHTML:{__html:e.localization.getText(0)}})]}),n&&l(V,{children:[l(w,{center:!0,overflow:"hidden",style:{height:140},children:[n.product.productType!==ue.BADGE&&l(V,{children:[t(kr,{}),t(Or,{className:"bg-muted rounded bottom-1 end-1"})]}),n.product.productType===ue.BADGE&&t(Or,{className:"scale-2"})]}),l(T,{grow:!0,gap:1,children:[t(bo,{fullWidth:!0}),t(S,{grow:!0,truncate:!0,children:n.localizationName}),l(w,{justifyContent:"between",children:[t(T,{gap:1,children:t(ol,{})}),t(Cr,{justifyContent:"end",alignItems:"end"})]}),t(Yn,{})]})]})]})]})})},LT=a=>{const{...e}=a,{currentOffer:n=null,purchaseOptions:r=null}=xe(),{previewStuffData:o=null}=r,s=i.useMemo(()=>{if(!n||!o)return null;const c=o.getValue(2);return!c||!c.length?null:c},[n,o]);return s?t(je,{badgeCode:s,isGroup:!0,...e}):null},rm=a=>{const[e,n]=i.useState(0),{currentOffer:r=null,catalogOptions:o=null,setPurchaseOptions:s=null}=xe(),{groups:c=null}=o,u=i.useMemo(()=>{if(!c||!c.length)return null;const h=c[e];if(!h)return null;const g=new Ks;return g.setValue(["0",h.groupId.toString(),h.badgeCode,h.colorA,h.colorB]),g},[e,c]);if(i.useEffect(()=>{r&&s(h=>{const g={...h};return g.extraParamRequired=!0,g.extraData=u&&u.getValue(1)||null,g.previewStuffData=u,g})},[r,u,s]),i.useEffect(()=>{M(new Uu)},[]),!c||!c.length)return l(U,{className:"bg-muted rounded p-1 text-black text-center",children:[d("catalog.guild_selector.members_only"),t(L,{className:"mt-1",children:d("catalog.guild_selector.find_groups")})]});const m=c[e];return l(w,{gap:1,children:[!!m&&l(w,{overflow:"hidden",className:"rounded border",children:[t(U,{fullHeight:!0,style:{width:"20px",backgroundColor:"#"+m.colorA}}),t(U,{fullHeight:!0,style:{width:"20px",backgroundColor:"#"+m.colorB}})]}),t("select",{className:"form-select form-select-sm",value:e,onChange:h=>n(parseInt(h.target.value)),children:c.map((h,g)=>t("option",{value:g,children:h.groupName},g))})]})},UT=a=>{const{page:e=null}=a,{currentOffer:n=null}=xe();return l(ne,{children:[t(T,{size:7,overflow:"hidden",children:t(oa,{})}),l(T,{center:!n,size:5,overflow:"hidden",children:[!n&&l(V,{children:[!!e.localization.getImage(1)&&t("img",{alt:"",src:e.localization.getImage(1)}),t(S,{center:!0,dangerouslySetInnerHTML:{__html:e.localization.getText(0)}})]}),n&&l(V,{children:[l(U,{position:"relative",overflow:"hidden",children:[t(kr,{}),t(LT,{position:"absolute",className:"bottom-1 end-1"})]}),l(T,{grow:!0,gap:1,children:[t(S,{truncate:!0,children:n.localizationName}),t(U,{grow:!0,children:t(rm,{})}),t(w,{justifyContent:"end",children:t(Cr,{alignItems:"end"})}),t(Yn,{})]})]})]})]})},xT=a=>{const{page:e=null}=a;i.useState(0);const{currentOffer:n=null,setCurrentOffer:r=null,catalogOptions:o=null}=xe();return i.useEffect(()=>{M(new Uu)},[e]),l(V,{children:[t(Co,{}),l(ne,{children:[t(T,{className:"bg-muted rounded p-2 text-black",size:7,overflow:"hidden",children:t(U,{className:"overflow-auto",dangerouslySetInnerHTML:{__html:e.localization.getText(1)}})}),t(T,{size:5,overflow:"hidden",gap:1,children:!!n&&t(V,{children:l(T,{grow:!0,gap:1,children:[t(S,{truncate:!0,children:n.localizationName}),t(U,{grow:!0,children:t(rm,{})}),t(w,{justifyContent:"end",children:t(Cr,{alignItems:"end"})}),t(Yn,{noGiftOption:!0})]})})})]})]})},FT=a=>{const{page:e=null}=a;return l(ne,{children:[l(T,{size:7,overflow:"hidden",className:"bg-muted rounded p-2 text-black",children:[t(U,{dangerouslySetInnerHTML:{__html:e.localization.getText(2)}}),t(U,{overflow:"auto",dangerouslySetInnerHTML:{__html:e.localization.getText(0)}}),t(U,{dangerouslySetInnerHTML:{__html:e.localization.getText(1)}})]}),l(T,{center:!0,size:5,overflow:"hidden",children:[t(sr,{imageUrl:e.localization.getImage(1)}),t(L,{onClick:()=>ee("groups/create"),children:d("catalog.start.guild.purchase.button")})]})]})},GT=a=>{const{page:e=null}=a;return t("div",{className:"h-100 nitro-catalog-layout-info-loyalty text-black d-flex flex-row",children:t("div",{className:"overflow-auto h-100 d-flex flex-column info-loyalty-content",children:t("div",{dangerouslySetInnerHTML:{__html:e.localization.getText(0)}})})})},sm=a=>{const{page:e=null}=a,n=e.localization.getImage(1);return l(T,{grow:!0,className:"bg-muted rounded text-black p-2",overflow:"hidden",children:[l(w,{alignItems:"center",gap:2,children:[n&&t("img",{alt:"",src:n}),t(U,{className:"fs-5",dangerouslySetInnerHTML:{__html:e.localization.getText(1)}})]}),t(T,{grow:!0,alignItems:"center",overflow:"auto",children:t(U,{dangerouslySetInnerHTML:{__html:e.localization.getText(2)}})}),t(w,{alignItems:"center",children:t(U,{className:"fw-bold",dangerouslySetInnerHTML:{__html:e.localization.getText(3)}})})]})},BT=a=>t(sm,{...a}),VT=a=>{const{page:e=null}=a,[n,r]=i.useState(""),[o,s]=i.useState(""),[c,u]=i.useState(-1),[m,h]=i.useState([]),[g,f]=i.useState(!1),[_,E]=i.useState(1),{categories:I=null}=Ln(),{setIsVisible:C=null}=xe(),{promoteInformation:p,isExtended:b,setIsExtended:N}=sl();i.useEffect(()=>{b&&(u(p.data.flatId),r(p.data.eventName),s(p.data.eventDescription),E(p.data.categoryId),f(b),N(!1))},[b,n,o,_]);const v=()=>{u(-1),r(""),s(""),E(1),N(!1),C(!1)},O=()=>{const R=e.pageId,y=e.offers.length>=1?e.offers[0].offerId:-1,F=c,P=n,D=o,A=_;M(new oI(R,y,F,P,g,D,A)),v()};return x(sI,R=>{const y=R.getParser();y&&h(y.rooms)}),i.useEffect(()=>{M(new aI),M(new wu)},[]),l(V,{children:[t(S,{bold:!0,center:!0,children:d("roomad.catalog_header")}),l(T,{size:12,overflow:"hidden",className:"text-black",children:[t(U,{children:d("roomad.catalog_text",["duration"],["120"])}),l(U,{className:"bg-muted rounded p-1",children:[l(T,{gap:2,children:[t(S,{bold:!0,children:d("navigator.category")}),t("select",{className:"form-select form-select-sm",value:_,onChange:R=>E(parseInt(R.target.value)),disabled:g,children:I&&I.map((R,y)=>t("option",{value:R.id,children:d(R.name)},y))})]}),l(T,{gap:1,children:[t(S,{bold:!0,children:d("roomad.catalog_name")}),t("input",{type:"text",className:"form-control form-control-sm",maxLength:64,value:n,onChange:R=>r(R.target.value),readOnly:g})]}),l(T,{gap:1,children:[t(S,{bold:!0,children:d("roomad.catalog_description")}),t("textarea",{className:"form-control form-control-sm",maxLength:64,value:o,onChange:R=>s(R.target.value),readOnly:g})]}),l(T,{gap:1,children:[t(S,{bold:!0,children:d("roomad.catalog_roomname")}),l("select",{className:"form-select form-select-sm",value:c,onChange:R=>u(parseInt(R.target.value)),disabled:g,children:[t("option",{value:-1,disabled:!0,children:d("roomad.catalog_roomname")}),m&&m.map((R,y)=>t("option",{value:R.roomId,children:R.roomName},y))]})]}),t(T,{gap:1,children:t(L,{variant:!n||!o||c===-1?"danger":"success",onClick:O,disabled:!n||!o||c===-1,children:d(g?"roomad.extend.event":"buy")})})]})]})]})},am=a=>{const{columnCount:e=5,children:n=null,...r}=a,{currentOffer:o=null}=xe(),s=i.useRef();return i.useEffect(()=>{s&&s.current&&(s.current.scrollTop=0)},[o]),o?l(Ue,{innerRef:s,columnCount:5,...r,children:[o.products&&o.products.length>0&&o.products.map((c,u)=>t(be,{itemImage:c.getIconUrl(),itemCount:c.productCount},u)),n]}):null},om=a=>{const{gap:e=1,...n}=a,{currentOffer:r=null}=xe();return t(w,{gap:e,alignItems:"center",classNames:["bg-muted","p-1","rounded"],...n,children:t(tm,{separator:!0,offer:r})})},HT=a=>{const{page:e=null}=a;return l(V,{children:[t(Co,{}),l(ne,{children:[l(T,{size:7,overflow:"hidden",children:[!!e.localization.getText(2)&&t(S,{dangerouslySetInnerHTML:{__html:e.localization.getText(2)}}),t(T,{grow:!0,overflow:"hidden",className:"bg-muted p-2 rounded",children:t(am,{fullWidth:!0,className:"nitro-catalog-layout-bundle-grid"})})]}),l(T,{size:5,overflow:"hidden",gap:1,children:[!!e.localization.getText(1)&&t(S,{center:!0,small:!0,overflow:"auto",children:e.localization.getText(1)}),l(T,{grow:!0,position:"relative",overflow:"hidden",gap:0,children:[!!e.localization.getImage(1)&&t("img",{alt:"",className:"flex-grow-1",src:e.localization.getImage(1)}),t(Or,{position:"absolute",className:"bg-muted rounded bottom-0 start-0"}),t(om,{position:"absolute",className:"bottom-0 end-0"})]}),t(T,{gap:1,children:t(Yn,{})})]})]})]})},WT=a=>{const{page:e=null}=a;return l(V,{children:[t(Co,{}),l(ne,{children:[l(T,{size:7,overflow:"hidden",children:[!!e.localization.getText(2)&&t(S,{dangerouslySetInnerHTML:{__html:e.localization.getText(2)}}),t(T,{grow:!0,overflow:"hidden",className:"bg-muted p-2 rounded",children:t(am,{fullWidth:!0,className:"nitro-catalog-layout-bundle-grid"})})]}),l(T,{size:5,overflow:"hidden",gap:1,children:[!!e.localization.getText(1)&&t(S,{center:!0,small:!0,overflow:"auto",children:e.localization.getText(1)}),l(T,{grow:!0,position:"relative",overflow:"hidden",gap:0,children:[!!e.localization.getImage(1)&&t("img",{alt:"",className:"flex-grow-1",src:e.localization.getImage(1)}),t(Or,{position:"absolute",className:"bg-muted rounded bottom-0 start-0"}),t(om,{position:"absolute",className:"bottom-0 end-0"})]}),t(T,{gap:1,children:t(Yn,{})})]})]})]})},jT=a=>{const{page:e=null}=a,[n,r]=i.useState(-1),[o,s]=i.useState(""),{currentOffer:c=null,currentPage:u=null}=xe(),m=h=>{var g;return(g=_e().soundManager.musicController)==null?void 0:g.playSong(h,Ds.PRIORITY_PURCHASE_PREVIEW,15,0,0,0)};return x(iI,h=>{const g=h.getParser();g.officialSongId===o&&r(g.songId)}),i.useEffect(()=>{if(!c)return;const h=c.product;if(h){if(h.extraParam.length>0){const g=parseInt(h.extraParam);g>0?r(g):(s(h.extraParam),M(new lI(h.extraParam)))}else s(""),r(-1);return()=>{var g;return(g=_e().soundManager.musicController)==null?void 0:g.stop(Ds.PRIORITY_PURCHASE_PREVIEW)}}},[c]),i.useEffect(()=>()=>{var h;return(h=_e().soundManager.musicController)==null?void 0:h.stop(Ds.PRIORITY_PURCHASE_PREVIEW)},[]),t(V,{children:l(ne,{children:[l(T,{size:7,overflow:"hidden",children:[K("catalog.headers")&&t(nm,{imageUrl:u.localization.getImage(0)}),t(oa,{})]}),l(T,{center:!c,size:5,overflow:"hidden",children:[!c&&l(V,{children:[!!e.localization.getImage(1)&&t(sr,{imageUrl:e.localization.getImage(1)}),t(S,{center:!0,dangerouslySetInnerHTML:{__html:e.localization.getText(0)}})]}),c&&l(V,{children:[l(w,{center:!0,overflow:"hidden",style:{height:140},children:[c.product.productType!==ue.BADGE&&l(V,{children:[t(kr,{}),t(Or,{className:"bg-muted rounded bottom-1 end-1"})]}),c.product.productType===ue.BADGE&&t(Or,{className:"scale-2"})]}),l(T,{grow:!0,gap:1,children:[t(bo,{fullWidth:!0}),t(S,{grow:!0,truncate:!0,children:c.localizationName}),n>-1&&t(L,{onClick:()=>m(n),children:d("play_preview_button")}),l(w,{justifyContent:"between",children:[t(T,{gap:1,children:t(ol,{})}),t(Cr,{justifyContent:"end",alignItems:"end"})]}),t(Yn,{})]})]})]})]})})},qT=["floors","walls","views"],YT=a=>{const{columnCount:e=5,children:n=null,...r}=a,[o,s]=i.useState(null),[c,u]=i.useState(-1),[m,h]=i.useState(null),{currentPage:g=null,currentOffer:f=null,setCurrentOffer:_=null,setPurchaseOptions:E=null}=xe(),I=i.useRef(),C=b=>{b&&h(N=>{const v=[...N];return v[c]=b,v})};if(i.useEffect(()=>{if(!g)return;const b=[[],[],[]];for(const N of g.offers){if(N.pricingModel!==it.PRICING_MODEL_SINGLE&&N.pricingModel!==it.PRICING_MODEL_MULTI)continue;const v=N.product;if(!v||v.productType!==ue.WALL&&v.productType!==ue.FLOOR||!v.furnitureData)continue;switch(v.furnitureData.className){case"floor":b[0].push(N);break;case"wallpaper":b[1].push(N);break;case"landscape":b[2].push(N);break}}s(b),u(0),h([b[0][0],b[1][0],b[2][0]])},[g]),i.useEffect(()=>{c===-1||!m||_(m[c])},[c,m,_]),i.useEffect(()=>{c===-1||!m||!f||E(b=>{const N={...b};return N.extraData=m[c].product.extraParam,N.extraParamRequired=!0,N})},[f,c,m,E]),i.useEffect(()=>{I&&I.current&&(I.current.scrollTop=0)},[c]),!o||c===-1)return null;const p=o[c];return l(V,{children:[t(er,{children:qT.map((b,N)=>t(L,{active:c===N,onClick:v=>u(N),children:d(`catalog.spaces.tab.${b}`)},N))}),l(Ue,{innerRef:I,columnCount:e,...r,children:[p&&p.length>0&&p.map((b,N)=>t(al,{itemActive:f&&f===b,offer:b,selectOffer:v=>C(v)},N)),n]})]})},zT=a=>{const{page:e=null}=a,{currentOffer:n=null,roomPreviewer:r=null}=xe();return i.useEffect(()=>{r.updatePreviewObjectBoundingRectangle(new vr)},[r]),l(ne,{children:[t(T,{size:7,overflow:"hidden",children:t(YT,{})}),l(T,{center:!n,size:5,overflow:"hidden",children:[!n&&l(V,{children:[!!e.localization.getImage(1)&&t("img",{alt:"",src:e.localization.getImage(1)}),t(S,{center:!0,dangerouslySetInnerHTML:{__html:e.localization.getText(0)}})]}),n&&l(V,{children:[t(U,{position:"relative",overflow:"hidden",children:t(kr,{})}),l(T,{grow:!0,gap:1,children:[t(S,{grow:!0,truncate:!0,children:n.localizationName}),t(w,{justifyContent:"end",children:t(Cr,{alignItems:"end"})}),t(Yn,{})]})]})]})]})},$T=a=>{const{page:e=null}=a,[n,r]=i.useState(""),{currentOffer:o=null,setPurchaseOptions:s=null}=xe();return i.useEffect(()=>{o&&s(c=>{const u={...c};return u.extraData=n,u})},[o,n,s]),l(ne,{children:[l(T,{size:7,overflow:"hidden",children:[t(oa,{}),t("textarea",{className:"flex-grow-1 form-control w-100",defaultValue:n||"",onChange:c=>r(c.target.value)})]}),l(T,{center:!o,size:5,overflow:"hidden",children:[!o&&l(V,{children:[!!e.localization.getImage(1)&&t("img",{alt:"",src:e.localization.getImage(1)}),t(S,{center:!0,dangerouslySetInnerHTML:{__html:e.localization.getText(0)}})]}),o&&l(V,{children:[t(kr,{}),l(T,{grow:!0,gap:1,children:[t(S,{grow:!0,truncate:!0,children:o.localizationName}),t(w,{justifyContent:"end",children:t(Cr,{alignItems:"end"})}),t(Yn,{})]})]})]})]})},KT=a=>{const[e,n]=i.useState(null),[r,o]=i.useState(Be.NONE),{currentPage:s=null,catalogOptions:c=null}=xe(),{purse:u=null,getCurrencyAmount:m=null}=ts(),{clubOffers:h=null}=c,g=i.useCallback(N=>{switch(N.type){case pr.PURCHASE_SUCCESS:o(Be.NONE);return;case Kr.PURCHASE_FAILED:o(Be.FAILED);return}},[]);ct(pr.PURCHASE_SUCCESS,g),ct(Kr.PURCHASE_FAILED,g);const f=i.useCallback(N=>{let v="";return N.months>0&&(v=d("catalog.vip.item.header.months",["num_months"],[N.months.toString()])),N.extraDays>0&&(v!==""&&(v+=" "),v+=" "+d("catalog.vip.item.header.days",["num_days"],[N.extraDays.toString()])),v},[]),_=i.useCallback(()=>{if(!u)return"";const N=u.clubDays>0||u.clubPeriods>0?"extension.":"subscription.",v=e.months===0?"days":"months",O=e.months===0?e.extraDays:e.months;return d("catalog.vip.buy.confirm."+N+v).replace("%NUM_"+v.toUpperCase()+"%",O.toString())},[e,u]),E=i.useCallback(()=>{let N=d("catalog.vip.buy.confirm.end_date");return N=N.replace("%month%",e.month.toString()),N=N.replace("%day%",e.day.toString()),N=N.replace("%year%",e.year.toString()),N},[e]),I=i.useMemo(()=>{const N=u.clubDays,O=u.clubPeriods*31+N;return d("catalog.vip.extend.info",["days"],[O.toString()])},[u]),C=i.useCallback(()=>{e&&(o(Be.PURCHASE),M(new ao(s.pageId,e.offerId,null,1)))},[e,s]),p=i.useCallback(N=>{o(Be.NONE),n(N)},[]),b=i.useCallback(()=>{if(!e)return null;if(e.priceCredits>m(-1))return t(L,{fullWidth:!0,variant:"danger",children:d("catalog.alert.notenough.title")});if(e.priceActivityPoints>m(e.priceActivityPointsType))return t(L,{fullWidth:!0,variant:"danger",children:d("catalog.alert.notenough.activitypoints.title."+e.priceActivityPointsType)});switch(r){case Be.CONFIRM:return t(L,{fullWidth:!0,variant:"warning",onClick:C,children:d("catalog.marketplace.confirm_title")});case Be.PURCHASE:return t(L,{fullWidth:!0,variant:"primary",disabled:!0,children:t(Ji,{})});case Be.FAILED:return t(L,{fullWidth:!0,variant:"danger",disabled:!0,children:d("generic.failed")});case Be.NONE:default:return t(L,{fullWidth:!0,variant:"success",onClick:()=>o(Be.CONFIRM),children:d("buy")})}},[e,r,C,m]);return i.useEffect(()=>{h||M(new cI(1))},[h]),l(ne,{children:[l(T,{fullHeight:!0,size:7,overflow:"hidden",justifyContent:"between",children:[t(Ue,{columnCount:1,className:"nitro-catalog-layout-vip-buy-grid",children:h&&h.length>0&&h.map((N,v)=>l(be,{column:!1,center:!1,alignItems:"center",justifyContent:"between",itemActive:e===N,className:"p-1",onClick:()=>p(N),children:[t("i",{className:"icon-hc-banner"}),l(T,{justifyContent:"end",gap:0,children:[t(S,{textEnd:!0,children:f(N)}),l(w,{justifyContent:"end",gap:1,children:[N.priceCredits>0&&l(w,{alignItems:"center",justifyContent:"end",gap:1,children:[t(S,{children:N.priceCredits}),t(lt,{type:-1})]}),N.priceActivityPoints>0&&l(w,{alignItems:"center",justifyContent:"end",gap:1,children:[t(S,{children:N.priceActivityPoints}),t(lt,{type:N.priceActivityPointsType})]})]})]})]},v))}),t(S,{center:!0,dangerouslySetInnerHTML:{__html:d("catalog.vip.buy.hccenter")}})]}),l(T,{size:5,overflow:"hidden",children:[l(T,{fullHeight:!0,center:!0,overflow:"hidden",children:[s.localization.getImage(1)&&t("img",{alt:"",src:s.localization.getImage(1)}),t(S,{center:!0,overflow:"auto",dangerouslySetInnerHTML:{__html:I}})]}),e&&l(T,{fullWidth:!0,grow:!0,justifyContent:"end",children:[l(w,{alignItems:"end",children:[l(T,{grow:!0,gap:0,children:[t(S,{fontWeight:"bold",children:_()}),t(S,{children:E()})]}),l(T,{gap:1,children:[e.priceCredits>0&&l(w,{alignItems:"center",justifyContent:"end",gap:1,children:[t(S,{children:e.priceCredits}),t(lt,{type:-1})]}),e.priceActivityPoints>0&&l(w,{alignItems:"center",justifyContent:"end",gap:1,children:[t(S,{children:e.priceActivityPoints}),t(lt,{type:e.priceActivityPointsType})]})]})]}),b()]})]})]})},XT=a=>{const{text:e=null}=a,[n,r]=i.useState(""),[o,s]=i.useState(!1),{simpleAlert:c=null}=Xe(),u=()=>{!n||!n.length||o||(M(new mI(n)),s(!0))};return x(uI,m=>{const h=m.getParser();let g=d("catalog.alert.voucherredeem.ok.description");h.productName&&(g=d("catalog.alert.voucherredeem.ok.description.furni",["productName","productDescription"],[h.productName,h.productDescription])),c(g,null,null,null,d("catalog.alert.voucherredeem.ok.title")),s(!1),r("")}),x(dI,m=>{const h=m.getParser();c(d(`catalog.alert.voucherredeem.error.description.${h.errorCode}`),null,null,null,d("catalog.alert.voucherredeem.error.title")),s(!1)}),l(w,{gap:1,children:[t("input",{type:"text",className:"form-control form-control-sm",placeholder:e,value:n,onChange:m=>r(m.target.value)}),t(L,{variant:"primary",onClick:u,disabled:o,children:t(km,{className:"fa-icon"})})]})},va=a=>{const{item:e=null,position:n="relative",pointer:r=!0,overflow:o="hidden",fullHeight:s=!0,classNames:c=[],children:u=null,...m}=a,h=i.useMemo(()=>{const f=["rounded","nitro-front-page-item"];return c.length&&f.push(...c),f},[c]);if(!e)return null;const g=K("image.library.url")+e.itemPromoImage;return l(Rd,{imageUrl:g,classNames:h,position:n,fullHeight:s,pointer:r,overflow:o,...m,children:[t(S,{position:"absolute",variant:"white",className:"bg-dark rounded p-2 m-2 bottom-0",children:e.itemName}),u]})},QT=a=>{const{page:e=null,hideNavigation:n=null}=a,{frontPageItems:r=[]}=xe(),o=i.useCallback(s=>{switch(s.type){case vl.ITEM_CATALOGUE_PAGE:ee(`catalog/open/${s.catalogPageLocation}`);return;case vl.ITEM_PRODUCT_OFFER:ee(`catalog/open/${s.productOfferId}`);return}},[]);return i.useEffect(()=>{n()},[e,n]),l(ne,{children:[t(T,{size:4,children:r[0]&&t(va,{item:r[0],onClick:s=>o(r[0])})}),l(T,{size:8,children:[r[1]&&t(va,{item:r[1],onClick:s=>o(r[1])}),r[2]&&t(va,{item:r[2],onClick:s=>o(r[2])}),r[3]&&t(va,{item:r[3],onClick:s=>o(r[3])}),t(XT,{text:e.localization.getText(1)})]})]})},yi=1,Ga=2,im=a=>{const{offerData:e=null,type:n=Ga,onClick:r=null}=a,o=i.useMemo(()=>e?d((e.furniType===2?"wallItem":"roomItem")+`.name.${e.furniId}`):"",[e]),s=i.useCallback(()=>{if(!e)return"";if(e.status===$r.SOLD)return d("catalog.marketplace.offer.sold");if(e.timeLeftMinutes<=0)return d("catalog.marketplace.offer.expired");const c=Math.max(1,e.timeLeftMinutes),u=Math.floor(c/60);let h=c-u*60+" "+d("catalog.marketplace.offer.minutes");return u>0&&(h=u+" "+d("catalog.marketplace.offer.hours")+" "+h),d("catalog.marketplace.offer.time_left",["time"],[h])},[e]);return l(be,{shrink:!0,center:!1,column:!1,alignItems:"center",className:"p-1",children:[t(T,{style:{width:40,height:40},children:t(be,{column:!1,itemImage:yC(e.furniType===Qs.TYPE_FLOOR?ue.FLOOR:ue.WALL,e.furniId,e.extraData),itemUniqueNumber:e.isUniqueLimitedItem?e.stuffData.uniqueNumber:0})}),l(T,{grow:!0,gap:0,children:[t(S,{fontWeight:"bold",children:o}),n===yi&&l(V,{children:[t(S,{children:d("catalog.marketplace.offer.price_own_item",["price"],[e.price.toString()])}),t(S,{children:s()})]}),n===Ga&&l(V,{children:[t(S,{children:d("catalog.marketplace.offer.price_public_item",["price","average"],[e.price.toString(),e.averagePrice>0?e.averagePrice.toString():"-"])}),t(S,{children:d("catalog.marketplace.offer_count",["count"],[e.offerCount.toString()])})]})]}),l(T,{gap:1,children:[n===yi&&e.status!==$r.SOLD&&t(L,{variant:"secondary",onClick:()=>r(e),children:d("catalog.marketplace.offer.pick")}),n===Ga&&l(V,{children:[t(L,{variant:"secondary",onClick:()=>r(e),children:d("buy")}),t(L,{variant:"secondary",disabled:!0,children:d("catalog.marketplace.view_more")})]})]})]})},JT=a=>{const[e,n]=i.useState(0),[r,o]=i.useState([]),{simpleAlert:s=null}=Xe();x(gI,h=>{const g=h.getParser();if(!g)return;const f=g.offers.map(_=>{const E=new Qs(_.offerId,_.furniId,_.furniType,_.extraData,_.stuffData,_.price,_.status,_.averagePrice,_.offerCount);return E.timeLeftMinutes=_.timeLeftMinutes,E});n(g.creditsWaiting),o(f)}),x(hI,h=>{const g=h.getParser();if(g){if(!g.success){s(d("catalog.marketplace.cancel_failed"),de.DEFAULT,null,null,d("catalog.marketplace.operation_failed.topic"));return}o(f=>f.filter(_=>_.offerId!==g.offerId))}});const c=i.useMemo(()=>r.filter(h=>h.status===$r.SOLD),[r]),u=i.useCallback(()=>{o(h=>{const g=c.map(f=>f.offerId);return h.filter(f=>g.indexOf(f.offerId)===-1)}),M(new fI)},[c]),m=h=>{M(new II(h.offerId))};return i.useEffect(()=>{M(new pI)},[]),l(T,{overflow:"hidden",children:[e<=0&&t(S,{center:!0,className:"bg-muted rounded p-1",children:d("catalog.marketplace.redeem.no_sold_items")}),e>0&&l(T,{center:!0,gap:1,className:"bg-muted rounded p-2",children:[t(S,{children:d("catalog.marketplace.redeem.get_credits",["count","credits"],[c.length.toString(),e.toString()])}),t(L,{className:"mt-1",onClick:u,children:d("catalog.marketplace.offer.redeem")})]}),l(T,{gap:1,overflow:"hidden",children:[t(S,{truncate:!0,shrink:!0,fontWeight:"bold",children:d("catalog.marketplace.items_found",["count"],[r.length.toString()])}),t(T,{overflow:"auto",className:"nitro-catalog-layout-marketplace-grid",children:r.length>0&&r.map(h=>t(im,{offerData:h,type:yi,onClick:m},h.offerId))})]})]})},ZT=a=>{const{searchType:e=null,sortTypes:n=null,onSearch:r=null}=a,[o,s]=i.useState(n?n[0]:3),[c,u]=i.useState(""),[m,h]=i.useState(0),[g,f]=i.useState(0),_=i.useCallback(I=>{s(I),(e===Ut.BY_ACTIVITY||e===Ut.BY_VALUE)&&r({minPrice:-1,maxPrice:-1,query:"",type:I})},[r,e]),E=i.useCallback(()=>{const I=m>0?m:-1,C=g>0?g:-1;r({minPrice:I,maxPrice:C,type:o,query:c})},[g,m,r,c,o]);return i.useEffect(()=>{if(!n||!n.length)return;const I=n[0];s(I),(e===Ut.BY_ACTIVITY||Ut.BY_VALUE===e)&&r({minPrice:-1,maxPrice:-1,query:"",type:I})},[r,e,n]),l(T,{gap:1,children:[l(w,{alignItems:"center",gap:1,children:[t(S,{className:"col-3",children:d("catalog.marketplace.sort_order")}),t("select",{className:"form-select form-select-sm",value:o,onChange:I=>_(parseInt(I.target.value)),children:n.map(I=>t("option",{value:I,children:d(`catalog.marketplace.sort.${I}`)},I))})]}),e===Ut.ADVANCED&&l(V,{children:[l(w,{alignItems:"center",gap:1,children:[t(S,{className:"col-3",children:d("catalog.marketplace.search_name")}),t("input",{className:"form-control form-control-sm",type:"text",value:c,onChange:I=>u(I.target.value)})]}),l(w,{alignItems:"center",gap:1,children:[t(S,{className:"col-3",children:d("catalog.marketplace.search_price")}),l(w,{fullWidth:!0,gap:1,children:[t("input",{className:"form-control form-control-sm",type:"number",min:0,value:m,onChange:I=>h(I.target.valueAsNumber)}),t("input",{className:"form-control form-control-sm",type:"number",min:0,value:g,onChange:I=>f(I.target.valueAsNumber)})]})]}),t(L,{variant:"secondary",className:"mx-auto",onClick:E,children:d("generic.search")})]})]})},ev=[1,2],tv=[3,4,5,6],nv=[1,2,3,4,5,6],rv=a=>{const[e,n]=i.useState(Ut.BY_ACTIVITY),[r,o]=i.useState(0),[s,c]=i.useState(new Map),[u,m]=i.useState({minPrice:-1,maxPrice:-1,query:"",type:3}),{getCurrencyAmount:h=null}=ts(),{simpleAlert:g=null,showConfirm:f=null}=Xe(),_=i.useCallback(C=>{m(C),M(new EI(C.minPrice,C.maxPrice,C.query,C.type))},[]),E=i.useMemo(()=>{switch(e){case Ut.BY_ACTIVITY:return tv;case Ut.BY_VALUE:return ev;case Ut.ADVANCED:return nv}return[]},[e]),I=i.useCallback(C=>{if(C.price>h(-1)){g(d("catalog.alert.notenough.credits.description"),de.DEFAULT,null,null,d("catalog.alert.notenough.title"));return}const p=C.offerId;f(d("catalog.marketplace.confirm_header"),()=>{M(new wl(p))},null,null,null,d("catalog.marketplace.confirm_title"))},[h,g,f]);return x(_I,C=>{const p=C.getParser();if(!p)return;const b=new Map;p.offers.forEach(N=>{const v=new Qs(N.offerId,N.furniId,N.furniType,N.extraData,N.stuffData,N.price,N.status,N.averagePrice,N.offerCount);v.timeLeftMinutes=N.timeLeftMinutes,b.set(N.offerId,v)}),o(p.totalItemsFound),c(b)}),x(CI,C=>{const p=C.getParser();if(p)switch(p.result){case 1:_(u);break;case 2:c(b=>{const N=new Map(b);return N.delete(p.requestedOfferId),N}),g(d("catalog.marketplace.not_available_header"),de.DEFAULT,null,null,d("catalog.marketplace.not_available_title"));break;case 3:c(b=>{const N=new Map(b),v=N.get(p.requestedOfferId);return v&&(v.offerId=p.offerId,v.price=p.newPrice,v.offerCount--,N.set(v.offerId,v)),N.delete(p.requestedOfferId),N}),f(d("catalog.marketplace.confirm_higher_header")+`
`+d("catalog.marketplace.confirm_price",["price"],[p.newPrice.toString()]),()=>{M(new wl(p.offerId))},null,null,null,d("catalog.marketplace.confirm_higher_title"));break;case 4:g(d("catalog.alert.notenough.credits.description"),de.DEFAULT,null,null,d("catalog.alert.notenough.title"));break}}),l(V,{children:[l(er,{children:[t(L,{active:e===Ut.BY_ACTIVITY,onClick:()=>n(Ut.BY_ACTIVITY),children:d("catalog.marketplace.search_by_activity")}),t(L,{active:e===Ut.BY_VALUE,onClick:()=>n(Ut.BY_VALUE),children:d("catalog.marketplace.search_by_value")}),t(L,{active:e===Ut.ADVANCED,onClick:()=>n(Ut.ADVANCED),children:d("catalog.marketplace.search_advanced")})]}),t(ZT,{sortTypes:E,searchType:e,onSearch:_}),l(T,{gap:1,overflow:"hidden",children:[t(S,{truncate:!0,shrink:!0,fontWeight:"bold",children:d("catalog.marketplace.items_found",["count"],[s.size.toString()])}),t(T,{className:"nitro-catalog-layout-marketplace-grid",overflow:"auto",children:Array.from(s.values()).map((C,p)=>t(im,{offerData:C,type:Ga,onClick:I},p))})]})]})},sv=a=>{const{page:e=null}=a,[n,r]=i.useState(-1),[o,s]=i.useState([]),[c,u]=i.useState(-1),[m,h]=i.useState([]),[g,f]=i.useState(-1),[_,E]=i.useState(!1),[I,C]=i.useState("");i.useState(!0);const[p,b]=i.useState(-1),{currentOffer:N=null,setCurrentOffer:v=null,setPurchaseOptions:O=null,catalogOptions:R=null,roomPreviewer:y=null}=xe(),{petPalettes:F=null}=R,P=i.useMemo(()=>!m.length||g===-1?16777215:m[g][0],[m,g]),D=i.useMemo(()=>n===-1||!o.length||c===-1?"":d(`pet.breed.${n}.${o[c].breedId}`),[n,o,c]),A=i.useMemo(()=>{if(!o.length||c===-1)return"";const G=o[c].paletteId;let z=16777215;if(n<=7){if(g===-1)return"";z=m[g][0]}let X=z.toString(16).toUpperCase();for(;X.length<6;)X="0"+X;return`${G}
${X}`},[o,c,n,m,g]),k=i.useMemo(()=>{let G="";switch(p){case 1:G="catalog.alert.petname.long";break;case 2:G="catalog.alert.petname.short";break;case 3:G="catalog.alert.petname.chars";break;case 4:G="catalog.alert.petname.bobba";break}return!G||!G.length?"":d(G)},[p]),B=i.useCallback(()=>{if(p===-1){M(new bI(I,1));return}if(p===0){M(new ao(e.pageId,N.offerId,`${I}
${A}`,1));return}},[e,N,I,A,p]);return x(SI,G=>{const z=G.getParser();b(z.result),z.result===0?B():St(new Kr(-1))}),i.useEffect(()=>{if(!e||!e.offers.length)return;const G=e.offers[0];v(G),r(vC(G.localizationId)),E(!1)},[e,v]),i.useEffect(()=>{if(!N)return;const G=N.product.productData;if(G){if(F)for(const z of F){if(z.breed!==G.type)continue;const X=[];for(const Y of z.palettes)Y.sellable&&X.push(Y);u(X.length?0:-1),s(X);return}u(-1),s([]),M(new NI(G.type))}},[N,F]),i.useEffect(()=>{if(n===-1)return;const G=wC(n,o);f(G.length?0:-1),h(G)},[n,o]),i.useEffect(()=>{if(!y||(y.reset(!1),n===-1||!o.length||c===-1))return;let G=`${n} ${o[c].paletteId}`;n<=7&&(G+=` ${P.toString(16)}`),y.addPetIntoRoom(G)},[y,n,o,c,P]),i.useEffect(()=>{b(-1)},[I]),N?l(ne,{children:[t(T,{size:7,overflow:"hidden",children:l(Ue,{columnCount:5,children:[!_&&o.length>0&&o.map((G,z)=>t(be,{itemActive:c===z,onClick:X=>u(z),children:t(Zn,{typeId:n,paletteId:G.paletteId,direction:2,headOnly:!0})},z)),_&&m.length>0&&m.map((G,z)=>t(be,{itemHighlight:!0,itemActive:g===z,itemColor:ln.int2rgb(G[0]),className:"clear-bg",onClick:X=>f(z)},z))]})}),l(T,{center:!N,size:5,overflow:"hidden",children:[!N&&l(V,{children:[!!e.localization.getImage(1)&&t("img",{alt:"",src:e.localization.getImage(1)}),t(S,{center:!0,dangerouslySetInnerHTML:{__html:e.localization.getText(0)}})]}),N&&l(V,{children:[l(U,{position:"relative",overflow:"hidden",children:[t(kr,{}),t(Or,{position:"absolute",className:"bg-muted rounded bottom-1 end-1"}),n>-1&&n<=7&&t(L,{position:"absolute",className:"bottom-1 start-1",onClick:G=>E(!_),children:t(cu,{className:"fa-icon"})})]}),l(T,{grow:!0,gap:1,children:[t(S,{truncate:!0,children:D}),l(T,{grow:!0,gap:1,children:[t("input",{type:"text",className:"form-control form-control-sm w-100",placeholder:d("widgets.petpackage.name.title"),value:I,onChange:G=>C(G.target.value)}),p>0&&t(U,{className:"invalid-feedback d-block m-0",children:k})]}),t(w,{justifyContent:"end",children:t(Cr,{justifyContent:"end",alignItems:"end"})}),t(Yn,{purchaseCallback:B})]})]})]})]}):null},av=a=>{const{offer:e=null,isAvailable:n=!1,daysRequired:r=0,onSelect:o=null}=a,s=i.useCallback(()=>{if(!e||!e.products.length)return"";const u=e.products[0];return Fa.getProductImageUrl(u.productType,u.furniClassId,u.extraParam)},[e]),c=i.useCallback(()=>{if(!e||!e.products.length)return"";const u=e.products[0],m=Fa.getProductCategory(u.productType,u.furniClassId)===2?"wallItem.name."+u.furniClassId:"roomItem.name."+u.furniClassId;return d(m)},[e]);return i.useCallback(()=>{if(!e||!e.products.length)return"";const u=e.products[0],m=Fa.getProductCategory(u.productType,u.furniClassId)===2?"wallItem.desc."+u.furniClassId:"roomItem.desc."+u.furniClassId;return d(m)},[e]),i.useCallback(()=>Math.floor(r/31),[r]),l(be,{center:!1,column:!1,alignItems:"center",className:"p-1",children:[t(sr,{imageUrl:s()}),t(S,{grow:!0,fontWeight:"bold",children:c()}),t(L,{variant:"secondary",onClick:()=>o(e.localizationId),disabled:!n,children:d("catalog.club_gift.select")})]})},ov=a=>{const{purse:e=null}=ts(),{catalogOptions:n=null,setCatalogOptions:r=null}=xe(),{clubGifts:o=null}=n,{showConfirm:s=null}=Xe(),c=i.useCallback(()=>o?o.giftsAvailable>0?d("catalog.club_gift.available",["amount"],[o.giftsAvailable.toString()]):o.daysUntilNextGift>0?d("catalog.club_gift.days_until_next",["days"],[o.daysUntilNextGift.toString()]):e.isVip?d("catalog.club_gift.not_available"):d("catalog.club_gift.no_club"):"",[o,e]),u=i.useCallback(h=>{s(d("catalog.club_gift.confirm"),()=>{M(new TI(h)),r(g=>(g.clubGifts.giftsAvailable--,{...g}))},null)},[r,s]),m=i.useMemo(()=>o.offers.sort((g,f)=>o.getOfferExtraData(g.offerId).daysRequired-o.getOfferExtraData(f.offerId).daysRequired),[o]);return l(V,{children:[t(S,{truncate:!0,shrink:!0,fontWeight:"bold",children:c()}),t(Ue,{columnCount:1,className:"nitro-catalog-layout-vip-gifts-grid",children:o.offers.length>0&&m.map(h=>t(av,{offer:h,isAvailable:o.getOfferExtraData(h.offerId).isSelectable&&o.giftsAvailable>0,onSelect:u,daysRequired:o.getOfferExtraData(h.offerId).daysRequired},h.offerId))})]})},iv=(a,e)=>{if(!a)return null;const n={page:a,hideNavigation:e};switch(a.layoutCode){case"frontpage_featured":return null;case"frontpage4":return t(QT,{...n});case"pets":return t(sv,{...n});case"pets2":return t(BT,{...n});case"pets3":return t(sm,{...n});case"vip_buy":return t(KT,{...n});case"guild_frontpage":return t(FT,{...n});case"guild_forum":return t(xT,{...n});case"guild_custom_furni":return t(UT,{...n});case"club_gifts":return t(ov,{...n});case"marketplace_own_items":return t(JT,{...n});case"marketplace":return t(rv,{...n});case"single_bundle":return t(WT,{...n});case"room_bundle":return t(HT,{...n});case"spaces_new":return t(zT,{...n});case"trophies":return t($T,{...n});case"info_loyalty":return t(GT,{...n});case"badge_display":return t(AT,{...n});case"roomads":return t(VT,{...n});case"default_3x3_color_grouping":return t(DT,{...n});case"soundmachine":return t(jT,{...n});case"bots":case"default_3x3":default:return t(MT,{...n})}},lv=a=>{const[e,n]=i.useState(null),[r,o]=i.useState(0),[s,c]=i.useState("0"),{catalogOptions:u=null,setCatalogOptions:m=null}=xe(),{marketplaceConfiguration:h=null}=u,{showConfirm:g=null}=Xe(),f=p=>{c(p);const b=parseInt(p);isNaN(b)||b===r||o(parseInt(p))};if(x(vI,p=>{const b=p.getParser();m(N=>{const v={...N};return v.marketplaceConfiguration=b,v})}),ct(nl.POST_MARKETPLACE,p=>n(p.item)),i.useEffect(()=>{!e||h||M(new wI)},[e,h]),i.useEffect(()=>{if(e)return()=>o(0)},[e]),!h||!e)return null;const _=e?d(e.isWallItem?"wallItem.name."+e.type:"roomItem.name."+e.type):"",E=e?d(e.isWallItem?"wallItem.desc."+e.type:"roomItem.desc."+e.type):"",I=()=>Math.max(Math.ceil(h.commission*.01*r),1),C=()=>{!e||r<h.minimumPrice||g(d("inventory.marketplace.confirm_offer.info",["furniname","price"],[_,r.toString()]),()=>{M(new RI(r,e.isWallItem?2:1,e.id)),n(null)},()=>{n(null)},null,null,d("inventory.marketplace.confirm_offer.title"))};return l(ae,{className:"nitro-catalog-layout-marketplace-post-offer",theme:"primary-slim",children:[t(se,{headerText:d("inventory.marketplace.make_offer.title"),onCloseClick:p=>n(null)}),t(re,{overflow:"hidden",children:l(ne,{fullHeight:!0,children:[t(T,{center:!0,className:"bg-muted rounded p-2",size:4,overflow:"hidden",children:t(Qi,{productType:e.isWallItem?ue.WALL:ue.FLOOR,productClassId:e.type,extraData:e.extra.toString()})}),l(T,{size:8,justifyContent:"between",overflow:"hidden",children:[l(T,{grow:!0,gap:1,children:[t(S,{fontWeight:"bold",children:_}),t(S,{truncate:!0,shrink:!0,children:E})]}),l(T,{overflow:"auto",children:[t(S,{italics:!0,children:d("inventory.marketplace.make_offer.expiration_info",["time"],[h.offerTime.toString()])}),l("div",{className:"input-group has-validation",children:[t("input",{className:"form-control form-control-sm",type:"number",min:0,value:s,onChange:p=>f(p.target.value),placeholder:d("inventory.marketplace.make_offer.price_request")}),(r<h.minimumPrice||isNaN(r))&&t(U,{className:"invalid-feedback d-block",children:d("inventory.marketplace.make_offer.min_price",["minprice"],[h.minimumPrice.toString()])}),r>h.maximumPrice&&!isNaN(r)&&t(U,{className:"invalid-feedback d-block",children:d("inventory.marketplace.make_offer.max_price",["maxprice"],[h.maximumPrice.toString()])}),!(r<h.minimumPrice||r>h.maximumPrice||isNaN(r))&&t(U,{className:"invalid-feedback d-block",children:d("inventory.marketplace.make_offer.final_price",["commission","finalprice"],[I().toString(),(r+I()).toString()])})]}),t(L,{disabled:r<h.minimumPrice||r>h.maximumPrice||isNaN(r),onClick:C,children:d("inventory.marketplace.make_offer.post")})]})]})]})})]})},cv=a=>{const{isVisible:e=!1,setIsVisible:n=null,rootNode:r=null,currentPage:o=null,navigationHidden:s=!1,setNavigationHidden:c=null,activeNodes:u=[],searchResult:m=null,setSearchResult:h=null,openPageByName:g=null,openPageByOfferId:f=null,activateNode:_=null,getNodeById:E}=xe();return i.useEffect(()=>{const I={linkReceived:C=>{const p=C.split("/");if(!(p.length<2))switch(p[1]){case"show":n(!0);return;case"hide":n(!1);return;case"toggle":n(b=>!b);return;case"open":if(p.length>2)if(p.length===4)switch(p[2]){case"offerId":f(parseInt(p[3]));return}else g(p[2]);else n(!0);return}},eventUrlPrefix:"catalog/"};return _t(I),()=>Ct(I)},[n,f,g]),l(V,{children:[e&&l(ae,{uniqueKey:"catalog",className:"nitro-catalog",style:K("catalog.headers")?{width:710}:{},children:[t(se,{headerText:d("catalog.title"),onCloseClick:I=>n(!1)}),t(Ir,{children:r&&r.children.length>0&&r.children.map(I=>I.isVisible?t(qn,{isActive:I.isActive,onClick:C=>{m&&h(null),_(I)},children:l(w,{gap:K("catalog.tab.icons")?1:0,alignItems:"center",children:[K("catalog.tab.icons")&&t(Jd,{icon:I.iconId}),I.localization]})},I.pageId):null)}),t(re,{children:l(ne,{children:[!s&&t(T,{size:3,overflow:"hidden",children:u&&u.length>0&&t(yT,{node:u[0]})}),t(T,{size:s?12:9,overflow:"hidden",children:iv(o,()=>c(!0))})]})})]}),t(wT,{}),t(lv,{})]})},uv=a=>{const[e,n]=i.useState(!1),[r,o]=i.useState(""),{chatHistory:s=[]}=po(),c=i.useRef(null),u=i.useMemo(()=>{if(r.length===0)return s;let m=r.toLowerCase();return s.filter(h=>h.message&&h.message.toLowerCase().includes(m)||h.name&&h.name.toLowerCase().includes(m))},[s,r]);return i.useEffect(()=>{c&&c.current&&e&&(c.current.scrollTop=c.current.scrollHeight)},[e]),i.useEffect(()=>{const m={linkReceived:h=>{const g=h.split("/");if(!(g.length<2))switch(g[1]){case"show":n(!0);return;case"hide":n(!1);return;case"toggle":n(f=>!f);return}},eventUrlPrefix:"chat-history/"};return _t(m),()=>Ct(m)},[]),e?l(ae,{uniqueKey:"chat-history",className:"nitro-chat-history",theme:"primary-slim",children:[t(se,{headerText:d("room.chathistory.button.text"),onCloseClick:m=>n(!1)}),l(re,{innerRef:c,overflow:"hidden",gap:2,children:[t("input",{type:"text",className:"form-control form-control-sm",placeholder:d("generic.search"),value:r,onChange:m=>o(m.target.value)}),t(ho,{rows:u,scrollToBottom:!0,rowRender:m=>l(w,{alignItems:"center",className:"p-1",gap:2,children:[t(S,{variant:"muted",children:m.timestamp}),m.type===Pn.TYPE_CHAT&&l("div",{className:"bubble-container",style:{position:"relative"},children:[m.style===0&&t("div",{className:"user-container-bg",style:{backgroundColor:m.color}}),l("div",{className:`chat-bubble bubble-${m.style} type-${m.chatType}`,style:{maxWidth:"100%"},children:[t("div",{className:"user-container",children:m.imageUrl&&m.imageUrl.length>0&&t("div",{className:"user-image",style:{backgroundImage:`url(${m.imageUrl})`}})}),l("div",{className:"chat-content",children:[t("b",{className:"username mr-1",dangerouslySetInnerHTML:{__html:`${m.name}: `}}),t("span",{className:"message",dangerouslySetInnerHTML:{__html:`${m.message}`}})]})]})]}),m.type===Pn.TYPE_ROOM_INFO&&l(V,{children:[t("i",{className:"icon icon-small-room"}),t(S,{textBreak:!0,wrap:!0,grow:!0,children:m.name})]})]})})]})]}):null},kn=32,Gr=64,Ls="x0123456789abcdefghijklmnopq";class Et{}Et.DOOR=0;Et.UP=1;Et.DOWN=2;Et.SET=3;Et.UNSET=4;const dv={x:"101010",0:"0065ff",1:"0091ff",2:"00bcff",3:"00e8ff",4:"00ffea",5:"00ffbf",6:"00ff93",7:"00ff68",8:"00ff3d",9:"19ff00",a:"44ff00",b:"70ff00",c:"9bff00",d:"f2ff00",e:"ffe000",f:"ffb500",g:"ff8900",h:"ff5e00",i:"ff3200",j:"ff0700",k:"ff0023",l:"ff007a",m:"ff00a5",n:"ff00d1",o:"ff00fc",p:"d600ff",q:"aa00ff"};class mv{constructor(){this._currentAction=Et.SET,this._currentHeight=Ls[1]}get currentAction(){return this._currentAction}set currentAction(e){this._currentAction=e}get currentHeight(){return this._currentHeight}set currentHeight(e){this._currentHeight=e}clear(){this._currentAction=Et.SET,this._currentHeight=Ls[1]}}class wa{constructor(e,n){this._height=e,this._isBlocked=n}get height(){return this._height}set height(e){this._height=e}get isBlocked(){return this._isBlocked}set isBlocked(e){this._isBlocked=e}}const gv=(a,e)=>{let n=a*kn/2-e*kn/2;const r=a*kn/4+e*kn/4;return n=n+1024,[n,r]},hv=(a,e)=>{const n=a-1024,r=(n/(kn/2)+e/(kn/4))/2,o=(e/(kn/4)-n/(kn/2))/2;return[r,o]},so=a=>{switch(a=parseInt(a.toString()),a){case 0:return-2;case 1:return-1;case 3:return 1;default:return 0}},Ra=a=>{switch(a){case .25:return 0;case .5:return 1;case 2:return 3;default:return 2}},Vr=class extends yI{constructor(){const a=kn*Gr+20,e=kn*Gr/2+100;super({width:a,height:e,backgroundColor:0,antialias:!0,autoDensity:!0,resolution:1,sharedLoader:!0,sharedTicker:!0}),this._tilemap=[],this._doorLocation=new vr(0,0),this._width=0,this._height=0,this._isHolding=!1,this._lastUsedTile=new vr(-1,-1),this._actionSettings=new mv}initialize(){if(this._isInitialized)return;const a=xu().getCollection("floor_editor");a&&(this._assetCollection=a,this._tilemapRenderer=new OI(a.baseTexture),this.registerEventListeners(),this.stage.addChild(this._tilemapRenderer),this._isInitialized=!0)}registerEventListeners(){const a=new vr;this._tilemapRenderer.containsPoint=e=>(this._tilemapRenderer.worldTransform.applyInverse(e,a),this.tileHitDetection(a,!1)),this._tilemapRenderer.on("pointerup",()=>{this._isHolding=!1}),this._tilemapRenderer.on("pointerout",()=>{this._isHolding=!1}),this._tilemapRenderer.on("pointerdown",e=>{if(!(e.data.originalEvent instanceof PointerEvent)&&!(e.data.originalEvent instanceof TouchEvent))return;const n=e.data.originalEvent;if(n instanceof MouseEvent&&n.button===2)return;const r=e.data.global;this.tileHitDetection(r,!0)}),this._tilemapRenderer.on("click",e=>{if(!(e.data.originalEvent instanceof PointerEvent)||e.data.originalEvent.button===2)return;const r=e.data.global;this.tileHitDetection(r,!0,!0)})}tileHitDetection(a,e,n=!1){const r=this._tilemapRenderer.pointsBuf,o=Pm,s=r.length;e&&(this._isHolding=!0);for(let c=0;c<s;c+=o){const u=c+o,m=r.slice(c,u),h=kn,g=kn/2,f=Math.floor(a.x),_=Math.floor(a.y),E=m[2],I=m[3],C=E+h/2,p=I+g/2,b=Math.abs(f-C),N=Math.abs(_-p);if(b/(h*.5)+N/(g*.5)<=1){if(this._isHolding){const[O,R]=hv(E,I);n?this.onClick(O,R):(this._lastUsedTile.x!==O||this._lastUsedTile.y!==R)&&(this._lastUsedTile.x=O,this._lastUsedTile.y=R,this.onClick(O,R))}return!0}}return!1}onClick(a,e){const n=this._tilemap[e][a],r=Ls.indexOf(n.height);let o=0;switch(this._actionSettings.currentAction){case Et.DOOR:n.height!=="x"&&(this._doorLocation.x=a,this._doorLocation.y=e,this.renderTiles());return;case Et.UP:if(n.height==="x")return;o=r+1;break;case Et.DOWN:if(n.height==="x"||r<=1)return;o=r-1;break;case Et.SET:o=Ls.indexOf(this._actionSettings.currentHeight);break;case Et.UNSET:o=0;break}if(o===-1||r===o)return;o>0&&(a+1>this._width&&(this._width=a+1),e+1>this._height&&(this._height=e+1));const s=Ls[o];s&&(n.isBlocked||(this._tilemap[e][a].height=s,this.renderTiles()))}renderTiles(){this.tilemapRenderer.clear();for(let a=0;a<this._tilemap.length;a++)for(let e=0;e<this.tilemap[a].length;e++){const n=this.tilemap[a][e];let r=n.height;this._doorLocation.x===e&&this._doorLocation.y===a&&(r=Vr.TILE_DOOR),n.isBlocked&&(r=Vr.TILE_BLOCKED);const[o,s]=gv(e,a);this._tilemapRenderer.tile(this._assetCollection.getTexture(`floor_editor_${r}`),o,s)}}setTilemap(a,e){this._tilemap=[];const n=a.split("\r");let r=0,o=n.length;for(let s=0;s<o;s++){const c=n[s];if(c.length===0){n.splice(s,1),o=n.length,s--;continue}c.length>r&&(r=c.length)}for(let s=0;s<o;s++){this._tilemap[s]=[];const c=n[s];for(let u=0;u<r;u++){const m=e[s]&&e[s][u]||!1,h=c[u];h!=="x"&&h!=="X"&&h?this._tilemap[s][u]=new wa(h,m):this._tilemap[s][u]=new wa("x",m)}for(let u=r;u<Gr;u++)this.tilemap[s][u]=new wa("x",!1)}for(let s=o;s<Gr;s++){this.tilemap[s]||(this.tilemap[s]=[]);for(let c=0;c<Gr;c++)this.tilemap[s][c]=new wa("x",!1)}this._width=r,this._height=o}getCurrentTilemapString(){if(this._tilemap[this._height-1][this._width-1].height==="x"){this._width=-1,this._height=-1;for(let n=Gr-1;n>=0;n--)if(this._tilemap[n])for(let r=Gr-1;r>=0;r--){if(!this._tilemap[n][r])continue;this._tilemap[n][r].height!=="x"&&(r+1>this._width&&(this._width=r+1),n+1>this._height&&(this._height=n+1))}}const e=[];for(let n=0;n<this._height;n++){const r=[];for(let o=0;o<this._width;o++){const s=this._tilemap[n][o];r[o]=s.height}e[n]=r.join("")}return e.join("\r")}clear(){this._tilemapRenderer.interactive=!1,this._tilemap=[],this._doorLocation.set(-1,-1),this._width=0,this._height=0,this._isHolding=!1,this._lastUsedTile.set(-1,-1),this._actionSettings.clear(),this._tilemapRenderer.clear()}get tilemapRenderer(){return this._tilemapRenderer}get tilemap(){return this._tilemap}get doorLocation(){return this._doorLocation}set doorLocation(a){this._doorLocation=a}get actionSettings(){return this._actionSettings}static get instance(){return Vr._INSTANCE||(Vr._INSTANCE=new Vr),Vr._INSTANCE}};let Mt=Vr;Mt._INSTANCE=null;Mt.TILE_BLOCKED="r_blocked";Mt.TILE_DOOR="r_door";const lm=i.createContext({originalFloorplanSettings:null,setOriginalFloorplanSettings:null,visualizationSettings:null,setVisualizationSettings:null}),fv=a=>t(lm.Provider,{...a}),il=()=>i.useContext(lm),pv=a=>{const{gap:e=1,children:n=null,...r}=a,[o,s]=i.useState(!1),[c,u]=i.useState(!1),{originalFloorplanSettings:m=null,setOriginalFloorplanSettings:h=null,setVisualizationSettings:g=null}=il(),f=i.useRef(null);x(AI,E=>{const I=E.getParser();h(C=>{const p={...C};return p.reservedTiles=I.blockedTilesMap,Mt.instance.setTilemap(p.tilemap,p.reservedTiles),p}),s(!0),f.current.scrollTo(Mt.instance.view.width/3,0)}),x(kI,E=>{const I=E.getParser();h(C=>{const p={...C};return p.entryPoint=[I.x,I.y],p.entryPointDir=I.direction,p}),g(C=>{const p={...C};return p.entryPointDir=I.direction,p}),Mt.instance.doorLocation=new vr(I.x,I.y),u(!0)});const _=E=>{const I=f.current;if(I)switch(E){case"up":I.scrollBy({top:-10});break;case"down":I.scrollBy({top:10});break;case"left":I.scrollBy({left:-10});break;case"right":I.scrollBy({left:10});break}};return i.useEffect(()=>()=>{Mt.instance.clear(),g(E=>({wallHeight:m.wallHeight,thicknessWall:m.thicknessWall,thicknessFloor:m.thicknessFloor,entryPointDir:E.entryPointDir}))},[m.thicknessFloor,m.thicknessWall,m.wallHeight,g]),i.useEffect(()=>{!c||!o||Mt.instance.renderTiles()},[c,o]),i.useEffect(()=>{M(new PI),M(new DI),Mt.instance.tilemapRenderer.interactive=!0,f.current&&f.current.appendChild(Mt.instance.renderer.view)},[]),l(T,{gap:e,...r,children:[l(ne,{overflow:"hidden",gap:1,children:[t(T,{center:!0,size:1,children:t(L,{className:"d-md-none",onClick:E=>_("left"),children:t(uu,{className:"fa-icon"})})}),l(T,{overflow:"hidden",size:10,gap:1,children:[t(w,{justifyContent:"center",className:"d-md-none",children:t(L,{shrink:!0,onClick:E=>_("up"),children:t(Dm,{className:"fa-icon"})})}),t(U,{overflow:"auto",innerRef:f}),t(w,{justifyContent:"center",className:"d-md-none",children:t(L,{shrink:!0,onClick:E=>_("down"),children:t(Mm,{className:"fa-icon"})})})]}),t(T,{center:!0,size:1,children:t(L,{className:"d-md-none",onClick:E=>_("right"),children:t(du,{className:"fa-icon"})})})]}),n]})},hc=a=>a.replace(/\r\n|\r|\n/g,`
`).toLowerCase(),Iv=a=>{const{onCloseClick:e=null}=a,[n,r]=i.useState(""),{originalFloorplanSettings:o=null}=il(),s=()=>{M(new Fu(n.split(`
`).join("\r"),o.entryPoint[0],o.entryPoint[1],o.entryPointDir,so(o.thicknessWall),so(o.thicknessFloor),o.wallHeight-1))};return Xd(()=>{r(hc(o.tilemap))}),l(ae,{theme:"primary-slim",className:"floorplan-import-export",children:[t(se,{headerText:d("floor.plan.editor.import.export"),onCloseClick:e}),l(re,{children:[t("textarea",{className:"h-100",value:n,onChange:c=>r(c.target.value)}),l(w,{justifyContent:"between",children:[t(L,{onClick:c=>r(hc(o.tilemap)),children:d("floor.plan.editor.revert.to.last.received.map")}),t(L,{onClick:s,children:d("floor.plan.editor.save")})]})]})]})},fc=0,ya=16,Ev=0,_v=26,Cv=a=>{const{visualizationSettings:e=null,setVisualizationSettings:n=null}=il(),[r,o]=i.useState(Et.SET),[s,c]=i.useState(0),u=C=>{o(C),Mt.instance.actionSettings.currentAction=C},m=()=>{n(C=>{const p={...C};return p.entryPointDir<7?++p.entryPointDir:p.entryPointDir=0,p})},h=C=>{(isNaN(C)||C<=0)&&(C=0),C>26&&(C=26),c(C),Mt.instance.actionSettings.currentHeight=C.toString(36)},g=C=>{n(p=>{const b={...p};return b.thicknessFloor=C,b})},f=C=>{n(p=>{const b={...p};return b.thicknessWall=C,b})},_=C=>{(isNaN(C)||C<=0)&&(C=fc),C>ya&&(C=ya),n(p=>{const b={...p};return b.wallHeight=C,b})},E=()=>{let C=e.wallHeight+1;C>ya&&(C=ya),_(C)},I=()=>{let C=e.wallHeight-1;C<=0&&(C=fc),_(C)};return l(T,{children:[l(w,{gap:1,children:[l(T,{size:5,gap:1,children:[t(S,{bold:!0,children:d("floor.plan.editor.draw.mode")}),l(w,{gap:3,children:[l(w,{gap:1,children:[t(be,{itemActive:r===Et.SET,onClick:C=>u(Et.SET),children:t("i",{className:"icon icon-set-tile"})}),t(be,{itemActive:r===Et.UNSET,onClick:C=>u(Et.UNSET),children:t("i",{className:"icon icon-unset-tile"})})]}),l(w,{gap:1,children:[t(be,{itemActive:r===Et.UP,onClick:C=>u(Et.UP),children:t("i",{className:"icon icon-increase-height"})}),t(be,{itemActive:r===Et.DOWN,onClick:C=>u(Et.DOWN),children:t("i",{className:"icon icon-decrease-height"})})]}),t(be,{itemActive:r===Et.DOOR,onClick:C=>u(Et.DOOR),children:t("i",{className:"icon icon-set-door"})})]})]}),l(T,{alignItems:"center",size:4,children:[t(S,{bold:!0,children:d("floor.plan.editor.enter.direction")}),t("i",{className:`icon icon-door-direction-${e.entryPointDir} cursor-pointer`,onClick:m})]}),l(T,{size:3,children:[t(S,{bold:!0,children:d("floor.editor.wall.height")}),l(w,{alignItems:"center",gap:1,children:[t(iu,{className:"cursor-pointer fa-icon",onClick:I}),t("input",{type:"number",className:"form-control form-control-sm quantity-input",value:e.wallHeight,onChange:C=>_(C.target.valueAsNumber)}),t(lu,{className:"cursor-pointer fa-icon",onClick:E})]})]})]}),l(w,{gap:1,children:[l(T,{size:6,children:[l(S,{bold:!0,children:[d("floor.plan.editor.tile.height"),": ",s]}),t(Dt,{className:"nitro-slider",min:Ev,max:_v,step:1,value:s,onChange:C=>h(C),renderThumb:({style:C,...p},b)=>t("div",{style:{backgroundColor:`#${dv[b.valueNow.toString(33)]}`,...C},...p,children:b.valueNow})})]}),l(T,{size:6,children:[t(S,{bold:!0,children:d("floor.plan.editor.room.options")}),l(w,{className:"align-items-center",children:[l("select",{className:"form-control form-control-sm",value:e.thicknessWall,onChange:C=>f(parseInt(C.target.value)),children:[t("option",{value:0,children:d("navigator.roomsettings.wall_thickness.thinnest")}),t("option",{value:1,children:d("navigator.roomsettings.wall_thickness.thin")}),t("option",{value:2,children:d("navigator.roomsettings.wall_thickness.normal")}),t("option",{value:3,children:d("navigator.roomsettings.wall_thickness.thick")})]}),l("select",{className:"form-control form-control-sm",value:e.thicknessFloor,onChange:C=>g(parseInt(C.target.value)),children:[t("option",{value:0,children:d("navigator.roomsettings.floor_thickness.thinnest")}),t("option",{value:1,children:d("navigator.roomsettings.floor_thickness.thin")}),t("option",{value:2,children:d("navigator.roomsettings.floor_thickness.normal")}),t("option",{value:3,children:d("navigator.roomsettings.floor_thickness.thick")})]})]})]})]})]})},bv=a=>{const[e,n]=i.useState(!1),[r,o]=i.useState(!1),[s,c]=i.useState({tilemap:"",reservedTiles:[],entryPoint:[0,0],entryPointDir:2,wallHeight:-1,thicknessWall:1,thicknessFloor:1}),[u,m]=i.useState({entryPointDir:2,wallHeight:-1,thicknessWall:1,thicknessFloor:1}),h=()=>{M(new Fu(Mt.instance.getCurrentTilemapString(),Mt.instance.doorLocation.x,Mt.instance.doorLocation.y,u.entryPointDir,so(u.thicknessWall),so(u.thicknessFloor),u.wallHeight-1))},g=()=>{m({wallHeight:s.wallHeight,thicknessWall:s.thicknessWall,thicknessFloor:s.thicknessFloor,entryPointDir:s.entryPointDir}),Mt.instance.doorLocation=new vr(s.entryPoint[0],s.entryPoint[1]),Mt.instance.setTilemap(s.tilemap,s.reservedTiles),Mt.instance.renderTiles()};return Te(pn.DISPOSED,f=>n(!1)),x(MI,f=>{const _=f.getParser();c(E=>{const I={...E};return I.tilemap=_.model,I.wallHeight=_.wallHeight+1,I}),m(E=>{const I={...E};return I.wallHeight=_.wallHeight+1,I})}),x(LI,f=>{const _=f.getParser();c(E=>{const I={...E};return I.thicknessFloor=Ra(_.thicknessFloor),I.thicknessWall=Ra(_.thicknessWall),I}),m(E=>{const I={...E};return I.thicknessFloor=Ra(_.thicknessFloor),I.thicknessWall=Ra(_.thicknessWall),I})}),i.useEffect(()=>{const f={linkReceived:_=>{const E=_.split("/");if(!(E.length<2))switch(E[1]){case"show":n(!0);return;case"hide":n(!1);return;case"toggle":n(I=>!I);return}},eventUrlPrefix:"floor-editor/"};return _t(f),()=>Ct(f)},[]),i.useEffect(()=>{Mt.instance.initialize()},[]),l(fv,{value:{originalFloorplanSettings:s,setOriginalFloorplanSettings:c,visualizationSettings:u,setVisualizationSettings:m},children:[e&&l(ae,{uniqueKey:"floorpan-editor",className:"nitro-floorplan-editor",theme:"primary-slim",children:[t(se,{headerText:d("floor.plan.editor.title"),onCloseClick:()=>n(!1)}),l(re,{overflow:"hidden",children:[t(Cv,{}),t(pv,{overflow:"hidden"}),l(w,{justifyContent:"between",children:[t(L,{onClick:g,children:d("floor.plan.editor.reload")}),l(er,{children:[t(L,{disabled:!0,children:d("floor.plan.editor.preview")}),t(L,{onClick:f=>o(!0),children:d("floor.plan.editor.import.export")}),t(L,{onClick:h,children:d("floor.plan.editor.save")})]})]})]})]}),r&&t(Iv,{onCloseClick:()=>o(!1)})]})},Sv=a=>{const{friend:e=null}=a,[n,r]=i.useState(!1),{followFriend:o=null}=gn(),s=i.useRef();return i.useEffect(()=>{const c=u=>{const m=s.current;m&&u.target!==m&&!m.contains(u.target)&&r(!1)};return document.addEventListener(ye.MOUSE_CLICK,c),()=>document.removeEventListener(ye.MOUSE_CLICK,c)},[]),e?l("div",{ref:s,className:"btn btn-success friend-bar-item "+(n?"friend-bar-item-active":""),onClick:c=>r(u=>!u),children:[l("div",{className:`friend-bar-item-head position-absolute ${e.id>0?"avatar":"group"}`,children:[e.id>0&&t(st,{headOnly:!0,figure:e.figure,direction:2}),e.id<=0&&t(je,{isGroup:!0,badgeCode:e.figure})]}),t("div",{className:"text-truncate",children:e.name}),n&&l("div",{className:"d-flex justify-content-between",children:[t(U,{className:"nitro-friends-spritesheet icon-friendbar-chat cursor-pointer",onClick:c=>co(e.id)}),e.followingAllowed&&t(U,{className:"nitro-friends-spritesheet icon-friendbar-visit cursor-pointer",onClick:c=>o(e)}),t(U,{className:"nitro-friends-spritesheet icon-profile cursor-pointer",onClick:c=>Jt(e.id)})]})]}):l("div",{ref:s,className:"btn btn-primary friend-bar-item friend-bar-search",children:[t("div",{className:"friend-bar-item-head position-absolute"}),t("div",{className:"text-truncate",children:d("friend.bar.find.title")})]})},Wo=3,Nv=a=>{const{onlineFriends:e=null}=a,[n,r]=i.useState(0),o=i.useRef();return l(w,{innerRef:o,alignItems:"center",className:"friend-bar",children:[t(L,{variant:"black",className:"friend-bar-button",disabled:n<=0,onClick:s=>r(n-1),children:t(sn,{className:"fa-icon"})}),Array.from(Array(Wo),(s,c)=>t(Sv,{friend:e[n+c]||null},c)),t(L,{variant:"black",className:"friend-bar-button",disabled:!(e.length>Wo&&n+Wo<=e.length-1),onClick:s=>r(n+1),children:t(an,{className:"fa-icon"})})]})},Tv=a=>{const{friend:e=null,selected:n=!1,selectFriend:r=null}=a,[o,s]=i.useState(!1),{followFriend:c=null,updateRelationship:u=null}=gn(),m=E=>{E.stopPropagation(),c(e)},h=E=>{E.stopPropagation(),co(e.id)},g=E=>{E.stopPropagation(),s(!0)},f=(E,I)=>{E.stopPropagation(),u(e,I),s(!1)},_=()=>{if(!e)return"none";switch(e.relationshipStatus){case jt.RELATIONSHIP_HEART:return"heart";case jt.RELATIONSHIP_SMILE:return"smile";case jt.RELATIONSHIP_BOBBA:return"bobba";default:return"none"}};return e?l(Ja,{justifyContent:"between",className:`px-2 py-1 ${n&&"bg-primary text-white"}`,onClick:E=>r(e.id),children:[l(w,{alignItems:"center",gap:1,children:[t(U,{onClick:E=>E.stopPropagation(),children:t(_n,{userId:e.id})}),t("div",{children:e.name})]}),l(w,{alignItems:"center",gap:1,children:[!o&&l(V,{children:[e.followingAllowed&&t(U,{pointer:!0,onClick:m,className:"nitro-friends-spritesheet icon-follow",title:d("friendlist.tip.follow")}),e.online&&t(U,{pointer:!0,className:"nitro-friends-spritesheet icon-chat",onClick:h,title:d("friendlist.tip.im")}),e.id>0&&t(U,{className:`nitro-friends-spritesheet icon-${_()} cursor-pointer`,onClick:g,title:d("infostand.link.relationship")})]}),o&&l(V,{children:[t(U,{pointer:!0,className:"nitro-friends-spritesheet icon-heart",onClick:E=>f(E,jt.RELATIONSHIP_HEART)}),t(U,{pointer:!0,className:"nitro-friends-spritesheet icon-smile",onClick:E=>f(E,jt.RELATIONSHIP_SMILE)}),t(U,{pointer:!0,className:"nitro-friends-spritesheet icon-bobba",onClick:E=>f(E,jt.RELATIONSHIP_BOBBA)}),t(U,{pointer:!0,className:"nitro-friends-spritesheet icon-none",onClick:E=>f(E,jt.RELATIONSHIP_NONE)})]})]})]}):null},pc=a=>{const{list:e=null,selectedFriendsIds:n=null,selectFriend:r=null}=a;return!e||!e.length?null:t(V,{children:e.map((o,s)=>t(Tv,{friend:o,selected:n&&n.indexOf(o.id)>=0,selectFriend:r},s))})},vv=a=>{const{request:e=null}=a,{requestResponse:n=null}=gn();return e?l(Ja,{justifyContent:"between",className:"px-2 py-1",children:[l(w,{alignItems:"center",gap:1,children:[t(_n,{userId:e.id}),t("div",{children:e.name})]}),l(w,{alignItems:"center",gap:1,children:[t(U,{className:"nitro-friends-spritesheet icon-accept cursor-pointer",onClick:r=>n(e.id,!0)}),t(U,{className:"nitro-friends-spritesheet icon-deny cursor-pointer",onClick:r=>n(e.id,!1)})]})]}):null},wv=a=>{const{children:e=null,...n}=a,{requests:r=[],requestResponse:o=null}=gn();return r.length?l(Za,{...n,children:[l(T,{fullHeight:!0,justifyContent:"between",gap:1,children:[t(T,{gap:0,children:r.map((s,c)=>t(vv,{request:s},c))}),t(w,{justifyContent:"center",className:"px-2 py-1",children:t(L,{onClick:s=>o(-1,!1),children:d("friendlist.requests.dismissall")})})]}),e]}):null},Rv=a=>{const{selectedFriendsIds:e=null,removeFriendsText:n=null,removeSelectedFriends:r=null,onCloseClick:o=null}=a;return l(ae,{className:"nitro-friends-remove-confirmation",theme:"primary-slim",children:[t(se,{headerText:d("friendlist.removefriendconfirm.title"),onCloseClick:o}),l(re,{className:"text-black",children:[t("div",{children:n}),l(w,{gap:1,children:[t(L,{fullWidth:!0,variant:"danger",disabled:e.length===0,onClick:r,children:d("generic.ok")}),t(L,{fullWidth:!0,onClick:o,children:d("generic.cancel")})]})]})]})},yv=a=>{const{selectedFriendsIds:e=null,onCloseClick:n=null,sendRoomInvite:r=null}=a,[o,s]=i.useState("");return l(ae,{className:"nitro-friends-room-invite",uniqueKey:"nitro-friends-room-invite",theme:"primary-slim",children:[t(se,{headerText:d("friendlist.invite.title"),onCloseClick:n}),l(re,{className:"text-black",children:[d("friendlist.invite.summary",["count"],[e.length.toString()]),t("textarea",{className:"form-control",value:o,maxLength:255,onChange:c=>s(c.target.value)}),t(S,{center:!0,className:"bg-muted rounded p-1",children:d("friendlist.invite.note")}),l(w,{gap:1,children:[t(L,{fullWidth:!0,variant:"success",disabled:o.length===0||e.length===0,onClick:()=>r(o),children:d("friendlist.invite.send")}),t(L,{fullWidth:!0,onClick:n,children:d("generic.cancel")})]})]})]})},Ov=a=>{const{...e}=a,[n,r]=i.useState(""),[o,s]=i.useState(null),[c,u]=i.useState(null),{canRequestFriend:m=null,requestFriend:h=null}=gn();return x(UI,g=>{const f=g.getParser();s(f.friends),u(f.others)}),i.useEffect(()=>{if(!n||!n.length)return;const g=setTimeout(()=>{!n||!n.length||M(new xI(n))},500);return()=>clearTimeout(g)},[n]),l(Za,{...e,children:[t("input",{type:"text",className:"search-input form-control form-control-sm w-100 rounded-0",placeholder:d("generic.search"),value:n,maxLength:50,onChange:g=>r(g.target.value)}),l(T,{children:[o&&l(V,{children:[o.length===0&&t(S,{bold:!0,small:!0,className:"px-2 py-1",children:d("friendlist.search.nofriendsfound")}),o.length>0&&l(T,{gap:0,children:[t(S,{bold:!0,small:!0,className:"px-2 py-1",children:d("friendlist.search.friendscaption",["cnt"],[o.length.toString()])}),t("hr",{className:"mx-2 mt-0 mb-1 text-black"}),t(T,{gap:0,children:o.map(g=>l(Ja,{justifyContent:"between",className:"px-2 py-1",children:[l(w,{alignItems:"center",gap:1,children:[t(_n,{userId:g.avatarId}),t("div",{children:g.avatarName})]}),t(w,{alignItems:"center",gap:1,children:g.isAvatarOnline&&t(U,{className:"nitro-friends-spritesheet icon-chat cursor-pointer",onClick:f=>co(g.avatarId),title:d("friendlist.tip.im")})})]},g.avatarId))})]})]}),c&&l(V,{children:[c.length===0&&t(S,{bold:!0,small:!0,className:"px-2 py-1",children:d("friendlist.search.noothersfound")}),c.length>0&&l(T,{gap:0,children:[t(S,{bold:!0,small:!0,className:"px-2 py-1",children:d("friendlist.search.otherscaption",["cnt"],[c.length.toString()])}),t("hr",{className:"mx-2 mt-0 mb-1 text-black"}),t(T,{gap:0,children:c.map(g=>l(Ja,{justifyContent:"between",className:"px-2 py-1",children:[l(w,{alignItems:"center",gap:1,children:[t(_n,{userId:g.avatarId}),t("div",{children:g.avatarName})]}),t(w,{alignItems:"center",gap:1,children:m(g.avatarId)&&t(U,{className:"nitro-friends-spritesheet icon-add cursor-pointer",onClick:f=>h(g.avatarId,g.avatarName),title:d("friendlist.tip.addfriend")})})]},g.avatarId))})]})]})]})]})},Av=a=>{const[e,n]=i.useState(!1),[r,o]=i.useState([]),[s,c]=i.useState(!1),[u,m]=i.useState(!1),{onlineFriends:h=[],offlineFriends:g=[],requests:f=[],requestFriend:_=null}=gn(),E=i.useMemo(()=>{if(!r||!r.length)return"";const b=[];for(const N of r){let v=h.find(O=>O.id===N);v||(v=g.find(O=>O.id===N)),v&&b.push(v.name)}return d("friendlist.removefriendconfirm.userlist",["user_names"],[b.join(", ")])},[g,h,r]),I=i.useCallback(b=>{b<0||o(N=>{const v=[...N],O=v.indexOf(b);return O>-1?v.splice(O,1):v.push(b),v})},[o]),C=b=>{!r.length||!b||!b.length||b.length>255||(M(new FI(b,r)),c(!1))},p=()=>{r.length!==0&&(o(b=>(M(new GI(...b)),[])),m(!1))};return i.useEffect(()=>{const b={linkReceived:N=>{const v=N.split("/");if(!(v.length<2))switch(v[1]){case"show":n(!0);return;case"hide":n(!1);return;case"toggle":n(O=>!O);return;case"request":if(v.length<4)return;_(parseInt(v[2]),v[3])}},eventUrlPrefix:"friends/"};return _t(b),()=>Ct(b)},[_]),e?l(V,{children:[l(ae,{className:"nitro-friends",uniqueKey:"nitro-friends",theme:"primary-slim",children:[t(se,{headerText:d("friendlist.friends"),onCloseClick:b=>n(!1)}),l(re,{overflow:"hidden",gap:1,className:"text-black p-0",children:[l(Ub,{fullHeight:!0,overflow:"hidden",children:[t(Za,{headerText:d("friendlist.friends")+` (${h.length})`,isExpanded:!0,children:t(pc,{list:h,selectedFriendsIds:r,selectFriend:I})}),t(Za,{headerText:d("friendlist.friends.offlinecaption")+` (${g.length})`,children:t(pc,{list:g,selectedFriendsIds:r,selectFriend:I})}),t(wv,{headerText:d("friendlist.tab.friendrequests")+` (${f.length})`,isExpanded:!0}),t(Ov,{headerText:d("people.search.title")})]}),r&&r.length>0&&l(w,{gap:1,className:"p-1",children:[t(L,{fullWidth:!0,onClick:()=>c(!0),children:d("friendlist.tip.invite")}),t(L,{fullWidth:!0,variant:"danger",onClick:b=>m(!0),children:d("generic.delete")})]})]})]}),s&&t(yv,{selectedFriendsIds:r,onCloseClick:()=>c(!1),sendRoomInvite:C}),u&&t(Rv,{selectedFriendsIds:r,removeFriendsText:E,onCloseClick:()=>m(!1),removeSelectedFriends:p})]}):null},kv=a=>{const{thread:e=null,group:n=null}=a,r=i.useMemo(()=>n.type===zr.GROUP_CHAT&&ud(n.chats[0].extraData),[n]),o=i.useMemo(()=>!e||!n?!1:!!(n.type===zr.PRIVATE_CHAT&&n.userId===H().userId||r&&n.chats.length&&r.userId===H().userId),[e,n,r]);return!e||!n?null:n.userId?l(w,{fullWidth:!0,justifyContent:o?"end":"start",gap:2,children:[l(U,{shrink:!0,className:"message-avatar",children:[n.type===zr.PRIVATE_CHAT&&!o&&t(st,{figure:e.participant.figure,direction:2}),r&&!o&&t(st,{figure:r.figure,direction:2})]}),l(U,{className:"bg-light text-black border-radius mb-2 rounded py-1 px-2 messages-group-"+(o?"right":"left"),children:[l(U,{className:"fw-bold",children:[o&&H().userName,!o&&(r?r.username:e.participant.name)]}),n.chats.map((s,c)=>t(U,{className:"text-break",children:s.message},c))]}),o&&t(U,{shrink:!0,className:"message-avatar",children:t(st,{figure:H().figure,direction:4})})]}):t(V,{children:n.chats.map((s,c)=>t(w,{fullWidth:!0,gap:2,justifyContent:"start",children:l(U,{className:"w-100 text-break",children:[s.type===jn.SECURITY_NOTIFICATION&&l(w,{gap:2,alignItems:"center",className:"bg-light rounded mb-2 px-2 py-1 small text-muted",children:[t(U,{className:"nitro-friends-spritesheet icon-warning flex-shrink-0"}),t(U,{children:s.message})]}),s.type===jn.ROOM_INVITE&&l(w,{gap:2,alignItems:"center",className:"bg-light rounded mb-2 px-2 py-1 small text-black",children:[t(U,{className:"messenger-notification-icon flex-shrink-0"}),l(U,{children:[d("messenger.invitation")+" ",s.message]})]})]})},c))})},Pv=a=>{const{thread:e=null}=a;return e.setRead(),t(V,{children:e.groups.length>0&&e.groups.map((n,r)=>t(kv,{thread:e,group:n},r))})},Dv=a=>{const[e,n]=i.useState(!1),[r,o]=i.useState(-1),[s,c]=i.useState(""),{visibleThreads:u=[],activeThread:m=null,getMessageThread:h=null,sendMessage:g=null,setActiveThreadId:f=null,closeThread:_=null}=Vd(),{report:E=null}=Mn(),I=i.useRef(),C=()=>m&&m.participant&&M(new xi(m.participant.id)),p=()=>m&&m.participant&&Jt(m.participant.id),b=()=>{!m||!s.length||(g(m,H().userId,s),c(""))},N=v=>{v.key==="Enter"&&b()};return i.useEffect(()=>{const v={linkReceived:O=>{const R=O.split("/");if(R.length===2){if(R[1]==="open"){n(!0);return}if(R[1]==="toggle"){n(F=>!F);return}const y=h(parseInt(R[1]));if(!y)return;f(y.threadId),n(!0)}},eventUrlPrefix:"friends-messenger/"};return _t(v),()=>Ct(v)},[h,f]),i.useEffect(()=>{!e||!m||(I.current.scrollTop=I.current.scrollHeight)},[e,m]),i.useEffect(()=>{if(e&&!m){r>0?f(r):u.length>0&&f(u[0].threadId);return}!e&&m&&(o(m.threadId),f(-1))},[e,m,r,u,f]),e?l(ae,{className:"nitro-friends-messenger",uniqueKey:"nitro-friends-messenger",theme:"primary-slim",children:[t(se,{headerText:d("messenger.window.title",["OPEN_CHAT_COUNT"],[u.length.toString()]),onCloseClick:v=>n(!1)}),t(re,{children:l(ne,{overflow:"hidden",children:[l(T,{size:4,overflow:"hidden",children:[t(S,{bold:!0,children:d("toolbar.icon.label.messenger")}),t(T,{fit:!0,overflow:"auto",children:t(T,{children:u&&u.length>0&&u.map(v=>l(be,{itemActive:m===v,onClick:O=>f(v.threadId),children:[v.unread&&t(Rr,{count:v.unreadCount}),l(w,{fullWidth:!0,alignItems:"center",gap:1,children:[l(w,{alignItems:"center",className:"friend-head px-1",children:[v.participant.id>0&&t(st,{figure:v.participant.figure,headOnly:!0,direction:3}),v.participant.id<=0&&t(je,{isGroup:!0,badgeCode:v.participant.figure})]}),t(S,{truncate:!0,grow:!0,children:v.participant.name})]})]},v.threadId))})})]}),t(T,{size:8,overflow:"hidden",children:m&&l(V,{children:[t(S,{bold:!0,center:!0,children:d("messenger.window.separator",["FRIEND_NAME"],[m.participant.name])}),l(w,{alignItems:"center",justifyContent:"between",gap:1,children:[l(w,{gap:1,children:[l(er,{children:[t(L,{onClick:C,children:t(U,{className:"nitro-friends-spritesheet icon-follow"})}),t(L,{onClick:p,children:t(U,{className:"nitro-friends-spritesheet icon-profile-sm"})})]}),t(L,{variant:"danger",onClick:()=>E(Ve.IM,{reportedUserId:m.participant.id}),children:d("messenger.window.button.report")})]}),t(L,{onClick:v=>_(m.threadId),children:t(Cn,{className:"fa-icon"})})]}),t(T,{fit:!0,className:"bg-muted p-2 rounded chat-messages",children:t(T,{innerRef:I,overflow:"auto",children:t(Pv,{thread:m})})}),l(w,{gap:1,children:[t("input",{type:"text",className:"form-control form-control-sm",maxLength:255,placeholder:d("messenger.window.input.default",["FRIEND_NAME"],[m.participant.name]),value:s,onChange:v=>c(v.target.value),onKeyDown:N}),t(L,{variant:"success",onClick:b,children:d("widgets.chatinput.say")})]})]})})]})})]}):null},Mv=a=>{const{settings:e=null,onlineFriends:n=[]}=gn();return e?l(V,{children:[ki.createPortal(t(Nv,{onlineFriends:n}),document.getElementById("toolbar-friend-bar-container")),t(Av,{}),t(Dv,{})]}):null},Lv=()=>{const{games:a,selectedGame:e,setSelectedGame:n}=Io(),r=s=>{let c=["game-icon"];return e===s&&c.push("selected"),c.join(" ")},o=s=>`url(${s.assetUrl}${s.gameNameId}_icon.png)`;return l(U,{fullWidth:!0,className:"gameList-container bg-dark p-1",children:[d("gamecenter.game_list_title"),t(w,{gap:3,children:a&&a.map((s,c)=>t(U,{className:r(s),onClick:u=>n(s),style:{backgroundImage:o(s)}},c))})]})},Uv=()=>{const{gameURL:a,setGameURL:e}=Io(),[n,r]=i.useState(0),o=i.useRef();return i.useEffect(()=>{if(!o||o&&!o.current)return;r(0);let s=document.createElement("iframe");s.src=a,s.classList.add("game-center-stage"),s.classList.add("h-100"),s.onload=()=>{r(c=>c+=1)},o.current.innerHTML="",o.current.appendChild(s)},[o,a]),i.useEffect(()=>{n>1&&(e(null),M(new BI))},[n,e]),a?t(U,{innerRef:o,className:"game-center-stage"}):null},xv=()=>{const{selectedGame:a,accountStatus:e}=Io();i.useEffect(()=>{a&&(M(new VI(a.gameId)),M(new HI(a.gameId)))},[a]);const n=()=>Qt.uintHexColor(a.bgColor),r=()=>`url(${a.assetUrl}${a.gameNameId}_theme.png)`,o=()=>Qt.uintHexColor(a.textColor),s=()=>{M(new WI(a.gameId))};return l(w,{className:"game-view py-4",fullHeight:!0,style:{backgroundColor:n(),backgroundImage:r(),color:o()},children:[l(w,{className:"w-75",column:!0,alignItems:"center",gap:2,children:[t(S,{bold:!0,children:d(`gamecenter.${a.gameNameId}.description_title`)}),t("img",{src:a.assetUrl+a.gameNameId+"_logo.png"}),(e.hasUnlimitedGames||e.freeGamesLeft>0)&&t(V,{children:l(L,{variant:"light",position:"relative",className:"px-4",onClick:s,children:[d("gamecenter.play_now"),!e.hasUnlimitedGames&&t(Rr,{className:"me-n1 mt-n1",count:e.freeGamesLeft})]})}),t(S,{bold:!0,className:"w-50",center:!0,children:d(`gamecenter.${a.gameNameId}.description_content`)})]}),t(U,{className:"w-25"})]})},Fv=()=>{const{isVisible:a,setIsVisible:e,games:n,accountStatus:r}=Io();if(i.useEffect(()=>{const o=()=>{e(c=>!c)},s={linkReceived:c=>{switch(c.split("/")[1]){case"toggle":o();break}},eventUrlPrefix:"games/"};return _t(s),()=>Ct(s)},[]),!(!a||!n||!r))return l(w,{position:"absolute",className:"top-0 bottom-0 start-0 end-0 bg-black",justifyContent:"center",children:[l(w,{className:"game-center-main",column:!0,children:[t(xv,{}),t(Lv,{})]}),t(Uv,{})]})},Gv=[0,1,2,3,4,5,6,7,8],Bv=a=>{const{badgeParts:e=[],setBadgeParts:n=null}=a,[r,o]=i.useState(-1),{groupCustomize:s=null}=aa(),c=(u,m,h)=>{const g=[...e];g[u][m]=h,n(g),m==="key"&&o(-1)};return!e||!e.length?null:l(V,{children:[r<0&&e&&e.length>0&&e.map((u,m)=>l(w,{alignItems:"center",justifyContent:"between",gap:2,className:"bg-muted rounded px-2 py-1",children:[l(w,{pointer:!0,center:!0,className:"bg-muted rounded p-1",onClick:h=>o(m),children:[e[m].code&&e[m].code.length>0&&t(je,{badgeCode:e[m].code,isGroup:!0}),(!e[m].code||!e[m].code.length)&&t(w,{center:!0,className:"badge-image group-badge",children:t(zs,{className:"fa-icon"})})]}),u.type!==zt.BASE&&t(ne,{gap:1,columnCount:3,children:Gv.map((h,g)=>t(U,{pointer:!0,className:`group-badge-position-swatch ${e[m].position===h?"active":""}`,onClick:f=>c(m,"position",h)},g))}),t(ne,{gap:1,columnCount:8,children:s.badgePartColors.length>0&&s.badgePartColors.map((h,g)=>t(U,{pointer:!0,className:`group-badge-color-swatch ${e[m].color===g+1?"active":""}`,style:{backgroundColor:"#"+h.color},onClick:f=>c(m,"color",g+1)},g))})]},m)),r>=0&&l(ne,{gap:1,columnCount:5,children:[e[r].type===zt.SYMBOL&&t(T,{pointer:!0,center:!0,className:"bg-muted rounded p-1",onClick:u=>c(r,"key",0),children:t(w,{center:!0,className:"badge-image group-badge",children:t(Cn,{className:"fa-icon"})})}),(e[r].type===zt.BASE?s.badgeBases:s.badgeSymbols).map((u,m)=>t(T,{pointer:!0,center:!0,className:"bg-muted rounded p-1",onClick:h=>c(r,"key",u.id),children:t(je,{badgeCode:zt.getCode(e[r].type,u.id,e[r].color,4),isGroup:!0})},m))]})]})},cm=a=>{const{groupData:e=null,setGroupData:n=null,setCloseAction:r=null,skipDefault:o=null}=a,[s,c]=i.useState(null),{groupCustomize:u=null}=aa(),m=()=>{if(!s||!s.length)return"";let g="";return s.forEach(f=>f.code&&(g+=f.code)),g},h=i.useCallback(()=>{if(!e||!s||!s.length)return!1;if(e.groupBadgeParts===s)return!0;if(e.groupId<=0)return n(f=>{const _={...f};return _.groupBadgeParts=s,_}),!0;const g=[];return s.forEach(f=>{f.code&&(g.push(f.key),g.push(f.color),g.push(f.position))}),M(new jI(e.groupId,g)),!0},[e,s,n]);return i.useEffect(()=>{if(e.groupBadgeParts)return;const g=[new zt(zt.BASE,u.badgeBases[0].id,u.badgePartColors[0].id),new zt(zt.SYMBOL,0,u.badgePartColors[0].id),new zt(zt.SYMBOL,0,u.badgePartColors[0].id),new zt(zt.SYMBOL,0,u.badgePartColors[0].id),new zt(zt.SYMBOL,0,u.badgePartColors[0].id)];n(f=>({...f,groupBadgeParts:g}))},[e.groupBadgeParts,u,n]),i.useEffect(()=>{if(e.groupId<=0){c(e.groupBadgeParts?[...e.groupBadgeParts]:null);return}c(e.groupBadgeParts)},[e]),i.useEffect(()=>(r({action:h}),()=>r(null)),[r,h]),l(ne,{overflow:"hidden",gap:1,children:[t(T,{size:2,children:t(w,{center:!0,className:"bg-muted rounded p-1",children:t(je,{badgeCode:m(),isGroup:!0})})}),t(T,{size:10,overflow:"auto",children:t(Bv,{badgeParts:s,setBadgeParts:c})})]})},um=a=>{const{groupData:e=null,setGroupData:n=null,setCloseAction:r=null}=a,[o,s]=i.useState(null),{groupCustomize:c=null}=aa(),u=g=>g===0?c.groupColorsA.find(f=>f.id===o[g]).color:c.groupColorsB.find(f=>f.id===o[g]).color,m=(g,f)=>{s(_=>{const E=[..._];return E[g]=f,E})},h=i.useCallback(()=>!e||!o||!o.length?!1:e.groupColors===o?!0:e.groupId<=0?(n(g=>{const f={...g};return f.groupColors=[...o],f}),!0):(M(new qI(e.groupId,o[0],o[1])),!0),[e,o,n]);return i.useEffect(()=>{if(!c.groupColorsA||!c.groupColorsB||e.groupColors)return;const g=[c.groupColorsA[0].id,c.groupColorsB[0].id];n(f=>({...f,groupColors:g}))},[c,e.groupColors,n]),i.useEffect(()=>{if(e.groupId<=0){s(e.groupColors?[...e.groupColors]:null);return}s(e.groupColors)},[e]),i.useEffect(()=>(r({action:h}),()=>r(null)),[r,h]),o?l(ne,{overflow:"hidden",children:[l(T,{size:2,gap:1,children:[t(S,{bold:!0,children:d("group.edit.color.guild.color")}),e.groupColors&&e.groupColors.length>0&&l(w,{overflow:"hidden",className:"rounded border",children:[t(U,{className:"group-color-swatch",style:{backgroundColor:"#"+u(0)}}),t(U,{className:"group-color-swatch",style:{backgroundColor:"#"+u(1)}})]})]}),l(T,{size:5,gap:1,overflow:"hidden",children:[t(S,{bold:!0,children:d("group.edit.color.primary.color")}),t(Ue,{gap:1,columnCount:7,columnMinWidth:16,columnMinHeight:16,children:e.groupColors&&c.groupColorsA&&c.groupColorsA.map((g,f)=>t("div",{className:Vt("group-badge-color-swatch cursor-pointer",e.groupColors[0]===g.id&&"active"),style:{backgroundColor:"#"+g.color},onClick:()=>m(0,g.id)},f))})]}),l(T,{size:5,gap:1,overflow:"hidden",children:[t(S,{bold:!0,children:d("group.edit.color.secondary.color")}),t(Ue,{gap:1,columnCount:7,columnMinWidth:16,columnMinHeight:16,children:e.groupColors&&c.groupColorsB&&c.groupColorsB.map((g,f)=>t("div",{className:Vt("group-badge-color-swatch cursor-pointer",e.groupColors[1]===g.id&&"active"),style:{backgroundColor:"#"+g.color},onClick:()=>m(1,g.id)},f))})]})]}):null},Vv=a=>{const{groupData:e=null,setGroupData:n=null,purchaseCost:r=0}=a,{groupCustomize:o=null}=aa(),s=()=>{if(!e||!e.groupBadgeParts||!e.groupBadgeParts.length)return"";let u="";return e.groupBadgeParts.forEach(m=>m.code&&(u+=m.code)),u},c=u=>u===0?o.groupColorsA.find(m=>m.id===e.groupColors[u]).color:o.groupColorsB.find(m=>m.id===e.groupColors[u]).color;return e?l(ne,{overflow:"hidden",gap:1,children:[l(T,{size:3,children:[l(T,{center:!0,className:"bg-muted rounded p-1",gap:2,children:[t(S,{bold:!0,center:!0,children:d("group.create.confirm.guildbadge")}),t(je,{badgeCode:s(),isGroup:!0})]}),l(T,{center:!0,className:"bg-muted rounded p-1",gap:2,children:[t(S,{bold:!0,center:!0,children:d("group.edit.color.guild.color")}),l(w,{overflow:"hidden",className:"rounded border",children:[t(U,{className:"group-color-swatch",style:{backgroundColor:"#"+c(0)}}),t(U,{className:"group-color-swatch",style:{backgroundColor:"#"+c(1)}})]})]})]}),l(T,{size:9,justifyContent:"between",children:[l(T,{children:[l(T,{gap:1,children:[t(S,{bold:!0,children:e.groupName}),t(S,{children:e.groupDescription})]}),t(S,{overflow:"auto",children:d("group.create.confirm.info")})]}),t(S,{center:!0,variant:"white",className:"bg-primary rounded p-1",children:d("group.create.confirm.buyinfo",["amount"],[r.toString()])})]})]}):null},dm=a=>{const{groupData:e=null,setGroupData:n=null,setCloseAction:r=null,onClose:o=null,isCreator:s=!1,availableRooms:c=[]}=a,[u,m]=i.useState(""),[h,g]=i.useState(""),[f,_]=i.useState(-1),{showConfirm:E=null}=Xe(),I=()=>{!e||e.groupId<=0||E(d("group.deleteconfirm.desc"),()=>{M(new zI(e.groupId)),o&&o()},null,null,null,d("group.deleteconfirm.title"))},C=i.useCallback(()=>!e||!u||!u.length?!1:u===e.groupName&&h===e.groupDescription?!0:e.groupId<=0?f<=0?!1:(n(p=>{const b={...p};return b.groupName=u,b.groupDescription=h,b.groupHomeroomId=f,b}),!0):(M(new YI(e.groupId,u,h||"")),!0),[e,u,h,f,n]);return i.useEffect(()=>{m(e.groupName||""),g(e.groupDescription||""),_(e.groupHomeroomId)},[e]),i.useEffect(()=>(r({action:C}),()=>r(null)),[r,C]),e?l(T,{justifyContent:"between",overflow:"auto",children:[l(T,{gap:1,children:[l(w,{alignItems:"center",gap:1,children:[t(S,{center:!0,className:"col-3",children:d("group.edit.name")}),t("input",{type:"text",className:"form-control form-control-sm",value:u,maxLength:29,onChange:p=>m(p.target.value)})]}),l(w,{alignItems:"center",gap:1,children:[t(S,{center:!0,className:"col-3",children:d("group.edit.desc")}),t("textarea",{className:"form-control form-control-sm",value:h,maxLength:254,onChange:p=>g(p.target.value)})]}),s&&l(V,{children:[l(w,{alignItems:"center",gap:1,children:[t(S,{center:!0,className:"col-3",children:d("group.edit.base")}),t(T,{fullWidth:!0,gap:1,children:l("select",{className:"form-select form-select-sm",value:f,onChange:p=>_(parseInt(p.target.value)),children:[t("option",{value:-1,disabled:!0,children:d("group.edit.base.select.room")}),c&&c.map((p,b)=>t("option",{value:p.id,children:p.name},b))]})})]}),l(w,{gap:1,children:[t(U,{className:"col-3",children:" "}),t(S,{small:!0,children:d("group.edit.base.warning")})]})]})]}),!s&&t(L,{variant:"danger",onClick:I,children:d("group.delete")}),s&&t(S,{underline:!0,center:!0,fullWidth:!0,pointer:!0,onClick:p=>ee("navigator/create"),children:d("group.createroom")})]}):null},Hv=[1,2,3,4],Wv=a=>{const{onClose:e=null}=a,[n,r]=i.useState(1),[o,s]=i.useState(null),[c,u]=i.useState(null),[m,h]=i.useState(null),[g,f]=i.useState(0),_=()=>{s(null),u(null),e&&e()},E=()=>{if(!c)return;const p=[];c.groupBadgeParts.forEach(b=>{b.code&&(p.push(b.key),p.push(b.color),p.push(b.position))}),M(new XI(c.groupName,c.groupDescription,c.groupHomeroomId,c.groupColors[0],c.groupColors[1],p))},I=()=>{if(!(o&&o.action&&!o.action())){if(n===1){e();return}r(p=>p-1)}},C=()=>{if(!(o&&o.action&&!o.action())){if(n===4){E();return}r(p=>p===4?p:p+1)}};return x($I,p=>{const b=p.getParser(),N=[];b.availableRooms.forEach((v,O)=>N.push({id:O,name:v})),h(N),f(b.groupCost)}),i.useEffect(()=>{r(1),u({groupId:-1,groupName:null,groupDescription:null,groupHomeroomId:-1,groupState:1,groupCanMembersDecorate:!0,groupColors:null,groupBadgeParts:null}),M(new KI)},[u]),c?l(ae,{className:"nitro-group-creator",theme:"primary-slim",children:[t(se,{headerText:d("group.create.title"),onCloseClick:_}),l(re,{children:[t(w,{center:!0,className:"creator-tabs",children:Hv.map((p,b)=>t(w,{center:!0,className:`tab tab-${p===1?"blue-flat":p===4?"yellow":"blue-arrow"} ${n===p?"active":""}`,children:t(S,{variant:"white",children:d(`group.create.steplabel.${p}`)})},b))}),l(T,{overflow:"hidden",children:[l(w,{alignItems:"center",gap:2,children:[t(U,{className:`nitro-group-tab-image tab-${n}`}),l(T,{grow:!0,gap:0,children:[t(S,{bold:!0,fontSize:4,children:d(`group.create.stepcaption.${n}`)}),t(S,{children:d(`group.create.stepdesc.${n}`)})]})]}),l(T,{overflow:"hidden",children:[n===1&&t(dm,{groupData:c,setGroupData:u,setCloseAction:s,onClose:null,isCreator:!0,availableRooms:m}),n===2&&t(cm,{groupData:c,setGroupData:u,setCloseAction:s}),n===3&&t(um,{groupData:c,setGroupData:u,setCloseAction:s}),n===4&&t(Vv,{groupData:c,setGroupData:u,purchaseCost:g})]}),l(w,{justifyContent:"between",children:[t(L,{variant:"link",className:"text-black",onClick:I,children:d(n===1?"generic.cancel":"group.create.previousstep")}),t(L,{disabled:n===4&&!qr(),variant:n===4?qr()?"success":"danger":"primary",onClick:C,children:d(n===4?qr()?"group.create.confirm.buy":"group.create.confirm.viprequired":"group.create.nextstep")})]})]})]})]}):null},jv=["regular","exclusive","private"],mm=a=>{const{groupInformation:e=null,onClose:n=null,overflow:r="hidden",...o}=a,{showConfirm:s=null}=Xe(),c=e&&e.ownerName===H().userName,u=()=>e&&$i(e.id),m=()=>{s(d("group.leaveconfirm.desc"),()=>{M(new Fi(e.id,H().userId)),n&&n()},null)},h=()=>e.membershipType===vt.NOT_MEMBER||e.membershipType===vt.REQUEST_PENDING?null:c?t("i",{className:"icon icon-group-owner",title:d("group.youareowner")}):e.isAdmin?t("i",{className:"icon icon-group-admin",title:d("group.youareadmin")}):t("i",{className:"icon icon-group-member",title:d("group.youaremember")}),g=()=>{if(c)return"group.youareowner";if(e.type===on.PRIVATE&&e.membershipType!==vt.MEMBER)return"";if(e.membershipType===vt.MEMBER)return"group.leave";if(e.membershipType===vt.NOT_MEMBER&&e.type===on.REGULAR)return"group.join";if(e.membershipType===vt.REQUEST_PENDING)return"group.membershippending";if(e.membershipType===vt.NOT_MEMBER&&e.type===on.EXCLUSIVE)return"group.requestmembership"},f=()=>{if(!(e.type===on.PRIVATE&&e.membershipType===vt.NOT_MEMBER)){if(e.membershipType===vt.MEMBER){m();return}u()}},_=E=>{switch(E){case"members":zl(e.id);break;case"members_pending":zl(e.id,2);break;case"manage":gd(e.id);break;case"homeroom":En(e.roomId);break;case"furniture":ee("catalog/open/"+ut.GUILD_CUSTOM_FURNI);break;case"popular_groups":ee("navigator/search/groups");break}};return e?l(ne,{overflow:r,...o,children:[l(T,{center:!0,size:3,overflow:"hidden",children:[t(w,{alignItems:"center",overflow:"hidden",className:"group-badge",children:t(je,{badgeCode:e.badge,isGroup:!0,scale:2})}),l(T,{alignItems:"center",gap:1,children:[t(S,{small:!0,underline:!0,pointer:!0,onClick:()=>_("members"),children:d("group.membercount",["totalMembers"],[e.membersCount.toString()])}),e.pendingRequestsCount>0&&t(S,{small:!0,underline:!0,pointer:!0,onClick:()=>_("members_pending"),children:d("group.pendingmembercount",["amount"],[e.pendingRequestsCount.toString()])}),e.isOwner&&t(S,{small:!0,underline:!0,pointer:!0,onClick:()=>_("manage"),children:d("group.manage")})]}),h()]}),l(T,{size:9,justifyContent:"between",overflow:"auto",children:[l(T,{overflow:"hidden",children:[l(T,{gap:1,children:[l(w,{alignItems:"center",gap:2,children:[t(S,{bold:!0,children:e.title}),l(w,{gap:1,children:[t("i",{className:"icon icon-group-type-"+e.type,title:d(`group.edit.settings.type.${jv[e.type]}.help`)}),e.canMembersDecorate&&t("i",{className:"icon icon-group-decorate",title:d("group.memberscandecorate")})]})]}),t(S,{small:!0,children:d("group.created",["date","owner"],[e.createdAt,e.ownerName])})]}),t(S,{small:!0,overflow:"auto",className:"group-description",children:e.description})]}),l(T,{children:[l(T,{gap:1,children:[t(S,{small:!0,underline:!0,pointer:!0,onClick:()=>_("homeroom"),children:d("group.linktobase")}),t(S,{small:!0,underline:!0,pointer:!0,onClick:()=>_("furniture"),children:d("group.buyfurni")}),t(S,{small:!0,underline:!0,pointer:!0,onClick:()=>_("popular_groups"),children:d("group.showgroups")})]}),(e.type!==on.PRIVATE||e.type===on.PRIVATE&&e.membershipType===vt.MEMBER)&&t(L,{disabled:e.membershipType===vt.REQUEST_PENDING||c,onClick:f,children:d(g())})]})]})]}):null},qv=a=>{const[e,n]=i.useState(null);return x(Xs,r=>{const o=r.getParser();(e&&e.id===o.id||o.flag)&&n(o)}),e?l(ae,{className:"nitro-group-information-standalone",theme:"primary-slim",children:[t(se,{headerText:d("group.window.title"),onCloseClick:r=>n(null)}),t(re,{children:t(mm,{groupInformation:e,onClose:()=>n(null)})})]}):null},Yv=["regular","exclusive","private"],zv=a=>{const{groupData:e=null,setGroupData:n=null,setCloseAction:r=null}=a,[o,s]=i.useState(e.groupState),[c,u]=i.useState(e.groupCanMembersDecorate),m=i.useCallback(()=>e?o===e.groupState&&c===e.groupCanMembersDecorate?!0:e.groupId<=0?(n(h=>{const g={...h};return g.groupState=o,g.groupCanMembersDecorate=c,g}),!0):(M(new QI(e.groupId,o,c?0:1)),!0):!1,[e,o,c,n]);return i.useEffect(()=>{s(e.groupState),u(e.groupCanMembersDecorate)},[e]),i.useEffect(()=>(r({action:m}),()=>r(null)),[r,m]),l(T,{overflow:"auto",children:[t(T,{children:Yv.map((h,g)=>l(w,{alignItems:"center",gap:1,children:[t("input",{className:"form-check-input",type:"radio",name:"groupState",checked:o===g,onChange:f=>s(g)}),l(T,{gap:0,children:[l(w,{gap:1,children:[t("i",{className:`icon icon-group-type-${g}`}),t(S,{bold:!0,children:d(`group.edit.settings.type.${h}.label`)})]}),t(S,{children:d(`group.edit.settings.type.${h}.help`)})]})]},g))}),t(jb,{}),l(w,{alignItems:"center",gap:1,children:[t("input",{className:"form-check-input",type:"checkbox",checked:c,onChange:h=>u(g=>!g)}),l(T,{gap:1,children:[t(S,{bold:!0,children:d("group.edit.settings.rights.caption")}),t(S,{children:d("group.edit.settings.rights.members.help")})]})]})]})},$v=[1,2,3,5],Kv=a=>{const[e,n]=i.useState(1),[r,o]=i.useState(null),[s,c]=i.useState(null),u=()=>{o(h=>(h&&h.action&&h.action(),null)),c(null)},m=h=>{r&&r.action&&r.action(),n(h)};return x(Xs,h=>{const g=h.getParser();!s||s.groupId!==g.id||c(f=>{const _={...f};return _.groupName=g.title,_.groupDescription=g.description,_.groupState=g.type,_.groupCanMembersDecorate=g.canMembersDecorate,_})}),x(JI,h=>{const g=h.getParser(),f=[];g.badgeParts.forEach((_,E)=>{f.push(new Mo(_.isBase?Mo.BASE:Mo.SYMBOL,_.key,_.color,_.position))}),c({groupId:g.id,groupName:g.title,groupDescription:g.description,groupHomeroomId:g.roomId,groupState:g.state,groupCanMembersDecorate:g.canMembersDecorate,groupColors:[g.colorA,g.colorB],groupBadgeParts:f})}),!s||s.groupId<=0?null:l(ae,{className:"nitro-group-manager",children:[t(se,{headerText:d("group.window.title"),onCloseClick:u}),t(Ir,{children:$v.map(h=>t(qn,{isActive:e===h,onClick:()=>m(h),children:d(`group.edit.tab.${h}`)},h))}),l(re,{children:[l(w,{alignItems:"center",gap:2,children:[t(U,{className:`nitro-group-tab-image tab-${e}`}),l(T,{grow:!0,gap:0,children:[t(S,{bold:!0,fontSize:4,children:d(`group.edit.tabcaption.${e}`)}),t(S,{children:d(`group.edit.tabdesc.${e}`)})]})]}),l(T,{grow:!0,overflow:"hidden",children:[e===1&&t(dm,{groupData:s,setGroupData:c,setCloseAction:o,onClose:u}),e===2&&t(cm,{groupData:s,setGroupData:c,setCloseAction:o,skipDefault:!0}),e===3&&t(um,{groupData:s,setGroupData:c,setCloseAction:o}),e===5&&t(zv,{groupData:s,setGroupData:c,setCloseAction:o})]})]})]})},Xv=a=>{const[e,n]=i.useState(-1),[r,o]=i.useState(-1),[s,c]=i.useState(null),[u,m]=i.useState(-1),[h,g]=i.useState(0),[f,_]=i.useState(""),[E,I]=i.useState(null),{showConfirm:C=null}=Xe(),p=R=>{if(R.rank===Xt.OWNER)return"group.members.owner";if(s.admin){if(R.rank===Xt.ADMIN)return"group.members.removerights";if(R.rank===Xt.MEMBER)return"group.members.giverights"}return""},b=i.useCallback(()=>{e===-1||r===-1||u===-1||M(new Rl(e,u,f,r))},[e,r,u,f]),N=R=>{!s.admin||R.rank===Xt.OWNER||(R.rank!==Xt.ADMIN?M(new tE(s.groupId,R.id)):M(new nE(s.groupId,R.id)),b())},v=R=>{!s.admin||R.rank!==Xt.REQUESTED||(M(new rE(s.groupId,R.id)),b())},O=R=>{if(s.admin){if(R.rank===Xt.REQUESTED){M(new sE(s.groupId,R.id)),b();return}I(R.name),M(new aE(s.groupId,R.id))}};return x(ZI,R=>{const y=R.getParser();c(y),o(y.level),g(Math.ceil(y.totalMembersCount/y.pageSize))}),x(eE,R=>{const y=R.getParser();C(d(y.furnitureCount>0?"group.kickconfirm.desc":"group.kickconfirm_nofurni.desc",["user","amount"],[E,y.furnitureCount.toString()]),()=>{M(new Fi(s.groupId,y.userId)),b()},null),I(null)}),i.useEffect(()=>{const R={linkReceived:y=>{const F=y.split("/");if(F.length<2)return;const P=parseInt(F[1])||-1,D=parseInt(F[2])||3;n(P),o(D),m(0)},eventUrlPrefix:"group-members/"};return _t(R),()=>Ct(R)},[]),i.useEffect(()=>{m(0)},[e,r,f]),i.useEffect(()=>{e===-1||r===-1||u===-1||M(new Rl(e,u,f,r))},[e,r,u,f]),i.useEffect(()=>{e!==-1&&(o(-1),c(null),g(0),_(""),I(null))},[e]),e===-1||!s?null:l(ae,{className:"nitro-group-members",theme:"primary-slim",children:[t(se,{headerText:d("group.members.title",["groupName"],[s?s.groupTitle:""]),onCloseClick:R=>n(-1)}),l(re,{overflow:"hidden",children:[l(w,{gap:2,children:[t(w,{center:!0,className:"group-badge",children:t(je,{badgeCode:s.badge,isGroup:!0,className:"mx-auto d-block"})}),l(T,{fullWidth:!0,gap:1,children:[t("input",{type:"text",className:"form-control form-control-sm w-100",placeholder:d("group.members.searchinfo"),value:f,onChange:R=>_(R.target.value)}),l("select",{className:"form-select form-select-sm w-100",value:r,onChange:R=>o(parseInt(R.target.value)),children:[t("option",{value:"0",children:d("group.members.search.all")}),t("option",{value:"1",children:d("group.members.search.admins")}),t("option",{value:"2",children:d("group.members.search.pending")})]})]})]}),t(ne,{columnCount:2,overflow:"auto",className:"nitro-group-members-list-grid",children:s.result.map((R,y)=>l(w,{gap:2,alignItems:"center",overflow:"hidden",className:"member-list-item bg-white rounded p-2",children:[t("div",{className:"avatar-head cursor-pointer",onClick:()=>Jt(R.id),children:t(st,{figure:R.figure,headOnly:!0,direction:2})}),l(T,{grow:!0,gap:1,children:[t(S,{bold:!0,small:!0,pointer:!0,onClick:F=>Jt(R.id),children:R.name}),R.rank!==Xt.REQUESTED&&t(S,{small:!0,italics:!0,variant:"muted",children:d("group.members.since",["date"],[R.joinedAt])})]}),l(T,{gap:1,children:[R.rank!==Xt.REQUESTED&&t(w,{center:!0,children:t(U,{pointer:s.admin,className:`icon icon-group-small-${R.rank===Xt.OWNER?"owner":R.rank===Xt.ADMIN?"admin":s.admin&&R.rank===Xt.MEMBER?"not-admin":""}`,title:d(p(R)),onClick:F=>N(R)})}),s.admin&&R.rank===Xt.REQUESTED&&t(w,{alignItems:"center",children:t(U,{pointer:!0,className:"nitro-friends-spritesheet icon-accept",title:d("group.members.accept"),onClick:F=>v(R)})}),s.admin&&R.rank!==Xt.OWNER&&R.id!==H().userId&&t(w,{alignItems:"center",children:t(U,{pointer:!0,className:"nitro-friends-spritesheet icon-deny",title:d(R.rank===Xt.REQUESTED?"group.members.reject":"group.members.kick"),onClick:F=>O(R)})})]})]},y))}),l(w,{gap:1,justifyContent:"between",alignItems:"center",children:[t(L,{disabled:s.pageIndex===0,onClick:R=>m(y=>y-1),children:t(sn,{className:"fa-icon"})}),t(S,{small:!0,children:d("group.members.pageinfo",["amount","page","totalPages"],[s.totalMembersCount.toString(),(s.pageIndex+1).toString(),h.toString()])}),t(L,{disabled:s.pageIndex===h-1,onClick:R=>m(y=>y+1),children:t(an,{className:"fa-icon"})})]})]})]})},Qv=a=>{const[e,n]=i.useState(!1);return aa(),x(oE,r=>{const o=r.getParser();n(!1),En(o.roomId)}),i.useEffect(()=>{const r={linkReceived:o=>{const s=o.split("/");if(!(s.length<2))switch(s[1]){case"create":n(!0);return;case"manage":if(!s[2])return;n(!1),M(new iE(Number(s[2])));return}},eventUrlPrefix:"groups/"};return _t(r),()=>Ct(r)},[]),l(V,{children:[e&&t(Wv,{onClose:()=>n(!1)}),!e&&t(Kv,{}),t(Xv,{}),t(qv,{})]})},Jv=a=>{const{helpRequestDescription:e=null,helpRequestAverageTime:n=0}=a,r=o=>M(new lE(o));return l(T,{children:[l(T,{gap:0,className:"bg-muted p-2 rounded",children:[t(S,{bold:!0,children:d("guide.help.request.guide.accept.request.title")}),t(S,{variant:"muted",children:d("guide.help.request.type.1")}),t(S,{wrap:!0,textBreak:!0,children:e})]}),l(T,{gap:1,children:[t(L,{variant:"success",onClick:o=>r(!0),children:d("guide.help.request.guide.accept.accept.button")}),t(L,{variant:"danger",onClick:o=>r(!1),children:d("guide.help.request.guide.accept.skip.link")})]})]})},Zv=a=>{const{isOnDuty:e=!1,isHandlingGuideRequests:n=!1,setIsHandlingGuideRequests:r=null,isHandlingHelpRequests:o=!1,setIsHandlingHelpRequests:s=null,isHandlingBullyReports:c=!1,setIsHandlingBullyReports:u=null,guidesOnDuty:m=0,helpersOnDuty:h=0,guardiansOnDuty:g=0,processAction:f=null}=a;return l(T,{children:[l(w,{alignItems:"center",gap:2,className:"bg-muted p-2 rounded",children:[t(U,{className:"duty-switch"+(e?"":" off"),onClick:_=>f("toggle_duty")}),l(T,{gap:0,children:[t(S,{bold:!0,children:d("guide.help.guide.tool.yourstatus")}),t(S,{children:d(`guide.help.guide.tool.duty.${e?"on":"off"}`)})]})]}),l(T,{gap:1,children:[t(S,{bold:!0,children:d("guide.help.guide.tool.tickettypeselection.caption")}),l(w,{alignItems:"center",gap:1,children:[t("input",{className:"form-check-input",disabled:e,type:"checkbox",checked:n,onChange:_=>r(_.target.checked)}),t(S,{children:d("guide.help.guide.tool.tickettypeselection.guiderequests")})]}),l(w,{alignItems:"center",gap:1,children:[t("input",{className:"form-check-input",disabled:e,type:"checkbox",checked:o,onChange:_=>s(_.target.checked)}),t(S,{children:d("guide.help.guide.tool.tickettypeselection.onlyhelprequests")})]}),l(w,{alignItems:"center",gap:1,children:[t("input",{className:"form-check-input",disabled:e,type:"checkbox",checked:c,onChange:_=>u(_.target.checked)}),t(S,{children:d("guide.help.guide.tool.tickettypeselection.bullyreports")})]})]}),t("hr",{className:"bg-dark m-0"}),l(w,{center:!0,gap:2,children:[t(U,{className:"info-icon"}),l(T,{gap:1,children:[t(U,{dangerouslySetInnerHTML:{__html:d("guide.help.guide.tool.guidesonduty",["amount"],[m.toString()])}}),t(U,{dangerouslySetInnerHTML:{__html:d("guide.help.guide.tool.helpersonduty",["amount"],[h.toString()])}}),t(U,{dangerouslySetInnerHTML:{__html:d("guide.help.guide.tool.guardiansonduty",["amount"],[g.toString()])}})]})]}),t("hr",{className:"bg-dark m-0"}),l(w,{justifyContent:"between",gap:2,children:[t(L,{disabled:!0,onClick:_=>f("forum_link"),children:d("guide.help.guide.tool.forum.link")}),t(L,{disabled:!0,children:d("guide.help.guide.tool.skill.link")})]})]})},ew=a=>{const e=i.useRef(null),{isGuide:n=!1,userId:r=0,userName:o=null,userFigure:s=null,isTyping:c=!1,messageGroups:u=[]}=a,[m,h]=i.useState("");i.useEffect(()=>{var p;(p=e.current)==null||p.scrollIntoView({block:"end",behavior:"smooth"})},[u]);const g=i.useCallback(()=>{M(new cE)},[]),f=i.useCallback(()=>{M(new uE)},[]),_=i.useCallback(()=>{M(new dE)},[]);x(mE,p=>{const b=p.getParser();En(b.requesterRoomId)});const E=i.useCallback(()=>{!m||!m.length||(M(new gE(m)),h(""))},[m]),I=i.useCallback(p=>{p.key==="Enter"&&E()},[E]),C=i.useCallback(p=>p===H().userId,[]);return l(T,{fullHeight:!0,children:[l(w,{alignItems:"center",justifyContent:"between",gap:1,className:"bg-muted p-2 rounded",children:[n&&l(er,{children:[t(L,{onClick:g,children:d("guide.help.request.guide.ongoing.visit.button")}),t(L,{onClick:f,children:d("guide.help.request.guide.ongoing.invite.button")})]}),!n&&l(T,{gap:0,children:[t(S,{bold:!0,children:o}),t(S,{children:d("guide.help.request.user.ongoing.guide.desc")})]}),t(L,{variant:"danger",disabled:!0,children:d("guide.help.common.report.link")})]}),t(T,{overflow:"hidden",gap:1,className:"bg-muted rounded chat-messages p-2",children:l(T,{overflow:"auto",children:[u.map((p,b)=>l(w,{fullWidth:!0,justifyContent:C(p.userId)?"end":"start",gap:2,children:[t(U,{shrink:!0,className:"message-avatar",children:!C(p.userId)&&t(st,{figure:s,direction:2})}),l(U,{className:"bg-light text-black border-radius mb-2 rounded py-1 px-2 messages-group-"+(C(p.userId)?"right":"left"),children:[l(S,{bold:!0,children:[C(p.userId)&&H().userName,!C(p.userId)&&o]}),p.messages.map((N,v)=>t(U,{pointer:!!N.roomId,className:N.roomId?"text-break text-underline":"text-break",onClick:()=>N.roomId?En(N.roomId):null,children:N.message},v))]}),C(p.userId)&&t(U,{className:"message-avatar flex-shrink-0",children:t(st,{figure:H().figure,direction:4})})]},b)),t("div",{ref:e})]})}),l(T,{gap:1,children:[l(w,{gap:1,children:[t("input",{type:"text",className:"form-control form-control-sm",placeholder:d("guide.help.request.guide.ongoing.input.empty",["name"],[o]),value:m,onChange:p=>h(p.target.value),onKeyDown:I}),t(L,{variant:"success",onClick:E,children:d("widgets.chatinput.say")})]}),c&&t(S,{variant:"muted",children:d("guide.help.common.typing")})]}),t(L,{fullWidth:!0,variant:"success",onClick:_,children:d("guide.help.request."+(n?"guide":"user")+".ongoing.close.link")})]})},tw=15,nw=a=>{const{userRequest:e="",setUserRequest:n=null}=a,[r,o]=i.useState(!1),s=()=>{o(!0),M(new hE(1,e))};return l(T,{children:[t(S,{children:d("guide.help.request.user.create.help")}),t("textarea",{className:"request-message",maxLength:140,value:e,onChange:c=>n(c.target.value),placeholder:d("guide.help.request.user.create.input.help")}),t(L,{fullWidth:!0,variant:"success",disabled:e.length<tw||r,onClick:s,children:d("guide.help.request.user.create.input.button")})]})},rw=a=>{const{userName:e=null}=a,n=r=>M(new fE(r));return l(T,{children:[l(w,{justifyContent:"between",gap:1,className:"bg-muted p-2 rounded",children:[l(T,{gap:0,children:[t(S,{bold:!0,children:e}),t(S,{children:d("guide.help.request.user.feedback.guide.desc")})]}),t(L,{variant:"danger",disabled:!0,children:d("guide.help.common.report.link")})]}),l(T,{gap:1,children:[t(S,{bold:!0,children:d("guide.help.request.user.feedback.closed.title")}),t(S,{children:d("guide.help.request.user.feedback.closed.desc")})]}),e&&e.length>0&&l(V,{children:[t("hr",{className:"bg-dark m-0 mt-auto"}),l(T,{children:[t(S,{center:!0,bold:!0,children:d("guide.help.request.user.feedback.question")}),l(w,{gap:1,children:[t(L,{fullWidth:!0,variant:"success",onClick:r=>n(!0),children:d("guide.help.request.user.feedback.positive.button")}),t(L,{fullWidth:!0,variant:"danger",onClick:r=>n(!1),children:d("guide.help.request.user.feedback.negative.button")})]})]})]})]})},sw=a=>l(T,{gap:1,children:[t(S,{bold:!0,children:d("guide.help.request.no_tour_guides.title")}),t(S,{children:d("guide.help.request.no_tour_guides.message")})]}),aw=a=>{const{helpRequestDescription:e=null,helpRequestAverageTime:n=0}=a,r=()=>M(new pE);return l(T,{children:[l(T,{gap:0,className:"bg-muted rounded p-2",children:[t(S,{bold:!0,children:d("guide.help.request.guide.accept.request.title")}),t(S,{variant:"muted",children:d("guide.help.request.type.1")}),t(S,{wrap:!0,textBreak:!0,children:e})]}),l(T,{gap:1,children:[t(S,{bold:!0,children:d("guide.help.request.user.pending.info.title")}),t(S,{children:d("guide.help.request.user.pending.info.message")}),t(S,{children:d("guide.help.request.user.pending.info.waiting",["waitingtime"],[n.toString()])})]}),t(L,{variant:"danger",onClick:r,children:d("guide.help.request.user.pending.cancel.button")})]})},ow=a=>t(T,{gap:1,children:t(S,{children:d("guide.help.request.user.guide.disconnected.error.desc")})}),iw=a=>l(T,{gap:1,children:[t(S,{bold:!0,children:d("guide.help.request.user.thanks.info.title")}),t(S,{children:d("guide.help.request.user.thanks.info.desc")})]}),lw=a=>{const[e,n]=i.useState(!1),[r,o]=i.useState(d("guide.help.guide.tool.title")),[s,c]=i.useState(!1),[u,m]=i.useState(ge.GUIDE_TOOL_MENU),[h,g]=i.useState(!1),[f,_]=i.useState(!1),[E,I]=i.useState(!1),[C,p]=i.useState(!1),[b,N]=i.useState(0),[v,O]=i.useState(0),[R,y]=i.useState(0),[F,P]=i.useState(""),[D,A]=i.useState(null),[k,B]=i.useState(0),[G,z]=i.useState(0),[X,Y]=i.useState(null),[Ee,le]=i.useState(null),[De,Qe]=i.useState(!1),[ft,Ze]=i.useState([]),{simpleAlert:Gt=null}=Xe(),We=i.useCallback((Fe,Ie)=>{switch(Fe){case ge.GUIDE_TOOL_MENU:o(d("guide.help.guide.tool.title")),c(!1);break;case ge.GUIDE_ACCEPT:o(d("guide.help.request.guide.accept.title")),c(!0);break;case ge.GUIDE_ONGOING:o(d("guide.help.request.guide.ongoing.title",["name"],[Ie])),c(!0);break;case ge.USER_CREATE:o(d("guide.help.request.user.create.title")),c(!1);break;case ge.USER_PENDING:o(d("guide.help.request.user.pending.title")),c(!0);break;case ge.USER_ONGOING:o(d("guide.help.request.user.ongoing.title",["name"],[Ie])),c(!0);break;case ge.USER_FEEDBACK:o(d("guide.help.request.user.feedback.title")),c(!0);break;case ge.USER_THANKS:o(d("guide.help.request.user.thanks.title")),c(!1);break;case ge.USER_NO_HELPERS:o(d("guide.help.request.no_tour_guides.heading")),c(!1);break;case ge.USER_SOMETHING_WRONG:o(d("guide.help.request.user.guide.disconnected.error.heading")),c(!1);break}m(Fe),n(!0)},[]),Yt=i.useCallback(Fe=>{switch(Fe.type){case Ht.SHOW_GUIDE_TOOL:n(!0);return;case Ht.HIDE_GUIDE_TOOL:n(!1);return;case Ht.TOGGLE_GUIDE_TOOL:n(Ie=>!Ie);return;case Ht.CREATE_HELP_REQUEST:We(ge.USER_CREATE);return}},[We]);ct(Ht.SHOW_GUIDE_TOOL,Yt),ct(Ht.HIDE_GUIDE_TOOL,Yt),ct(Ht.TOGGLE_GUIDE_TOOL,Yt),ct(Ht.CREATE_HELP_REQUEST,Yt),x(Bu,Fe=>{!Fe.getParser().isAllowed(Gu.USE_GUIDE_TOOL)&&h&&(g(!1),M(new yl(!1,!1,!1,!1)))}),x(IE,Fe=>{const Ie=Fe.getParser();g(Ie.onDuty),O(Ie.guidesOnDuty),N(Ie.helpersOnDuty),y(Ie.guardiansOnDuty)}),x(EE,Fe=>{const Ie=Fe.getParser();A(Ie.helpRequestDescription),B(Ie.roleSpecificWaitTime),Ie.asGuide&&h&&We(ge.GUIDE_ACCEPT),Ie.asGuide||We(ge.USER_PENDING)}),x(_E,Fe=>{const Ie=Fe.getParser();h?(z(Ie.requesterUserId),Y(Ie.requesterName),le(Ie.requesterFigure),We(ge.GUIDE_ONGOING,Ie.requesterName)):(z(Ie.guideUserId),Y(Ie.guideName),le(Ie.guideFigure),We(ge.USER_ONGOING,Ie.guideName))}),x(CE,Fe=>{const Ie=Fe.getParser();Qe(Ie.isTyping)}),x(bE,Fe=>{const Ie=Fe.getParser(),ze=[...ft];let Ot=ze[ze.length-1];(!Ot||Ot.userId!==Ie.senderId)&&(Ot=new Kl(Ie.senderId),ze.push(Ot)),Ot.addChat(new $l(Ie.chatMessage)),Ze(ze)}),x(SE,Fe=>{const Ie=Fe.getParser();if(Ie.roomId!==0){const ze=[...ft];let Ot=ze[ze.length-1];const me=h?H().userId:G;(!Ot||Ot.userId!==me)&&(Ot=new Kl(me),ze.push(Ot)),Ot.addChat(new $l(Ie.roomName,Ie.roomId)),Ze(ze)}}),x(NE,Fe=>{h?(z(0),Y(null),le(null),Qe(!1),Ze([]),We(ge.GUIDE_TOOL_MENU)):We(ge.USER_FEEDBACK)}),x(TE,Fe=>{switch(Fe.getParser().errorCode){case 0:We(ge.USER_SOMETHING_WRONG);break;case 1:case 2:We(ge.USER_NO_HELPERS);break}}),x(vE,Fe=>{z(0),Y(null),le(null),Qe(!1),Ze([]),We(h?ge.GUIDE_TOOL_MENU:ge.USER_THANKS)}),i.useEffect(()=>{const Fe={linkReceived:Ie=>{const ze=Ie.split("/");if(!(ze.length<2))switch(ze[1]){case"tour":return}},eventUrlPrefix:"help/"};return _t(Fe),()=>Ct(Fe)},[]);const Nn=i.useCallback(Fe=>{switch(Fe){case"close":n(!1),P(""),m(ge.GUIDE_TOOL_MENU);return;case"toggle_duty":if(!f&&!E&&!C){Gt(d("guide.help.guide.tool.noqueueselected.message"),null,null,null,d("guide.help.guide.tool.noqueueselected.caption"),null);return}g(ze=>(M(new yl(!ze,ze?!1:E,ze?!1:C,ze?!1:f)),!ze));return;case"forum_link":const Ie=K("group.homepage.url","").replace("%groupid%",K("guide.help.alpha.groupid","0"));window.open(Ie);return}},[f,E,C,Gt]);return e?l(ae,{className:"nitro-guide-tool",theme:"primary-slim",children:[t(se,{headerText:r,onCloseClick:Fe=>Nn("close"),noCloseButton:s}),l(re,{className:"text-black",children:[u===ge.GUIDE_TOOL_MENU&&t(Zv,{isOnDuty:h,isHandlingGuideRequests:E,setIsHandlingGuideRequests:I,isHandlingHelpRequests:C,setIsHandlingHelpRequests:p,isHandlingBullyReports:f,setIsHandlingBullyReports:_,guidesOnDuty:v,helpersOnDuty:b,guardiansOnDuty:R,processAction:Nn}),u===ge.GUIDE_ACCEPT&&t(Jv,{helpRequestDescription:D,helpRequestAverageTime:k}),[ge.GUIDE_ONGOING,ge.USER_ONGOING].includes(u)&&t(ew,{isGuide:h,userId:G,userName:X,userFigure:Ee,isTyping:De,messageGroups:ft}),u===ge.USER_CREATE&&t(nw,{userRequest:F,setUserRequest:P}),u===ge.USER_PENDING&&t(aw,{helpRequestDescription:D,helpRequestAverageTime:k}),u===ge.USER_FEEDBACK&&t(rw,{userName:X}),u===ge.USER_THANKS&&t(iw,{}),u===ge.USER_NO_HELPERS&&t(sw,{}),u===ge.USER_SOMETHING_WRONG&&t(ow,{})]})]}):null},cw=a=>{const[e,n]=i.useState(!1),[r,o]=i.useState(null),[s,c]=i.useState(0),[u,m]=i.useState(null),{userFigure:h=null}=_r(),{purse:g=null,clubStatus:f=null}=ts(),{badgeCodes:_=[],activate:E=null,deactivate:I=null}=_o(),C=()=>g.clubDays<=0?d("purse.clubdays.zero.amount.text"):g.minutesUntilExpiration>-1&&g.minutesUntilExpiration<60*24?Hn.shortFormat(g.minutesUntilExpiration*60):Hn.shortFormat((g.clubPeriods*31+g.clubDays)*86400),p=()=>{switch(f){case Bn.ACTIVE:return d(`hccenter.status.${f}.info`,["timeleft","joindate","streakduration"],[C(),r==null?void 0:r.firstSubscriptionDate,Hn.shortFormat((r==null?void 0:r.currentHcStreak)*86400)]);case Bn.EXPIRED:return d(`hccenter.status.${f}.info`,["joindate"],[r==null?void 0:r.firstSubscriptionDate]);default:return d(`hccenter.status.${f}.info`)}},b=()=>!r||r.timeUntilPayday<60?d("hccenter.special.time.soon"):Hn.shortFormat(r.timeUntilPayday*60),N=()=>d("hccenter.special.sum",["credits"],[((r==null?void 0:r.creditRewardForStreakBonus)+(r==null?void 0:r.creditRewardForMonthlySpent)).toString()]);if(x(_u,O=>{const R=O.getParser();c(R.giftsAvailable)}),x(wE,O=>{const R=O.getParser();o(R.data)}),i.useEffect(()=>{const O={linkReceived:R=>{const y=R.split("/");if(!(y.length<2))switch(y[1]){case"open":if(y.length>2)switch(y[2]){case"hccenter":n(!0);break}return}},eventUrlPrefix:"habboUI/"};return _t(O),()=>Ct(O)},[]),i.useEffect(()=>{m(Ib(_))},[_]),i.useEffect(()=>{if(!e)return;const O=E();return()=>I(O)},[e,E,I]),i.useEffect(()=>{M(new Cu),M(new RE)},[]),!e)return null;const v=t(Ba,{id:"popover-basic",children:l(Ba.Body,{className:"text-black py-2 px-3",children:[t("h5",{children:d("hccenter.breakdown.title")}),t("div",{children:d("hccenter.breakdown.creditsspent",["credits"],[r==null?void 0:r.totalCreditsSpent.toString()])}),t("div",{children:d("hccenter.breakdown.paydayfactor.percent",["percent"],[((r==null?void 0:r.kickbackPercentage)*100).toString()])}),t("div",{children:d("hccenter.breakdown.streakbonus",["credits"],[r==null?void 0:r.creditRewardForStreakBonus.toString()])}),t("hr",{className:"w-100 text-black my-1"}),t("div",{children:d("hccenter.breakdown.total",["credits","actual"],[N(),(((r==null?void 0:r.kickbackPercentage)*(r==null?void 0:r.totalCreditsSpent)+(r==null?void 0:r.creditRewardForStreakBonus))*100/100).toString()])}),t("div",{className:"btn btn-link text-primary p-0",onClick:()=>ee("habbopages/"+K("hc.center")["payday.habbopage"]),children:d("hccenter.special.infolink")})]})});return l(ae,{theme:"primary-slim",className:"nitro-hc-center",children:[t(se,{headerText:d("generic.hccenter"),onCloseClick:()=>n(!1)}),l(w,{position:"relative",className:"bg-muted p-2",children:[l(T,{gap:1,children:[t("div",{className:"hc-logo"}),t(w,{children:t(L,{variant:"success",onClick:O=>ee("catalog/open/"+K("catalog.links")["hc.buy_hc"]),children:d(f===Bn.ACTIVE?"hccenter.btn.extend":"hccenter.btn.buy")})})]}),t(U,{position:"absolute",className:"end-0 p-4 top-0 habbo-avatar",children:t(st,{figure:h,direction:4,scale:2})})]}),l(re,{children:[l(w,{gap:2,children:[t(je,{badgeCode:u,className:"align-self-center flex-shrink-0 me-1"}),l(T,{size:5,className:"streak-info",gap:0,children:[t(S,{children:d("hccenter.status."+f)}),t(S,{dangerouslySetInnerHTML:{__html:p()}})]})]}),K("hc.center")["payday.info"]&&l(w,{alignItems:"center",children:[l(T,{className:"rounded-start bg-primary p-2 payday-special mb-1",children:[t("h4",{className:"mb-1",children:d("hccenter.special.title")}),t("div",{children:d("hccenter.special.info")}),t("div",{className:"btn btn-link text-white p-0 mt-auto align-self-baseline",onClick:()=>ee("habbopages/"+K("hc.center")["payday.habbopage"]),children:d("hccenter.special.infolink")})]}),l("div",{className:"payday flex-shrink-0 p-2",children:[t("h5",{className:"mb-2 ms-2",children:d("hccenter.special.time.title")}),l("div",{className:"d-flex flex-row mb-2",children:[t("div",{className:"clock me-2"}),t("h6",{className:"mb-0 align-self-center",children:b()})]}),f===Bn.ACTIVE&&l("div",{className:"pe-3",children:[t("h5",{className:"ms-2 mb-1 bolder",children:d("hccenter.special.amount.title")}),l("div",{className:"d-flex flex-column",children:[t("div",{className:"w-100 text-center ms-4n",children:N()}),t(mu,{trigger:["hover","focus"],placement:"left",overlay:v,children:t("div",{className:"btn btn-link align-self-end text-primary",children:d("hccenter.breakdown.infolink")})})]})]})]})]}),K("hc.center")["gift.info"]&&l("div",{className:"rounded bg-success p-2 d-flex flex-row mb-0",children:[l("div",{children:[t("h4",{className:"mb-1",children:d("hccenter.gift.title")}),t("div",{dangerouslySetInnerHTML:{__html:s>0?d("hccenter.unclaimedgifts",["unclaimedgifts"],[s.toString()]):d("hccenter.gift.info")}})]}),t("button",{className:"btn btn-primary btn-lg align-self-center ms-auto",onClick:()=>ee("catalog/open/"+K("catalog.links")["hc.hc_gifts"]),children:d(f===Bn.ACTIVE?"hccenter.btn.gifts.redeem":"hccenter.btn.gifts.view")})]}),K("hc.center")["benefits.info"]&&l("div",{className:"benefits text-black py-2",children:[t("h5",{className:"mb-1 text-primary",children:d("hccenter.general.title")}),t("div",{className:"mb-2",dangerouslySetInnerHTML:{__html:d("hccenter.general.info")}}),t("button",{className:"btn btn-link p-0 text-primary",onClick:()=>ee("habbopages/"+K("hc.center")["benefits.habbopage"]),children:d("hccenter.general.infolink")})]})]})]})},uw=a=>{const[e,n]=i.useState(""),{activeReport:r=null,setActiveReport:o=null}=Mn(),s=()=>{e.length<15||o(u=>{const m=kt.REPORT_SUMMARY;return{...u,message:e,currentStep:m}})},c=()=>{o(u=>({...u,currentStep:u.currentStep-1}))};return l(V,{children:[l(T,{gap:1,children:[t(S,{fontSize:4,children:d("help.emergency.chat_report.subtitle")}),t(S,{children:d("help.cfh.input.text")})]}),t("textarea",{className:"form-control h-100",value:e,onChange:u=>n(u.target.value)}),l(w,{gap:2,justifyContent:"between",children:[t(L,{variant:"secondary",disabled:!(r.reportType===Ve.BULLY||r.reportType===Ve.EMERGENCY),onClick:c,children:d("generic.back")}),t(L,{disabled:e.length<15,onClick:s,children:d("help.emergency.main.submit.button")})]})]})},dw=a=>{const{setActiveReport:e=null}=Mn(),n=()=>{e(r=>{const o=kt.SELECT_USER,s=Ve.BULLY;return{...r,currentStep:o,reportType:s}})};return l(V,{children:[l(T,{grow:!0,center:!0,gap:1,children:[t(S,{fontSize:3,children:d("help.main.frame.title")}),t(S,{children:d("help.main.self.description")})]}),l(T,{gap:1,children:[t(L,{onClick:n,children:d("help.main.bully.subtitle")}),t(L,{onClick:()=>St(new Ht(Ht.CREATE_HELP_REQUEST)),disabled:!K("guides.enabled"),children:d("help.main.help.title")}),t(L,{disabled:!0,children:d("help.main.self.tips.title")})]}),t(L,{variant:"link",textColor:"black",onClick:()=>M(new yE(!1)),children:d("help.main.my.sanction.status")})]})},mw=a=>{const{username:e="",onAction:n=null}=a,[r,o]=i.useState(!1),s=()=>{r||(o(!0),M(new AE(e)))};return x(OE,c=>{const u=c.getParser();u&&u.webId===H().userId&&n("close")}),l("div",{className:"d-flex flex-column gap-4 h-100",children:[t("div",{className:"bg-muted rounded p-2 text-center",children:d("tutorial.name_change.info.confirm")}),l("div",{className:"d-flex flex-column align-items-center gap-1 h-100",children:[t("div",{children:d("tutorial.name_change.confirm")}),t("div",{className:"fw-bold",children:e})]}),l("div",{className:"d-flex gap-2",children:[t("button",{className:"btn btn-success w-100",disabled:r,onClick:s,children:d("generic.ok")}),t("button",{className:"btn btn-primary w-100",onClick:()=>n("close"),children:d("cancel")})]})]})},gw=a=>{const{onAction:e=null}=a;return l("div",{className:"d-flex flex-column gap-4 h-100",children:[t("div",{className:"bg-muted rounded p-2 text-center",children:d("tutorial.name_change.info.main")}),t("div",{className:"fw-bold d-flex align-items-center justify-content-center h-100 w-100",children:d("tutorial.name_change.current",["name"],[H().userName])}),l("div",{className:"d-flex gap-2",children:[t("button",{className:"btn btn-success w-100",onClick:()=>e("start"),children:d("tutorial.name_change.change")}),t("button",{className:"btn btn-primary w-100",onClick:()=>e("confirmation",H().userName),children:d("tutorial.name_change.keep")})]})]})},hw=0,fw=2,pw=3,Iw=4,Ew=5,_w=6,Cw=a=>{const{onAction:e=null}=a,[n,r]=i.useState(""),[o,s]=i.useState(!1),[c,u]=i.useState(!1),[m,h]=i.useState(null),[g,f]=i.useState([]),_=()=>{n!==""&&(s(!1),f([]),h(null),u(!0),M(new PE(n)))},E=I=>{s(!1),f([]),h(null),r(I)};return x(kE,I=>{u(!1);const C=I.getParser();if(C)switch(C.resultCode){case hw:s(!0);break;case fw:h("short");break;case pw:h("long");break;case Iw:h("invalid");break;case Ew:f(C.nameSuggestions),h("taken");break;case _w:h("change_not_allowed")}}),l("div",{className:"d-flex flex-column gap-3 h-100",children:[t("div",{children:d("tutorial.name_change.info.select")}),l("div",{className:"d-flex gap-2",children:[t("input",{type:"text",className:"form-control form-control-sm",value:n,onChange:I=>E(I.target.value)}),t("button",{className:"btn btn-primary",disabled:n===""||c,onClick:_,children:d("tutorial.name_change.check")})]}),!m&&!o&&t("div",{className:"bg-muted rounded p-2 text-center",children:d("help.tutorial.name.info")}),m&&t("div",{className:"bg-danger rounded p-2 text-center text-white",children:d(`help.tutorial.name.${m}`,["name"],[n])}),o&&t("div",{className:"bg-success rounded p-2 text-center text-white",children:d("help.tutorial.name.available",["name"],[n])}),g&&t("div",{className:"d-flex flex-column gap-2",children:g.map((I,C)=>t("div",{className:"col bg-muted rounded p-1 cursor-pointer",onClick:()=>E(I),children:I},C))}),l("div",{className:"d-flex gap-2",children:[t("button",{className:"btn btn-success w-100",disabled:!o,onClick:()=>e("confirmation",n),children:d("tutorial.name_change.pick")}),t("button",{className:"btn btn-primary w-100",onClick:()=>e("close"),children:d("cancel")})]})]})},Oa="INIT",jo="INPUT",qo="CONFIRMATION",bw=a=>{const[e,n]=i.useState(!1),[r,o]=i.useState(Oa),[s,c]=i.useState(""),u=(h,g)=>{switch(h){case"start":o(jo);break;case"confirmation":c(g),o(qo);break;case"close":c(""),n(!1);break}},m=i.useMemo(()=>{switch(r){case Oa:return"tutorial.name_change.title.main";case jo:return"tutorial.name_change.title.select";case qo:return"tutorial.name_change.title.confirm"}},[r]);return ct(no.INIT,h=>{o(Oa),n(!0)}),e?l(ae,{className:"nitro-change-username",theme:"primary-slim",children:[t(se,{headerText:d(m),onCloseClick:()=>u("close")}),l(re,{className:"text-black",children:[r===Oa&&t(gw,{onAction:u}),r===jo&&t(Cw,{onAction:u}),r===qo&&t(mw,{username:s,onAction:u})]})]}):null},Sw=a=>{const{activeReport:e=null,setActiveReport:n=null}=Mn(),r=()=>{const o=[];switch(e.reportType){case Ve.BULLY:case Ve.EMERGENCY:case Ve.ROOM:{const s=e.roomId<=0?e.reportedChats[0].roomId:e.roomId;e.reportedChats.forEach(c=>o.push(c.webId,c.message)),M(new xE(e.message,e.cfhTopic,e.reportedUserId,s,o));break}case Ve.IM:e.reportedChats.forEach(s=>o.push(s.webId,s.message)),M(new UE(e.message,e.cfhTopic,e.reportedUserId,o));break;case Ve.THREAD:M(new LE(e.groupId,e.threadId,e.cfhTopic,e.message));break;case Ve.MESSAGE:M(new ME(e.groupId,e.threadId,e.messageId,e.cfhTopic,e.message));break;case Ve.PHOTO:M(new DE(e.extraData,e.roomId,e.reportedUserId,e.cfhTopic,e.roomObjectId));break}n(null)};return l(V,{children:[l(T,{gap:1,children:[t(S,{fontSize:4,children:d("help.cfh.button.send")}),t(S,{children:d("help.main.summary")})]}),t(L,{variant:"success",onClick:r,children:d("guide.help.request.emergency.submit.button")})]})},Nw=a=>{const{sanctionInfo:e=null,setSanctionInfo:n=null}=Mn(),r=(o,s,c)=>{let u=`help.sanction.${o}`;switch(s){case"ALERT":u=u+".alert";break;case"MUTE":u=u+".mute";break;case"BAN_PERMANENT":u=u+".permban";break;default:if(u=u+".ban",c>24)return u=u+".days",d(u,["days"],[(c/24).toString()])}return d(u,["hours"],[c.toString()])};return e?l(ae,{className:"nitro-help",theme:"primary-slim",children:[t(se,{headerText:d("help.sanction.info.title"),onCloseClick:()=>n(null)}),t(re,{className:"text-black",children:l(ne,{children:[t(T,{center:!0,size:5,overflow:"hidden",children:t(U,{className:"index-image"})}),l(T,{justifyContent:"between",size:7,overflow:"hidden",children:[e.sanctionReason==="cfh.reason.EMPTY"?t("div",{className:"col-12 fw-bold",children:d("help.sanction.current.none")}):l(V,{children:[(e.probationHoursLeft>0||e.isSanctionActive)&&t("div",{className:"col-12 fw-bold",children:d("help.sanction.probation.reminder")}),l("div",{className:`col-12 fw-bold ${e.isSanctionNew?"text-danger":""}`,children:[d("help.sanction.last.sanction")," ",r("current",e.sanctionName,e.sanctionLengthHours)]}),l("div",{className:"col-12",children:[d("generic.start.time")," ",e.sanctionCreationTime]}),l("div",{className:"col-12",children:[d("generic.reason")," ",e.sanctionReason]}),l("div",{className:"col-12",children:[d("help.sanction.probation.days.left")," ",Math.trunc(e.probationHoursLeft/24)+1]})]}),e.hasCustomMute&&!e.isSanctionActive&&t("div",{className:"col-12 fw-bold",children:d("help.sanction.custom.mute")}),e.tradeLockExpiryTime&&e.tradeLockExpiryTime.length>0&&l("div",{className:"col-12 fw-bold",children:[d("trade.locked.until")," ",e.tradeLockExpiryTime]}),t("div",{className:"col-12",children:r("next",e.nextSanctionName,e.nextSanctionLengthHours)}),t(L,{variant:"success",onClick:o=>n(null),children:d("habbo.way.ok.button")})]})]})})]}):null},Tw=a=>{const[e,n]=i.useState([]),{activeReport:r=null,setActiveReport:o=null}=Mn(),{chatHistory:s=[],messengerHistory:c=[]}=po(),u=i.useMemo(()=>{switch(r.reportType){case Ve.BULLY:case Ve.EMERGENCY:return s.filter(f=>f.type===Pn.TYPE_CHAT&&f.webId===r.reportedUserId&&f.entityType===ht.USER);case Ve.IM:return c.filter(f=>f.webId===r.reportedUserId&&f.type===Pn.TYPE_IM)}return[]},[r,s,c]),m=f=>{n(_=>{const E=[..._],I=E.indexOf(f);return I>=0?E.splice(I,1):E.push(f),E})},h=()=>{!e||e.length<=0||o(f=>({...f,reportedChats:e,currentStep:kt.SELECT_TOPICS}))},g=()=>{o(f=>({...f,currentStep:f.currentStep-1}))};return l(V,{children:[l(T,{gap:1,children:[t(S,{fontSize:4,children:d("help.emergency.chat_report.subtitle")}),t(S,{children:d("help.emergency.chat_report.description")})]}),l(T,{gap:1,overflow:"hidden",children:[!u||!u.length&&t(S,{children:d("help.cfh.error.no_user_data")}),u.length>0&&t(Ue,{gap:1,columnCount:1,columnMinHeight:25,overflow:"auto",children:u.map((f,_)=>t(be,{onClick:E=>m(f),itemActive:e.indexOf(f)>=0,children:t(S,{children:f.message})},f.id))})]}),l(w,{gap:2,justifyContent:"between",children:[t(L,{variant:"secondary",onClick:g,disabled:r.reportType===Ve.IM,children:d("generic.back")}),t(L,{disabled:e.length<=0,onClick:h,children:d("help.emergency.main.submit.button")})]})]})},vw=a=>{const[e,n]=i.useState(-1),{chatHistory:r=[]}=po(),{activeReport:o=null,setActiveReport:s=null}=Mn(),c=i.useMemo(()=>{const g=new Map;return r.forEach(f=>{f.type===Pn.TYPE_CHAT&&f.entityType===ht.USER&&f.webId!==H().userId&&!g.has(f.webId)&&g.set(f.webId,{id:f.webId,username:f.name})}),Array.from(g.values())},[r]),u=g=>{g<=0||s(f=>({...f,reportedUserId:g,currentStep:kt.SELECT_CHATS}))},m=g=>{n(f=>g===f?-1:g)},h=()=>{s(g=>({...g,currentStep:g.currentStep-1}))};return l(V,{children:[l(T,{gap:1,children:[t(S,{fontSize:4,children:d("help.emergency.main.step.two.title")}),c.length>0&&t(S,{children:d("report.user.pick.user")})]}),l(T,{gap:1,overflow:"hidden",children:[!c.length&&t(S,{children:d("report.user.error.nolist")}),c.length>0&&t(Ue,{columnCount:1,columnMinHeight:25,gap:1,children:c.map((g,f)=>t(be,{onClick:_=>m(g.id),itemActive:e===g.id,children:t("span",{dangerouslySetInnerHTML:{__html:g.username}})},g.id))})]}),l(w,{gap:2,justifyContent:"between",children:[t(L,{variant:"secondary",onClick:h,children:d("generic.back")}),t(L,{disabled:e<=0,onClick:()=>u(e),children:d("help.emergency.main.submit.button")})]})]})},ww=a=>{const[e,n]=i.useState(-1),[r,o]=i.useState(-1),{setActiveReport:s=null}=Mn(),{cfhCategories:c=[]}=ws(),u=()=>{e<0||r<0||s(h=>({...h,cfhCategory:e,cfhTopic:c[e].topics[r].id,currentStep:kt.INPUT_REPORT_MESSAGE}))},m=()=>{s(h=>({...h,currentStep:h.currentStep-1}))};return l(V,{children:[l(T,{gap:1,children:[t(S,{fontSize:4,children:d("help.emergency.chat_report.subtitle")}),t(S,{children:d("help.cfh.pick.topic")})]}),l(T,{gap:1,overflow:"auto",children:[e<0&&c.map((h,g)=>t(L,{variant:"danger",onClick:f=>n(g),children:d(`help.cfh.reason.${h.name}`)},g)),e>=0&&c[e].topics.map((h,g)=>t(L,{variant:"danger",onClick:f=>o(g),active:r===g,children:d(`help.cfh.topic.${h.id}`)},g))]}),l(w,{gap:2,justifyContent:"between",children:[t(L,{variant:"secondary",onClick:m,children:d("generic.back")}),t(L,{disabled:r<0,onClick:u,children:d("help.emergency.main.submit.button")})]})]})},Rw=a=>{const[e,n]=i.useState(!1),{activeReport:r=null,setActiveReport:o=null,report:s=null}=Mn(),c=()=>{o(null),n(!1)};i.useEffect(()=>{const m={linkReceived:h=>{const g=h.split("/");if(!(g.length<2))switch(g[1]){case"show":n(!0);return;case"hide":n(!1);return;case"toggle":n(f=>!f);return;case"tour":return;case"report":g.length>=5&&g[2]==="room"&&(parseInt(g[3]),unescape(g.splice(4).join("/")));return}},eventUrlPrefix:"help/"};return _t(m),()=>Ct(m)},[]),i.useEffect(()=>{r&&n(!0)},[r]);const u=()=>{if(r)switch(r.currentStep){case kt.SELECT_USER:return t(vw,{});case kt.SELECT_CHATS:return t(Tw,{});case kt.SELECT_TOPICS:return t(ww,{});case kt.INPUT_REPORT_MESSAGE:return t(uw,{});case kt.REPORT_SUMMARY:return t(Sw,{})}return t(dw,{})};return l(V,{children:[e&&l(ae,{className:"nitro-help",theme:"primary-slim",children:[t(se,{headerText:d("help.button.cfh"),onCloseClick:c}),t(re,{className:"text-black",children:l(ne,{children:[t(T,{center:!0,size:5,overflow:"hidden",children:t(U,{className:"index-image"})}),t(T,{justifyContent:"between",size:7,overflow:"hidden",children:t(u,{})})]})})]}),t(Nw,{}),t(bw,{})]})},yw=a=>{const[e,n]=i.useState(null),[r,o]=i.useState(null),[s,c]=i.useState(null),[u,m]=i.useState(null);return x(FE,h=>{const g=h.getParser();n(g.productType),o(g.productClassId),c(g.totalCoinsForBonus),m(g.coinsStillRequiredToBuy)}),i.useEffect(()=>{M(new GE)},[]),e?l("div",{className:"bonus-rare widget d-flex",children:[e,l("div",{className:"bg-light-dark rounded overflow-hidden position-relative bonus-bar-container",children:[t("div",{className:"d-flex justify-content-center align-items-center w-100 h-100 position-absolute small top-0",children:s-u+"/"+s}),t("div",{className:"small bg-info rounded position-absolute top-0 h-100",style:{width:(s-u)/s*100+"%"}})]})]}):null},Ow=a=>{const{data:e=null,level:n=0}=a;return l("div",{className:"hof-user-container",children:[l("div",{className:"hof-tooltip",children:[l("div",{className:"hof-header",children:[n,". ",e.userName," ",t(_n,{userId:e.userId})]}),t("div",{className:"small text-center text-white",children:d("landing.view.competition.hof.points",["points"],[za(e.currentScore).toString()])})]}),t(st,{figure:e.figure,direction:2})]})},Aw=a=>{const{slot:e=-1,conf:n=null}=a,[r,o]=i.useState(null);return x(BE,s=>{const c=s.getParser();o(c.data)}),i.useEffect(()=>{const s=n?n.campaign:"";M(new VE(s))},[n]),r?t("div",{className:"hall-of-fame d-flex",children:r.hof&&r.hof.length>0&&r.hof.map((s,c)=>t(Ow,{data:s,level:c+1},c))}):null},kw=a=>{const[e,n]=i.useState(null),[r,o]=i.useState(0);return x(HE,s=>{const c=s.getParser();n(c.articles)}),i.useEffect(()=>{M(new WE)},[]),e?l("div",{className:"promo-articles widget mb-2",children:[l("div",{className:"d-flex flex-row align-items-center w-100 mb-1",children:[t("small",{className:"flex-shrink-0 pe-1",children:d("landing.view.promo.article.header")}),t("hr",{className:"w-100 my-0"})]}),t("div",{className:"d-flex flex-row mb-1",children:e&&e.length>0&&e.map((s,c)=>t("div",{className:"promo-articles-bullet cursor-pointer "+(s===e[r]?"promo-articles-bullet-active":""),onClick:u=>o(c)},s.id))}),e&&e[r]&&l("div",{className:"promo-article d-flex flex-row row mx-0",children:[t("div",{className:"promo-article-image",style:{backgroundImage:`url(${e[r].imageUrl})`}}),l("div",{className:"col-3 d-flex flex-column h-100",children:[t("h3",{className:"my-0",children:e[r].title}),t("b",{children:e[r].bodyText}),t("button",{className:"btn btn-sm mt-auto btn-gainsboro",onClick:s=>Xr(e[r].linkContent),children:e[r].buttonText})]})]})]}):null},Pw=a=>{const{conf:e=null}=a,n=r=>{const o=e[r];if(!o)return null;switch(r){case"image":return ur.interpolate(o)}return o};return l("div",{className:"widgetcontainer widget d-flex flex-row overflow-hidden",children:[t("div",{className:"widgetcontainer-image flex-shrink-0",style:{backgroundImage:`url(${n("image")})`}}),l("div",{className:"d-flex flex-column align-self-center",children:[t("h3",{className:"my-0",children:d(`landing.view.${n("texts")}.header`)}),t("i",{children:d(`landing.view.${n("texts")}.body`)}),t("button",{className:"btn btn-sm btn-gainsboro align-self-start px-3 mt-auto",onClick:r=>Xr(n("btnLink")),children:d(`landing.view.${n("texts")}.button`)})]})]})},Dw=a=>{switch(a.widgetType){case"promoarticle":return t(kw,{});case"achievementcompetition_hall_of_fame":return t(Aw,{slot:a.slot,conf:a.widgetConf});case"bonusrare":return t(yw,{});case"widgetcontainer":return t(Pw,{conf:a.widgetConf});default:return null}},Br=a=>{const{widgetType:e=null,widgetSlot:n=0,widgetConf:r=null,className:o="",...s}=a;return t("div",{className:`widget-slot slot-${n} ${o||""}`,...s,children:t(Dw,{widgetType:e,slot:n,widgetConf:r})})},Mw=a=>{const[e,n]=i.useState(!0),{userFigure:r=null}=_r();if(Ye([qt.CREATED,qt.ENDED],f=>{switch(f.type){case qt.CREATED:n(!1);return;case qt.ENDED:n(f.openLandingView);return}}),!e)return null;const o=K("hotelview").images["background.colour"],s=ur.interpolate(K("hotelview").images.background),c=ur.interpolate(K("hotelview").images.sun),u=ur.interpolate(K("hotelview").images.drape),m=ur.interpolate(K("hotelview").images.left),h=ur.interpolate(K("hotelview").images["right.repeat"]),g=ur.interpolate(K("hotelview").images.right);return l("div",{className:"nitro-hotel-view",style:o&&o?{background:o}:{},children:[t("div",{className:"container h-100 py-3 overflow-hidden landing-widgets",children:l("div",{className:"row h-100",children:[l("div",{className:"col-9 h-100 d-flex flex-column",children:[t(Br,{widgetSlot:1,widgetType:K("hotelview").widgets["slot.1.widget"],widgetConf:K("hotelview").widgets["slot.1.conf"],className:"col-6"}),l("div",{className:"col-12 row mx-0",children:[t(Br,{widgetSlot:2,widgetType:K("hotelview").widgets["slot.2.widget"],widgetConf:K("hotelview").widgets["slot.2.conf"],className:"col-7"}),t(Br,{widgetSlot:3,widgetType:K("hotelview").widgets["slot.3.widget"],widgetConf:K("hotelview").widgets["slot.3.conf"],className:"col-5"}),t(Br,{widgetSlot:4,widgetType:K("hotelview").widgets["slot.4.widget"],widgetConf:K("hotelview").widgets["slot.4.conf"],className:"col-7"}),t(Br,{widgetSlot:5,widgetType:K("hotelview").widgets["slot.5.widget"],widgetConf:K("hotelview").widgets["slot.5.conf"],className:"col-5"})]}),t(Br,{widgetSlot:6,widgetType:K("hotelview").widgets["slot.6.widget"],widgetConf:K("hotelview").widgets["slot.6.conf"],className:"mt-auto"})]}),t("div",{className:"col-3 h-100",children:t(Br,{widgetSlot:7,widgetType:K("hotelview").widgets["slot.7.widget"],widgetConf:K("hotelview").widgets["slot.7.conf"]})})]})}),t("div",{className:"background position-absolute",style:s&&s.length?{backgroundImage:`url(${s})`}:{}}),t("div",{className:"sun position-absolute",style:c&&c.length?{backgroundImage:`url(${c})`}:{}}),t("div",{className:"drape position-absolute",style:u&&u.length?{backgroundImage:`url(${u})`}:{}}),t("div",{className:"left position-absolute",style:m&&m.length?{backgroundImage:`url(${m})`}:{}}),t("div",{className:"right-repeat position-absolute",style:h&&h.length?{backgroundImage:`url(${h})`}:{}}),t("div",{className:"right position-absolute",style:g&&g.length?{backgroundImage:`url(${g})`}:{}}),K("hotelview")["show.avatar"]&&t("div",{className:"avatar-image",children:t(st,{figure:r,direction:2})})]})},Ic=a=>{const{badgeCode:e=null,children:n=null,...r}=a,{selectedBadgeCode:o=null,setSelectedBadgeCode:s=null,toggleBadge:c=null,getBadgeId:u=null}=_o(),{isUnseen:m=null}=bn(),h=m(qe.BADGE,u(e));return l(be,{itemActive:o===e,itemUnseen:h,onMouseDown:g=>s(e),onDoubleClick:g=>c(o),...r,children:[t(je,{badgeCode:e}),n]})},Lw=a=>{const[e,n]=i.useState(!1),{badgeCodes:r=[],activeBadgeCodes:o=[],selectedBadgeCode:s=null,isWearingBadge:c=null,canWearBadges:u=null,toggleBadge:m=null,getBadgeId:h=null,activate:g=null,deactivate:f=null}=_o(),{isUnseen:_=null,removeUnseen:E=null}=bn();return i.useEffect(()=>{!s||!_(qe.BADGE,h(s))||E(qe.BADGE,h(s))},[s,_,E,h]),i.useEffect(()=>{if(!e)return;const I=g();return()=>f(I)},[e,g,f]),i.useEffect(()=>(n(!0),()=>n(!1)),[]),l(ne,{children:[t(T,{size:7,overflow:"hidden",children:t(Ue,{columnCount:4,children:r&&r.length>0&&r.map((I,C)=>c(I)?null:t(Ic,{badgeCode:I},C))})}),l(T,{className:"justify-content-between",size:5,overflow:"auto",children:[l(T,{overflow:"hidden",gap:2,children:[t(S,{children:d("inventory.badges.activebadges")}),t(Ue,{columnCount:3,children:o&&o.length>0&&o.map((I,C)=>t(Ic,{badgeCode:I},C))})]}),!!s&&l(T,{grow:!0,justifyContent:"end",gap:2,children:[l(w,{alignItems:"center",gap:2,children:[t(je,{shrink:!0,badgeCode:s}),t(S,{children:Js(s)})]}),t(L,{variant:c(s)?"danger":"success",disabled:!c(s)&&!u(),onClick:I=>m(s),children:d(c(s)?"inventory.badges.clearbadge":"inventory.badges.wearbadge")})]})]})]})},ll=a=>{const{title:e="",desc:n="",children:r=null,...o}=a;return l(ne,{...o,children:[t(T,{center:!0,size:5,overflow:"hidden",children:t("div",{className:"empty-image"})}),l(T,{justifyContent:"center",size:7,overflow:"hidden",children:[t(S,{fontWeight:"bold",fontSize:5,overflow:"unset",truncate:!0,children:e}),t(S,{overflow:"auto",children:n})]}),r]})},Uw=a=>{const{botItem:e=null,children:n=null,...r}=a,[o,s]=i.useState(!1),{selectedBot:c=null,setSelectedBot:u=null}=Hd(),{isUnseen:m=null}=bn(),h=m(qe.BOT,e.botData.id),g=f=>{switch(f.type){case ye.MOUSE_DOWN:u(e),s(!0);return;case ye.MOUSE_UP:s(!1);return;case ye.ROLL_OUT:if(!o||c!==e)return;_i(e);return;case"dblclick":_i(e);return}};return l(be,{itemActive:c===e,itemUnseen:h,onMouseDown:g,onMouseUp:g,onMouseOut:g,onDoubleClick:g,...r,children:[t(st,{figure:e.botData.figure,direction:3,headOnly:!0}),n]})},xw=a=>{const{roomSession:e=null,roomPreviewer:n=null}=a,[r,o]=i.useState(!1),{botItems:s=[],selectedBot:c=null,activate:u=null,deactivate:m=null}=Hd(),{isUnseen:h=null,removeUnseen:g=null}=bn();return i.useEffect(()=>{if(!c||!n)return;const f=c.botData,_=q();let E=_.getRoomInstanceVariable(_.activeRoomId,te.ROOM_WALL_TYPE),I=_.getRoomInstanceVariable(_.activeRoomId,te.ROOM_FLOOR_TYPE),C=_.getRoomInstanceVariable(_.activeRoomId,te.ROOM_LANDSCAPE_TYPE);E=E&&E.length?E:"101",I=I&&I.length?I:"101",C=C&&C.length?C:"1.1",n.reset(!1),n.updateRoomWallsAndFloorVisibility(!0,!0),n.updateObjectRoom(I,E,C),n.addAvatarIntoRoom(f.figure,0)},[n,c]),i.useEffect(()=>{!c||!h(qe.BOT,c.botData.id)||g(qe.BOT,c.botData.id)},[c,h,g]),i.useEffect(()=>{if(!r)return;const f=u();return()=>m(f)},[r,u,m]),i.useEffect(()=>(o(!0),()=>o(!1)),[]),!s||!s.length?t(ll,{title:d("inventory.empty.bots.title"),desc:d("inventory.empty.bots.desc")}):l(ne,{children:[t(T,{size:7,overflow:"hidden",children:t(Ue,{columnCount:5,children:s&&s.length>0&&s.map(f=>t(Uw,{botItem:f},f.botData.id))})}),l(T,{size:5,overflow:"auto",children:[t(T,{overflow:"hidden",position:"relative",children:t(mo,{roomPreviewer:n,height:140})}),c&&l(T,{grow:!0,justifyContent:"between",gap:2,children:[t(S,{grow:!0,truncate:!0,children:c.botData.name}),!!e&&t(L,{variant:"success",onClick:f=>_i(c),children:d("inventory.furni.placetoroom")})]})]})]})},Fw=a=>{const{groupItem:e=null,...n}=a,[r,o]=i.useState(!1),{selectedItem:s=null,setSelectedItem:c=null}=es(),u=h=>{switch(h.type){case ye.MOUSE_DOWN:c(e),o(!0);return;case ye.MOUSE_UP:o(!1);return;case ye.ROLL_OUT:if(!r||e!==s)return;Cs(e);return;case"dblclick":Cs(e);return}},m=e.getUnlockedCount();return t(be,{className:m?"":"opacity-0-5 ",itemImage:e.iconUrl,itemCount:e.getUnlockedCount(),itemActive:e===s,itemUniqueNumber:e.stuffData.uniqueNumber,itemUnseen:e.hasUnseenItems,onMouseDown:u,onMouseUp:u,onMouseOut:u,onDoubleClick:u,...n})},gm=a=>{const{groupItems:e=[],setGroupItems:n=null}=a,[r,o]=i.useState("");return i.useEffect(()=>{let s=[...e];if(r&&r.length){const c=r.toLocaleLowerCase();s=e.filter(u=>c&&c.length&&u.name.toLocaleLowerCase().includes(c)?u:null)}n(s)},[e,n,r]),l(w,{gap:1,children:[t("input",{type:"text",className:"form-control form-control-sm",placeholder:d("generic.search"),value:r,onChange:s=>o(s.target.value)}),t(L,{variant:"primary",children:t(Di,{className:"fa-icon"})})]})},Gw=a=>{const e=a.getLastItem();if(!e||!e.sellable)return!1;St(new nl(e))},Bw=a=>{const{roomSession:e=null,roomPreviewer:n=null}=a,[r,o]=i.useState(!1),[s,c]=i.useState([]),{groupItems:u=[],selectedItem:m=null,activate:h=null,deactivate:g=null}=es(),{resetItems:f=null}=bn();return i.useEffect(()=>{if(!m||!n)return;const _=m.getLastItem();if(!_)return;const E=q();let I=E.getRoomInstanceVariable(E.activeRoomId,te.ROOM_WALL_TYPE),C=E.getRoomInstanceVariable(E.activeRoomId,te.ROOM_FLOOR_TYPE),p=E.getRoomInstanceVariable(E.activeRoomId,te.ROOM_LANDSCAPE_TYPE);if(I=I&&I.length?I:"101",C=C&&C.length?C:"101",p=p&&p.length?p:"1.1",n.reset(!1),n.updateObjectRoom(C,I,p),n.updateRoomWallsAndFloorVisibility(!0,!0),_.category===Z.WALL_PAPER||_.category===Z.FLOOR||_.category===Z.LANDSCAPE){if(C=_.category===Z.FLOOR?m.stuffData.getLegacyString():C,I=_.category===Z.WALL_PAPER?m.stuffData.getLegacyString():I,p=_.category===Z.LANDSCAPE?m.stuffData.getLegacyString():p,n.updateObjectRoom(C,I,p),_.category===Z.LANDSCAPE){const b=H().getWallItemDataByName("window_double_default");b&&n.addWallItemIntoRoom(b.id,new Rt(90,0,0),b.customParams)}}else m.isWallItem?n.addWallItemIntoRoom(m.type,new Rt(90),_.stuffData.getLegacyString()):n.addFurnitureIntoRoom(m.type,new Rt(90),m.stuffData,_.extra.toString())},[n,m]),i.useEffect(()=>{!m||!m.hasUnseenItems||(f(qe.FURNI,m.items.map(_=>_.id)),m.hasUnseenItems=!1)},[m,f]),i.useEffect(()=>{if(!r)return;const _=h();return()=>g(_)},[r,h,g]),i.useEffect(()=>(o(!0),()=>o(!1)),[]),!u||!u.length?t(ll,{title:d("inventory.empty.title"),desc:d("inventory.empty.desc")}):l(ne,{children:[l(T,{size:7,overflow:"hidden",children:[t(gm,{groupItems:u,setGroupItems:c}),t(Ue,{columnCount:5,children:s&&s.length>0&&s.map((_,E)=>t(Fw,{groupItem:_},E))})]}),l(T,{size:5,overflow:"auto",children:[l(T,{overflow:"hidden",position:"relative",children:[t(mo,{roomPreviewer:n,height:140}),m&&m.stuffData.isUnique&&t(Od,{className:"top-2 end-2",position:"absolute",uniqueNumber:m.stuffData.uniqueNumber,uniqueSeries:m.stuffData.uniqueSeries}),m&&m.stuffData.rarityLevel>-1&&t(tl,{className:"top-2 end-2",position:"absolute",level:m.stuffData.rarityLevel})]}),m&&l(T,{grow:!0,justifyContent:"between",gap:2,children:[t(S,{grow:!0,truncate:!0,children:m.name}),l(T,{gap:1,children:[!!e&&t(L,{variant:"success",onClick:_=>Cs(m),children:d("inventory.furni.placetoroom")}),m&&m.isSellable&&t(L,{onClick:_=>Gw(m),children:d("inventory.marketplace.sell")})]})]})]})]})},Yo=9,Vw=a=>{const{cancelTrade:e=null}=a,[n,r]=i.useState(null),[o,s]=i.useState(null),[c,u]=i.useState(null),[m,h]=i.useState(null),[g,f]=i.useState(3),[_,E]=i.useState(1),{ownUser:I=null,otherUser:C=null,groupItems:p=[],tradeState:b=nt.TRADING_STATE_READY,progressTrade:N=null,removeItem:v=null,setTradeState:O=null}=jd(),{simpleAlert:R=null}=Xe(),y=(k,B,G,z,X)=>{if(!I||I.accepts||!I.userItems)return!1;if(I.userItems.length<Yo)return!0;if(!z)return!1;let Y=B.toString();return G===Z.POSTER?Y=Y+"poster"+X.getLegacyString():G===Z.GUILD_FURNI?Y=XC(B,X):Y=(k?"I":"S")+Y,!!I.userItems.getValue(Y)},F=k=>{if(!n)return;const B=n.getTradeItems(k);if(!B||!B.length)return;let G=null;const z=[];for(const Y of B)z.push(Y.id),G||(G=Y);if(I.userItems.length+z.length<=1500)if(!G.isGroupable&&z.length)M(new Ol(z.pop()));else{const Y=[];for(const Ee of z)y(G.isWallItem,G.type,G.category,G.isGroupable,G.stuffData)&&Y.push(Ee);Y.length&&(Y.length===1?M(new Ol(Y.pop())):M(new jE(...Y)))}else R(d("trading.items.too_many_items.desc"),de.DEFAULT,null,null,d("trading.items.too_many_items.title"))},P=k=>k?t(ou,{className:"text-success fa-icon"}):t(Lm,{className:"text-danger fa-icon"}),D=(k,B)=>{(isNaN(Number(k))||Number(k)<0||!k)&&(k=1),k=Math.max(Number(k),1),k=Math.min(Number(k),B),k!==_&&E(k)},A=k=>{D(_,k),F(_)};return i.useEffect(()=>{E(1)},[n]),i.useEffect(()=>{if(b!==nt.TRADING_STATE_COUNTDOWN)return;f(3);const k=setInterval(()=>{f(B=>{const G=B-1;return G===0&&clearInterval(k),G})},1e3);return()=>clearInterval(k)},[b,O]),i.useEffect(()=>{g===0&&O(nt.TRADING_STATE_CONFIRMING)},[g,O]),b===nt.TRADING_STATE_READY||!I||!C?null:l(ne,{children:[l(T,{size:4,overflow:"hidden",children:[t(gm,{groupItems:p,setGroupItems:h}),l(w,{column:!0,fullHeight:!0,justifyContent:"between",overflow:"hidden",gap:2,children:[t(Ue,{columnCount:3,children:m&&m.length>0&&m.map((k,B)=>{const G=k.getUnlockedCount();return t(be,{className:G?"":"opacity-0-5 ",itemImage:k.iconUrl,itemCount:G,itemActive:n===k,itemUniqueNumber:k.stuffData.uniqueNumber,onClick:z=>G&&r(k),onDoubleClick:z=>F(1),children:G>0&&n===k&&t(L,{position:"absolute",variant:"success",className:"trade-button bottom-1 end-1",onClick:z=>F(1),children:t(an,{className:"fa-icon"})})},B)})}),l(T,{gap:1,alignItems:"end",children:[l(ne,{overflow:"hidden",children:[t(T,{size:6,overflow:"hidden",children:t("input",{type:"number",className:"form-control form-control-sm quantity-input",placeholder:d("catalog.bundlewidget.spinner.select.amount"),disabled:!n,value:_,onChange:k=>E(k.target.valueAsNumber)})}),t(T,{size:6,overflow:"hidden",children:t(L,{variant:"secondary",disabled:!n,onClick:k=>A(n.getUnlockedCount()),children:d("inventory.trading.areoffering")})})]}),t(U,{fullWidth:!0,className:"badge bg-muted",children:n?n.name:d("catalog_selectproduct")})]})]})]}),l(T,{size:8,overflow:"hidden",children:[l(ne,{overflow:"hidden",children:[l(T,{size:6,overflow:"hidden",children:[l(w,{justifyContent:"between",alignItems:"center",children:[l(S,{children:[d("inventory.trading.you")," ",d("inventory.trading.areoffering"),":"]}),P(I.accepts)]}),t(Ue,{columnCount:3,children:Array.from(Array(Yo),(k,B)=>{const G=I.userItems.getWithIndex(B)||null;return G?t(be,{itemActive:o===G,itemImage:G.iconUrl,itemCount:G.getTotalCount(),itemUniqueNumber:G.stuffData.uniqueNumber,onClick:z=>s(G),onDoubleClick:z=>v(G),children:o===G&&t(L,{position:"absolute",variant:"danger",className:"trade-button bottom-1 start-1",onClick:z=>v(G),children:t(sn,{className:"fa-icon"})})},B):t(be,{},B)})}),t(U,{fullWidth:!0,className:"badge bg-muted",children:o?o.name:d("catalog_selectproduct")})]}),l(T,{size:6,overflow:"hidden",children:[l(w,{justifyContent:"between",alignItems:"center",children:[l(S,{children:[C.userName," ",d("inventory.trading.isoffering"),":"]}),P(C.accepts)]}),t(Ue,{columnCount:3,children:Array.from(Array(Yo),(k,B)=>{const G=C.userItems.getWithIndex(B)||null;return G?t(be,{itemActive:c===G,itemImage:G.iconUrl,itemCount:G.getTotalCount(),itemUniqueNumber:G.stuffData.uniqueNumber,onClick:z=>u(G)},B):t(be,{},B)})}),t(U,{fullWidth:!0,className:"badge bg-muted w-100",children:c?c.name:d("catalog_selectproduct")})]})]}),l(w,{grow:!0,justifyContent:"between",children:[t(L,{variant:"danger",onClick:e,children:d("generic.cancel")}),b===nt.TRADING_STATE_READY&&t(L,{variant:"secondary",disabled:!I.itemCount&&!C.itemCount,onClick:N,children:d("inventory.trading.accept")}),b===nt.TRADING_STATE_RUNNING&&t(L,{variant:"secondary",disabled:!I.itemCount&&!C.itemCount,onClick:N,children:d(I.accepts?"inventory.trading.modify":"inventory.trading.accept")}),b===nt.TRADING_STATE_COUNTDOWN&&t(L,{variant:"secondary",disabled:!0,children:d("inventory.trading.countdown",["counter"],[g.toString()])}),b===nt.TRADING_STATE_CONFIRMING&&t(L,{variant:"secondary",onClick:N,children:d("inventory.trading.button.restore")}),b===nt.TRADING_STATE_CONFIRMED&&t(L,{variant:"secondary",children:d("inventory.trading.info.waiting")})]})]})]})},Hw=a=>{const{petItem:e=null,children:n=null,...r}=a,[o,s]=i.useState(!1),{selectedPet:c=null,setSelectedPet:u=null}=Wd(),{isUnseen:m}=bn(),h=m(qe.PET,e.petData.id),g=f=>{switch(f.type){case ye.MOUSE_DOWN:u(e),s(!0);return;case ye.MOUSE_UP:s(!1);return;case ye.ROLL_OUT:if(!o||e!==c)return;Ei(e);return;case"dblclick":Ei(e);return}};return l(be,{itemActive:e===c,itemUnseen:h,onMouseDown:g,onMouseUp:g,onMouseOut:g,onDoubleClick:g,...r,children:[t(Zn,{figure:e.petData.figureData.figuredata,direction:3,headOnly:!0}),n]})},Ww=a=>{const{roomSession:e=null,roomPreviewer:n=null}=a,[r,o]=i.useState(!1),{petItems:s=null,selectedPet:c=null,activate:u=null,deactivate:m=null}=Wd(),{isUnseen:h=null,removeUnseen:g=null}=bn();return i.useEffect(()=>{if(!c||!n)return;const f=c.petData,_=q();let E=_.getRoomInstanceVariable(_.activeRoomId,te.ROOM_WALL_TYPE),I=_.getRoomInstanceVariable(_.activeRoomId,te.ROOM_FLOOR_TYPE),C=_.getRoomInstanceVariable(_.activeRoomId,te.ROOM_LANDSCAPE_TYPE);E=E&&E.length?E:"101",I=I&&I.length?I:"101",C=C&&C.length?C:"1.1",n.reset(!1),n.updateRoomWallsAndFloorVisibility(!0,!0),n.updateObjectRoom(I,E,C),n.addPetIntoRoom(f.figureString)},[n,c]),i.useEffect(()=>{!c||!h(qe.PET,c.petData.id)||g(qe.PET,c.petData.id)},[c,h,g]),i.useEffect(()=>{if(!r)return;const f=u();return()=>m(f)},[r,u,m]),i.useEffect(()=>(o(!0),()=>o(!1)),[]),!s||!s.length?t(ll,{title:d("inventory.empty.pets.title"),desc:d("inventory.empty.pets.desc")}):l(ne,{children:[t(T,{size:7,overflow:"hidden",children:t(Ue,{columnCount:5,children:s&&s.length>0&&s.map(f=>t(Hw,{petItem:f},f.petData.id))})}),l(T,{size:5,overflow:"auto",children:[t(T,{overflow:"hidden",position:"relative",children:t(mo,{roomPreviewer:n,height:140})}),c&&c.petData&&l(T,{grow:!0,justifyContent:"between",gap:2,children:[t(S,{grow:!0,truncate:!0,children:c.petData.name}),!!e&&t(L,{variant:"success",onClick:f=>Ei(c),children:d("inventory.furni.placetoroom")})]})]})]})},hm="inventory.furni",fm="inventory.bots",pm="inventory.furni.tab.pets",Im="inventory.badges",Ec=[hm,fm,pm,Im],jw=[qe.FURNI,qe.BOT,qe.PET,qe.BADGE],qw=a=>{const[e,n]=i.useState(!1),[r,o]=i.useState(Ec[0]),[s,c]=i.useState(null),[u,m]=i.useState(null),{isTrading:h=!1,stopTrading:g=null}=jd(),{getCount:f=null,resetCategory:_=null}=bn(),E=()=>{h&&g(),n(!1)};return Te(pt.PLACED,I=>{YC()&&(Zs(!1),I.placedInRoom||n(!0))}),Ye([qt.CREATED,qt.ENDED],I=>{switch(I.type){case qt.CREATED:c(I.session);return;case qt.ENDED:c(null),n(!1);return}}),x(qE,I=>{const C=I.getParser();for(const p of C.data)Xu().setBadgePointLimit(p.badgeId,p.limit)}),i.useEffect(()=>{const I={linkReceived:C=>{const p=C.split("/");if(!(p.length<2))switch(p[1]){case"show":n(!0);return;case"hide":n(!1);return;case"toggle":n(b=>!b);return}},eventUrlPrefix:"inventory/"};return _t(I),()=>Ct(I)},[]),i.useEffect(()=>(m(new ja(q(),++ja.PREVIEW_COUNTER)),()=>{m(I=>(I.dispose(),null))}),[]),i.useEffect(()=>{!e&&h&&n(!0)},[e,h]),e?l(ae,{uniqueKey:"inventory",className:"nitro-inventory",theme:h?"primary-slim":"",children:[t(se,{headerText:d("inventory.title"),onCloseClick:E}),!h&&l(V,{children:[t(Ir,{children:Ec.map((I,C)=>t(qn,{isActive:r===I,onClick:p=>o(I),count:f(jw[C]),children:d(I)},C))}),l(re,{children:[r===hm&&t(Bw,{roomSession:s,roomPreviewer:u}),r===fm&&t(xw,{roomSession:s,roomPreviewer:u}),r===pm&&t(Ww,{roomSession:s,roomPreviewer:u}),r===Im&&t(Lw,{})]})]}),h&&t(re,{children:t(Vw,{cancelTrade:E})})]}):null},cl=a=>{const{records:e=null}=a,{openRoomInfo:n=null}=ws(),r=i.useMemo(()=>{const s=[];return e.forEach(c=>{s.push({isRoomInfo:!0,roomId:c.roomId,roomName:c.roomName}),c.chatlog.forEach(u=>{s.push({timestamp:u.timestamp,habboId:u.userId,username:u.userName,hasHighlighting:u.hasHighlighting,message:u.message,isRoomInfo:!1})})}),s},[e]),o=s=>l(w,{gap:2,alignItems:"center",justifyContent:"between",className:"bg-muted rounded p-1",children:[l(w,{gap:1,children:[t(S,{bold:!0,children:"Room name:"}),t(S,{children:s.roomName})]}),l(w,{gap:1,children:[t(L,{onClick:c=>En(s.roomId),children:"Visit Room"}),t(L,{onClick:c=>n(s.roomId),children:"Room Tools"})]})]});return t(V,{children:l(T,{fit:!0,gap:0,overflow:"hidden",children:[t(T,{gap:2,children:l(ne,{gap:1,className:"text-black fw-bold border-bottom pb-1",children:[t(U,{className:"g-col-2",children:"Time"}),t(U,{className:"g-col-3",children:"User"}),t(U,{className:"g-col-7",children:"Message"})]})}),e&&e.length>0&&t(ho,{rows:r,rowRender:s=>l(V,{children:[s.isRoomInfo&&t(o,{roomId:s.roomId,roomName:s.roomName}),!s.isRoomInfo&&l(ne,{fullHeight:!1,gap:1,alignItems:"center",className:"log-entry py-1 border-bottom",children:[t(S,{className:"g-col-2",children:s.timestamp}),t(S,{className:"g-col-3",bold:!0,underline:!0,pointer:!0,onClick:c=>ee(`mod-tools/open-user-info/${s.habboId}`),children:s.username}),t(S,{textBreak:!0,wrap:!0,className:"g-col-7",children:s.message})]})]})})]})})},Yw=a=>{const{roomId:e=null,onCloseClick:n=null}=a,[r,o]=i.useState(null);return x(YE,s=>{const c=s.getParser();!c||c.data.roomId!==e||o(c.data)}),i.useEffect(()=>{M(new zE(e))},[e]),r?l(ae,{className:"nitro-mod-tools-chatlog",theme:"primary-slim",windowPosition:Pt.TOP_LEFT,children:[t(se,{headerText:`Room Chatlog ${r.roomName}`,onCloseClick:n}),t(re,{className:"text-black",overflow:"hidden",children:r&&t(cl,{records:[r]})})]}):null},zw=a=>{const{roomId:e=null,onCloseClick:n=null}=a,[r,o]=i.useState(!1),[s,c]=i.useState(null),[u,m]=i.useState(null),[h,g]=i.useState(null),[f,_]=i.useState(null),[E,I]=i.useState(!1),[C,p]=i.useState(0),[b,N]=i.useState(!1),[v,O]=i.useState(!1),[R,y]=i.useState(!1),[F,P]=i.useState(""),D=(A,k)=>{if(A)switch(A){case"alert_only":if(F.trim().length===0)return;M(new da(da.ACTION_ALERT,F,"")),M(new Al(e,v?1:0,R?1:0,b?1:0));return;case"send_message":if(F.trim().length===0)return;M(new da(da.ACTION_MESSAGE,F,"")),M(new Al(e,v?1:0,R?1:0,b?1:0));return}};return x($E,A=>{const k=A.getParser();!k||k.data.flatId!==e||(c(k.data.flatId),m(k.data.room.name),g(k.data.ownerId),_(k.data.ownerName),I(k.data.ownerInRoom),p(k.data.userCount))}),i.useEffect(()=>{r||(M(new KE(e)),o(!0))},[e,r,o]),l(ae,{className:"nitro-mod-tools-room",theme:"primary-slim",windowPosition:Pt.TOP_LEFT,children:[t(se,{headerText:"Room Info"+(u?": "+u:""),onCloseClick:A=>n()}),l(re,{className:"text-black",children:[l(w,{gap:2,children:[l(T,{justifyContent:"center",grow:!0,gap:1,children:[l(w,{alignItems:"center",gap:2,children:[t(S,{bold:!0,align:"end",className:"col-7",children:"Room Owner:"}),t(S,{underline:!0,pointer:!0,truncate:!0,children:f})]}),l(w,{alignItems:"center",gap:2,children:[t(S,{bold:!0,align:"end",className:"col-7",children:"Users in room:"}),t(S,{children:C})]}),l(w,{alignItems:"center",gap:2,children:[t(S,{bold:!0,align:"end",className:"col-7",children:"Owner in room:"}),t(S,{children:E?"Yes":"No"})]})]}),l(T,{gap:1,children:[t(L,{onClick:A=>En(e),children:"Visit Room"}),t(L,{onClick:A=>ee(`mod-tools/open-room-chatlog/${e}`),children:"Chatlog"})]})]}),l(T,{className:"bg-muted rounded p-2",gap:1,children:[l(w,{alignItems:"center",gap:1,children:[t("input",{className:"form-check-input",type:"checkbox",checked:b,onChange:A=>N(A.target.checked)}),t(S,{small:!0,children:"Kick everyone out"})]}),l(w,{alignItems:"center",gap:1,children:[t("input",{className:"form-check-input",type:"checkbox",checked:v,onChange:A=>O(A.target.checked)}),t(S,{small:!0,children:"Enable the doorbell"})]}),l(w,{alignItems:"center",gap:1,children:[t("input",{className:"form-check-input",type:"checkbox",checked:R,onChange:A=>y(A.target.checked)}),t(S,{small:!0,children:"Change room name"})]})]}),t("textarea",{className:"form-control",placeholder:"Type a mandatory message to the users in this text box...",value:F,onChange:A=>P(A.target.value)}),l(w,{justifyContent:"between",children:[t(L,{variant:"danger",onClick:A=>D("send_message"),children:"Send Caution"}),t(L,{onClick:A=>D("alert_only"),children:"Send Alert only"})]})]})]})},$w=a=>{const{onCloseClick:e=null,issueId:n=null}=a,[r,o]=i.useState(null);return x(XE,s=>{const c=s.getParser();!c||c.data.issueId!==n||o(c.data)}),i.useEffect(()=>{M(new QE(n))},[n]),l(ae,{className:"nitro-mod-tools-chatlog",theme:"primary-slim",children:[t(se,{headerText:"Issue Chatlog",onCloseClick:e}),t(re,{className:"text-black",children:r&&t(cl,{records:[r.chatRecord]})})]})},Kw=a=>{const{issueId:e=null,onIssueInfoClosed:n=null}=a,[r,o]=i.useState(!1),{tickets:s=[],openUserInfo:c=null}=ws(),u=s.find(g=>g.issueId===e),m=g=>{M(new Vu([g])),n(g)},h=g=>{M(new ma([e],g)),n(e)};return l(V,{children:[l(ae,{className:"nitro-mod-tools-handle-issue",theme:"primary-slim",children:[t(se,{headerText:"Resolving issue "+e,onCloseClick:()=>n(e)}),l(re,{className:"text-black",children:[t(S,{fontSize:4,children:"Issue Information"}),l(ne,{overflow:"auto",children:[t(T,{size:8,children:t("table",{className:"table table-striped table-sm table-text-small text-black m-0",children:l("tbody",{children:[l("tr",{children:[t("th",{children:"Source"}),t("td",{children:_b(u.categoryId)})]}),l("tr",{children:[t("th",{children:"Category"}),t("td",{className:"text-break",children:d("help.cfh.topic."+u.reportedCategoryId)})]}),l("tr",{children:[t("th",{children:"Description"}),t("td",{className:"text-break",children:u.message})]}),l("tr",{children:[t("th",{children:"Caller"}),t("td",{children:t(S,{bold:!0,underline:!0,pointer:!0,onClick:g=>c(u.reporterUserId),children:u.reporterUserName})})]}),l("tr",{children:[t("th",{children:"Reported User"}),t("td",{children:t(S,{bold:!0,underline:!0,pointer:!0,onClick:g=>c(u.reportedUserId),children:u.reportedUserName})})]})]})})}),l(T,{size:4,gap:1,children:[t(L,{variant:"secondary",onClick:()=>o(!r),children:"Chatlog"}),t(L,{onClick:g=>h(ma.RESOLUTION_USELESS),children:"Close as useless"}),t(L,{variant:"danger",onClick:g=>h(ma.RESOLUTION_ABUSIVE),children:"Close as abusive"}),t(L,{variant:"success",onClick:g=>h(ma.RESOLUTION_RESOLVED),children:"Close as resolved"}),t(L,{variant:"secondary",onClick:g=>m(e),children:"Release"})]})]})]})]}),r&&t($w,{issueId:e,onCloseClick:()=>o(!1)})]})},Xw=a=>{const{myIssues:e=null,handleIssue:n=null}=a;return l(T,{gap:0,overflow:"hidden",children:[t(T,{gap:2,children:l(ne,{gap:1,className:"text-black fw-bold border-bottom pb-1",children:[t(U,{className:"g-col-2",children:"Type"}),t(U,{className:"g-col-3",children:"Room/Player"}),t(U,{className:"g-col-3",children:"Opened"}),t(U,{className:"g-col-2"}),t(U,{className:"g-col-2"})]})}),t(T,{overflow:"auto",className:"striped-children",gap:0,children:e&&e.length>0&&e.map(r=>l(ne,{gap:1,alignItems:"center",className:"text-black py-1 border-bottom",children:[t(U,{className:"g-col-2",children:r.categoryId}),t(U,{className:"g-col-3",children:r.reportedUserName}),t(U,{className:"g-col-3",children:new Date(Date.now()-r.issueAgeInMilliseconds).toLocaleTimeString()}),t(U,{className:"g-col-2",children:t(L,{variant:"primary",onClick:o=>n(r.issueId),children:"Handle"})}),t(U,{className:"g-col-2",children:t(L,{variant:"danger",onClick:o=>M(new Vu([r.issueId])),children:"Release"})})]},r.issueId))})]})},Qw=a=>{const{openIssues:e=null}=a;return l(T,{gap:0,overflow:"hidden",children:[t(T,{gap:2,children:l(ne,{gap:1,className:"text-black fw-bold border-bottom pb-1",children:[t(U,{className:"g-col-2",children:"Type"}),t(U,{className:"g-col-3",children:"Room/Player"}),t(U,{className:"g-col-4",children:"Opened"}),t(U,{className:"g-col-3"})]})}),t(T,{overflow:"auto",className:"striped-children",gap:0,children:e&&e.length>0&&e.map(n=>l(ne,{gap:1,alignItems:"center",className:"text-black py-1 border-bottom",children:[t(U,{className:"g-col-2",children:n.categoryId}),t(U,{className:"g-col-3",children:n.reportedUserName}),t(U,{className:"g-col-4",children:new Date(Date.now()-n.issueAgeInMilliseconds).toLocaleTimeString()}),t(U,{className:"g-col-3",children:t(L,{variant:"success",onClick:r=>M(new JE([n.issueId],!1,0,"pick issue button")),children:"Pick Issue"})})]},n.issueId))})]})},Jw=a=>{const{pickedIssues:e=null}=a;return l(T,{gap:0,overflow:"hidden",children:[t(T,{gap:2,children:l(ne,{gap:1,className:"text-black fw-bold border-bottom pb-1",children:[t(U,{className:"g-col-2",children:"Type"}),t(U,{className:"g-col-3",children:"Room/Player"}),t(U,{className:"g-col-4",children:"Opened"}),t(U,{className:"g-col-3",children:"Picker"})]})}),t(T,{overflow:"auto",className:"striped-children",gap:0,children:e&&e.length>0&&e.map(n=>l(ne,{gap:1,alignItems:"center",className:"text-black py-1 border-bottom",children:[t(U,{className:"g-col-2",children:n.categoryId}),t(U,{className:"g-col-3",children:n.reportedUserName}),t(U,{className:"g-col-4",children:new Date(Date.now()-n.issueAgeInMilliseconds).toLocaleTimeString()}),t(U,{className:"g-col-3",children:n.pickerUserName})]},n.issueId))})]})},Zw=["Open Issues","My Issues","Picked Issues"],eR=a=>{const{onCloseClick:e=null}=a,[n,r]=i.useState(0),[o,s]=i.useState([]),{tickets:c=[]}=ws(),u=c.filter(E=>E.state===Lo.STATE_OPEN),m=c.filter(E=>E.state===Lo.STATE_PICKED&&E.pickerUserId===H().userId),h=c.filter(E=>E.state===Lo.STATE_PICKED),g=E=>{s(I=>{const C=[...I],p=C.indexOf(E);return p>=0&&C.splice(p,1),C})},f=E=>{s(I=>{const C=[...I],p=C.indexOf(E);return p===-1?C.push(E):C.splice(p,1),C})},_=()=>{switch(n){case 0:return t(Qw,{openIssues:u});case 1:return t(Xw,{myIssues:m,handleIssue:f});case 2:return t(Jw,{pickedIssues:h})}return null};return l(V,{children:[l(ae,{className:"nitro-mod-tools-tickets",children:[t(se,{headerText:"Tickets",onCloseClick:e}),t(Ir,{children:Zw.map((E,I)=>t(qn,{isActive:n===I,onClick:C=>r(I),children:E},I))}),t(re,{gap:1,children:t(_,{})})]}),o&&o.length>0&&o.map(E=>t(Kw,{issueId:E,onIssueInfoClosed:g},E))]})},tR=a=>{const{userId:e=null,onCloseClick:n=null}=a,[r,o]=i.useState(null),[s,c]=i.useState(null);return x(ZE,u=>{const m=u.getParser();!m||m.data.userId!==e||(c(m.data.username),o(m.data.roomChatlogs))}),i.useEffect(()=>{M(new e_(e))},[e]),l(ae,{className:"nitro-mod-tools-chatlog",theme:"primary-slim",windowPosition:Pt.TOP_LEFT,children:[t(se,{headerText:`User Chatlog: ${s||""}`,onCloseClick:n}),t(re,{className:"text-black h-100",children:r&&t(cl,{records:r})})]})},_c=[new Le(1,"Alert",Le.ALERT,1,0),new Le(2,"Mute 1h",Le.MUTE,2,0),new Le(3,"Ban 18h",Le.BAN,3,0),new Le(4,"Ban 7 days",Le.BAN,4,0),new Le(5,"Ban 30 days (step 1)",Le.BAN,5,0),new Le(7,"Ban 30 days (step 2)",Le.BAN,7,0),new Le(6,"Ban 100 years",Le.BAN,6,0),new Le(106,"Ban avatar-only 100 years",Le.BAN,6,0),new Le(101,"Kick",Le.KICK,0,0),new Le(102,"Lock trade 1 week",Le.TRADE_LOCK,0,168),new Le(104,"Lock trade permanent",Le.TRADE_LOCK,0,876e3),new Le(105,"Message",Le.MESSAGE,0,0)],nR=a=>{const{user:e=null,onCloseClick:n=null}=a,[r,o]=i.useState(-1),[s,c]=i.useState(-1),[u,m]=i.useState(""),{cfhCategories:h=null,settings:g=null}=ws(),{simpleAlert:f=null}=Xe(),_=i.useMemo(()=>{const p=[];if(h&&h.length)for(const b of h)for(const N of b.topics)p.push(N);return p},[h]),E=p=>f(p,de.DEFAULT,null,null,"Error"),I=()=>{let p=null;const b=_[r];if(r===-1&&(p="You must select a CFH topic"),p)return E(p);const N=u.trim().length===0?d(`help.cfh.topic.${b.id}`):u;M(new t_(e.userId,r,N)),n()},C=()=>{let p=null;const b=_[r],N=_c[s];if(r===-1||s===-1?p="You must select a CFH topic and Sanction":!g||!g.cfhPermission?p="You do not have permission to do this":b?N||(p="You must select a sanction"):p="You must select a CFH topic",p){E(p);return}const v=u.trim().length===0?d(`help.cfh.topic.${b.id}`):u;switch(N.actionType){case Le.ALERT:{if(!g.alertPermission){E("You have insufficient permissions");return}M(new o_(e.userId,v,b.id));break}case Le.MUTE:M(new a_(e.userId,v,b.id));break;case Le.BAN:{if(!g.banPermission){E("You have insufficient permissions");return}M(new s_(e.userId,v,b.id,s,N.actionId===106));break}case Le.KICK:{if(!g.kickPermission){E("You have insufficient permissions");return}M(new r_(e.userId,v,b.id));break}case Le.TRADE_LOCK:{const O=N.actionLengthHours*60;M(new n_(e.userId,v,O,b.id));break}case Le.MESSAGE:{if(u.trim().length===0){E("Please write a message to user");return}M(new Hu(e.userId,u,b.id));break}}n()};return e?l(ae,{className:"nitro-mod-tools-user-action",theme:"primary-slim",windowPosition:Pt.TOP_LEFT,children:[t(se,{headerText:"Mod Action: "+(e?e.username:""),onCloseClick:()=>n()}),l(re,{className:"text-black",children:[l("select",{className:"form-select form-select-sm",value:r,onChange:p=>o(parseInt(p.target.value)),children:[t("option",{value:-1,disabled:!0,children:"CFH Topic"}),_.map((p,b)=>t("option",{value:b,children:d("help.cfh.topic."+p.id)},b))]}),l("select",{className:"form-select form-select-sm",value:s,onChange:p=>c(parseInt(p.target.value)),children:[t("option",{value:-1,disabled:!0,children:"Sanction Type"}),_c.map((p,b)=>t("option",{value:b,children:p.name},b))]}),l(T,{gap:1,children:[t(S,{small:!0,children:"Optional message type, overrides default"}),t("textarea",{className:"form-control",value:u,onChange:p=>m(p.target.value)})]}),l(w,{justifyContent:"between",gap:1,children:[t(L,{variant:"primary",onClick:I,children:"Default Sanction"}),t(L,{variant:"success",onClick:C,children:"Sanction"})]})]})]}):null},rR=a=>{const{userId:e=null,onCloseClick:n=null}=a,[r,o]=i.useState(null);return x(i_,s=>{const c=s.getParser();c.data.userId===e&&o(c.data)}),i.useEffect(()=>{M(new l_(e))},[e]),e?l(ae,{className:"nitro-mod-tools-user-visits",theme:"primary-slim",windowPosition:Pt.TOP_LEFT,children:[t(se,{headerText:"User Visits",onCloseClick:n}),t(re,{className:"text-black",gap:1,children:l(T,{fullHeight:!0,gap:0,overflow:"hidden",children:[t(T,{gap:2,children:l(ne,{gap:1,className:"text-black fw-bold border-bottom pb-1",children:[t(U,{className:"g-col-2",children:"Time"}),t(U,{className:"g-col-7",children:"Room name"}),t(U,{className:"g-col-3",children:"Visit"})]})}),t(ho,{rows:(r==null?void 0:r.rooms)??[],rowRender:s=>l(ne,{fullHeight:!1,gap:1,alignItems:"center",className:"text-black py-1 border-bottom",children:[l(S,{className:"g-col-2",children:[s.enterHour.toString().padStart(2,"0"),": ",s.enterMinute.toString().padStart(2,"0")]}),t(S,{className:"g-col-7",children:s.roomName}),t(S,{bold:!0,underline:!0,pointer:!0,variant:"primary",className:"g-col-3",onClick:c=>En(s.roomId),children:"Visit Room"})]})})]})})]}):null},sR=a=>{const{user:e=null,onCloseClick:n=null}=a,[r,o]=i.useState(""),{simpleAlert:s=null}=Xe();if(!e)return null;const c=()=>{if(r.trim().length===0){s("Please write a message to user.",null,null,null,"Error",null);return}M(new Hu(e.userId,r,-999)),n()};return l(ae,{className:"nitro-mod-tools-user-message",theme:"primary-slim",windowPosition:Pt.TOP_LEFT,children:[t(se,{headerText:"Send Message",onCloseClick:()=>n()}),l(re,{className:"text-black",children:[l(S,{children:["Message To: ",e.username]}),t("textarea",{className:"form-control",value:r,onChange:u=>o(u.target.value)}),t(L,{fullWidth:!0,onClick:c,children:"Send message"})]})]})},aR=a=>{const{onCloseClick:e=null,userId:n=null}=a,[r,o]=i.useState(null),[s,c]=i.useState(!1),[u,m]=i.useState(!1),[h,g]=i.useState(!1),f=i.useMemo(()=>r?[{localeKey:"modtools.userinfo.userName",value:r.userName,showOnline:!0},{localeKey:"modtools.userinfo.cfhCount",value:r.cfhCount.toString()},{localeKey:"modtools.userinfo.abusiveCfhCount",value:r.abusiveCfhCount.toString()},{localeKey:"modtools.userinfo.cautionCount",value:r.cautionCount.toString()},{localeKey:"modtools.userinfo.banCount",value:r.banCount.toString()},{localeKey:"modtools.userinfo.lastSanctionTime",value:r.lastSanctionTime},{localeKey:"modtools.userinfo.tradingLockCount",value:r.tradingLockCount.toString()},{localeKey:"modtools.userinfo.tradingExpiryDate",value:r.tradingExpiryDate},{localeKey:"modtools.userinfo.minutesSinceLastLogin",value:Hn.format(r.minutesSinceLastLogin*60,".ago",2)},{localeKey:"modtools.userinfo.lastPurchaseDate",value:r.lastPurchaseDate},{localeKey:"modtools.userinfo.primaryEmailAddress",value:r.primaryEmailAddress},{localeKey:"modtools.userinfo.identityRelatedBanCount",value:r.identityRelatedBanCount.toString()},{localeKey:"modtools.userinfo.registrationAgeInMinutes",value:Hn.format(r.registrationAgeInMinutes*60,".ago",2)},{localeKey:"modtools.userinfo.userClassification",value:r.userClassification}]:null,[r]);return x(c_,_=>{const E=_.getParser();!E||E.data.userId!==n||o(E.data)}),i.useEffect(()=>{M(new u_(n))},[n]),r?l(V,{children:[l(ae,{className:"nitro-mod-tools-user",theme:"primary-slim",windowPosition:Pt.TOP_LEFT,children:[t(se,{headerText:d("modtools.userinfo.title",["username"],[r.userName]),onCloseClick:()=>e()}),t(re,{className:"text-black",children:l(ne,{overflow:"hidden",children:[t(T,{size:8,overflow:"auto",children:t("table",{className:"table table-striped table-sm table-text-small text-black m-0",children:t("tbody",{children:f.map((_,E)=>l("tr",{children:[t("th",{scope:"row",children:d(_.localeKey)}),l("td",{children:[_.value,_.showOnline&&t("i",{className:`icon icon-pf-${r.online?"online":"offline"} ms-2`})]})]},E))})})}),l(T,{size:4,gap:1,children:[t(L,{onClick:_=>ee(`mod-tools/open-user-chatlog/${n}`),children:"Room Chat"}),t(L,{onClick:_=>c(!s),children:"Send Message"}),t(L,{onClick:_=>g(!h),children:"Room Visits"}),t(L,{onClick:_=>m(!u),children:"Mod Action"})]})]})})]}),s&&t(sR,{user:{userId:n,username:r.userName},onCloseClick:()=>c(!1)}),u&&t(nR,{user:{userId:n,username:r.userName},onCloseClick:()=>m(!1)}),h&&t(rR,{userId:n,onCloseClick:()=>g(!1)})]}):null},oR=a=>{const[e,n]=i.useState(!1),[r,o]=i.useState(-1),[s,c]=i.useState(null),[u,m]=i.useState(!1),{openRooms:h=[],openRoomChatlogs:g=[],openUserChatlogs:f=[],openUserInfos:_=[],openRoomInfo:E=null,closeRoomInfo:I=null,toggleRoomInfo:C=null,openRoomChatlog:p=null,closeRoomChatlog:b=null,toggleRoomChatlog:N=null,openUserInfo:v=null,closeUserInfo:O=null,toggleUserInfo:R=null,openUserChatlog:y=null,closeUserChatlog:F=null,toggleUserChatlog:P=null}=ws(),D=i.useRef(null);return Te([pn.INITIALIZED,pn.DISPOSED],A=>{if(!Wr.isRoomPreviewerId(A.roomId))switch(A.type){case pn.INITIALIZED:o(A.roomId);return;case pn.DISPOSED:o(-1);return}}),rl(A=>{if(A.category!==Q.UNIT)return;const k=Oe();if(!k)return;const B=k.userDataManager.getUserDataByIndex(A.id);!B||B.type!==ht.USER||c({userId:B.webID,username:B.name})}),i.useEffect(()=>{const A={linkReceived:k=>{const B=k.split("/");if(!(B.length<2))switch(B[1]){case"show":n(!0);return;case"hide":n(!1);return;case"toggle":n(G=>!G);return;case"open-room-info":E(Number(B[2]));return;case"close-room-info":I(Number(B[2]));return;case"toggle-room-info":C(Number(B[2]));return;case"open-room-chatlog":p(Number(B[2]));return;case"close-room-chatlog":b(Number(B[2]));return;case"toggle-room-chatlog":N(Number(B[2]));return;case"open-user-info":v(Number(B[2]));return;case"close-user-info":O(Number(B[2]));return;case"toggle-user-info":R(Number(B[2]));return;case"open-user-chatlog":y(Number(B[2]));return;case"close-user-chatlog":F(Number(B[2]));return;case"toggle-user-chatlog":P(Number(B[2]));return}},eventUrlPrefix:"mod-tools/"};return _t(A),()=>Ct(A)},[E,I,C,p,b,N,v,O,R,y,F,P]),l(V,{children:[e&&l(ae,{uniqueKey:"mod-tools",className:"nitro-mod-tools",windowPosition:Pt.TOP_LEFT,theme:"primary-slim",children:[t(se,{headerText:"Mod Tools",onCloseClick:A=>n(!1)}),l(re,{className:"text-black",gap:1,children:[l(L,{gap:1,onClick:A=>ee(`mod-tools/toggle-room-info/${r}`),disabled:r<=0,className:"position-relative",children:[t(U,{className:"icon icon-small-room position-absolute start-1"})," Room Tool"]}),l(L,{innerRef:D,gap:1,onClick:A=>ee(`mod-tools/toggle-room-chatlog/${r}`),disabled:r<=0,className:"position-relative",children:[t(U,{className:"icon icon-chat-history position-absolute start-1"})," Chatlog Tool"]}),l(L,{gap:1,onClick:()=>ee(`mod-tools/toggle-user-info/${s.userId}`),disabled:!s,className:"position-relative",children:[t(U,{className:"icon icon-user position-absolute start-1"})," User: ",s?s.username:""]}),l(L,{gap:1,onClick:()=>m(A=>!A),className:"position-relative",children:[t(U,{className:"icon icon-tickets position-absolute start-1"})," Report Tool"]})]})]}),h.length>0&&h.map(A=>t(zw,{roomId:A,onCloseClick:()=>ee(`mod-tools/close-room-info/${A}`)},A)),g.length>0&&g.map(A=>t(Yw,{roomId:A,onCloseClick:()=>ee(`mod-tools/close-room-chatlog/${A}`)},A)),_.length>0&&_.map(A=>t(aR,{userId:A,onCloseClick:()=>ee(`mod-tools/close-user-info/${A}`)},A)),f.length>0&&f.map(A=>t(tR,{userId:A,onCloseClick:()=>ee(`mod-tools/close-user-chatlog/${A}`)},A)),u&&t(eR,{onCloseClick:()=>m(!1)})]})},iR=[Pe.START_DOORBELL,Pe.STATE_WAITING,Pe.STATE_NO_ANSWER,Pe.START_PASSWORD,Pe.STATE_WRONG_PASSWORD],lR=[Pe.START_DOORBELL,Pe.STATE_WAITING,Pe.STATE_NO_ANSWER],cR=a=>{const[e,n]=i.useState(""),{doorData:r=null,setDoorData:o=null}=Ln(),s=()=>{r&&r.state===Pe.STATE_WAITING&&pi(),o(null)},c=()=>{!r||!r.roomInfo||(jr(r.roomInfo.roomId),o(h=>{const g={...h};return g.state=Pe.STATE_PENDING_SERVER,g}))},u=()=>{!r||!r.roomInfo||(jr(r.roomInfo.roomId,e),o(h=>{const g={...h};return g.state=Pe.STATE_PENDING_SERVER,g}))};if(i.useEffect(()=>{!r||r.state!==Pe.STATE_NO_ANSWER||pi()},[r]),!r||r.state===Pe.NONE||iR.indexOf(r.state)===-1)return null;const m=lR.indexOf(r.state)>=0;return l(ae,{className:"nitro-navigator-doorbell",theme:"primary-slim",children:[t(se,{headerText:d(m?"navigator.doorbell.title":"navigator.password.title"),onCloseClick:s}),l(re,{children:[l(T,{gap:1,children:[t(S,{bold:!0,children:r&&r.roomInfo&&r.roomInfo.roomName}),r.state===Pe.START_DOORBELL&&t(S,{children:d("navigator.doorbell.info")}),r.state===Pe.STATE_WAITING&&t(S,{children:d("navigator.doorbell.waiting")}),r.state===Pe.STATE_NO_ANSWER&&t(S,{children:d("navigator.doorbell.no.answer")}),r.state===Pe.START_PASSWORD&&t(S,{children:d("navigator.password.info")}),r.state===Pe.STATE_WRONG_PASSWORD&&t(S,{children:d("navigator.password.retryinfo")})]}),m&&l(T,{gap:1,children:[r.state===Pe.START_DOORBELL&&t(L,{variant:"success",onClick:c,children:d("navigator.doorbell.button.ring")}),t(L,{variant:"danger",onClick:s,children:d("generic.cancel")})]}),!m&&l(V,{children:[l(T,{gap:1,children:[t(S,{children:d("navigator.password.enter")}),t("input",{type:"password",className:"form-control form-control-sm",onChange:h=>n(h.target.value)})]}),l(T,{gap:1,children:[t(L,{variant:"success",onClick:u,children:d("navigator.password.button.try")}),t(L,{variant:"danger",onClick:s,children:d("generic.cancel")})]})]})]})]})},uR=a=>{const[e,n]=i.useState(null),[r,o]=i.useState(null),[s,c]=i.useState(null),[u,m]=i.useState(null),[h,g]=i.useState(null),[f,_]=i.useState(0),[E,I]=i.useState([]),[C,p]=i.useState(""),{categories:b=null}=Ln(),N=K("hc.disabled",!1),v=y=>K("images.url")+`/navigator/models/model_${y}.png`,O=(y,F)=>{!y||y.clubLevel>In()||p(E[F].name)},R=()=>{M(new d_(r,s,"model_"+C,Number(u),Number(h),f))};return i.useEffect(()=>{if(!e){const y=[];for(let F=10;F<=100;F=F+10)y.push(F);n(y),g(y[0])}},[e]),i.useEffect(()=>{b&&b.length&&m(b[0].id)},[b]),i.useEffect(()=>{const y=K("navigator.room.models");y&&y.length&&(I(y),p(y[0].name))},[]),l(T,{overflow:"hidden",children:[l(ne,{overflow:"hidden",children:[l(T,{size:6,gap:1,overflow:"auto",children:[l(T,{gap:1,children:[t(S,{children:d("navigator.createroom.roomnameinfo")}),t("input",{type:"text",className:"form-control form-control-sm",maxLength:60,onChange:y=>o(y.target.value),placeholder:d("navigator.createroom.roomnameinfo")})]}),l(T,{grow:!0,gap:1,children:[t(S,{children:d("navigator.createroom.roomdescinfo")}),t("textarea",{className:"flex-grow-1 form-control form-control-sm w-100",maxLength:255,onChange:y=>c(y.target.value),placeholder:d("navigator.createroom.roomdescinfo")})]}),l(T,{gap:1,children:[t(S,{children:d("navigator.category")}),t("select",{className:"form-select form-select-sm",onChange:y=>m(Number(y.target.value)),children:b&&b.length>0&&b.map(y=>t("option",{value:y.id,children:d(y.name)},y.id))})]}),l(T,{gap:1,children:[t(S,{children:d("navigator.maxvisitors")}),t("select",{className:"form-select form-select-sm",onChange:y=>g(Number(y.target.value)),children:e&&e.map(y=>t("option",{value:y,children:y},y))})]}),l(T,{gap:1,children:[t(S,{children:d("navigator.tradesettings")}),l("select",{className:"form-select form-select-sm",onChange:y=>_(Number(y.target.value)),children:[t("option",{value:"0",children:d("navigator.roomsettings.trade_not_allowed")}),t("option",{value:"1",children:d("navigator.roomsettings.trade_not_with_Controller")}),t("option",{value:"2",children:d("navigator.roomsettings.trade_allowed")})]})]})]}),t(T,{size:6,gap:1,overflow:"auto",children:E.map((y,F)=>l(be,{fullHeight:!0,onClick:()=>O(y,F),itemActive:C===y.name,overflow:"unset",gap:0,className:"p-1",disabled:In()<y.clubLevel,children:[t(w,{fullHeight:!0,center:!0,overflow:"hidden",children:t("img",{alt:"",src:v(y.name)})}),l(S,{bold:!0,children:[y.tileSize," ",d("navigator.createroom.tilesize")]}),!N&&y.clubLevel>un.NO_CLUB&&t(lt,{position:"absolute",className:"top-1 end-1",type:"hc"})]},y.name))})]}),t(L,{fullWidth:!0,variant:!r||r.length<3?"danger":"success",onClick:R,disabled:!r||r.length<3,children:d("navigator.createroom.create")})]})},dR=a=>{const{onCloseClick:e=null}=a,[n,r]=i.useState(!1),[o,s]=i.useState(!1),{report:c=null}=Mn(),{navigatorData:u=null}=Ln(),m=g=>{switch(g){case"settings":return H().userId===u.enteredGuestRoom.ownerId||H().isModerator;case"staff_pick":return H().securityLevel>=qa.COMMUNITY;default:return!1}},h=(g,f)=>{if(!(!u||!u.enteredGuestRoom))switch(g){case"set_home_room":let _=-1;u.homeRoomId!==u.enteredGuestRoom.roomId&&(_=u.enteredGuestRoom.roomId),_>0&&M(new f_(_));return;case"navigator_search_tag":ee(`navigator/search/${f}`),M(new Es("hotel_view",`tag:${f}`));return;case"open_room_thumbnail_camera":St(new Fn(Fn.TOGGLE_THUMBNAIL));return;case"open_group_info":ea(u.enteredGuestRoom.habboGroupId);return;case"toggle_room_link":ee("navigator/toggle-room-link");return;case"open_room_settings":M(new Du(u.enteredGuestRoom.roomId));return;case"toggle_pick":r(E=>!E),M(new h_(u.enteredGuestRoom.roomId));return;case"toggle_mute":s(E=>!E),M(new g_);return;case"room_filter":M(new m_(u.enteredGuestRoom.roomId));return;case"open_floorplan_editor":ee("floor-editor/toggle");return;case"report_room":c(Ve.ROOM,{roomId:u.enteredGuestRoom.roomId,roomName:u.enteredGuestRoom.roomName});return;case"close":e();return}};return i.useEffect(()=>{u&&(r(u.currentRoomIsStaffPick),u.enteredGuestRoom&&s(u.enteredGuestRoom.allInRoomMuted))},[u]),u.enteredGuestRoom?l(ae,{className:"nitro-room-info",theme:"primary-slim",children:[t(se,{headerText:d("navigator.roomsettings.roominfo"),onCloseClick:()=>h("close")}),t(re,{className:"text-black",children:u.enteredGuestRoom&&l(V,{children:[l(w,{gap:2,overflow:"hidden",children:[t(go,{roomId:u.enteredGuestRoom.roomId,customUrl:u.enteredGuestRoom.officialRoomPicRef,children:m("settings")&&t("i",{className:"icon icon-camera-small position-absolute b-0 r-0 m-1 cursor-pointer top-0",onClick:()=>h("open_room_thumbnail_camera")})}),l(T,{grow:!0,gap:1,overflow:"hidden",children:[l(w,{gap:1,children:[l(T,{grow:!0,gap:1,children:[l(w,{gap:1,children:[t("i",{onClick:()=>h("set_home_room"),className:Vt("flex-shrink-0 icon icon-house-small cursor-pointer",u.homeRoomId!==u.enteredGuestRoom.roomId&&"gray")}),t(S,{bold:!0,children:u.enteredGuestRoom.roomName})]}),u.enteredGuestRoom.showOwner&&l(w,{alignItems:"center",gap:1,children:[t(S,{variant:"muted",children:d("navigator.roomownercaption")}),l(w,{alignItems:"center",gap:1,children:[t(_n,{userId:u.enteredGuestRoom.ownerId}),t(S,{children:u.enteredGuestRoom.ownerName})]})]}),l(w,{alignItems:"center",gap:1,children:[t(S,{variant:"muted",children:d("navigator.roomrating")}),t(S,{children:u.currentRoomRating})]}),u.enteredGuestRoom.tags.length>0&&t(w,{alignItems:"center",gap:1,children:u.enteredGuestRoom.tags.map(g=>l(S,{pointer:!0,className:"bg-muted rounded p-1",onClick:f=>h("navigator_search_tag",g),children:["#",g]},g))})]}),l(T,{alignItems:"center",gap:1,children:[m("settings")&&t("i",{className:"icon icon-cog cursor-pointer",title:d("navigator.room.popup.info.room.settings"),onClick:g=>h("open_room_settings")}),t(Um,{title:d("navigator.embed.caption"),className:"cursor-pointer fa-icon",onClick:g=>ee("navigator/toggle-room-link")})]})]}),t(S,{overflow:"auto",style:{maxHeight:50},children:u.enteredGuestRoom.description}),u.enteredGuestRoom.habboGroupId>0&&l(w,{pointer:!0,alignItems:"center",gap:1,onClick:()=>h("open_group_info"),children:[t(je,{className:"flex-none",badgeCode:u.enteredGuestRoom.groupBadgeCode,isGroup:!0}),t(S,{underline:!0,children:d("navigator.guildbase",["groupName"],[u.enteredGuestRoom.groupName])})]})]})]}),l(T,{gap:1,children:[m("staff_pick")&&t(L,{onClick:()=>h("toggle_pick"),children:d(n?"navigator.staffpicks.unpick":"navigator.staffpicks.pick")}),t(L,{variant:"danger",onClick:()=>h("report_room"),children:d("help.emergency.main.report.room")}),m("settings")&&l(V,{children:[t(L,{onClick:()=>h("toggle_mute"),children:d(o?"navigator.muteall_on":"navigator.muteall_off")}),t(L,{onClick:()=>h("room_filter"),children:d("navigator.roomsettings.roomfilter")}),t(L,{onClick:()=>h("open_floorplan_editor"),children:d("open.floor.plan.editor")})]})]})]})})]}):null},mR=a=>{const{onCloseClick:e=null}=a,{navigatorData:n=null}=Ln();return n.enteredGuestRoom?l(ae,{className:"nitro-room-link",theme:"primary-slim",children:[t(se,{headerText:d("navigator.embed.title"),onCloseClick:e}),t(re,{className:"text-black d-flex align-items-center",children:l(w,{gap:2,children:[t(go,{roomId:n.enteredGuestRoom.roomId,customUrl:n.enteredGuestRoom.officialRoomPicRef}),l(T,{children:[t(S,{bold:!0,fontSize:5,children:d("navigator.embed.headline")}),t(S,{children:d("navigator.embed.info")}),t("input",{type:"text",readOnly:!0,className:"form-control form-control-sm",value:d("navigator.embed.src",["roomId"],[n.enteredGuestRoom.roomId.toString()]).replace("${url.prefix}",K("url.prefix",""))})]})]})})]}):null},gR=a=>{const{roomData:e=null,handleChange:n=null}=a,[r,o]=i.useState(""),[s,c]=i.useState(""),[u,m]=i.useState(!1),h=()=>{!u||r.length<=0||s.length<=0||r!==s||n("password",r)};return i.useEffect(()=>{o(""),c(""),m(!1)},[e]),l(V,{children:[l(T,{gap:1,children:[t(S,{bold:!0,children:d("navigator.roomsettings.roomaccess.caption")}),t(S,{children:d("navigator.roomsettings.roomaccess.info")})]}),l(T,{overflow:"auto",children:[l(T,{gap:1,children:[t(S,{bold:!0,children:d("navigator.roomsettings.doormode")}),l(w,{alignItems:"center",gap:1,children:[t("input",{className:"form-check-input",type:"radio",name:"lockState",checked:e.lockState===rt.OPEN_STATE&&!u,onChange:g=>n("lock_state",rt.OPEN_STATE)}),t(S,{children:d("navigator.roomsettings.doormode.open")})]}),l(w,{alignItems:"center",gap:1,children:[t("input",{className:"form-check-input",type:"radio",name:"lockState",checked:e.lockState===rt.DOORBELL_STATE&&!u,onChange:g=>n("lock_state",rt.DOORBELL_STATE)}),t(S,{children:d("navigator.roomsettings.doormode.doorbell")})]}),l(w,{alignItems:"center",gap:1,children:[t("input",{className:"form-check-input",type:"radio",name:"lockState",checked:e.lockState===rt.INVISIBLE_STATE&&!u,onChange:g=>n("lock_state",rt.INVISIBLE_STATE)}),t(S,{children:d("navigator.roomsettings.doormode.invisible")})]}),l(w,{fullWidth:!0,gap:1,children:[t("input",{className:"form-check-input",type:"radio",name:"lockState",checked:e.lockState===rt.PASSWORD_STATE||u,onChange:g=>m(g.target.checked)}),!u&&e.lockState!==rt.PASSWORD_STATE&&t(S,{children:d("navigator.roomsettings.doormode.password")}),(u||e.lockState===rt.PASSWORD_STATE)&&l(T,{gap:1,children:[t(S,{children:d("navigator.roomsettings.doormode.password")}),t("input",{type:"password",className:"form-control form-control-sm col-4",value:r,onChange:g=>o(g.target.value),placeholder:d("navigator.roomsettings.password"),onFocus:g=>m(!0)}),u&&r.length<=0&&t(S,{bold:!0,small:!0,variant:"danger",children:d("navigator.roomsettings.passwordismandatory")}),t("input",{type:"password",className:"form-control form-control-sm col-4",value:s,onChange:g=>c(g.target.value),onBlur:h,placeholder:d("navigator.roomsettings.passwordconfirm")}),u&&r.length>0&&r!==s&&t(S,{bold:!0,small:!0,variant:"danger",children:d("navigator.roomsettings.invalidconfirm")})]})]})]}),l(T,{gap:1,children:[t(S,{bold:!0,children:d("navigator.roomsettings.pets")}),l(w,{alignItems:"center",gap:1,children:[t("input",{className:"form-check-input",type:"checkbox",checked:e.allowPets,onChange:g=>n("allow_pets",g.target.checked)}),t(S,{children:d("navigator.roomsettings.allowpets")})]}),l(w,{alignItems:"center",gap:1,children:[t("input",{className:"form-check-input",type:"checkbox",checked:e.allowPetsEat,onChange:g=>n("allow_pets_eat",g.target.checked)}),t(S,{children:d("navigator.roomsettings.allowfoodconsume")})]})]})]})]})},Cc=3,bc=60,Sc=255,Aa=15,hR=a=>{const{roomData:e=null,handleChange:n=null,onClose:r=null}=a,[o,s]=i.useState(""),[c,u]=i.useState(""),[m,h]=i.useState(""),[g,f]=i.useState(""),[_,E]=i.useState(0),[I,C]=i.useState(""),{showConfirm:p=null}=Xe(),{categories:b=null}=Ln();x(p_,y=>{const F=y.getParser();if(F)switch(F.code){case kl.ERROR_INVALID_TAG:C("navigator.roomsettings.unacceptablewords");case kl.ERROR_NON_USER_CHOOSABLE_TAG:C("navigator.roomsettings.nonuserchoosabletag");break;default:C("");break}});const N=()=>{p(d("navigator.roomsettings.deleteroom.confirm.message",["room_name"],[e.roomName]),()=>{M(new I_(e.roomId)),r&&r(),ee("navigator/search/myworld_view")},null,null,null,d("navigator.roomsettings.deleteroom.confirm.title"))},v=()=>{o===e.roomName||o.length<Cc||o.length>bc||n("name",o)},O=()=>{c===e.roomDescription||c.length>Sc||n("description",c)},R=y=>{y===0&&m===e.tags[0]||m.length>Aa||y===1&&g===e.tags[1]||g.length>Aa||(m===""&&g!==""&&f(""),C(""),E(y),n("tags",m===""&&g!==""?[g]:[m,g]))};return i.useEffect(()=>{s(e.roomName),u(e.roomDescription),h(e.tags.length>0&&e.tags[0]?e.tags[0]:""),f(e.tags.length>0&&e.tags[1]?e.tags[1]:"")},[e]),l(V,{children:[l(w,{alignItems:"center",gap:1,children:[t(S,{className:"col-3",children:d("navigator.roomname")}),l(T,{fullWidth:!0,gap:0,children:[t("input",{className:"form-control form-control-sm",value:o,maxLength:bc,onChange:y=>s(y.target.value),onBlur:v}),o.length<Cc&&t(S,{bold:!0,small:!0,variant:"danger",children:d("navigator.roomsettings.roomnameismandatory")})]})]}),l(w,{alignItems:"center",gap:1,children:[t(S,{className:"col-3",children:d("navigator.roomsettings.desc")}),t("textarea",{className:"form-control form-control-sm",value:c,maxLength:Sc,onChange:y=>u(y.target.value),onBlur:O})]}),l(w,{alignItems:"center",gap:1,children:[t(S,{className:"col-3",children:d("navigator.category")}),t("select",{className:"form-select form-select-sm",value:e.categoryId,onChange:y=>n("category",y.target.value),children:b&&b.map(y=>t("option",{value:y.id,children:d(y.name)},y.id))})]}),l(w,{alignItems:"center",gap:1,children:[t(S,{className:"col-3",children:d("navigator.maxvisitors")}),t("select",{className:"form-select form-select-sm",value:e.userCount,onChange:y=>n("max_visitors",y.target.value),children:Xl&&Xl.map(y=>t("option",{value:y,children:y},y))})]}),l(w,{alignItems:"center",gap:1,children:[t(S,{className:"col-3",children:d("navigator.tradesettings")}),l("select",{className:"form-select form-select-sm",value:e.tradeState,onChange:y=>n("trade_state",y.target.value),children:[t("option",{value:"0",children:d("navigator.roomsettings.trade_not_allowed")}),t("option",{value:"1",children:d("navigator.roomsettings.trade_not_with_Controller")}),t("option",{value:"2",children:d("navigator.roomsettings.trade_allowed")})]})]}),l(w,{alignItems:"center",gap:1,children:[t(S,{className:"col-3",children:d("navigator.tags")}),l(T,{fullWidth:!0,gap:0,children:[t("input",{className:"form-control form-control-sm",value:m,onChange:y=>h(y.target.value),onBlur:()=>R(0)}),m.length>Aa&&t(S,{bold:!0,small:!0,variant:"danger",children:d("navigator.roomsettings.toomanycharacters")}),_===0&&I!=""&&t(S,{bold:!0,small:!0,variant:"danger",children:d(I)})]}),l(T,{fullWidth:!0,gap:0,children:[t("input",{className:"form-control form-control-sm",value:g,onChange:y=>f(y.target.value),onBlur:()=>R(1)}),g.length>Aa&&t(S,{bold:!0,small:!0,variant:"danger",children:d("navigator.roomsettings.toomanycharacters")}),_===1&&I!=""&&t(S,{bold:!0,small:!0,variant:"danger",children:d(I)})]})]}),l(w,{alignItems:"center",gap:1,children:[t(U,{className:"col-3"}),t("input",{className:"form-check-input",type:"checkbox",checked:e.allowWalkthrough,onChange:y=>n("allow_walkthrough",y.target.checked)}),t(S,{children:d("navigator.roomsettings.allow_walk_through")})]}),l(S,{variant:"danger",underline:!0,bold:!0,pointer:!0,className:"d-flex justify-content-center align-items-center gap-1",onClick:N,children:[t(Cn,{className:"fa-icon"}),d("navigator.roomsettings.delete")]})]})},fR=a=>{var m;const{roomData:e=null,handleChange:n=null}=a,[r,o]=i.useState(-1),[s,c]=i.useState([]),u=h=>{c(g=>{const f=[...g],_=f.findIndex(E=>E.userId===h);return _>=0&&f.splice(_,1),f}),M(new __(h,e.roomId)),o(-1)};return x(E_,h=>{const g=h.getParser();!e||e.roomId!==g.roomId||c(g.bannedUsers)}),i.useEffect(()=>{M(new Wu(e.roomId))},[e.roomId]),l(ne,{overflow:"auto",children:[l(T,{size:6,children:[l(S,{bold:!0,children:[d("navigator.roomsettings.moderation.banned.users")," (",s.length,")"]}),t(w,{overflow:"hidden",className:"bg-white rounded list-container p-2",children:t(T,{fullWidth:!0,overflow:"auto",gap:1,children:s&&s.length>0&&s.map((h,g)=>l(w,{shrink:!0,alignItems:"center",gap:1,overflow:"hidden",children:[t(_n,{userName:h.userName}),l(S,{pointer:!0,grow:!0,onClick:f=>o(h.userId),children:[" ",h.userName]})]},g))})}),l(L,{disabled:r<=0,onClick:h=>u(r),children:[d("navigator.roomsettings.moderation.unban")," ",r>0&&((m=s.find(h=>h.userId===r))==null?void 0:m.userName)]})]}),l(T,{size:6,children:[l(T,{gap:1,children:[t(S,{bold:!0,children:d("navigator.roomsettings.moderation.mute.header")}),t(w,{alignItems:"center",gap:1,children:l("select",{className:"form-select form-select-sm",value:e.moderationSettings.allowMute,onChange:h=>n("moderation_mute",h.target.value),children:[t("option",{value:Un.MODERATION_LEVEL_NONE,children:d("navigator.roomsettings.moderation.none")}),t("option",{value:Un.MODERATION_LEVEL_USER_WITH_RIGHTS,children:d("navigator.roomsettings.moderation.rights")})]})})]}),l(T,{gap:1,children:[t(S,{bold:!0,children:d("navigator.roomsettings.moderation.kick.header")}),t(w,{alignItems:"center",gap:1,children:l("select",{className:"form-select form-select-sm",value:e.moderationSettings.allowKick,onChange:h=>n("moderation_kick",h.target.value),children:[t("option",{value:Un.MODERATION_LEVEL_NONE,children:d("navigator.roomsettings.moderation.none")}),t("option",{value:Un.MODERATION_LEVEL_USER_WITH_RIGHTS,children:d("navigator.roomsettings.moderation.rights")}),t("option",{value:Un.MODERATION_LEVEL_ALL,children:d("navigator.roomsettings.moderation.all")})]})})]}),l(T,{gap:1,children:[t(S,{bold:!0,children:d("navigator.roomsettings.moderation.ban.header")}),t(w,{alignItems:"center",gap:1,children:l("select",{className:"form-select form-select-sm",value:e.moderationSettings.allowBan,onChange:h=>n("moderation_ban",h.target.value),children:[t("option",{value:Un.MODERATION_LEVEL_NONE,children:d("navigator.roomsettings.moderation.none")}),t("option",{value:Un.MODERATION_LEVEL_USER_WITH_RIGHTS,children:d("navigator.roomsettings.moderation.rights")})]})})]})]})]})},pR=a=>{const{roomData:e=null}=a,[n,r]=i.useState(new Map);return x(C_,o=>{const s=o.getParser();!e||e.roomId!==s.roomId||r(s.users)}),x(b_,o=>{const s=o.getParser();!e||e.roomId!==s.roomId||r(c=>{const u=new Map(c);return u.set(s.data.userId,s.data.userName),u})}),x(S_,o=>{const s=o.getParser();!e||e.roomId!==s.roomId||r(c=>{const u=new Map(c);return u.delete(s.userId),u})}),i.useEffect(()=>{M(new N_(e.roomId))},[e.roomId]),l(ne,{children:[l(T,{size:6,children:[t(S,{bold:!0,children:d("navigator.flatctrls.userswithrights",["displayed","total"],[n.size.toString(),n.size.toString()])}),t(w,{overflow:"hidden",className:"bg-white rounded list-container p-2",children:t(T,{fullWidth:!0,overflow:"auto",gap:1,children:Array.from(n.entries()).map(([o,s],c)=>l(w,{shrink:!0,alignItems:"center",gap:1,overflow:"hidden",children:[t(_n,{userName:s}),l(S,{pointer:!0,grow:!0,onClick:u=>M(new T_(o)),children:[" ",s]})]},c))})})]}),t(T,{size:6,justifyContent:"end",children:t(L,{variant:"danger",disabled:!n.size,onClick:o=>M(new v_(e.roomId)),children:d("navigator.flatctrls.clear")})})]})},IR=a=>{const{roomData:e=null,handleChange:n=null}=a,[r,o]=i.useState(0);return i.useEffect(()=>{o(e.chatSettings.distance)},[e.chatSettings]),l(V,{children:[l(T,{gap:1,children:[t(S,{bold:!0,children:d("navigator.roomsettings.vip.caption")}),t(S,{children:d("navigator.roomsettings.vip.info")})]}),l(ne,{overflow:"auto",children:[l(T,{size:6,gap:1,children:[t(S,{bold:!0,children:d("navigator.roomsettings.chat_settings")}),t(S,{children:d("navigator.roomsettings.chat_settings.info")}),l("select",{className:"form-select form-select-sm",value:e.chatSettings.mode,onChange:s=>n("bubble_mode",s.target.value),children:[t("option",{value:It.CHAT_MODE_FREE_FLOW,children:d("navigator.roomsettings.chat.mode.free.flow")}),t("option",{value:It.CHAT_MODE_LINE_BY_LINE,children:d("navigator.roomsettings.chat.mode.line.by.line")})]}),l("select",{className:"form-select form-select-sm",value:e.chatSettings.weight,onChange:s=>n("chat_weight",s.target.value),children:[t("option",{value:It.CHAT_BUBBLE_WIDTH_NORMAL,children:d("navigator.roomsettings.chat.bubbles.width.normal")}),t("option",{value:It.CHAT_BUBBLE_WIDTH_THIN,children:d("navigator.roomsettings.chat.bubbles.width.thin")}),t("option",{value:It.CHAT_BUBBLE_WIDTH_WIDE,children:d("navigator.roomsettings.chat.bubbles.width.wide")})]}),l("select",{className:"form-select form-select-sm",value:e.chatSettings.speed,onChange:s=>n("bubble_speed",s.target.value),children:[t("option",{value:It.CHAT_SCROLL_SPEED_FAST,children:d("navigator.roomsettings.chat.speed.fast")}),t("option",{value:It.CHAT_SCROLL_SPEED_NORMAL,children:d("navigator.roomsettings.chat.speed.normal")}),t("option",{value:It.CHAT_SCROLL_SPEED_SLOW,children:d("navigator.roomsettings.chat.speed.slow")})]}),l("select",{className:"form-select form-select-sm",value:e.chatSettings.protection,onChange:s=>n("flood_protection",s.target.value),children:[t("option",{value:It.FLOOD_FILTER_LOOSE,children:d("navigator.roomsettings.chat.flood.loose")}),t("option",{value:It.FLOOD_FILTER_NORMAL,children:d("navigator.roomsettings.chat.flood.normal")}),t("option",{value:It.FLOOD_FILTER_STRICT,children:d("navigator.roomsettings.chat.flood.strict")})]}),t(S,{children:d("navigator.roomsettings.chat_settings.hearing.distance")}),t("input",{type:"number",min:"0",className:"form-control form-control-sm",value:r,onChange:s=>o(s.target.valueAsNumber),onBlur:s=>n("chat_distance",r)})]}),l(T,{size:6,gap:1,children:[t(S,{bold:!0,children:d("navigator.roomsettings.vip_settings")}),l(w,{alignItems:"center",gap:1,children:[t("input",{className:"form-check-input",type:"checkbox",checked:e.hideWalls,onChange:s=>n("hide_walls",s.target.checked)}),t(S,{children:d("navigator.roomsettings.hide_walls")})]}),l("select",{className:"form-select form-select-sm",value:e.wallThickness,onChange:s=>n("wall_thickness",s.target.value),children:[t("option",{value:"0",children:d("navigator.roomsettings.wall_thickness.normal")}),t("option",{value:"1",children:d("navigator.roomsettings.wall_thickness.thick")}),t("option",{value:"-1",children:d("navigator.roomsettings.wall_thickness.thin")}),t("option",{value:"-2",children:d("navigator.roomsettings.wall_thickness.thinnest")})]}),l("select",{className:"form-select form-select-sm",value:e.floorThickness,onChange:s=>n("floor_thickness",s.target.value),children:[t("option",{value:"0",children:d("navigator.roomsettings.floor_thickness.normal")}),t("option",{value:"1",children:d("navigator.roomsettings.floor_thickness.thick")}),t("option",{value:"-1",children:d("navigator.roomsettings.floor_thickness.thin")}),t("option",{value:"-2",children:d("navigator.roomsettings.floor_thickness.thinnest")})]})]})]})]})},Nr=["navigator.roomsettings.tab.1","navigator.roomsettings.tab.2","navigator.roomsettings.tab.3","navigator.roomsettings.tab.4","navigator.roomsettings.tab.5"],ER=a=>{const[e,n]=i.useState(null),[r,o]=i.useState(Nr[0]);x(w_,u=>{const m=u.getParser();if(!m)return;const h=m.data;n({roomId:h.roomId,roomName:h.name,roomDescription:h.description,categoryId:h.categoryId,userCount:h.maximumVisitorsLimit,tags:h.tags,tradeState:h.tradeMode,allowWalkthrough:h.allowWalkThrough,lockState:h.doorMode,password:null,allowPets:h.allowPets,allowPetsEat:h.allowFoodConsume,hideWalls:h.hideWalls,wallThickness:h.wallThickness,floorThickness:h.floorThickness,chatSettings:{mode:h.chatSettings.mode,weight:h.chatSettings.weight,speed:h.chatSettings.speed,distance:h.chatSettings.distance,protection:h.chatSettings.protection},moderationSettings:{allowMute:h.roomModerationSettings.allowMute,allowKick:h.roomModerationSettings.allowKick,allowBan:h.roomModerationSettings.allowBan}}),M(new Wu(h.roomId))});const s=()=>{n(null),o(Nr[0])},c=(u,m)=>{n(h=>{const g={...h};switch(u){case"name":g.roomName=String(m);break;case"description":g.roomDescription=String(m);break;case"category":g.categoryId=Number(m);break;case"max_visitors":g.userCount=Number(m);break;case"trade_state":g.tradeState=Number(m);break;case"tags":g.tags=m;break;case"allow_walkthrough":g.allowWalkthrough=!!m;break;case"allow_pets":g.allowPets=!!m;break;case"allow_pets_eat":g.allowPetsEat=!!m;break;case"hide_walls":g.hideWalls=!!m;break;case"wall_thickness":g.wallThickness=Number(m);break;case"floor_thickness":g.floorThickness=Number(m);break;case"lock_state":g.lockState=Number(m);break;case"password":g.lockState=rt.PASSWORD_STATE,g.password=String(m);break;case"moderation_mute":g.moderationSettings.allowMute=Number(m);break;case"moderation_kick":g.moderationSettings.allowKick=Number(m);break;case"moderation_ban":g.moderationSettings.allowBan=Number(m);break;case"bubble_mode":g.chatSettings.mode=Number(m);break;case"chat_weight":g.chatSettings.weight=Number(m);break;case"bubble_speed":g.chatSettings.speed=Number(m);break;case"flood_protection":g.chatSettings.protection=Number(m);break;case"chat_distance":g.chatSettings.distance=Number(m);break}return M(new R_(g.roomId,g.roomName,g.roomDescription,g.lockState,g.password,g.userCount,g.categoryId,g.tags.length,g.tags,g.tradeState,g.allowPets,g.allowPetsEat,g.allowWalkthrough,g.hideWalls,g.wallThickness,g.floorThickness,g.moderationSettings.allowMute,g.moderationSettings.allowKick,g.moderationSettings.allowBan,g.chatSettings.mode,g.chatSettings.weight,g.chatSettings.speed,g.chatSettings.distance,g.chatSettings.protection)),g})};return e?l(ae,{uniqueKey:"nitro-room-settings",className:"nitro-room-settings",children:[t(se,{headerText:d("navigator.roomsettings"),onCloseClick:s}),t(Ir,{children:Nr.map(u=>t(qn,{isActive:r===u,onClick:m=>o(u),children:d(u)},u))}),l(re,{children:[r===Nr[0]&&t(hR,{roomData:e,handleChange:c,onClose:s}),r===Nr[1]&&t(gR,{roomData:e,handleChange:c}),r===Nr[2]&&t(pR,{roomData:e,handleChange:c}),r===Nr[3]&&t(IR,{roomData:e,handleChange:c}),r===Nr[4]&&t(fR,{roomData:e,handleChange:c})]})]}):null},Nc=a=>{const{roomData:e=null}=a,[n,r]=i.useState(!1),o=i.useRef(),s=()=>{const c=100*(e.userCount/e.maxUserCount);let u="bg-primary";return c>=92?u="bg-danger":c>=50?u="bg-warning":c>0&&(u="bg-success"),u};return l(V,{children:[t(U,{pointer:!0,innerRef:o,className:"icon icon-navigator-info",onMouseOver:c=>r(!0),onMouseLeave:c=>r(!1)}),t(gu,{show:n,target:o.current,placement:"right",children:t(Ba,{children:t(re,{overflow:"hidden",className:"room-info image-rendering-pixelated bg-transparent",children:l(w,{gap:2,overflow:"hidden",children:[l(go,{roomId:e.roomId,customUrl:e.officialRoomPicRef,className:"d-flex flex-column align-items-center justify-content-end mb-1",children:[e.habboGroupId>0&&t(je,{badgeCode:e.groupBadgeCode,isGroup:!0,className:"position-absolute top-0 start-0 m-1 "}),e.doorMode!==rt.OPEN_STATE&&t("i",{className:"position-absolute end-0 mb-1 me-1 icon icon-navigator-room-"+(e.doorMode===rt.DOORBELL_STATE?"locked":e.doorMode===rt.PASSWORD_STATE?"password":e.doorMode===rt.INVISIBLE_STATE?"invisible":"")})]}),l(T,{gap:1,children:[t(S,{bold:!0,truncate:!0,className:"flex-grow-1",style:{maxHeight:13},children:e.roomName}),l(w,{gap:2,children:[t(S,{italics:!0,variant:"muted",children:d("navigator.roomownercaption")}),l(w,{alignItems:"center",gap:1,children:[t(_n,{userId:e.ownerId}),t(S,{italics:!0,children:e.ownerName})]})]}),t(S,{className:"flex-grow-1",children:e.description}),l(w,{className:"badge p-1 position-absolute m-1 bottom-0 end-0 m-2 "+s(),gap:1,children:[t(li,{className:"fa-icon"}),e.userCount]})]})]})})})})]})},Tc=a=>{const{roomData:e=null,children:n=null,thumbnail:r=!1,...o}=a,{setDoorData:s=null}=Ln(),c=()=>{const m=100*(e.userCount/e.maxUserCount);let h="bg-primary";return m>=92?h="bg-danger":m>=50?h="bg-warning":m>0&&(h="bg-success"),h},u=m=>{if(e.ownerId!==H().userId){if(e.habboGroupId!==0){En(e.roomId);return}switch(e.doorMode){case rt.DOORBELL_STATE:s(h=>{const g={...h};return g.roomInfo=e,g.state=Pe.START_DOORBELL,g});return;case rt.PASSWORD_STATE:s(h=>{const g={...h};return g.roomInfo=e,g.state=Pe.START_PASSWORD,g});return}}jr(e.roomId)};return r?l(T,{pointer:!0,overflow:"hidden",alignItems:"center",onClick:u,gap:0,className:"navigator-item p-1 bg-light rounded-3 small mb-1 flex-column border border-muted",...o,children:[l(go,{roomId:e.roomId,customUrl:e.officialRoomPicRef,className:"d-flex flex-column align-items-center justify-content-end mb-1",children:[e.habboGroupId>0&&t(je,{badgeCode:e.groupBadgeCode,isGroup:!0,className:"position-absolute top-0 start-0 m-1"}),l(w,{center:!0,className:"badge p-1 position-absolute m-1 "+c(),gap:1,children:[t(li,{className:"fa-icon"}),e.userCount]}),e.doorMode!==rt.OPEN_STATE&&t("i",{className:"position-absolute end-0 mb-1 me-1 icon icon-navigator-room-"+(e.doorMode===rt.DOORBELL_STATE?"locked":e.doorMode===rt.PASSWORD_STATE?"password":e.doorMode===rt.INVISIBLE_STATE?"invisible":"")})]}),l(w,{className:"w-100",children:[t(S,{truncate:!0,className:"flex-grow-1",children:e.roomName}),t(w,{reverse:!0,alignItems:"center",gap:1,children:t(Nc,{roomData:e})}),n]})]}):l(w,{pointer:!0,overflow:"hidden",alignItems:"center",onClick:u,gap:2,className:"navigator-item px-2 py-1 small",...o,children:[l(w,{center:!0,className:"badge p-1 "+c(),gap:1,children:[t(li,{className:"fa-icon"}),e.userCount]}),t(S,{truncate:!0,grow:!0,children:e.roomName}),l(w,{reverse:!0,alignItems:"center",gap:1,children:[t(Nc,{roomData:e}),e.habboGroupId>0&&t("i",{className:"icon icon-navigator-room-group"}),e.doorMode!==rt.OPEN_STATE&&t("i",{className:"icon icon-navigator-room-"+(e.doorMode===rt.DOORBELL_STATE?"locked":e.doorMode===rt.PASSWORD_STATE?"password":e.doorMode===rt.INVISIBLE_STATE?"invisible":"")})]}),n]})},_R=a=>{const{searchResult:e=null,...n}=a,[r,o]=i.useState(!0),[s,c]=i.useState(0),{topLevelContext:u=null}=Ln(),m=()=>{let _=e.code;return!_||!_.length||d("navigator.searchcode.title."+_)=="navigator.searchcode.title."+_?e.data:_.startsWith("${")?_.slice(2,_.length-1):"navigator.searchcode.title."+_},h=()=>{c(_=>_===dr.LIST?dr.THUMBNAILS:dr.LIST)},g=()=>{e.action==1?M(new Es(e.code,"")):e.action==2&&u&&M(new Es(u.code,""))};i.useEffect(()=>{e&&(o(!e.closed),c(e.mode))},[e]);const f=s>=dr.THUMBNAILS;return l(T,{className:"bg-white rounded border border-muted",gap:0,children:[l(w,{fullWidth:!0,alignItems:"center",justifyContent:"between",className:"px-2 py-1",children:[l(w,{grow:!0,pointer:!0,alignItems:"center",gap:1,onClick:_=>o(E=>!E),children:[r&&t(xm,{className:"text-secondary fa-icon"}),!r&&t(zs,{className:"text-secondary fa-icon"}),t(S,{children:d(m())})]}),l(w,{gap:2,children:[s===dr.LIST&&t(Fm,{className:"text-secondary fa-icon",onClick:h}),s>=dr.THUMBNAILS&&t(Gm,{className:"text-secondary fa-icon",onClick:h}),e.action>0&&e.action===1&&t(Bm,{className:"text-secondary fa-icon",onClick:g}),e.action>0&&e.action!==1&&t(Vm,{className:"text-secondary fa-icon",onClick:g})]})]})," ",r&&t(V,{children:f?t(Ue,{columnCount:3,...n,columnMinWidth:110,columnMinHeight:130,className:"mx-2",children:e.rooms.length>0&&e.rooms.map((_,E)=>t(Tc,{roomData:_,thumbnail:!0},E))}):t(ne,{columnCount:1,className:"navigator-grid",gap:0,children:e.rooms.length>0&&e.rooms.map((_,E)=>t(Tc,{roomData:_},E))})})]})},CR=a=>{const{sendSearch:e=null}=a,[n,r]=i.useState(0),[o,s]=i.useState(""),{topLevelContext:c=null,searchResult:u=null}=Ln(),m=()=>{if(!c)return;let g=ss[n];g||(g=ss[0]);const f=(g.query?g.query+":":"")+o;e(f||"",c.code)},h=g=>{g.key==="Enter"&&m()};return i.useEffect(()=>{if(!u)return;const g=u.data.split(":");let f=null,_="";if(g.length>=2){const[E,...I]=g;f=ss.find(C=>C.query===E),_=I.join(":")}else _=u.data;f||(f=ss[0]),r(ss.findIndex(E=>E===f)),s(_)},[u]),l(w,{fullWidth:!0,gap:1,children:[t(w,{shrink:!0,children:t("select",{className:"form-select form-select-sm",value:n,onChange:g=>r(parseInt(g.target.value)),children:ss.map((g,f)=>t("option",{value:f,children:d("navigator.filter."+g.name)},f))})}),l(w,{fullWidth:!0,gap:1,children:[t("input",{type:"text",className:"form-control form-control-sm",placeholder:d("navigator.filter.input.placeholder"),value:o,onChange:g=>s(g.target.value),onKeyDown:g=>h(g)}),t(L,{variant:"primary",onClick:m,children:t(Di,{className:"fa-icon"})})]})]})},bR=a=>{const[e,n]=i.useState(!1),[r,o]=i.useState(!1),[s,c]=i.useState(!1),[u,m]=i.useState(!1),[h,g]=i.useState(!1),[f,_]=i.useState(!1),[E,I]=i.useState(!0),[C,p]=i.useState(!1),{searchResult:b=null,topLevelContext:N=null,topLevelContexts:v=null,navigatorData:O=null}=Ln(),R=i.useRef(null),y=i.useRef();Ye(qt.CREATED,D=>{n(!1),c(!1)});const F=i.useCallback((D,A)=>{c(!1),M(new Es(A,D)),_(!0)},[]),P=i.useCallback(()=>{if(!r){p(!0);return}if(R.current){F(R.current.value,R.current.code),R.current=null;return}if(b){F(b.data,b.code);return}N&&F("",N.code)},[r,b,N,F]);return i.useEffect(()=>{const D={linkReceived:A=>{const k=A.split("/");if(!(k.length<2))switch(k[1]){case"show":{n(!0),p(!0);return}case"hide":n(!1);return;case"toggle":{if(e){n(!1);return}n(!0),p(!0);return}case"toggle-room-info":m(B=>!B);return;case"toggle-room-link":g(B=>!B);return;case"goto":if(k.length<=2)return;switch(k[2]){case"home":if(O.homeRoomId<=0)return;En(O.homeRoomId);break;default:{const B=parseInt(k[2]);En(B)}}return;case"create":n(!0),c(!0);return;case"search":if(k.length>2){const B=k[2];let G="";k.length>3&&(G=k[3]),R.current={value:G,code:B},n(!0),p(!0)}return}},eventUrlPrefix:"navigator/"};return _t(D),()=>Ct(D)},[e,O]),i.useEffect(()=>{b&&(_(!1),y&&y.current&&(y.current.scrollTop=0))},[b]),i.useEffect(()=>{!e||!r||!C||(P(),p(!1))},[e,r,C,P]),i.useEffect(()=>{r||!N||o(!0)},[r,N]),i.useEffect(()=>{!e||!E||(M(new y_),I(!1))},[e,E]),i.useEffect(()=>{Gs.addCallback($s.OPENROOM,(D,A=!1,k=null)=>M(new O_(D)))},[]),l(V,{children:[e&&l(ae,{uniqueKey:"navigator",className:"nitro-navigator",children:[t(se,{headerText:d(s?"navigator.createroom.title":"navigator.title"),onCloseClick:D=>n(!1)}),l(Ir,{children:[v&&v.length>0&&v.map((D,A)=>t(qn,{isActive:N===D&&!s,onClick:k=>F("",D.code),children:d("navigator.toplevelview."+D.code)},A)),t(qn,{isActive:s,onClick:D=>c(!0),children:t(zs,{className:"fa-icon"})})]}),l(re,{position:"relative",children:[f&&t(U,{fit:!0,position:"absolute",className:"top-0 start-0 z-index-1 bg-muted opacity-0-5"}),!s&&l(V,{children:[t(CR,{sendSearch:F}),t(T,{innerRef:y,overflow:"auto",children:b&&b.results.map((D,A)=>t(_R,{searchResult:D},A))})]}),s&&t(uR,{})]})]}),t(cR,{}),u&&t(dR,{onCloseClick:()=>m(!1)}),h&&t(mR,{onCloseClick:()=>g(!1)}),t(ER,{})]})},SR=/\n\r|\n|\r/mg,NR=a=>{const[e,n]=i.useState(null),[r,o]=i.useState(""),[s,c]=i.useState(null),u=i.useRef(null);return i.useEffect(()=>{const m=async g=>{try{const f=await fetch(g);if(!f)return;const E=(await f.text()).split(SR),I=E.shift().split("|");o(I[0]),c(C=>I[1]&&I[1].split(";").length===2?{width:parseInt(I[1].split(";")[0]),height:parseInt(I[1].split(";")[1])}:null),n(E.join(""))}catch{Eu.error(`Failed to fetch ${g}`)}},h={linkReceived:g=>{const f=g.split("/");f.length<2||(f.shift(),m(K("habbopages.url")+f.join("/")))},eventUrlPrefix:"habbopages/"};return _t(h),()=>Ct(h)},[]),i.useEffect(()=>{const m=h=>{if(!(h.target instanceof HTMLAnchorElement))return;h.preventDefault();const g=h.target.href;!g||!g.length||Xr(g)};return document.addEventListener("click",m),()=>{document.removeEventListener("click",m)}},[]),e?l(ae,{className:"nitropedia",theme:"primary-slim",style:s?{width:s.width,height:s.height}:{},children:[t(se,{headerText:r,onCloseClick:()=>n(null)}),t(re,{children:t(U,{fit:!0,innerRef:u,className:"text-black",dangerouslySetInnerHTML:{__html:e}})})]}):null},TR=a=>{const{offer:e=null,setOpen:n=null}=a;if(e)return l(Zi,{fadesOut:!1,onClose:null,onClick:r=>n(!0),gap:2,children:[t(U,{className:"nitro-targeted-offer-icon",style:{backgroundImage:`url(${K("image.library.url")+e.iconImageUrl})`}}),t(S,{variant:"light",className:"ubuntu-bold",children:e.title})]})},vR=a=>{const{offer:e=null,setOpen:n=null}=a,{getCurrencyAmount:r}=ts(),[o,s]=i.useState(1),c=i.useMemo(()=>{let h=!1,g=!1,f=!1;return e.priceInCredits>0&&(h=r(-1)>=e.priceInCredits),e.priceInActivityPoints>0?g=r(e.activityPointType)>=e.priceInActivityPoints:g=!0,e.purchaseLimit>0&&(f=!0),h&&g&&f},[e,r]),u=()=>{let h=Math.max(0,(e.expirationTime-Date.now())/1e3);return Hn.format(h)},m=()=>{M(new A_(e.id,o)),M(new ju)};if(e)return l(ae,{theme:"primary-slim",uniqueKey:"targeted-offer",className:"nitro-targeted-offer",children:[t(se,{headerText:d(e.title),onCloseClick:h=>n(!1)}),t(wd,{position:"relative",className:"justify-content-center align-items-center cursor-pointer",variant:"danger",gap:3,children:d("targeted.offer.timeleft",["timeleft"],[u()])}),l(re,{gap:1,children:[l(w,{gap:1,fullHeight:!0,children:[l(w,{gap:1,column:!0,className:"w-75 text-black",children:[l(T,{className:"bg-warning p-2",fullHeight:!0,children:[t("h4",{children:d(e.title)}),t(U,{dangerouslySetInnerHTML:{__html:e.description}})]}),l(w,{alignSelf:"center",alignItems:"center",justifyContent:"center",gap:2,children:[e.purchaseLimit>1&&l(w,{gap:1,children:[t(S,{variant:"muted",children:d("catalog.bundlewidget.quantity")}),t("input",{type:"number",value:o,onChange:h=>s(parseInt(h.target.value)),min:1,max:e.purchaseLimit})]}),t(L,{variant:"primary",disabled:!c,onClick:()=>m(),children:d("targeted.offer.button.buy")})]})]}),t(U,{className:"w-50",fullHeight:!0,style:{background:`url(${K("image.library.url")+e.imageUrl}) no-repeat center`}})]}),l(w,{className:"price-ray position-absolute",alignItems:"center",justifyContent:"center",column:!0,children:[t(S,{children:d("targeted.offer.price.label")}),e.priceInCredits>0&&l(w,{gap:1,children:[t(S,{variant:"light",children:e.priceInCredits}),t(lt,{type:-1})]}),e.priceInActivityPoints>0&&l(w,{gap:1,children:[l(S,{className:"ubuntu-bold",variant:"light",children:["+",e.priceInActivityPoints]})," ",t(lt,{type:e.activityPointType})]})]})]})]})},wR=()=>{const[a,e]=i.useState(null),[n,r]=i.useState(!1);if(x(k_,o=>{let s=o.getParser();s&&e(s.data)}),Xd(()=>{M(new ju)}),!!a)return t(V,{children:n?t(vR,{offer:a,setOpen:r}):t(TR,{offer:a,setOpen:r})})},RR=a=>{const[e,n]=i.useState(0),[r,o]=i.useState(null),[s,c]=i.useState(!0),{showConfirm:u=null}=Xe();x(qu,_=>{n(0),o(null)}),x(yu,_=>{n(0),o(null)}),x(vs,_=>{const E=_.getParser();E.roomEnter&&(E.data.habboGroupId>0?(n(E.data.habboGroupId),M(new Fs(E.data.habboGroupId,!1))):(n(0),o(null)))}),x(P_,_=>{const E=_.getParser();!r||E.groupId!==r.id&&E.groupId!==e||(n(0),o(null))}),x(Xs,_=>{const E=_.getParser();E.id===e&&o(E)});const m=()=>{u(d("group.leaveconfirm.desc"),()=>{M(new Fi(r.id,H().userId))},null)},h=r&&r.ownerName===H().userName,g=()=>{if(h)return"group.manage";if(r.type===on.PRIVATE)return"";if(r.membershipType===vt.MEMBER)return"group.leave";if(r.membershipType===vt.NOT_MEMBER&&r.type===on.REGULAR)return"group.join";if(r.membershipType===vt.REQUEST_PENDING)return"group.membershippending";if(r.membershipType===vt.NOT_MEMBER&&r.type===on.EXCLUSIVE)return"group.requestmembership"},f=()=>{if(h)return gd(r.id);if(!(r.type===on.PRIVATE&&r.membershipType===vt.NOT_MEMBER)){if(r.membershipType===vt.MEMBER){m();return}$i(r.id)}};return r?t(U,{className:"nitro-notification-bubble rounded",children:l(T,{children:[l(w,{alignItems:"center",justifyContent:"between",pointer:!0,onClick:_=>c(E=>!E),children:[t(S,{variant:"white",children:d("group.homeroominfo.title")}),s&&t(Mi,{className:"fa-icon"}),!s&&t(Li,{className:"fa-icon"})]}),s&&l(V,{children:[l(w,{pointer:!0,alignItems:"center",gap:2,onClick:_=>ea(r.id),children:[t(U,{className:"group-badge",children:t(je,{badgeCode:r.badge,isGroup:!0})}),t(S,{variant:"white",children:r.title})]}),(r.type!==on.PRIVATE||h)&&t(L,{fullWidth:!0,variant:"success",disabled:r.membershipType===vt.REQUEST_PENDING,onClick:f,children:d(g())})]})]})}):null},yR=a=>{const{title:e="Nitro",onClose:n=null,...r}=a;return t(uo,{title:e,onClose:n,...r,children:l(ne,{children:[t(T,{center:!0,size:5,children:t("object",{data:"https://assets.nitrodev.co/logos/nitro-n-dark.svg",width:"100",height:"100",children:" "})}),l(T,{size:7,children:[l(T,{alignItems:"center",gap:0,children:[t(S,{bold:!0,fontSize:4,children:"Nitro React"}),l(S,{children:["v",md()]})]}),l(T,{alignItems:"center",children:[l(S,{children:[t("b",{children:"Renderer:"})," v",gb()]}),l(T,{fullWidth:!0,gap:1,children:[t(L,{fullWidth:!0,variant:"success",onClick:o=>window.open("https://discord.nitrodev.co"),children:"Discord"}),l(w,{gap:1,children:[t(L,{fullWidth:!0,onClick:o=>window.open("https://git.krews.org/nitro/nitro-react"),children:"Git"}),t(L,{fullWidth:!0,onClick:o=>window.open("https://git.krews.org/nitro/nitro-react/-/issues"),children:"Bug Report"})]})]})]})]})]})})},OR=a=>{const{item:e=null,title:n=a.item&&a.item.title||"",onClose:r=null,...o}=a,[s,c]=i.useState(!1),u=()=>{Xr(e.clickUrl),r()},m=e.alertType===de.DEFAULT;return l(uo,{title:n,onClose:r,...o,type:m?de.DEFAULT:e.alertType,children:[l(w,{fullHeight:!0,overflow:"auto",gap:m||e.imageUrl&&!s?2:0,children:[m&&!e.imageUrl&&t(U,{className:"notification-frank flex-shrink-0"}),e.imageUrl&&!s&&t("img",{src:e.imageUrl,alt:e.title,onError:()=>{c(!0)},className:"align-self-baseline"}),l(U,{classNames:["notification-text overflow-y-auto d-flex flex-column w-100",e.clickUrl&&!m?"justify-content-center":""],children:[e.messages.length>0&&e.messages.map((h,g)=>{const f=h.replace(/\r\n|\r|\n/g,"<br />");return t(U,{dangerouslySetInnerHTML:{__html:f}},g)}),e.clickUrl&&e.clickUrl.length>0&&e.imageUrl&&!s&&l(V,{children:[t("hr",{className:"my-2 w-100"}),t(L,{onClick:u,className:"align-self-center px-3",children:d(e.clickUrlText)})]})]})]}),(!e.imageUrl||e.imageUrl&&s)&&t(V,{children:l(T,{alignItems:"center",center:!0,gap:0,children:[t("hr",{className:"my-2 w-100"}),!e.clickUrl&&t(L,{onClick:r,children:d("generic.close")}),e.clickUrl&&e.clickUrl.length>0&&t(L,{onClick:u,children:d(e.clickUrlText)})]})})]})},AR=a=>{const{item:e=null,title:n=a.item&&a.item.title||"",onClose:r=null,...o}=a,[s,c]=i.useState(""),[u,m]=i.useState([]),h=()=>{Xr(e.clickUrl),r()},g=_=>{let E=JSON.parse(e.messages[0]);m(E.filter(I=>I.includes(_))),c(_)};i.useEffect(()=>{m(JSON.parse(e.messages[0]))},[e]);const f=e.clickUrl&&e.clickUrl.startsWith("event:");return l(uo,{title:n,onClose:r,...o,children:[t(w,{fullWidth:!0,alignItems:"center",position:"relative",children:t("input",{type:"text",className:"form-control form-control-sm",placeholder:d("generic.search"),value:s,onChange:_=>g(_.target.value)})}),t(T,{fullHeight:!0,className:"py-1",overflow:"hidden",children:t(Ue,{gap:1,columnCount:1,children:u&&u.map((_,E)=>t("span",{children:_},E))})}),t("hr",{className:"my-2"}),l(T,{alignItems:"center",center:!0,gap:1,children:[!f&&!e.clickUrl&&t(L,{onClick:r,children:d("generic.close")}),e.clickUrl&&e.clickUrl.length>0&&t(L,{onClick:h,children:d(e.clickUrlText)})]})]})},kR=(a,e)=>{if(!a)return null;const n={key:a.id,item:a,onClose:e};switch(a.alertType){case de.NITRO:return t(yR,{...n});case de.SEARCH:return t(AR,{...n});default:return t(OR,{...n})}},PR=a=>{const{item:e=null,onClose:n=null,...r}=a;return l(Zi,{fadesOut:!1,className:"flex-column club-gift",onClose:n,...r,children:[l("div",{className:"d-flex align-items-center gap-2 mb-2",children:[t(lt,{type:"hc",className:"flex-shrink-0"}),t("span",{className:"ms-1",children:d("notifications.text.club_gift")})]}),l("div",{className:"d-flex align-items-center justify-content-end gap-2",children:[t("button",{type:"button",className:"btn btn-success w-100 btn-sm",onClick:()=>Xr(e.linkUrl),children:d("notifications.button.show_gift_list")}),t("span",{className:"text-decoration-underline cursor-pointer text-nowrap",onClick:n,children:d("notifications.button.later")})]})]})},DR=a=>{const{item:e=null,onClose:n=null,...r}=a,o=e.message.replace(/\r\n|\r|\n/g,"<br />");return l(Zi,{onClose:n,gap:2,alignItems:"center",onClick:s=>e.linkUrl&&e.linkUrl.length&&Xr(e.linkUrl),...r,children:[t(w,{center:!0,className:"bubble-image-container",children:e.iconUrl&&e.iconUrl.length&&t("img",{className:"no-select",src:e.iconUrl,alt:""})}),t(S,{wrap:!0,variant:"white",dangerouslySetInnerHTML:{__html:o}})]})},MR=(a,e)=>{if(!a)return null;const n={key:a.id,item:a,onClose:e};switch(a.notificationType){case $e.CLUBGIFT:return t(PR,{...n});default:return t(DR,{...n})}},LR=a=>{const{item:e=null,onClose:n=null,...r}=a,{message:o=null,onConfirm:s=null,onCancel:c=null,confirmText:u=null,cancelText:m=null,title:h=null}=e,g=()=>{s&&s(),n()},f=()=>{c&&c(),n()};return l(uo,{title:h,onClose:n,...r,type:de.ALERT,children:[t(w,{grow:!0,center:!0,children:t(S,{children:o})}),l(w,{gap:1,children:[t(L,{fullWidth:!0,variant:"danger",onClick:f,children:m}),t(L,{fullWidth:!0,onClick:g,children:u})]})]})},UR=(a,e)=>{if(!a)return null;const n={key:a.id,item:a,onClose:e};switch(a.confirmType){default:return t(LR,{...n})}},xR=a=>{const{alerts:e=[],bubbleAlerts:n=[],confirms:r=[],closeAlert:o=null,closeBubbleAlert:s=null,closeConfirm:c=null}=Xe(),u=i.useMemo(()=>{if(!e||!e.length)return null;const g=[];for(const f of e){const _=kR(f,()=>o(f));g.push(_)}return g},[e,o]),m=i.useMemo(()=>{if(!n||!n.length)return null;const g=[];for(const f of n){const _=MR(f,()=>s(f));if(f.notificationType===$e.CLUBGIFT){g.unshift(_);continue}g.push(_)}return g},[n,s]),h=i.useMemo(()=>{if(!r||!r.length)return null;const g=[];for(const f of r){const _=UR(f,()=>c(f));g.push(_)}return g},[r,c]);return l(V,{children:[t(T,{gap:1,children:m}),h,u]})},vc=a=>{const{type:e=-1,amount:n=-1,short:r=!1}=a,o=i.useMemo(()=>l(w,{justifyContent:"end",pointer:!0,gap:1,className:"nitro-purse-button rounded",children:[t(S,{truncate:!0,textEnd:!0,variant:"white",grow:!0,children:r?BC(n):za(n)}),t(lt,{type:e})]}),[n,r,e]);return r?t(mu,{placement:"left",overlay:t(Hm,{id:`tooltip-${e}`,children:za(n)}),children:o}):o},FR=a=>{const{type:e=-1,amount:n=-1}=a;return l(w,{fullWidth:!0,justifyContent:"between",className:"nitro-purse-seasonal-currency p-2 rounded",children:[t(S,{variant:"white",children:d(`purse.seasonal.currency.${e}`)}),l(w,{gap:1,children:[t(S,{variant:"white",children:za(n)}),t(lt,{type:e})]})]})},GR=a=>{const{purse:e=null,hcDisabled:n=!1}=ts(),r=i.useMemo(()=>K("system.currency.types",[]),[]),o=i.useMemo(()=>K("currency.display.number.short",!1),[]),s=(()=>{if(!e)return null;const u=e.clubPeriods*31+e.clubDays,m=e.minutesUntilExpiration;return e.clubLevel===un.NO_CLUB?d("purse.clubdays.zero.amount.text"):m>-1&&m<60*24?Hn.shortFormat(m*60):Hn.shortFormat(u*86400)})(),c=(u,m=-1,h=!1)=>{if(!e||!e.activityPoints||!e.activityPoints.size)return null;const g=Array.from(e.activityPoints.keys()).filter(E=>r.indexOf(E)>=0);let f=0;for(;f<u;)g.shift(),f++;f=0;const _=[];for(const E of g){if(m>-1&&f===m)break;h?_.push(t(FR,{type:E,amount:e.activityPoints.get(E)},E)):_.push(t(vc,{type:E,amount:e.activityPoints.get(E),short:o},E)),f++}return _};return e?l(T,{alignItems:"end",className:"nitro-purse-container",gap:1,children:[t(w,{className:"nitro-purse rounded-bottom p-1",children:l(ne,{fullWidth:!0,gap:1,children:[l(T,{justifyContent:"center",size:n?10:6,gap:0,children:[t(vc,{type:-1,amount:e.credits,short:o}),c(0,2)]}),!n&&l(T,{center:!0,pointer:!0,size:4,gap:1,className:"nitro-purse-subscription rounded",onClick:u=>ee("habboUI/open/hccenter"),children:[t(lt,{type:"hc"}),t(S,{variant:"white",children:s})]}),l(T,{justifyContent:"center",size:2,gap:0,children:[t(w,{center:!0,pointer:!0,fullHeight:!0,className:"nitro-purse-button p-1 rounded",onClick:u=>ee("help/show"),children:t("i",{className:"icon icon-help"})}),t(w,{center:!0,pointer:!0,fullHeight:!0,className:"nitro-purse-button p-1 rounded",onClick:u=>ee("user-settings/toggle"),children:t("i",{className:"icon icon-cog"})})]})]})}),c(2,-1,!0)]}):null},BR={purple:9452386,blue:3891856,green:6459451,yellow:10658089,lilac:6897548,orange:10841125,turquoise:2661026,red:10104881},VR=a=>{const[e,n]=i.useState(!0),[r,o]=i.useState(""),[s,c]=i.useState("");$b(D_.MYSTERY_BOX_KEYS_UPDATE,m=>{o(m.keyColor),c(m.boxColor)});const u=m=>{const h=BR[m];return Qt.int2rgb(h)};return r===""&&s===""?null:t(U,{className:"nitro-notification-bubble rounded mysterybox-extension",children:l(T,{children:[l(w,{alignItems:"center",justifyContent:"between",pointer:!0,onClick:m=>n(h=>!h),children:[t(S,{variant:"white",children:d("mysterybox.tracker.title")}),e&&t(Mi,{className:"fa-icon"}),!e&&t(Li,{className:"fa-icon"})]}),e&&l(V,{children:[t(S,{variant:"white",children:d("mysterybox.tracker.description")}),l(w,{justifyContent:"center",alignItems:"center",gap:2,children:[t(be,{className:"mysterybox-container",children:t("div",{className:"box-image flex-shrink-0",style:{backgroundColor:u(s)},children:t("div",{className:"chain-overlay-image"})})}),t(be,{className:"mysterybox-container",children:t("div",{className:"key-image flex-shrink-0",style:{backgroundColor:u(r)},children:t("div",{className:"key-overlay-image"})})})]})]})]})})},HR=a=>{const{eventId:e=-1,eventName:n="",eventDescription:r="",setIsEditingPromote:o=null}=a,[s,c]=i.useState(n),[u,m]=i.useState(r),h=()=>{M(new M_(e,s,u)),o(!1)};return l(ae,{className:"nitro-guide-tool",theme:"primary-slim",children:[t(se,{headerText:d("navigator.eventsettings.editcaption"),onCloseClick:()=>o(!1)}),l(re,{className:"text-black",children:[l(T,{children:[t(S,{bold:!0,children:d("navigator.eventsettings.name")}),t("input",{type:"text",className:"form-control form-control-sm",placeholder:d("navigator.eventsettings.name"),maxLength:64,value:s,onChange:g=>c(g.target.value)})]}),l(T,{children:[t(S,{bold:!0,children:d("navigator.eventsettings.desc")}),t("textarea",{className:"form-control form-control-sm",placeholder:d("navigator.eventsettings.desc"),maxLength:64,value:u,onChange:g=>m(g.target.value)})]}),t(T,{children:t(L,{fullWidth:!0,disabled:!s||!u,variant:!s||!u?"danger":"success",onClick:g=>h(),children:d("navigator.eventsettings.edit")})})]})]})},WR=a=>{const{eventDescription:e="",setIsEditingPromote:n=null}=a,{setIsExtended:r}=sl(),o=()=>{r(!0),ee("catalog/open/room_event")};return l(V,{children:[t(w,{alignItems:"center",gap:2,style:{overflowWrap:"anywhere"},children:t(S,{variant:"white",children:e})}),t("br",{}),t("br",{}),l(ne,{className:"d-flex align-items-center justify-content-end gap-2",children:[t(L,{className:"btn btn-primary w-100 btn-sm",onClick:s=>n(!0),children:d("navigator.roominfo.editevent")}),t(L,{className:"btn btn-success w-100 btn-sm",onClick:s=>o(),children:d("roomad.extend.event")})]})]})},jR=a=>{const{eventDescription:e=""}=a;return l(V,{children:[t(w,{alignItems:"center",gap:2,style:{overflowWrap:"anywhere"},children:t(S,{variant:"white",children:e})}),t("br",{}),t("br",{}),t(T,{alignItems:"center",gap:1,children:l(U,{fullWidth:!0,overflow:"hidden",position:"relative",className:"bg-light-dark rounded",children:[t(w,{fit:!0,center:!0,position:"absolute",children:t(S,{variant:"white",center:!0,children:d("navigator.eventinprogress")})}),t(S,{children:" "})]})})]})},qR=a=>{const[e,n]=i.useState(!1),[r,o]=i.useState(!0),{promoteInformation:s,setPromoteInformation:c}=sl();return x(qu,u=>{c(null)}),s?t(V,{children:s.data.adId!==-1&&t(U,{className:"nitro-notification-bubble rounded",children:l(T,{children:[l(w,{alignItems:"center",justifyContent:"between",pointer:!0,onClick:u=>o(m=>!m),children:[t(S,{variant:"white",overflow:"hidden",children:s.data.eventName}),r&&t(Mi,{className:"fa-icon"}),!r&&t(Li,{className:"fa-icon"})]}),r&&H().userId!==s.data.ownerAvatarId&&t(jR,{eventDescription:s.data.eventDescription}),r&&H().userId===s.data.ownerAvatarId&&t(WR,{eventDescription:s.data.eventDescription,setIsEditingPromote:()=>n(!0)}),e&&t(HR,{eventId:s.data.adId,eventName:s.data.eventName,eventDescription:s.data.eventDescription,setIsEditingPromote:()=>n(!1)})]})})}):null},YR=a=>t("div",{className:"nitro-right-side",children:l(T,{position:"relative",gap:1,children:[t(GR,{}),t(RR,{}),t(VR,{}),t(wR,{}),t(qR,{}),t(xR,{})]})}),zR=a=>t("div",{className:"room-spectator"}),$R=a=>{const[e,n]=i.useState(null),[r,o]=i.useState(null),{chatStyleId:s=0}=_r(),{roomSession:c=null}=Ge();x(L_,m=>{const h=m.getParser();if(!h)return;const g=c.userDataManager.getPetData(h.petId);g&&(n(g),o(h))});const u=(m,h)=>{!m||!h||c==null||c.sendChatMessage(`${m} ${h}`,s)};return!e||!r?null:l(ae,{uniqueKey:"user-settings",className:"user-settings-window no-resize",theme:"primary-slim",children:[t(se,{headerText:d("widgets.pet.commands.title"),onCloseClick:()=>o(null)}),l(re,{className:"text-black",children:[t(w,{alignItems:"center",justifyContent:"center",gap:2,children:l(ne,{columnCount:2,children:[t(T,{fullWidth:!0,overflow:"hidden",className:"body-image pet p-1",children:t(Zn,{figure:e.figure,posture:"std",direction:2})}),t(S,{variant:"black",small:!0,wrap:!0,children:e.name})]})}),t(ne,{columnCount:2,children:r.commands&&r.commands.length>0&&r.commands.map((m,h)=>t(L,{disabled:!r.enabledCommands.includes(m),onClick:()=>u(e.name,d(`pet.command.${m}`)),children:d(`pet.command.${m}`)},h))})]})]})},$t=a=>{const{justifyContent:e="center",alignItems:n="center",classNames:r=[],...o}=a,s=i.useMemo(()=>{const c=["menu-header","p-1"];return r.length&&c.push(...r),c},[r]);return t(w,{justifyContent:e,alignItems:n,classNames:s,...o})},KR=a=>{const{chatEvent:e=null,onClose:n=null}=a,[r,o]=i.useState(e.chat==="${bot.skill.chatter.configuration.text.placeholder}"?"":e.chat),[s,c]=i.useState(e.automaticChat),[u,m]=i.useState(e.mixSentences),[h,g]=i.useState(e.chatDelay),f=i.useMemo(()=>Hi(Oe().roomId,e.objectId,e.category,1),[e]),_=I=>I.replace(/;#;/g," ").replace(/\r\n|\r|\n/g,"\r"),E=()=>{const I=_(r)+";#;"+s+";#;"+h+";#;"+u;M(new lr(e.botId,Ne.SETUP_CHAT,I)),n()};return t(Ar,{windowPosition:Pt.NOTHING,handleSelector:".drag-handler",dragStyle:{top:f.y,left:f.x},children:l(U,{className:"nitro-context-menu bot-chat",children:[t($t,{className:"drag-handler",children:d("bot.skill.chatter.configuration.title")}),l(T,{className:"p-1",children:[l(T,{gap:1,children:[t(S,{variant:"white",children:d("bot.skill.chatter.configuration.chat.text")}),t("textarea",{className:"form-control form-control-sm",placeholder:d("bot.skill.chatter.configuration.text.placeholder"),value:r,rows:7,onChange:I=>o(I.target.value)})]}),l(T,{gap:1,children:[l(w,{gap:1,alignItems:"center",justifyContent:"between",children:[t(S,{fullWidth:!0,variant:"white",children:d("bot.skill.chatter.configuration.automatic.chat")}),t("input",{type:"checkbox",className:"form-check-input",checked:s,onChange:I=>c(I.target.checked)})]}),l(w,{gap:1,alignItems:"center",justifyContent:"between",children:[t(S,{fullWidth:!0,variant:"white",children:d("bot.skill.chatter.configuration.markov")}),t("input",{type:"checkbox",className:"form-check-input",checked:u,onChange:I=>m(I.target.checked)})]}),l(w,{gap:1,alignItems:"center",justifyContent:"between",children:[t(S,{fullWidth:!0,variant:"white",children:d("bot.skill.chatter.configuration.chat.delay")}),t("input",{type:"number",className:"form-control form-control-sm",value:h,onChange:I=>g(I.target.valueAsNumber)})]})]}),l(w,{alignItems:"center",justifyContent:"between",gap:1,children:[t(L,{fullWidth:!0,variant:"primary",onClick:n,children:d("cancel")}),t(L,{fullWidth:!0,variant:"success",onClick:E,children:d("save")})]})]})]})})},wc=-1,Rc=0,yc=1,Oc=2,Ac=3,kc=4,Pc=5,Dc=6,XR=a=>{const{item:e=null,onClose:n=null}=a,[r,o]=i.useState(wc),[s,c]=i.useState(null),[u,m]=i.useState(null),{roomSession:h=null}=Ge(),g=()=>{s&&q().selectRoomObject(h.roomId,s.roomIndex,Q.UNIT)},f=()=>{h.usePetProduct(e.requestRoomObjectId,s.webID),n()},_=i.useMemo(()=>{if(!s||!u)return null;const E=new Is(s.figure),I=u.customParams.split(" "),C=parseInt(I[0]);switch(u.specialType){case Z.PET_SHAMPOO:{if(I.length<2)return null;const p=q().getPetColorResult(C,E.paletteId),b=q().getPetColorResultsForTag(C,I[1]);let N=-1;for(const v of b)if(v.breed===p.breed){N=parseInt(v.id);break}return t(Zn,{typeId:E.typeId,paletteId:N,petColor:E.color,customParts:E.customParts,direction:2})}case Z.PET_CUSTOM_PART:{if(I.length<4)return null;const p=[],b=I[1].split(",").map(R=>parseInt(R)),N=I[2].split(",").map(R=>parseInt(R)),v=I[3].split(",").map(R=>parseInt(R));let O=0;for(;O<b.length;){const R=b[O],y=E.getCustomPart(R);let F=v[O];y!=null&&(F=y.paletteId),p.push(new Uo(R,N[O],F)),O++}return t(Zn,{typeId:E.typeId,paletteId:E.paletteId,petColor:E.color,customParts:p,direction:2})}case Z.PET_CUSTOM_PART_SHAMPOO:{if(I.length<3)return null;const p=[],b=I[1].split(",").map(O=>parseInt(O)),N=I[2].split(",").map(O=>parseInt(O));let v=0;for(;v<b.length;){const O=b[v],R=E.getCustomPart(O);let y=-1;R!=null&&(y=R.partId),p.push(new Uo(b[v],y,N[v])),v++}return t(Zn,{typeId:E.typeId,paletteId:E.paletteId,petColor:E.color,customParts:p,direction:2})}case Z.PET_SADDLE:{if(I.length<4)return null;const p=[],b=I[1].split(",").map(R=>parseInt(R)),N=I[2].split(",").map(R=>parseInt(R)),v=I[3].split(",").map(R=>parseInt(R));let O=0;for(;O<b.length;)p.push(new Uo(b[O],N[O],v[O])),O++;for(const R of E.customParts)b.indexOf(R.layerId)===-1&&p.push(R);return t(Zn,{typeId:E.typeId,paletteId:E.paletteId,petColor:E.color,customParts:p,direction:2})}case Z.MONSTERPLANT_REBREED:case Z.MONSTERPLANT_REVIVAL:case Z.MONSTERPLANT_FERTILIZE:{let p="rip";const b=q().getRoomObject(h.roomId,s.roomIndex,Q.UNIT);if(b&&(p=b.model.getValue(te.FIGURE_POSTURE),p==="rip")){const N=s.petLevel;N<7?p=`grw${N}`:p="std"}return t(Zn,{typeId:E.typeId,paletteId:E.paletteId,petColor:E.color,customParts:E.customParts,posture:p,direction:2})}}},[s,u,h]);return i.useEffect(()=>{const E=h.userDataManager.getUserDataByIndex(e.id);c(E);const I=oo(h.roomId,e.requestRoomObjectId,Q.FLOOR);if(!I)return;m(I);let C=wc;switch(I.specialType){case Z.PET_SHAMPOO:C=Rc;break;case Z.PET_CUSTOM_PART:C=yc;break;case Z.PET_CUSTOM_PART_SHAMPOO:C=Oc;break;case Z.PET_SADDLE:C=Ac;break;case Z.MONSTERPLANT_REVIVAL:C=kc;break;case Z.MONSTERPLANT_REBREED:C=Pc;break;case Z.MONSTERPLANT_FERTILIZE:C=Dc;break}o(C)},[h,e]),s?l(ae,{className:"nitro-use-product-confirmation",children:[t(se,{headerText:d("useproduct.widget.title",["name"],[s.name]),onCloseClick:n}),t(re,{center:!0,children:l(w,{gap:2,overflow:"hidden",children:[t(T,{children:t(U,{pointer:!0,className:"product-preview",onClick:g,children:_})}),l(T,{justifyContent:"between",overflow:"auto",children:[l(T,{gap:2,children:[r===Rc&&l(V,{children:[t(S,{children:d("useproduct.widget.text.shampoo",["productName"],[u.name])}),t(S,{children:d("useproduct.widget.info.shampoo")})]}),r===yc&&l(V,{children:[t(S,{children:d("useproduct.widget.text.custompart",["productName"],[u.name])}),t(S,{children:d("useproduct.widget.info.custompart")})]}),r===Oc&&l(V,{children:[t(S,{children:d("useproduct.widget.text.custompartshampoo",["productName"],[u.name])}),t(S,{children:d("useproduct.widget.info.custompartshampoo")})]}),r===Ac&&l(V,{children:[t(S,{children:d("useproduct.widget.text.saddle",["productName"],[u.name])}),t(S,{children:d("useproduct.widget.info.saddle")})]}),r===kc&&l(V,{children:[t(S,{children:d("useproduct.widget.text.revive_monsterplant",["productName"],[u.name])}),t(S,{children:d("useproduct.widget.info.revive_monsterplant")})]}),r===Pc&&l(V,{children:[t(S,{children:d("useproduct.widget.text.rebreed_monsterplant",["productName"],[u.name])}),t(S,{children:d("useproduct.widget.info.rebreed_monsterplant")})]}),r===Dc&&l(V,{children:[t(S,{children:d("useproduct.widget.text.fertilize_monsterplant",["productName"],[u.name])}),t(S,{children:d("useproduct.widget.info.fertilize_monsterplant")})]})]}),l(w,{alignItems:"center",justifyContent:"between",children:[t(L,{variant:"danger",onClick:n,children:d("useproduct.widget.cancel")}),t(L,{variant:"success",onClick:f,children:d("useproduct.widget.use")})]})]})]})})]}):null},j=a=>{const{disabled:e=!1,fullWidth:n=!0,justifyContent:r="center",alignItems:o="center",classNames:s=[],onClick:c=null,...u}=a,m=g=>{e||c&&c(g)},h=i.useMemo(()=>{const g=["menu-item","list-item"];return e&&g.push("disabled"),s.length&&g.push(...s),g},[e,s]);return t(w,{fullWidth:n,justifyContent:r,alignItems:o,classNames:h,onClick:m,...u})},QR=a=>{const{justifyContent:e="center",alignItems:n="center",classNames:r=[],collapsed:o=!0,...s}=a,c=i.useMemo(()=>{const u=["menu-footer"];return r.length&&u.push(...r),u},[r]);return l(w,{justifyContent:e,alignItems:n,classNames:c,...s,children:[!o&&t(Ai,{className:"fa-icon align-self-center"}),o&&t(Oi,{className:"fa-icon align-self-center"})]})},JR=25,Mc=3,ZR=5e3,ey=75,is=10;let zo=!1,ka=null,Pa=-1e6,$o=1;const ar=a=>{const{objectId:e=-1,category:n=-1,userType:r=-1,fades:o=!1,onClose:s=null,position:c="absolute",classNames:u=[],style:m={},children:h=null,collapsable:g=!1,...f}=a,[_,E]=i.useState({x:null,y:null}),[I,C]=i.useState(1),[p,b]=i.useState(!1),[N,v]=i.useState(zo),O=i.useRef(),R=i.useCallback(D=>{if(!p)return;$o+=D;let A=(1-$o/ey)*1;if(A<=0)return s(),!1;C(A)},[p,s]),y=i.useCallback((D,A)=>{if(!D||!A||!ka)return;let k=-O.current.offsetHeight;r>-1&&(r===ht.USER||r===ht.BOT||r===ht.RENTABLE_BOT)?k=k+(D.height>50?15:0):k=k-14,ka.addValue(A.y-D.top);let B=ka.getMax();B<Pa-Mc&&(B=Pa-Mc),Pa=B;const G=A.y-B;let z=~~(A.x-O.current.offsetWidth/2),X=~~(G+k);const Y=_e().width-O.current.offsetWidth-is,Ee=_e().height-O.current.offsetHeight-is;z<is?z=is:z>Y&&(z=Y),X<is?X=is:X>Ee&&(X=Ee),E({x:z,y:X})},[r]),F=i.useMemo(()=>{const D=["nitro-context-menu"];return N&&D.push("menu-hidden"),D.push(_.x!==null?"visible":"invisible"),u.length&&D.push(...u),D},[_,u,N]),P=i.useMemo(()=>{let D={};return D.left=_.x||0,D.top=_.y||0,D.opacity=I,Object.keys(m).length&&(D={...D,...m}),D},[_,I,m]);return i.useEffect(()=>{if(!O.current)return;const D=A=>{if(!O.current)return;R(A);const k=Hi(Oe().roomId,e,n),B=td(Oe().roomId,e,n);y(k,B)};return fr().add(D),()=>{fr().remove(D)}},[e,n,R,y]),i.useEffect(()=>{if(!o)return;const D=setTimeout(()=>b(!0),ZR);return()=>clearTimeout(D)},[o]),i.useEffect(()=>{zo=N},[N]),i.useEffect(()=>{ka=new U_(JR),Pa=-1e6,$o=1},[]),l(U,{innerRef:O,position:c,classNames:F,style:P,...f,children:[!(g&&zo)&&h,g&&t(QR,{onClick:()=>v(!N),collapsed:N})]})},Lc=0,Uc=1,xc=2,Fc=3,Gc=4,Bc=5,Vc=6,Hc=7,ty=a=>{const{item:e=null,updateConfirmingProduct:n=null,onClose:r=null}=a,[o,s]=i.useState(0),{roomSession:c=null}=Ge(),u=m=>{if(m)switch(m){case"use_product":case"use_product_shampoo":case"use_product_custom_part":case"use_product_custom_part_shampoo":case"use_product_saddle":case"replace_product_saddle":case"revive_monsterplant":case"rebreed_monsterplant":case"fertilize_monsterplant":n(e);break}};return i.useEffect(()=>{if(!e)return;const m=oo(c.roomId,e.requestRoomObjectId,Q.FLOOR);if(!m)return;let h=Lc;switch(m.specialType){case Z.PET_SHAMPOO:h=Uc;break;case Z.PET_CUSTOM_PART:h=xc;break;case Z.PET_CUSTOM_PART_SHAMPOO:h=Fc;break;case Z.PET_SADDLE:h=Gc;break;case Z.MONSTERPLANT_REVIVAL:h=Bc;break;case Z.MONSTERPLANT_REBREED:h=Vc;break;case Z.MONSTERPLANT_FERTILIZE:h=Hc;break}s(h)},[c,e]),l(ar,{objectId:e.id,category:Q.UNIT,userType:ht.PET,onClose:r,collapsable:!0,children:[t($t,{children:e.name}),o===Lc&&t(j,{onClick:m=>u("use_product"),children:d("infostand.button.useproduct")}),o===Uc&&t(j,{onClick:m=>u("use_product_shampoo"),children:d("infostand.button.useproduct_shampoo")}),o===xc&&t(j,{onClick:m=>u("use_product_custom_part"),children:d("infostand.button.useproduct_custom_part")}),o===Fc&&t(j,{onClick:m=>u("use_product_custom_part_shampoo"),children:d("infostand.button.useproduct_custom_part_shampoo")}),o===Gc&&l(V,{children:[e.replace&&t(j,{onClick:m=>u("replace_product_saddle"),children:d("infostand.button.replaceproduct_saddle")}),!e.replace&&t(j,{onClick:m=>u("use_product_saddle"),children:d("infostand.button.useproduct_saddle")})]}),o===Bc&&t(j,{onClick:m=>u("revive_monsterplant"),children:d("infostand.button.revive_monsterplant")}),o===Vc&&t(j,{onClick:m=>u("rebreed_monsterplant"),children:d("infostand.button.rebreed_monsterplant")}),o===Hc&&t(j,{onClick:m=>u("fertilize_monsterplant"),children:d("infostand.button.fertilize_monsterplant")})]})},ny=a=>{const{avatarInfo:e=null,onClose:n=null}=a;return e?t(T,{className:"nitro-infostand rounded",children:l(T,{overflow:"visible",className:"container-fluid content-area",gap:1,children:[l(T,{gap:1,children:[l(w,{alignItems:"center",justifyContent:"between",gap:1,children:[t(S,{variant:"white",small:!0,wrap:!0,children:e.name}),t(Cn,{className:"cursor-pointer fa-icon",onClick:n})]}),t("hr",{className:"m-0"})]}),l(T,{gap:1,children:[l(w,{gap:1,children:[t(T,{fullWidth:!0,className:"body-image bot",children:t(st,{figure:e.figure,direction:4})}),t(T,{grow:!0,center:!0,gap:0,children:e.badges.length>0&&e.badges.map(r=>t(je,{badgeCode:r,showInfo:!0},r))})]}),t("hr",{className:"m-0"})]}),t(w,{alignItems:"center",className:"bg-light-dark rounded py-1 px-2",children:t(S,{fullWidth:!0,wrap:!0,textBreak:!0,variant:"white",small:!0,className:"motto-content",children:e.motto})}),e.carryItem>0&&l(T,{gap:1,children:[t("hr",{className:"m-0"}),t(S,{variant:"white",small:!0,wrap:!0,children:d("infostand.text.handitem",["item"],[d("handitem"+e.carryItem)])})]})]})}):null},Ko=0,Wc=1,jc=2,ry=a=>{const{avatarInfo:e=null,onClose:n=null}=a,{roomSession:r=null}=Ge(),[o,s]=i.useState(0),[c,u]=i.useState(!1),[m,h]=i.useState(!1),[g,f]=i.useState(!1),[_,E]=i.useState([]),[I,C]=i.useState([]),[p,b]=i.useState([]),[N,v]=i.useState([]),[O,R]=i.useState(!1),[y,F]=i.useState(0),[P,D]=i.useState(0),[A,k]=i.useState(!1),[B,G]=i.useState(!1),[z,X]=i.useState(null),[Y,Ee]=i.useState(!1),[le,De]=i.useState(!1),[Qe,ft]=i.useState(-1),[Ze,Gt]=i.useState(""),[We,Yt]=i.useState("");Hr(Ou.NPE_SONG_CHANGED,me=>{ft(me.id)},Y||le),Hr(F_.SIR_TRAX_SONG_INFO_RECEIVED,me=>{if(me.id!==Qe)return;const Ae=_e().soundManager.musicController.getSongInfo(me.id);Ae&&(Gt(Ae.name),Yt(Ae.creator))},Y||le),i.useEffect(()=>{let me=Ko,Ae=!1,at=!1,en=!1,pe=[],Me=[],Tn=[],Pr=[],tn=!1,ia=0,Rs=0,Dr=!1,Mr=!1,ns=!1,ys=!1,br=-1;const Lr=e.roomControllerLevel>=tt.GUEST;if((Lr||e.isOwner||e.isRoomOwner||e.isAnyRoomController)&&(Ae=!0,at=!e.isWallItem,e.roomControllerLevel>=tt.MODERATOR&&(Dr=!0)),e.isAnyRoomController&&(Mr=!0),(e.usagePolicy===Pl.EVERYBODY||e.usagePolicy===Pl.CONTROLLER&&Lr||e.extraParam===cr.JUKEBOX&&Lr||e.extraParam===cr.USABLE_PRODUCT&&Lr)&&(en=!0),e.extraParam){if(e.extraParam===cr.CRACKABLE_FURNI){const Bt=e.stuffData;en=!0,tn=!0,ia=Bt.hits,Rs=Bt.target}else if(e.extraParam===cr.JUKEBOX){const Bt=_e().soundManager.musicController.getRoomItemPlaylist();Bt&&(br=Bt.nowPlayingSongId),ns=!0}else e.extraParam.indexOf(cr.SONGDISK)===0&&(br=parseInt(e.extraParam.substr(cr.SONGDISK.length)),ys=!0);if(Dr){const Bt=e.extraParam.substr(cr.BRANDING_OPTIONS.length);if(Bt){const zn=Bt.split("	");for(const rs of zn){const $n=rs.split("=");$n&&$n.length===2&&(pe.push($n[0]),Me.push($n[1]))}}}}if(Dr){const Bt=q().getRoomObject(r.roomId,e.id,e.isWallItem?Q.WALL:Q.FLOOR);if(Bt){const zn=Bt.model.getValue(te.FURNITURE_CUSTOM_VARIABLES),rs=Bt.model.getValue(te.FURNITURE_DATA);if(zn&&zn.length)for(const $n of zn)Tn.push($n),Pr.push(rs[$n]||"")}}e.isOwner||e.isAnyRoomController?me=jc:(e.isRoomOwner||e.roomControllerLevel>=tt.GUILD_ADMIN)&&(me=Wc),e.isStickie&&(me=Ko),s(me),u(Ae),h(at),f(en),E(pe),C(Me),b(Tn),v(Pr),R(tn),F(ia),D(Rs),k(Dr),G(Mr),X(null),Ee(ns),De(ys),ft(br),e.groupId&&M(new Fs(e.groupId,!1))},[r,e]),x(Xs,me=>{const Ae=me.getParser();!e||e.groupId!==Ae.id||Ae.flag||(z&&X(null),X(Ae.title))}),i.useEffect(()=>{const me=_e().soundManager.musicController.getSongInfo(Qe);Gt((me==null?void 0:me.name)??""),Yt((me==null?void 0:me.creator)??"")},[Qe]);const Nn=i.useCallback((me,Ae)=>{const at=Array.from(I);at[me]=Ae,C(at)},[I]),Fe=i.useCallback((me,Ae)=>{const at=Array.from(N);at[me]=Ae,v(at)},[N]),Ie=i.useCallback(()=>{if(_.length===0||I.length===0)return"";let me="",Ae=0;for(;Ae<_.length;){const at=_[Ae],en=I[Ae];me=me+(at+"="+en+"	"),Ae++}return me},[_,I]),ze=i.useCallback(me=>{if(!(!me||me===""))switch(me){case"buy_one":ee(`catalog/open/offerId/${e.purchaseOfferId}`);return;case"move":q().processRoomObjectOperation(e.id,e.category,Gn.OBJECT_MOVE);break;case"rotate":q().processRoomObjectOperation(e.id,e.category,Gn.OBJECT_ROTATE_POSITIVE);break;case"pickup":o===jc?q().processRoomObjectOperation(e.id,e.category,Gn.OBJECT_PICKUP):q().processRoomObjectOperation(e.id,e.category,Gn.OBJECT_EJECT);break;case"use":q().useRoomObject(e.id,e.category);break;case"save_branding_configuration":{const Ae=new Map,at=Ie().split("	");if(at)for(const en of at){const[pe,Me]=en.split("=",2);Ae.set(pe,Me)}q().modifyRoomObjectDataWithMap(e.id,e.category,Gn.OBJECT_SAVE_STUFF_DATA,Ae);break}case"save_custom_variables":{const Ae=new Map;for(let at=0;at<p.length;at++){const en=p[at],pe=N[at];en&&en.length&&pe&&pe.length&&Ae.set(en,pe)}M(new x_(e.id,Ae));break}}},[e,o,p,N,Ie]),Ot=i.useCallback(()=>{const me=e.stuffData;return!me||!(me instanceof Ks)?null:me.getValue(2)},[e]);return e?l(T,{gap:1,alignItems:"end",children:[t(T,{className:"nitro-infostand rounded",children:l(T,{overflow:"visible",className:"container-fluid content-area",gap:1,children:[l(T,{gap:1,children:[l(w,{alignItems:"center",justifyContent:"between",gap:1,children:[t(S,{variant:"white",small:!0,wrap:!0,children:e.name}),t(Cn,{className:"cursor-pointer fa-icon",onClick:n})]}),t("hr",{className:"m-0"})]}),l(T,{gap:1,children:[l(w,{position:"relative",gap:1,children:[e.stuffData.isUnique&&t("div",{className:"position-absolute end-0",children:t(Od,{uniqueNumber:e.stuffData.uniqueNumber,uniqueSeries:e.stuffData.uniqueSeries})}),e.stuffData.rarityLevel>-1&&t("div",{className:"position-absolute end-0",children:t(tl,{level:e.stuffData.rarityLevel})}),e.image&&e.image.src.length&&t("img",{className:"d-block mx-auto",src:e.image.src,alt:""})]}),t("hr",{className:"m-0"})]}),l(T,{gap:1,children:[t(S,{fullWidth:!0,wrap:!0,textBreak:!0,variant:"white",small:!0,children:e.description}),t("hr",{className:"m-0"})]}),l(T,{gap:1,children:[l(w,{alignItems:"center",gap:1,children:[t(_n,{userId:e.ownerId}),t(S,{variant:"white",small:!0,wrap:!0,children:d("furni.owner",["name"],[e.ownerName])})]}),e.purchaseOfferId>0&&t(w,{children:t(S,{variant:"white",small:!0,underline:!0,pointer:!0,onClick:me=>ze("buy_one"),children:d("infostand.button.buy")})})]}),(Y||le)&&l(T,{gap:1,children:[t("hr",{className:"m-0"}),Qe===-1&&t(S,{variant:"white",small:!0,wrap:!0,children:d("infostand.jukebox.text.not.playing")}),!!Ze.length&&l(w,{alignItems:"center",gap:1,children:[t(U,{className:"icon disk-icon"}),t(S,{variant:"white",small:!0,wrap:!0,children:Ze})]}),!!We.length&&l(w,{alignItems:"center",gap:1,children:[t(U,{className:"icon disk-creator"}),t(S,{variant:"white",small:!0,wrap:!0,children:We})]})]}),l(T,{gap:1,children:[O&&l(V,{children:[t("hr",{className:"m-0"}),t(S,{variant:"white",small:!0,wrap:!0,children:d("infostand.crackable_furni.hits_remaining",["hits","target"],[y.toString(),P.toString()])})]}),e.groupId>0&&l(V,{children:[t("hr",{className:"m-0"}),l(w,{pointer:!0,alignItems:"center",gap:2,onClick:()=>ea(e.groupId),children:[t(je,{badgeCode:Ot(),isGroup:!0}),t(S,{variant:"white",underline:!0,children:z})]})]}),A&&l(V,{children:[t("hr",{className:"m-0"}),B&&l(S,{small:!0,wrap:!0,variant:"white",children:["ID: ",e.id]}),_.length>0&&l(V,{children:[t("hr",{className:"m-0"}),t(T,{gap:1,children:_.map((me,Ae)=>l(w,{alignItems:"center",gap:1,children:[t(S,{small:!0,wrap:!0,align:"end",variant:"white",className:"col-4",children:me}),t("input",{type:"text",className:"form-control form-control-sm",value:I[Ae],onChange:at=>Nn(Ae,at.target.value)})]},Ae))})]})]}),p.length>0&&l(V,{children:[t("hr",{className:"m-0 my-1"}),t(T,{gap:1,children:p.map((me,Ae)=>l(w,{alignItems:"center",gap:1,children:[t(S,{small:!0,wrap:!0,align:"end",variant:"white",className:"col-4",children:me}),t("input",{type:"text",className:"form-control form-control-sm",value:N[Ae],onChange:at=>Fe(Ae,at.target.value)})]},Ae))})]})]})]})}),l(w,{gap:1,justifyContent:"end",children:[c&&t(L,{variant:"dark",onClick:me=>ze("move"),children:d("infostand.button.move")}),m&&t(L,{variant:"dark",onClick:me=>ze("rotate"),children:d("infostand.button.rotate")}),o!==Ko&&t(L,{variant:"dark",onClick:me=>ze("pickup"),children:d(o===Wc?"infostand.button.eject":"infostand.button.pickup")}),g&&t(L,{variant:"dark",onClick:me=>ze("use"),children:d("infostand.button.use")}),_.length>0&&I.length>0&&_.length===I.length&&t(L,{variant:"dark",onClick:()=>ze("save_branding_configuration"),children:d("save")}),p.length>0&&N.length>0&&p.length===N.length&&t(L,{variant:"dark",onClick:()=>ze("save_custom_variables"),children:d("save")})]})]}):null},sy=a=>{const{avatarInfo:e=null,onClose:n=null}=a,[r,o]=i.useState(0),[s,c]=i.useState(0),{roomSession:u=null}=Ge(),{petRespectRemaining:m=0,respectPet:h=null}=_r();if(i.useEffect(()=>{o(e.remainingGrowTime),c(e.remainingTimeToLive)},[e]),i.useEffect(()=>{if(e.petType!==xt.MONSTERPLANT||e.dead)return;const f=setInterval(()=>{o(_=>_-1),c(_=>_-1)},1e3);return()=>clearInterval(f)},[e]),!e)return null;const g=f=>{let _=!0;if(!(!f||f=="")){switch(f){case"respect":h(e.id),m-1>=1&&(_=!1);break;case"buyfood":ee("catalog/open/"+K("catalog.links")["pets.buy_food"]);break;case"train":u==null||u.requestPetCommands(e.id);break;case"treat":M(new Gi(e.id));break;case"compost":u==null||u.compostPlant(e.id);break;case"pick_up":u==null||u.pickupPet(e.id);break}_&&n()}};return l(T,{gap:1,alignItems:"end",children:[t(T,{className:"nitro-infostand rounded",children:l(T,{overflow:"visible",className:"container-fluid content-area",gap:1,children:[l(T,{gap:1,children:[l(w,{alignItems:"center",justifyContent:"between",gap:1,children:[t(S,{variant:"white",small:!0,wrap:!0,children:e.name}),t(Cn,{className:"cursor-pointer fa-icon",onClick:n})]}),t(S,{variant:"white",small:!0,wrap:!0,children:d(`pet.breed.${e.petType}.${e.petBreed}`)}),t("hr",{className:"m-0"})]}),e.petType===xt.MONSTERPLANT&&l(V,{children:[l(T,{center:!0,gap:1,children:[t(Zn,{figure:e.petFigure,posture:e.posture,direction:4}),t("hr",{className:"m-0"})]}),l(T,{gap:2,children:[!e.dead&&t(T,{alignItems:"center",gap:1,children:t(S,{variant:"white",center:!0,small:!0,wrap:!0,children:d("pet.level",["level","maxlevel"],[e.level.toString(),e.maximumLevel.toString()])})}),l(T,{alignItems:"center",gap:1,children:[t(S,{variant:"white",small:!0,truncate:!0,children:d("infostand.pet.text.wellbeing")}),l(U,{fullWidth:!0,overflow:"hidden",position:"relative",className:"bg-light-dark rounded",children:[t(w,{fit:!0,center:!0,position:"absolute",children:t(S,{variant:"white",small:!0,children:e.dead?"00:00:00":xr(s==0?e.remainingTimeToLive:s).split(":")[1]+":"+xr(s==null||s==null?0:s).split(":")[2]+":"+xr(s==null||s==null?0:s).split(":")[3]})}),t(U,{className:"bg-success rounded pet-stats",style:{width:e.dead?"0":Math.round(e.maximumTimeToLive*100/s).toString()}})]})]}),r!=0&&r>0&&l(T,{alignItems:"center",gap:1,children:[t(S,{variant:"white",small:!0,truncate:!0,children:d("infostand.pet.text.growth")}),t(Gb,{className:"top-2 end-2",day:xr(r).split(":")[0],hour:xr(r).split(":")[1],minutes:xr(r).split(":")[2],seconds:xr(r).split(":")[3]})]}),l(T,{alignItems:"center",gap:1,children:[t(S,{variant:"white",small:!0,truncate:!0,children:d("infostand.pet.text.raritylevel",["level"],[d(`infostand.pet.raritylevel.${e.rarityLevel}`)])}),t(tl,{className:"top-2 end-2",level:e.rarityLevel})]}),t("hr",{className:"m-0"})]}),l(T,{gap:1,children:[t(S,{variant:"white",small:!0,wrap:!0,children:d("pet.age",["age"],[e.age.toString()])}),t("hr",{className:"m-0"})]})]}),e.petType!==xt.MONSTERPLANT&&l(V,{children:[l(T,{gap:1,children:[l(w,{gap:1,children:[t(T,{fullWidth:!0,overflow:"hidden",className:"body-image pet p-1",children:t(Zn,{figure:e.petFigure,posture:e.posture,direction:4})}),l(T,{grow:!0,gap:1,children:[t(S,{variant:"white",center:!0,small:!0,wrap:!0,children:d("pet.level",["level","maxlevel"],[e.level.toString(),e.maximumLevel.toString()])}),l(T,{alignItems:"center",gap:1,children:[t(S,{variant:"white",small:!0,truncate:!0,children:d("infostand.pet.text.happiness")}),l(U,{fullWidth:!0,overflow:"hidden",position:"relative",className:"bg-light-dark rounded",children:[t(w,{fit:!0,center:!0,position:"absolute",children:t(S,{variant:"white",small:!0,children:e.happyness+"/"+e.maximumHappyness})}),t(U,{className:"bg-info rounded pet-stats",style:{width:e.happyness/e.maximumHappyness*100+"%"}})]})]}),l(T,{alignItems:"center",gap:1,children:[t(S,{variant:"white",small:!0,truncate:!0,children:d("infostand.pet.text.experience")}),l(U,{fullWidth:!0,overflow:"hidden",position:"relative",className:"bg-light-dark rounded",children:[t(w,{fit:!0,center:!0,position:"absolute",children:t(S,{variant:"white",small:!0,children:e.experience+"/"+e.levelExperienceGoal})}),t(U,{className:"bg-purple rounded pet-stats",style:{width:e.experience/e.levelExperienceGoal*100+"%"}})]})]}),l(T,{alignItems:"center",gap:1,children:[t(S,{variant:"white",small:!0,truncate:!0,children:d("infostand.pet.text.energy")}),l(U,{fullWidth:!0,overflow:"hidden",position:"relative",className:"bg-light-dark rounded",children:[t(w,{fit:!0,center:!0,position:"absolute",children:t(S,{variant:"white",small:!0,children:e.energy+"/"+e.maximumEnergy})}),t(U,{className:"bg-success rounded pet-stats",style:{width:e.energy/e.maximumEnergy*100+"%"}})]})]})]})]}),t("hr",{className:"m-0"})]}),l(T,{gap:1,children:[e.petType!==xt.MONSTERPLANT&&t(S,{variant:"white",small:!0,wrap:!0,children:d("infostand.text.petrespect",["count"],[e.respect.toString()])}),t(S,{variant:"white",small:!0,wrap:!0,children:d("pet.age",["age"],[e.age.toString()])}),t("hr",{className:"m-0"})]})]}),t(T,{gap:1,children:l(w,{alignItems:"center",gap:1,children:[t(_n,{userId:e.ownerId}),t(S,{variant:"white",small:!0,wrap:!0,children:d("infostand.text.petowner",["name"],[e.ownerName])})]})})]})}),l(w,{gap:1,justifyContent:"end",children:[e.petType!==xt.MONSTERPLANT&&t(L,{variant:"dark",onClick:f=>g("buyfood"),children:d("infostand.button.buyfood")}),e.isOwner&&e.petType!==xt.MONSTERPLANT&&t(L,{variant:"dark",onClick:f=>g("train"),children:d("infostand.button.train")}),!e.dead&&e.energy/e.maximumEnergy<.98&&e.petType===xt.MONSTERPLANT&&t(L,{variant:"dark",onClick:f=>g("treat"),children:d("infostand.button.pettreat")}),(u==null?void 0:u.isRoomOwner)&&e.petType===xt.MONSTERPLANT&&t(L,{variant:"dark",onClick:f=>g("compost"),children:d("infostand.button.compost")}),e.isOwner&&t(L,{variant:"dark",onClick:f=>g("pick_up"),children:d("inventory.pets.pickup")}),m>0&&e.petType!==xt.MONSTERPLANT&&t(L,{variant:"dark",onClick:f=>g("respect"),children:d("infostand.button.petrespect",["count"],[m.toString()])})]})]})},ay=a=>{const{avatarInfo:e=null,onClose:n=null}=a,r=i.useMemo(()=>!(e.botSkills.indexOf(Ne.NO_PICK_UP)>=0||!e.amIOwner&&!e.amIAnyRoomController),[e]),o=()=>M(new Yu(e.webID));if(e)return l(T,{gap:1,children:[t(T,{className:"nitro-infostand rounded",children:l(T,{overflow:"visible",className:"container-fluid content-area",gap:1,children:[l(T,{gap:1,children:[l(w,{alignItems:"center",justifyContent:"between",gap:1,children:[t(S,{variant:"white",small:!0,wrap:!0,children:e.name}),t(Cn,{className:"cursor-pointer fa-icon",onClick:n})]}),t("hr",{className:"m-0"})]}),l(T,{gap:1,children:[l(w,{gap:1,children:[t(T,{fullWidth:!0,className:"body-image bot",children:t(st,{figure:e.figure,direction:4})}),t(T,{grow:!0,center:!0,gap:0,children:e.badges.length>0&&e.badges.map(s=>t(je,{badgeCode:s,showInfo:!0},s))})]}),t("hr",{className:"m-0"})]}),l(T,{gap:1,children:[t(w,{alignItems:"center",className:"bg-light-dark rounded py-1 px-2",children:t(S,{fullWidth:!0,wrap:!0,textBreak:!0,variant:"white",small:!0,className:"motto-content",children:e.motto})}),t("hr",{className:"m-0"})]}),l(T,{gap:1,children:[l(w,{alignItems:"center",gap:1,children:[t(_n,{userId:e.ownerId}),t(S,{variant:"white",small:!0,wrap:!0,children:d("infostand.text.botowner",["name"],[e.ownerName])})]}),e.carryItem>0&&l(V,{children:[t("hr",{className:"m-0"}),t(S,{variant:"white",small:!0,wrap:!0,children:d("infostand.text.handitem",["item"],[d("handitem"+e.carryItem)])})]})]})]})}),r&&t(w,{justifyContent:"end",children:t(L,{variant:"dark",onClick:o,children:d("infostand.button.pickup")})})]})},Xo=a=>{const{type:e=-1,relationship:n=null}=a;if(!n)return null;const r=xn.RELATIONSHIP_NAMES[e].toLocaleLowerCase();return l(w,{alignItems:"center",gap:1,children:[t("i",{className:`nitro-friends-spritesheet icon-${r}`}),t(w,{alignItems:"center",gap:0,children:l(S,{small:!0,variant:"white",onClick:o=>Jt(n.randomFriendId),children:[t("u",{children:n.randomFriendName}),n.friendCount>1&&" "+d(`extendedprofile.relstatus.others.${r}`,["count"],[(n.friendCount-1).toString()])]})})]})},oy=a=>{const{relationships:e=null}=a;return!e||!e.relationshipStatusMap.length?null:l(V,{children:[t(Xo,{type:xn.HEART,relationship:e.relationshipStatusMap.getValue(xn.HEART)}),t(Xo,{type:xn.SMILE,relationship:e.relationshipStatusMap.getValue(xn.SMILE)}),t(Xo,{type:xn.BOBBA,relationship:e.relationshipStatusMap.getValue(xn.BOBBA)})]})},iy=a=>{ee(`navigator/search/${a}`),M(new Es("hotel_view",`tag:${a}`))},ly=a=>{const{tags:e=null}=a;return!e||!e.length?null:l(V,{children:[t("hr",{className:"m-0"}),t(w,{className:"flex-tags",children:e&&e.length>0&&e.map((n,r)=>t(S,{variant:"white",className:"text-tags",onClick:o=>iy(n),children:n},r))})]})},cy=a=>{const{avatarInfo:e=null,setAvatarInfo:n=null,onClose:r=null}=a,[o,s]=i.useState(null),[c,u]=i.useState(!1),[m,h]=i.useState(null),{roomSession:g=null}=Ge(),f=I=>{!c||I.length>K("motto.max.length",38)||(g.sendMottoMessage(I),u(!1))},_=I=>f(I.target.value),E=I=>{switch(I.stopPropagation(),I.key){case"Enter":f(I.target.value);return}};return Ye(G_.RSUBE_BADGES,I=>{!e||e.webID!==I.userId||e.badges.join("")===I.badges.join("")||n(p=>{const b=Kt(p);return b.badges=I.badges,b})}),Ye(B_.USER_FIGURE,I=>{!e||e.roomIndex!==I.roomIndex||n(C=>{const p=Kt(C);return p.figure=I.figure,p.motto=I.customInfo,p.achievementScore=I.activityPoints,p})}),Ye(V_.FAVOURITE_GROUP_UPDATE,I=>{!e||e.roomIndex!==I.roomIndex||n(C=>{const p=Kt(C),b=I.status===-1||I.habboGroupId<=0;return p.groupId=b?-1:I.habboGroupId,p.groupName=b?null:I.habboGroupName,p.groupBadgeId=b?null:H().getGroupBadge(I.habboGroupId),p})}),x(zu,I=>{const C=I.getParser();!e||e.webID!==C.userId||h(C)}),i.useEffect(()=>(u(!1),s(e.motto),M(new $u(e.webID)),()=>{u(!1),s(null),h(null)}),[e]),e?t(T,{className:"nitro-infostand rounded",children:l(T,{overflow:"visible",className:"container-fluid content-area",gap:1,children:[l(T,{gap:1,children:[l(w,{alignItems:"center",justifyContent:"between",children:[l(w,{alignItems:"center",gap:1,children:[t(_n,{userId:e.webID}),t(S,{variant:"white",small:!0,wrap:!0,children:e.name})]}),t(Cn,{className:"cursor-pointer fa-icon",onClick:r})]}),t("hr",{className:"m-0"})]}),l(T,{gap:1,children:[l(w,{gap:1,children:[t(T,{fullWidth:!0,className:"body-image",onClick:I=>Jt(e.webID),children:t(st,{figure:e.figure,direction:4})}),l(T,{grow:!0,alignItems:"center",gap:0,children:[l(w,{gap:1,children:[t(w,{center:!0,className:"badge-image",children:e.badges[0]&&t(je,{badgeCode:e.badges[0],showInfo:!0})}),t(w,{center:!0,pointer:e.groupId>0,className:"badge-image",onClick:I=>ea(e.groupId),children:e.groupId>0&&t(je,{badgeCode:e.groupBadgeId,isGroup:!0,showInfo:!0,customTitle:e.groupName})})]}),l(w,{center:!0,gap:1,children:[t(w,{center:!0,className:"badge-image",children:e.badges[1]&&t(je,{badgeCode:e.badges[1],showInfo:!0})}),t(w,{center:!0,className:"badge-image",children:e.badges[2]&&t(je,{badgeCode:e.badges[2],showInfo:!0})})]}),l(w,{center:!0,gap:1,children:[t(w,{center:!0,className:"badge-image",children:e.badges[3]&&t(je,{badgeCode:e.badges[3],showInfo:!0})}),t(w,{center:!0,className:"badge-image",children:e.badges[4]&&t(je,{badgeCode:e.badges[4],showInfo:!0})})]})]})]}),t("hr",{className:"m-0"})]}),l(T,{gap:1,children:[l(w,{alignItems:"center",className:"bg-light-dark rounded py-1 px-2",children:[e.type!==et.OWN_USER&&t(w,{grow:!0,alignItems:"center",className:"motto-content",children:t(S,{fullWidth:!0,pointer:!0,wrap:!0,textBreak:!0,small:!0,variant:"white",children:o})}),e.type===et.OWN_USER&&l(w,{grow:!0,alignItems:"center",gap:2,children:[t(Wm,{className:"small fa-icon"}),l(w,{grow:!0,alignItems:"center",className:"motto-content",children:[!c&&l(S,{fullWidth:!0,pointer:!0,wrap:!0,textBreak:!0,small:!0,variant:"white",onClick:I=>u(!0),children:[o," "]}),c&&t("input",{type:"text",className:"motto-input",maxLength:K("motto.max.length",38),value:o,onChange:I=>s(I.target.value),onBlur:_,onKeyDown:E,autoFocus:!0})]})]})]}),t("hr",{className:"m-0"})]}),l(T,{gap:1,children:[t(S,{variant:"white",small:!0,wrap:!0,children:d("infostand.text.achievement_score")+" "+e.achievementScore}),e.carryItem>0&&l(V,{children:[t("hr",{className:"m-0"}),t(S,{variant:"white",small:!0,wrap:!0,children:d("infostand.text.handitem",["item"],[d("handitem"+e.carryItem)])})]})]}),t(T,{gap:1,children:t(oy,{relationships:m})}),K("user.tags.enabled")&&t(T,{gap:1,className:"mt-1",children:t(ly,{tags:H().tags})})]})}):null},Da=0,Qo=1,qc=2,Yc=3,Jo=4,zc=5,$c=6,uy=a=>{const{avatarInfo:e=null,onClose:n=null}=a,[r,o]=i.useState(Da),{canRequestFriend:s=null}=gn(),{report:c=null}=Mn(),{roomSession:u=null}=Ge(),{userRespectRemaining:m=0,respectUser:h=null}=_r(),g=i.useMemo(()=>e.amIOwner&&e.targetRoomControllerLevel<tt.GUEST&&!e.isGuildRoom,[e]),f=i.useMemo(()=>e.amIOwner&&e.targetRoomControllerLevel===tt.GUEST&&!e.isGuildRoom,[e]),_=i.useMemo(()=>e.canBeKicked||e.canBeBanned||e.canBeMuted||g||f,[g,f,e]),E=i.useMemo(()=>{let C=!1;const p=Jr();if(p){const b=p.model.getValue(te.FIGURE_CARRY_OBJECT);b>0&&b<999999&&(C=!0)}return C},[]),I=C=>{let p=!0;if(C)switch(C){case"moderate":p=!1,o(Qo);break;case"ban":p=!1,o(qc);break;case"mute":p=!1,o(Yc);break;case"ambassador":p=!1,o(Jo);break;case"ambassador_mute":p=!1,o(zc);break;case"back_moderate":p=!1,o(Qo);break;case"back_ambassador":p=!1,o(Jo);break;case"back":p=!1,o(Da);break;case"whisper":St(new wr(wr.WHISPER,e.name));break;case"friend":ee(`friends/request/${e.webID}/${e.name}`);break;case"relationship":p=!1,o($c);break;case"respect":{h(e.webID),m-1>=1&&(p=!1);break}case"ignore":H().ignoreUser(e.name);break;case"unignore":H().unignoreUser(e.name);break;case"kick":u.sendKickMessage(e.webID);break;case"ban_hour":u.sendBanMessage(e.webID,"RWUAM_BAN_USER_HOUR");break;case"ban_day":u.sendBanMessage(e.webID,"RWUAM_BAN_USER_DAY");break;case"perm_ban":u.sendBanMessage(e.webID,"RWUAM_BAN_USER_PERM");break;case"mute_2min":u.sendMuteMessage(e.webID,2);break;case"mute_5min":u.sendMuteMessage(e.webID,5);break;case"mute_10min":u.sendMuteMessage(e.webID,10);break;case"give_rights":u.sendGiveRightsMessage(e.webID);break;case"remove_rights":u.sendTakeRightsMessage(e.webID);break;case"trade":M(new W_(e.roomIndex));break;case"report":c(Ve.BULLY,{reportedUserId:e.webID});break;case"pass_hand_item":M(new H_(e.webID));break;case"ambassador_alert":u.sendAmbassadorAlertMessage(e.webID);break;case"ambassador_kick":u.sendKickMessage(e.webID);break;case"ambassador_mute_2min":u.sendMuteMessage(e.webID,2);break;case"ambassador_mute_10min":u.sendMuteMessage(e.webID,10);break;case"ambassador_mute_60min":u.sendMuteMessage(e.webID,60);break;case"ambassador_mute_18hour":u.sendMuteMessage(e.webID,1080);break;case"rship_heart":M(new Ps(e.webID,jt.RELATIONSHIP_HEART));break;case"rship_smile":M(new Ps(e.webID,jt.RELATIONSHIP_SMILE));break;case"rship_bobba":M(new Ps(e.webID,jt.RELATIONSHIP_BOBBA));break;case"rship_none":M(new Ps(e.webID,jt.RELATIONSHIP_NONE));break}p&&n()};return i.useEffect(()=>{o(Da)},[e]),l(ar,{objectId:e.roomIndex,category:Q.UNIT,userType:e.userType,onClose:n,collapsable:!0,children:[t($t,{className:"cursor-pointer",onClick:C=>Jt(e.webID),children:e.name}),r===Da&&l(V,{children:[s(e.webID)&&t(j,{onClick:C=>I("friend"),children:d("infostand.button.friend")}),t(j,{onClick:C=>I("trade"),children:d("infostand.button.trade")}),t(j,{onClick:C=>I("whisper"),children:d("infostand.button.whisper")}),m>0&&t(j,{onClick:C=>I("respect"),children:d("infostand.button.respect",["count"],[m.toString()])}),!s(e.webID)&&l(j,{onClick:C=>I("relationship"),children:[d("infostand.link.relationship"),t(an,{className:"right fa-icon"})]}),!e.isIgnored&&t(j,{onClick:C=>I("ignore"),children:d("infostand.button.ignore")}),e.isIgnored&&t(j,{onClick:C=>I("unignore"),children:d("infostand.button.unignore")}),t(j,{onClick:C=>I("report"),children:d("infostand.button.report")}),_&&l(j,{onClick:C=>I("moderate"),children:[t(an,{className:"right fa-icon"}),d("infostand.link.moderate")]}),e.isAmbassador&&l(j,{onClick:C=>I("ambassador"),children:[t(an,{className:"right fa-icon"}),d("infostand.link.ambassador")]}),E&&t(j,{onClick:C=>I("pass_hand_item"),children:d("avatar.widget.pass_hand_item")})]}),r===Qo&&l(V,{children:[t(j,{onClick:C=>I("kick"),children:d("infostand.button.kick")}),l(j,{onClick:C=>I("mute"),children:[t(an,{className:"right fa-icon"}),d("infostand.button.mute")]}),l(j,{onClick:C=>I("ban"),children:[t(an,{className:"right fa-icon"}),d("infostand.button.ban")]}),g&&t(j,{onClick:C=>I("give_rights"),children:d("infostand.button.giverights")}),f&&t(j,{onClick:C=>I("remove_rights"),children:d("infostand.button.removerights")}),l(j,{onClick:C=>I("back"),children:[t(sn,{className:"left fa-icon"}),d("generic.back")]})]}),r===qc&&l(V,{children:[t(j,{onClick:C=>I("ban_hour"),children:d("infostand.button.ban_hour")}),t(j,{onClick:C=>I("ban_day"),children:d("infostand.button.ban_day")}),t(j,{onClick:C=>I("perm_ban"),children:d("infostand.button.perm_ban")}),l(j,{onClick:C=>I("back_moderate"),children:[t(sn,{className:"left fa-icon"}),d("generic.back")]})]}),r===Yc&&l(V,{children:[t(j,{onClick:C=>I("mute_2min"),children:d("infostand.button.mute_2min")}),t(j,{onClick:C=>I("mute_5min"),children:d("infostand.button.mute_5min")}),t(j,{onClick:C=>I("mute_10min"),children:d("infostand.button.mute_10min")}),l(j,{onClick:C=>I("back_moderate"),children:[t(sn,{className:"left fa-icon"}),d("generic.back")]})]}),r===Jo&&l(V,{children:[t(j,{onClick:C=>I("ambassador_alert"),children:d("infostand.button.alert")}),t(j,{onClick:C=>I("ambassador_kick"),children:d("infostand.button.kick")}),l(j,{onClick:C=>I("ambassador_mute"),children:[d("infostand.button.mute"),t(an,{className:"right fa-icon"})]}),l(j,{onClick:C=>I("back"),children:[t(sn,{className:"left fa-icon"}),d("generic.back")]})]}),r===zc&&l(V,{children:[t(j,{onClick:C=>I("ambassador_mute_2min"),children:d("infostand.button.mute_2min")}),t(j,{onClick:C=>I("ambassador_mute_10min"),children:d("infostand.button.mute_10min")}),t(j,{onClick:C=>I("ambassador_mute_60min"),children:d("infostand.button.mute_60min")}),t(j,{onClick:C=>I("ambassador_mute_18hr"),children:d("infostand.button.mute_18hour")}),l(j,{onClick:C=>I("back_ambassador"),children:[t(sn,{className:"left fa-icon"}),d("generic.back")]})]}),r===$c&&l(V,{children:[l(w,{className:"menu-list-split-3",children:[t(j,{onClick:C=>I("rship_heart"),children:t(U,{pointer:!0,className:"nitro-friends-spritesheet icon-heart"})}),t(j,{onClick:C=>I("rship_smile"),children:t(U,{pointer:!0,className:"nitro-friends-spritesheet icon-smile"})}),t(j,{onClick:C=>I("rship_bobba"),children:t(U,{pointer:!0,className:"nitro-friends-spritesheet icon-bobba"})})]}),t(j,{onClick:C=>I("rship_none"),children:d("avatar.widget.clear_relationship")}),l(j,{onClick:C=>I("back"),children:[t(sn,{className:"left fa-icon"}),d("generic.back")]})]})]})},Em=a=>{const{classNames:e=[],...n}=a,r=i.useMemo(()=>{const o=["menu-list"];return e.length&&o.push(...e),o},[e]);return t(T,{classNames:r,...n})},dy=a=>{const{userId:e=-1,userName:n="",roomIndex:r=-1,setIsDecorating:o=null}=a;return t(ar,{objectId:r,category:Q.UNIT,onClose:null,children:t(Em,{children:t(j,{onClick:s=>o(!1),children:d("widget.avatar.stop_decorating")})})})},my=a=>{const{avatarInfo:e=null,onClose:n=null}=a,r=o=>{if(o)switch(o){case"move":ds(e.id,e.category,Gn.OBJECT_MOVE);break;case"rotate":ds(e.id,e.category,Gn.OBJECT_ROTATE_POSITIVE);break;case"pickup":ds(e.id,e.category,Gn.OBJECT_PICKUP);break;case"eject":ds(e.id,e.category,Gn.OBJECT_EJECT);break}};return l(ar,{objectId:e.id,category:e.category,onClose:n,collapsable:!0,children:[t($t,{children:e.name}),l(w,{className:"menu-list-split-3",children:[t(j,{onClick:o=>r("move"),children:t(jm,{className:"center fa-icon"})}),t(j,{onClick:o=>r("rotate"),disabled:e.isWallItem,children:t(qm,{className:"center fa-icon"})}),(e.isOwner||e.isAnyRoomController)&&t(j,{onClick:o=>r("pickup"),children:t(gl,{className:"center fa-icon"})}),!e.isOwner&&!e.isAnyRoomController&&(e.isRoomOwner||e.roomControllerLevel>=tt.GUILD_ADMIN)&&t(j,{onClick:o=>r("eject"),children:t(gl,{className:"center fa-icon"})})]})]})},Kc=a=>{const{nameInfo:e=null,onClose:n=null}=a,r=i.useMemo(()=>{const o=["name-only"];return e.isFriend&&o.push("is-friend"),o},[e]);return t(ar,{objectId:e.roomIndex,category:e.category,userType:e.userType,fades:e.id!==H().userId,classNames:r,onClose:n,children:t("div",{className:"text-shadow",children:e.name})})},Zo=0,ei=1,Xc=3,Qc=4,gy=a=>{const{avatarInfo:e=null,isDancing:n=!1,setIsDecorating:r=null,onClose:o=null}=a,[s,c]=i.useState(n&&qr()?ei:Zo),{roomSession:u=null}=Ge(),m=f=>{let _=!0;if(f)if(f.startsWith("sign_")){const E=parseInt(f.split("_")[1]);u.sendSignMessage(E)}else switch(f){case"decorate":r(!0);break;case"change_name":St(new no(no.INIT));break;case"change_looks":ee("avatar-editor/show");break;case"expressions":_=!1,c(Xc);break;case"sit":u.sendPostureMessage(Xa.POSTURE_SIT);break;case"stand":u.sendPostureMessage(Xa.POSTURE_STAND);break;case"wave":u.sendExpressionMessage(Jn.WAVE.ordinal);break;case"blow":u.sendExpressionMessage(Jn.BLOW.ordinal);break;case"laugh":u.sendExpressionMessage(Jn.LAUGH.ordinal);break;case"idle":u.sendExpressionMessage(Jn.IDLE.ordinal);break;case"dance_menu":_=!1,c(ei);break;case"dance":u.sendDanceMessage(1);break;case"dance_stop":u.sendDanceMessage(0);break;case"dance_1":case"dance_2":case"dance_3":case"dance_4":u.sendDanceMessage(parseInt(f.charAt(f.length-1)));break;case"signs":_=!1,c(Qc);break;case"back":_=!1,c(Zo);break;case"drop_carry_item":M(new j_);break}_&&o()},h=()=>e.amIOwner||e.amIAnyRoomController||e.roomControllerLevel>tt.GUEST,g=MC();return l(ar,{objectId:e.roomIndex,category:Q.UNIT,userType:e.userType,onClose:o,collapsable:!0,children:[t($t,{className:"cursor-pointer",onClick:f=>Jt(e.webID),children:e.name}),s===Zo&&l(V,{children:[e.allowNameChange&&t(j,{onClick:f=>m("change_name"),children:d("widget.avatar.change_name")}),h()&&t(j,{onClick:f=>m("decorate"),children:d("widget.avatar.decorate")}),t(j,{onClick:f=>m("change_looks"),children:d("widget.memenu.myclothes")}),qr()&&!g&&l(j,{onClick:f=>m("dance_menu"),children:[t(an,{className:"right fa-icon"}),d("widget.memenu.dance")]}),!n&&!qr()&&!g&&t(j,{onClick:f=>m("dance"),children:d("widget.memenu.dance")}),n&&!qr()&&!g&&t(j,{onClick:f=>m("dance_stop"),children:d("widget.memenu.dance.stop")}),l(j,{onClick:f=>m("expressions"),children:[t(an,{className:"right fa-icon"}),d("infostand.link.expressions")]}),l(j,{onClick:f=>m("signs"),children:[t(an,{className:"right fa-icon"}),d("infostand.show.signs")]}),e.carryItem>0&&t(j,{onClick:f=>m("drop_carry_item"),children:d("avatar.widget.drop_hand_item")})]}),s===ei&&l(V,{children:[n&&t(j,{onClick:f=>m("dance_stop"),children:d("widget.memenu.dance.stop")}),t(j,{onClick:f=>m("dance_1"),children:d("widget.memenu.dance1")}),t(j,{onClick:f=>m("dance_2"),children:d("widget.memenu.dance2")}),t(j,{onClick:f=>m("dance_3"),children:d("widget.memenu.dance3")}),t(j,{onClick:f=>m("dance_4"),children:d("widget.memenu.dance4")}),l(j,{onClick:f=>m("back"),children:[t(sn,{className:"left fa-icon"}),d("generic.back")]})]}),s===Xc&&l(V,{children:[PC()===gs.POSTURE_STAND&&t(j,{onClick:f=>m("sit"),children:d("widget.memenu.sit")}),CC()&&t(j,{onClick:f=>m("stand"),children:d("widget.memenu.stand")}),Bo()&&t(j,{onClick:f=>m("wave"),children:d("widget.memenu.wave")}),Bo()&&l(j,{disabled:!ba(),onClick:f=>m("laugh"),children:[!ba()&&t(lt,{type:"hc"}),d("widget.memenu.laugh")]}),Bo()&&l(j,{disabled:!ba(),onClick:f=>m("blow"),children:[!ba()&&t(lt,{type:"hc"}),d("widget.memenu.blow")]}),t(j,{onClick:f=>m("idle"),children:d("widget.memenu.idle")}),l(j,{onClick:f=>m("back"),children:[t(sn,{className:"left fa-icon"}),d("generic.back")]})]}),s===Qc&&l(V,{children:[l(w,{className:"menu-list-split-3",children:[t(j,{onClick:f=>m("sign_1"),children:"1"}),t(j,{onClick:f=>m("sign_2"),children:"2"}),t(j,{onClick:f=>m("sign_3"),children:"3"})]}),l(w,{className:"menu-list-split-3",children:[t(j,{onClick:f=>m("sign_4"),children:"4"}),t(j,{onClick:f=>m("sign_5"),children:"5"}),t(j,{onClick:f=>m("sign_6"),children:"6"})]}),l(w,{className:"menu-list-split-3",children:[t(j,{onClick:f=>m("sign_7"),children:"7"}),t(j,{onClick:f=>m("sign_8"),children:"8"}),t(j,{onClick:f=>m("sign_9"),children:"9"})]}),l(w,{className:"menu-list-split-3",children:[t(j,{onClick:f=>m("sign_10"),children:"10"}),t(j,{onClick:f=>m("sign_11"),children:t("i",{className:"icon icon-sign-heart"})}),t(j,{onClick:f=>m("sign_12"),children:t("i",{className:"icon icon-sign-skull"})})]}),l(w,{className:"menu-list-split-3",children:[t(j,{onClick:f=>m("sign_0"),children:"0"}),t(j,{onClick:f=>m("sign_13"),children:t("i",{className:"icon icon-sign-exclamation"})}),t(j,{onClick:f=>m("sign_15"),children:t("i",{className:"icon icon-sign-smile"})})]}),l(w,{className:"menu-list-split-3",children:[t(j,{onClick:f=>m("sign_14"),children:t("i",{className:"icon icon-sign-soccer"})}),t(j,{onClick:f=>m("sign_17"),children:t("i",{className:"icon icon-sign-yellow"})}),t(j,{onClick:f=>m("sign_16"),children:t("i",{className:"icon icon-sign-red"})})]}),l(j,{onClick:f=>m("back"),children:[t(sn,{className:"left fa-icon"}),d("generic.back")]})]})]})},ti=0,Jc=1,Zc=2,eu=3,hy=a=>{const{avatarInfo:e=null,onClose:n=null}=a,[r,o]=i.useState(ti),{roomSession:s=null}=Ge(),{petRespectRemaining:c=0,respectPet:u=null}=_r(),m=i.useMemo(()=>{let g=!1;const f=Jr();if(f){const _=f.model.getValue(te.FIGURE_CARRY_OBJECT);_>0&&_<999999&&(g=!0)}return g},[]),h=g=>{let f=!0;if(g)switch(g){case"respect":u(e.id),c-1>=1&&(f=!1);break;case"treat":M(new Gi(e.id));break;case"pass_handitem":M(new Ku(e.id));break;case"train":s.requestPetCommands(e.id);break;case"pick_up":s.pickupPet(e.id);break;case"mount":s.mountPet(e.id);break;case"toggle_riding_permission":s.togglePetRiding(e.id);break;case"toggle_breeding_permission":s.togglePetBreeding(e.id);break;case"dismount":s.dismountPet(e.id);break;case"saddle_off":s.removePetSaddle(e.id);break;case"breed":break;case"harvest":s.harvestPet(e.id);break;case"revive":break;case"compost":s.compostPlant(e.id);break;case"buy_saddle":ee("catalog/open/"+K("catalog.links")["pets.buy_saddle"]);break}f&&n()};return i.useEffect(()=>{o(g=>e.petType===xt.MONSTERPLANT?eu:e.saddle&&!e.rider?Jc:e.rider?Zc:ti)},[e]),l(ar,{objectId:e.roomIndex,category:Q.UNIT,userType:ht.PET,onClose:n,collapsable:!0,children:[t($t,{children:e.name}),r===ti&&l(V,{children:[c>0&&t(j,{onClick:g=>h("respect"),children:d("infostand.button.petrespect",["count"],[c.toString()])}),t(j,{onClick:g=>h("train"),children:d("infostand.button.train")}),t(j,{onClick:g=>h("pick_up"),children:d("infostand.button.pickup")}),e.petType===xt.HORSE&&t(j,{onClick:g=>h("buy_saddle"),children:d("infostand.button.buy_saddle")}),[xt.BEAR,xt.TERRIER,xt.CAT,xt.DOG,xt.PIG].indexOf(e.petType)>-1&&t(j,{onClick:g=>h("breed"),children:d("infostand.button.breed")})]}),r===Jc&&l(V,{children:[t(j,{onClick:g=>h("mount"),children:d("infostand.button.mount")}),l(j,{onClick:g=>h("toggle_riding_permission"),gap:1,children:[t("input",{type:"checkbox",checked:!!e.publiclyRideable,readOnly:!0}),d("infostand.button.toggle_riding_permission")]}),c>0&&t(j,{onClick:g=>h("respect"),children:d("infostand.button.petrespect",["count"],[c.toString()])}),t(j,{onClick:g=>h("train"),children:d("infostand.button.train")}),t(j,{onClick:g=>h("pick_up"),children:d("infostand.button.pickup")}),t(j,{onClick:g=>h("saddle_off"),children:d("infostand.button.saddleoff")})]}),r===Zc&&l(V,{children:[t(j,{onClick:g=>h("dismount"),children:d("infostand.button.dismount")}),c>0&&t(j,{onClick:g=>h("respect"),children:d("infostand.button.petrespect",["count"],[c.toString()])})]}),r===eu&&l(V,{children:[t(j,{onClick:g=>h("pick_up"),children:d("infostand.button.pickup")}),e.dead&&t(j,{onClick:g=>h("revive"),children:d("infostand.button.revive")}),s.isRoomOwner&&t(j,{onClick:g=>h("compost"),children:d("infostand.button.compost")}),!e.dead&&e.energy/e.maximumEnergy<.98&&t(j,{onClick:g=>h("treat"),children:d("infostand.button.pettreat")}),!e.dead&&e.level===e.maximumLevel&&e.breedable&&l(V,{children:[l(j,{onClick:g=>h("toggle_breeding_permission"),gap:1,children:[t("input",{type:"checkbox",checked:e.publiclyBreedable,readOnly:!0}),d("infostand.button.toggle_breeding_permission")]}),t(j,{onClick:g=>h("breed"),children:d("infostand.button.breed")})]})]}),m&&t(j,{onClick:g=>h("pass_hand_item"),children:d("infostand.button.pass_hand_item")})]})},ni=0,tu=1,nu=2,ru=3,fy=a=>{const{avatarInfo:e=null,onClose:n=null}=a,[r,o]=i.useState(ni),{roomSession:s=null}=Ge(),{petRespectRemaining:c=0,respectPet:u=null}=_r(),m=i.useMemo(()=>s.isRoomOwner||s.controllerLevel>=tt.GUEST||H().isModerator,[s]),h=i.useMemo(()=>{let f=!1;const _=Jr();if(_){const E=_.model.getValue(te.FIGURE_CARRY_OBJECT);E>0&&E<999999&&(f=!0)}return f},[]),g=f=>{let _=!0;if(f)switch(f){case"respect":u(e.id),c-1>=1&&(_=!1);break;case"treat":M(new Gi(e.id));break;case"pass_handitem":M(new Ku(e.id));break;case"pick_up":s.pickupPet(e.id);break;case"mount":s.mountPet(e.id);break;case"dismount":s.dismountPet(e.id);break}_&&n()};return i.useEffect(()=>{o(f=>e.petType===xt.MONSTERPLANT?ru:e.saddle&&!e.rider?tu:e.rider?nu:ni)},[e]),l(ar,{objectId:e.roomIndex,category:Q.UNIT,userType:ht.PET,onClose:n,collapsable:!0,children:[t($t,{children:e.name}),r===ni&&c>0&&t(j,{onClick:f=>g("respect"),children:d("infostand.button.petrespect",["count"],[c.toString()])}),r===tu&&l(V,{children:[!!e.publiclyRideable&&t(j,{onClick:f=>g("mount"),children:d("infostand.button.mount")}),c>0&&t(j,{onClick:f=>g("respect"),children:d("infostand.button.petrespect",["count"],[c.toString()])})]}),r===nu&&l(V,{children:[t(j,{onClick:f=>g("dismount"),children:d("infostand.button.dismount")}),c>0&&t(j,{onClick:f=>g("respect"),children:d("infostand.button.petrespect",["count"],[c.toString()])})]}),r===ru&&!e.dead&&e.energy/e.maximumEnergy<.98&&t(j,{onClick:f=>g("treat"),children:d("infostand.button.pettreat")}),m&&t(j,{onClick:f=>g("pick_up"),children:d("infostand.button.pickup")}),h&&t(j,{onClick:f=>g("pass_hand_item"),children:d("infostand.button.pass_hand_item")})]})},ri=0,su=1,au=2,py=a=>{const{avatarInfo:e=null,onClose:n=null}=a,[r,o]=i.useState(ri),[s,c]=i.useState(""),[u,m]=i.useState("");x(q_,_=>{const E=_.getParser();if(E.botId===e.webID)switch(E.commandId){case Ne.CHANGE_BOT_NAME:c(E.data),o(su);return;case Ne.CHANGE_BOT_MOTTO:m(E.data),o(au);return;case Ne.SETUP_CHAT:{const I=E.data,C=I.split(I.indexOf(";#;")===-1?";":";#;");(C.length===3||C.length===4)&&(St(new Xi(e.roomIndex,Q.UNIT,e.webID,C[0],C[1].toLowerCase()==="true"||C[1]==="1",parseInt(C[2]),C[3]?C[3].toLowerCase()==="true"||C[3]==="1":!1)),n());return}}});const h=_=>M(new Y_(e.webID,_)),g=_=>{let E=!0;if(_)switch(_){case"donate_to_all":h(Ne.DONATE_TO_ALL),M(new lr(e.webID,Ne.DONATE_TO_ALL,""));break;case"donate_to_user":h(Ne.DONATE_TO_USER),M(new lr(e.webID,Ne.DONATE_TO_USER,""));break;case"change_bot_name":h(Ne.CHANGE_BOT_NAME),E=!1;break;case"save_bot_name":M(new lr(e.webID,Ne.CHANGE_BOT_NAME,s));break;case"change_bot_motto":h(Ne.CHANGE_BOT_MOTTO),E=!1;break;case"save_bot_motto":M(new lr(e.webID,Ne.CHANGE_BOT_MOTTO,u));break;case"dress_up":M(new lr(e.webID,Ne.DRESS_UP,""));break;case"random_walk":M(new lr(e.webID,Ne.RANDOM_WALK,""));break;case"setup_chat":h(Ne.SETUP_CHAT),E=!1;break;case"dance":M(new lr(e.webID,Ne.DANCE,""));break;case"nux_take_tour":_e().createLinkEvent("help/tour"),M(new lr(e.webID,Ne.NUX_TAKE_TOUR,""));break;case"pick":M(new Yu(e.webID));break}E&&n()};i.useEffect(()=>{o(ri)},[e]);const f=e.amIOwner||e.amIAnyRoomController;return l(ar,{objectId:e.roomIndex,category:Q.UNIT,userType:ht.RENTABLE_BOT,onClose:n,collapsable:!0,children:[t($t,{children:e.name}),r===ri&&f&&l(V,{children:[e.botSkills.indexOf(Ne.DONATE_TO_ALL)>=0&&t(j,{onClick:_=>g("donate_to_all"),children:d("avatar.widget.donate_to_all")}),e.botSkills.indexOf(Ne.DONATE_TO_USER)>=0&&t(j,{onClick:_=>g("donate_to_user"),children:d("avatar.widget.donate_to_user")}),e.botSkills.indexOf(Ne.CHANGE_BOT_NAME)>=0&&t(j,{onClick:_=>g("change_bot_name"),children:d("avatar.widget.change_bot_name")}),e.botSkills.indexOf(Ne.CHANGE_BOT_MOTTO)>=0&&t(j,{onClick:_=>g("change_bot_motto"),children:d("avatar.widget.change_bot_motto")}),e.botSkills.indexOf(Ne.DRESS_UP)>=0&&t(j,{onClick:_=>g("dress_up"),children:d("avatar.widget.dress_up")}),e.botSkills.indexOf(Ne.RANDOM_WALK)>=0&&t(j,{onClick:_=>g("random_walk"),children:d("avatar.widget.random_walk")}),e.botSkills.indexOf(Ne.SETUP_CHAT)>=0&&t(j,{onClick:_=>g("setup_chat"),children:d("avatar.widget.setup_chat")}),e.botSkills.indexOf(Ne.DANCE)>=0&&t(j,{onClick:_=>g("dance"),children:d("avatar.widget.dance")}),e.botSkills.indexOf(Ne.NO_PICK_UP)===-1&&t(j,{onClick:_=>g("pick"),children:d("avatar.widget.pick_up")})]}),r===su&&l(T,{className:"menu-item",onClick:null,gap:1,children:[t(S,{variant:"white",children:d("bot.skill.name.configuration.new.name")}),t("input",{type:"text",className:"form-control form-control-sm",value:s,maxLength:K("bot.name.max.length",15),onChange:_=>c(_.target.value)}),l(w,{alignItems:"center",justifyContent:"between",gap:1,children:[t(L,{fullWidth:!0,variant:"secondary",onClick:_=>g(null),children:d("cancel")}),t(L,{fullWidth:!0,variant:"success",onClick:_=>g("save_bot_name"),children:d("save")})]})]}),r===au&&l(T,{className:"menu-item",onClick:null,gap:1,children:[t(S,{variant:"white",children:d("bot.skill.name.configuration.new.motto")}),t("input",{type:"text",className:"form-control form-control-sm",value:u,maxLength:K("motto.max.length",38),onChange:_=>m(_.target.value)}),l(w,{alignItems:"center",justifyContent:"between",gap:1,children:[t(L,{fullWidth:!0,variant:"secondary",onClick:_=>g(null),children:d("cancel")}),t(L,{fullWidth:!0,variant:"success",onClick:_=>g("save_bot_motto"),children:d("save")})]})]})]})},Iy=a=>{const[e,n]=i.useState(!1),[r,o]=i.useState(!1),[s,c]=i.useState(null),{avatarInfo:u=null,setAvatarInfo:m=null,activeNameBubble:h=null,setActiveNameBubble:g=null,nameBubbles:f=[],removeNameBubble:_=null,productBubbles:E=[],confirmingProduct:I=null,updateConfirmingProduct:C=null,removeProductBubble:p=null,isDecorating:b=!1,setIsDecorating:N=null}=ON(),{roomSession:v=null}=Ge();Te(pn.NORMAL_MODE,y=>{e&&n(!1)}),Te(pn.GAME_MODE,y=>{e||n(!0)}),Ye(z_.RSDE_DANCE,y=>{y.roomIndex===v.ownRoomIndex&&o(y.danceId!==0)}),ct(Xi.UPDATE_CHAT,y=>c(y));const O=()=>{if(!v||e)return null;if(h)return t(Kc,{nameInfo:h,onClose:()=>g(null)});if(u)switch(u.type){case bs.FURNI:{const y=u;return b?t(my,{avatarInfo:y,onClose:()=>m(null)}):null}case et.OWN_USER:case et.PEER:{const y=u;return K("user.tags.enabled")&&H().getUserTags(y.roomIndex),y.isSpectatorMode?null:y.isOwnUser?ci.isRunning()?null:t(gy,{avatarInfo:y,isDancing:r,setIsDecorating:N,onClose:()=>m(null)}):t(uy,{avatarInfo:y,onClose:()=>m(null)})}case Ss.PET_INFO:{const y=u;return y.isOwner?t(hy,{avatarInfo:y,onClose:()=>m(null)}):t(fy,{avatarInfo:y,onClose:()=>m(null)})}case Ns.RENTABLE_BOT:return t(py,{avatarInfo:u,onClose:()=>m(null)})}return null},R=()=>{if(!u)return null;switch(u.type){case bs.FURNI:return t(ry,{avatarInfo:u,onClose:()=>m(null)});case et.OWN_USER:case et.PEER:return t(cy,{avatarInfo:u,setAvatarInfo:m,onClose:()=>m(null)});case et.BOT:return t(ny,{avatarInfo:u,onClose:()=>m(null)});case Ns.RENTABLE_BOT:return t(ay,{avatarInfo:u,onClose:()=>m(null)});case Ss.PET_INFO:return t(sy,{avatarInfo:u,onClose:()=>m(null)})}};return l(V,{children:[b&&t(dy,{userId:H().userId,userName:H().userName,roomIndex:v.ownRoomIndex,setIsDecorating:N}),O(),u&&t(T,{alignItems:"end",className:"nitro-infostand-container",children:R()}),f.length>0&&f.map((y,F)=>t(Kc,{nameInfo:y,onClose:()=>_(F)},F)),E.length>0&&E.map((y,F)=>t(ty,{item:y,updateConfirmingProduct:C,onClose:()=>p(F)},y.id)),s&&t(KR,{chatEvent:s,onClose:()=>c(null)}),I&&t(XR,{item:I,onClose:()=>C(null)}),t($R,{})]})},Ey=a=>{const{chatStyleId:e=0,chatStyleIds:n=null,selectChatStyleId:r=null}=a,[o,s]=i.useState(null),[c,u]=i.useState(!1),m=g=>{r(g),u(!1)},h=g=>{let f=!1;u(_=>(f=!_,f)),f&&s(g.target)};return i.useEffect(()=>{c||s(null)},[c]),l(V,{children:[t(U,{pointer:!0,className:"icon chatstyles-icon",onClick:h}),t(gu,{show:c,target:o,placement:"top",children:t(Ba,{className:"nitro-chat-style-selector-container image-rendering-pixelated",children:t(re,{overflow:"hidden",className:"bg-transparent",children:t(ne,{columnCount:3,overflow:"auto",children:n&&n.length>0&&n.map(g=>t(w,{center:!0,pointer:!0,className:"bubble-parent-container",onClick:f=>m(g),children:t(U,{className:"bubble-container",children:t(U,{className:`chat-bubble bubble-${g}`,children:" "})},g)},g))})})})})]})},_y=a=>{const[e,n]=i.useState(""),{chatStyleId:r=0,updateChatStyleId:o=null}=_r(),{selectedUsername:s="",floodBlocked:c=!1,floodBlockedSeconds:u=0,setIsTyping:m=null,setIsIdle:h=null,sendChat:g=null}=kN(),{roomSession:f=null}=Ge(),_=i.useRef(),E=i.useMemo(()=>d("widgets.chatinput.mode.whisper"),[]),I=i.useMemo(()=>d("widgets.chatinput.mode.shout"),[]),C=i.useMemo(()=>d("widgets.chatinput.mode.speak"),[]),p=i.useMemo(()=>K("chat.input.maxlength",100),[]),b=i.useCallback(()=>{const P=document.activeElement;return!(!P||_&&_.current===P||!(P instanceof HTMLInputElement)&&!(P instanceof HTMLTextAreaElement))},[_]),N=i.useCallback(()=>{_.current.focus(),_.current.setSelectionRange(_.current.value.length*2,_.current.value.length*2)},[_]),v=i.useCallback(()=>{n(P=>P!==E||!s.length?P:`${P} ${s}`)},[s,E]),O=i.useCallback((P,D=!1)=>{if(!P||P==="")return;let A=D?Vn.CHAT_SHOUT:Vn.CHAT_DEFAULT,k=P;const B=k.split(" ");let G="",z="";switch(B[0]){case E:A=Vn.CHAT_WHISPER,G=B[1],z=E+" "+G+" ",B.shift(),B.shift();break;case I:A=Vn.CHAT_SHOUT,B.shift();break;case C:A=Vn.CHAT_DEFAULT,B.shift();break}k=B.join(" "),m(!1),h(!1),k.length<=p&&(/%CC%/g.test(encodeURIComponent(k))?n(""):(n(""),g(k,A,G,r))),n(z)},[E,I,C,p,r,m,h,g]),R=i.useCallback(P=>{!P||!P.length?m(!1):(m(!0),h(!0)),n(P)},[m,h]),y=i.useCallback(P=>{if(c||!_.current||b())return;document.activeElement!==_.current&&N();const D=P.target.value;switch(P.key){case" ":case"Space":v();return;case"NumpadEnter":case"Enter":O(D,P.shiftKey);return;case"Backspace":if(D){const A=D.split(" ");A[0]===E&&A.length===3&&A[2]===""&&n("")}return}},[c,_,E,b,N,v,O]);ct(wr.CHAT_INPUT_CONTENT,P=>{switch(P.chatMode){case wr.WHISPER:{n(`${E} ${P.userName} `);return}case wr.SHOUT:return}});const F=i.useMemo(()=>{let P=[];const D=K("chat.styles");for(const A of D)if(A){if(A.minRank>0){H().hasSecurity(A.minRank)&&P.push(A.styleId);continue}if(A.isSystemStyle&&H().hasSecurity(tt.MODERATOR)){P.push(A.styleId);continue}if(!(K("chat.styles.disabled").indexOf(A.styleId)>=0)){if(A.isHcOnly&&In()>=un.CLUB){P.push(A.styleId);continue}if(A.isAmbassadorOnly&&H().isAmbassador){P.push(A.styleId);continue}!A.isHcOnly&&!A.isAmbassadorOnly&&P.push(A.styleId)}}return P},[]);return i.useEffect(()=>(document.body.addEventListener("keydown",y),()=>{document.body.removeEventListener("keydown",y)}),[y]),i.useEffect(()=>{_.current&&(_.current.parentElement.dataset.value=e)},[e]),!f||f.isSpectator?null:ki.createPortal(l("div",{className:"nitro-chat-input-container",children:[l("div",{className:"input-sizer align-items-center",children:[!c&&t("input",{ref:_,type:"text",className:"chat-input",placeholder:d("widgets.chatinput.default"),value:e,maxLength:p,onChange:P=>R(P.target.value),onMouseDown:P=>N()}),c&&l(S,{variant:"danger",children:[d("chat.input.alert.flood",["time"],[u.toString()])," "]})]}),t(Ey,{chatStyleId:r,chatStyleIds:F,selectChatStyleId:o})]}),document.getElementById("toolbar-chat-input-container"))},Cy=()=>{let a=null;self.onmessage=e=>{if(!e)return;const n=e.data;switch(n.action){case"START":a=setInterval(()=>postMessage(null),n.content);break;case"STOP":a&&(clearInterval(a),a=null);break}}};class by extends Worker{constructor(e){const n=e.toString(),r=new Blob([`(${n})()`]);super(URL.createObjectURL(r))}}const Sy=a=>{const{chat:e=null,makeRoom:n=null,bubbleWidth:r=It.CHAT_BUBBLE_WIDTH_NORMAL}=a,[o,s]=i.useState(!1),[c,u]=i.useState(!1),m=i.useRef(),h=i.useMemo(()=>{switch(r){case It.CHAT_BUBBLE_WIDTH_NORMAL:return 350;case It.CHAT_BUBBLE_WIDTH_THIN:return 240;case It.CHAT_BUBBLE_WIDTH_WIDE:return 2e3}},[r]);return i.useEffect(()=>{s(!1);const g=m.current;if(!g)return;const f=g.offsetWidth,_=g.offsetHeight;e.width=f,e.height=_,e.elementRef=g;let E=e.left,I=e.top;return!E&&!I&&(E=e.location.x-f/2,I=g.parentElement.offsetHeight-_,e.left=E,e.top=I),u(!0),()=>{e.elementRef=null,u(!1)}},[e]),i.useEffect(()=>{!c||!e||o||(n&&n(e),s(!0))},[e,c,o,n]),l("div",{ref:m,className:`bubble-container ${o?"visible":"invisible"}`,onClick:g=>q().selectRoomObject(e.roomId,e.senderId,Q.UNIT),children:[e.styleId===0&&t("div",{className:"user-container-bg",style:{backgroundColor:e.color}}),l("div",{className:`chat-bubble bubble-${e.styleId} type-${e.type}`,style:{maxWidth:h},children:[t("div",{className:"user-container",children:e.imageUrl&&e.imageUrl.length>0&&t("div",{className:"user-image",style:{backgroundImage:`url(${e.imageUrl})`}})}),l("div",{className:"chat-content",children:[t("b",{className:"username mr-1",dangerouslySetInnerHTML:{__html:`${e.username}: `}}),t("span",{className:"message",dangerouslySetInnerHTML:{__html:`${e.formattedText}`}})]}),t("div",{className:"pointer"})]})]})},Ny=a=>{const{chatMessages:e=[],setChatMessages:n=null,chatSettings:r=null,getScrollSpeed:o=6e3}=DN(),s=i.useRef(),c=i.useCallback(()=>{n(h=>{if(h){const g=h.filter(f=>f.top>-f.height*2);if(g.length!==h.length)return g}return h})},[n]),u=i.useCallback((h,g,f)=>{for(let _=e.indexOf(h)-1;_>=0;_--){const E=e[_];if(!(!E||h===E||f.indexOf(E)>=0||E.top+E.height-g>h.top+h.height)&&bb(h,E,-g,0)){const I=Math.abs(E.top+E.height-h.top);f.push(E),E.top-=I,E.skipMovement=!0,u(E,I,f)}}},[e]),m=i.useCallback(h=>{if(r.mode===It.CHAT_MODE_FREE_FLOW)h.skipMovement=!0,u(h,0,[h]),c();else{const g=h.top+h.height,f=h.height,_=s.current.offsetHeight-g,E=f-_;_<f&&(n(I=>(I.forEach(C=>{C!==h&&(C.top-=E)}),I)),c())}},[r,u,c,n]);return i.useEffect(()=>{const h=(g=null)=>{if(!s||!s.current)return;const f=s.current.offsetHeight,_=Math.round(document.body.offsetHeight*K("chat.viewer.height.percentage"));s.current.style.height=`${_}px`,n(E=>(E&&E.forEach(I=>I.top-=f-_),E))};return window.addEventListener("resize",h),h(),()=>{window.removeEventListener("resize",h)}},[n]),i.useEffect(()=>{const h=f=>{n(_=>(_.forEach(E=>{if(E.skipMovement){E.skipMovement=!1;return}E.top-=f}),_)),c()},g=new by(Cy);return g.onmessage=()=>h(15),g.postMessage({action:"START",content:o}),()=>{g.postMessage({action:"STOP"})}},[o,c,n]),t("div",{ref:s,className:"nitro-chat-widget",children:e.map(h=>t(Sy,{chat:h,makeRoom:m,bubbleWidth:r.weight},h.id))})},_m=a=>{const{title:e=null,items:n=[],selectItem:r=null,onClose:o=null}=a,[s,c]=i.useState(null),[u,m]=i.useState(""),h=H().isModerator,g=i.useMemo(()=>{const f=u.toLocaleLowerCase();return n.filter(_=>{var E;return(E=_.name)==null?void 0:E.toLocaleLowerCase().includes(f)})},[n,u]);return i.useEffect(()=>{s&&r(s)},[s,r]),l(ae,{className:"nitro-chooser-widget",theme:"primary-slim",children:[t(se,{headerText:e,onCloseClick:o}),l(re,{overflow:"hidden",gap:2,children:[t("input",{type:"text",className:"form-control form-control-sm",placeholder:d("generic.search"),value:u,onChange:f=>m(f.target.value)}),t(ho,{rows:g,rowRender:f=>t(w,{alignItems:"center",className:Vt("rounded p-1",s===f&&"bg-muted"),pointer:!0,onClick:_=>c(f),children:l(S,{truncate:!0,children:[f.name," ",h&&" - "+f.id]})})})]})]})},Ty=a=>{const{items:e=null,onClose:n=null,selectItem:r=null,populateChooser:o=null}=VN();return i.useEffect(()=>{const s={linkReceived:c=>{c.split("/"),o()},eventUrlPrefix:"furni-chooser/"};return _t(s),()=>Ct(s)},[o]),e?t(_m,{title:d("widget.chooser.furni.title"),items:e,selectItem:r,onClose:n}):null},vy=a=>{const{items:e=null,onClose:n=null,selectItem:r=null,populateChooser:o=null}=$N();return i.useEffect(()=>{const s={linkReceived:c=>{c.split("/"),o()},eventUrlPrefix:"user-chooser/"};return _t(s),()=>Ct(s)},[o]),e?t(_m,{title:d("widget.chooser.user.title"),items:e,selectItem:r,onClose:n}):null},wy=a=>{const[e,n]=i.useState(!1),{users:r=[],answer:o=null}=LN();return i.useEffect(()=>{n(!!r.length)},[r]),e?l(ae,{className:"nitro-widget-doorbell",theme:"primary-slim",children:[t(se,{headerText:d("navigator.doorbell.title"),onCloseClick:s=>n(!1)}),l(re,{overflow:"hidden",gap:0,children:[t(T,{gap:2,children:l(ne,{gap:1,className:"text-black fw-bold border-bottom px-1 pb-1",children:[t(U,{className:"g-col-6",children:d("generic.username")}),t(U,{className:"g-col-6"})]})}),t(T,{overflow:"auto",className:"striped-children",gap:0,children:r&&r.length>0&&r.map(s=>l(ne,{gap:1,alignItems:"center",className:"text-black border-bottom p-1",children:[t(U,{className:"g-col-6",children:s}),t(U,{className:"g-col-6",children:l(w,{alignItems:"center",justifyContent:"end",gap:1,children:[t(L,{variant:"success",onClick:()=>o(s,!0),children:d("generic.accept")}),t(L,{variant:"danger",onClick:()=>o(s,!1),children:d("generic.deny")})]})})]},s))})]})]}):null},ul=a=>{const{objectId:e=-1,category:n=-1,noFollow:r=!1,position:o="absolute",...s}=a,[c,u]=i.useState({x:-1,y:-1}),m=i.useRef();return i.useEffect(()=>{let h=!1;const g=()=>{const _=Oe();return Hi(_.roomId,e,n,1)},f=()=>{const _=g();!_||!m.current||u({x:Math.round(_.left+_.width/2-m.current.offsetWidth/2),y:Math.round(_.top-m.current.offsetHeight+10)})};return r?f():(h=!0,fr().add(f)),()=>{h&&fr().remove(f)}},[e,n,r]),t(U,{innerRef:m,position:o,visible:c.x+(m.current?m.current.offsetWidth:0)>-1,className:"object-location",style:{left:c.x,top:c.y},...s})},Ry=a=>{const{roomIndex:e=-1,request:n=null,hideFriendRequest:r=null,requestResponse:o=null}=a;return t(ul,{objectId:e,category:Q.UNIT,children:t(U,{className:"nitro-friend-request-dialog nitro-context-menu p-2",children:l(T,{children:[l(w,{alignItems:"center",justifyContent:"between",gap:2,children:[t(S,{variant:"white",fontSize:6,children:d("widget.friendrequest.from",["username"],[n.name])}),t(Cn,{className:"cursor-pointer fa-icon",onClick:s=>r(n.requesterUserId)})]}),l(w,{justifyContent:"end",gap:1,children:[t(L,{variant:"danger",onClick:s=>o(n.requesterUserId,!1),children:d("widget.friendrequest.decline")}),t(L,{variant:"success",onClick:s=>o(n.requesterUserId,!0),children:d("widget.friendrequest.accept")})]})]})})})},yy=a=>{const{displayedRequests:e=[],hideFriendRequest:n=null}=GN(),{requestResponse:r=null}=gn();return e.length?t(V,{children:e.map((o,s)=>t(Ry,{roomIndex:o.roomIndex,request:o.request,hideFriendRequest:n,requestResponse:r},s))}):null},Oy=a=>{const{productType:e=ue.FLOOR,classId:n=-1,extraParam:r=void 0}=a;switch(e){case ue.WALL:case ue.FLOOR:return t(Qi,{productType:e,productClassId:n});case ue.BADGE:return t(je,{badgeCode:r});case ue.HABBO_CLUB:return t(lt,{type:"hc"})}return null},Ay=a=>{const{ownerId:e=-1}=a,[n,r]=i.useState(0),[o,s]=i.useState(void 0),c=()=>{n===1&&M(new Q_(e)),r(0),s(void 0)};x($_,m=>{r(1)}),x(K_,m=>{r(0),s(void 0)}),x(X_,m=>{const h=m.getParser();s({contentType:h.contentType,classId:h.classId}),r(2)});const u=H().userId===e;return n===0?null:l(ae,{className:"nitro-mysterybox-dialog",theme:"primary-slim",children:[t(se,{headerText:d(n===1?`mysterybox.dialog.${u?"owner":"other"}.title`:"mysterybox.reward.title"),onCloseClick:c}),l(re,{children:[n===1&&l(V,{children:[l(S,{variant:"primary",children:[" ",d(`mysterybox.dialog.${u?"owner":"other"}.subtitle`)," "]}),l(S,{children:[" ",d(`mysterybox.dialog.${u?"owner":"other"}.description`)," "]}),l(S,{children:[" ",d(`mysterybox.dialog.${u?"owner":"other"}.waiting`)]}),l(L,{variant:"danger",onClick:c,className:"mt-auto",children:[" ",d(`mysterybox.dialog.${u?"owner":"other"}.cancel`)," "]})]}),n===2&&o&&l(V,{children:[l(S,{variant:"black",children:[" ",d("mysterybox.reward.text")," "]}),t(w,{className:"prize-container justify-content-center mx-auto",children:t(Oy,{classId:o.classId,productType:o.contentType})}),l(L,{variant:"success",onClick:c,className:"mt-auto",children:[" ",d("mysterybox.reward.close")," "]})]})]})]})},ky=a=>{const{objectId:e=-1,onClose:n=null}=a,[r,o]=i.useState(""),s=()=>{M(new J_(e,r)),n()};return e===-1?null:l(ae,{className:"nitro-mysterytrophy-dialog no-resize",theme:"primary-slim",children:[t(se,{center:!0,headerText:d("mysterytrophy.header.title"),onCloseClick:n}),l(re,{children:[l(w,{className:"mysterytrophy-dialog-top p-3",children:[t("div",{className:"mysterytrophy-image flex-shrink-0"}),t("div",{className:"m-2",children:t(S,{variant:"white",className:"mysterytrophy-text-big",children:d("mysterytrophy.header.description")})})]}),t(w,{className:"mysterytrophy-dialog-bottom p-2",children:l(T,{gap:1,children:[l(w,{alignItems:"center",className:"bg-white rounded py-1 px-2 input-mysterytrophy-dialog",children:[t("textarea",{className:"form-control form-control-sm input-mysterytrophy",value:r,onChange:c=>o(c.target.value)}),t("div",{className:"mysterytrophy-pencil-image flex-shrink-0 small fa-icon"})]}),l(w,{className:"mt-2",gap:5,display:"flex",justifyContent:"center",alignItems:"center",children:[t(S,{pointer:!0,className:"text-decoration",onClick:()=>n(),children:d("cancel")}),t(L,{variant:"success",onClick:()=>s(),children:d("generic.ok")})]})]})})]})]})},Py=a=>{const{objectId:e=-1,onClose:n=null}=a,{roomSession:r=null}=Ge(),o=()=>{r.useMultistateItem(e),n()};return l(ae,{className:"nitro-use-product-confirmation",children:[t(se,{headerText:d("effectbox.header.title"),onCloseClick:n}),t(re,{center:!0,children:t(w,{gap:2,children:l(T,{justifyContent:"between",children:[t(S,{children:d("effectbox.header.description")}),l(w,{alignItems:"center",justifyContent:"between",children:[t(L,{variant:"danger",onClick:n,children:d("generic.cancel")}),t(L,{variant:"success",onClick:o,children:d("generic.ok")})]})]})})})]})},Ma=-1,Dy=0,My=a=>{const{objectId:e=-1,onClose:n=null}=a,[r,o]=i.useState(null),[s,c]=i.useState(Ma),{roomSession:u=null}=Ge(),m=()=>{u.useMultistateItem(e),n()};return i.useEffect(()=>{if(!u||e===-1)return;const h=oo(u.roomId,e,Q.FLOOR);if(!h)return;o(h);let g=Ma;switch(h.specialType){case Z.MONSTERPLANT_SEED:g=Dy;break}if(g===Ma){n();return}c(g)},[u,e,n]),s===Ma?null:l(ae,{className:"nitro-use-product-confirmation",children:[t(se,{headerText:d("useproduct.widget.title.plant_seed",["name"],[r.name]),onCloseClick:n}),t(re,{center:!0,children:l(w,{gap:2,overflow:"hidden",children:[t(T,{children:t(U,{className:"product-preview",children:t(U,{className:"monsterplant-image"})})}),l(T,{justifyContent:"between",overflow:"auto",children:[l(T,{gap:2,children:[t(S,{children:d("useproduct.widget.text.plant_seed",["productName"],[r.name])}),t(S,{children:d("useproduct.widget.info.plant_seed")})]}),l(w,{alignItems:"center",justifyContent:"between",children:[t(L,{variant:"danger",onClick:n,children:d("useproduct.widget.cancel")}),t(L,{variant:"success",onClick:m,children:d("widget.monsterplant_seed.button.use")})]})]})]})})]})},La=-1,Ly=0,Uy=a=>{const{objectId:e=-1,onClose:n=null}=a,[r,o]=i.useState(La),[s,c]=i.useState(ce.MALE),[u,m]=i.useState(null),{roomSession:h=null}=Ge(),g=()=>{hi().send(new Z_(e)),hi().send(new Lu(s,u)),n()};return i.useEffect(()=>{let f=La;const _=H().figure,E=H().gender,I=[];if(h&&e>=0){const C=oo(h.roomId,e,Q.FLOOR);if(C)switch(C.specialType){case Z.FIGURE_PURCHASABLE_SET:f=Ly;const p=C.customParams.split(",").map(b=>parseInt(b));for(const b of p)Nt().isValidFigureSetForGender(b,E)&&I.push(b);break}}if(f===La){n();return}c(E),m(Nt().getFigureStringWithFigureIds(_,E,I)),o(f)},[h,e,n]),r===La?null:l(ae,{className:"nitro-use-product-confirmation",children:[t(se,{headerText:d("useproduct.widget.title.bind_clothing"),onCloseClick:n}),t(re,{center:!0,children:l(w,{gap:2,overflow:"hidden",children:[t(T,{children:t(U,{className:"mannequin-preview",children:t(st,{figure:u,direction:2})})}),l(T,{justifyContent:"between",overflow:"auto",children:[l(T,{gap:2,children:[t(S,{children:d("useproduct.widget.text.bind_clothing")}),t(S,{children:d("useproduct.widget.info.bind_clothing")})]}),l(w,{alignItems:"center",justifyContent:"between",children:[t(L,{variant:"danger",onClick:n,children:d("useproduct.widget.cancel")}),t(L,{variant:"success",onClick:g,children:d("useproduct.widget.bind_clothing")})]})]})]})})]})},xy=a=>{const{closeConfirm:e=null,processAction:n=null,onClose:r=null,objectId:o=-1,mode:s=null,confirmMode:c=null,confirmingObjectId:u=-1,groupData:m=null,isGroupMember:h=!1,objectOwnerId:g=-1}=FS(),{simpleAlert:f=null}=Xe();x(eC,E=>{const I=E.getParser();if(I)switch(I.count){case 1:f(d("costumehopper.costumerequired.bodytext"),null,"catalog/open/temporary_effects",d("costumehopper.costumerequired.buy"),d("costumehopper.costumerequired.header"),null);break;case 2:f(d("viphopper.viprequired.bodytext"),null,"catalog/open/habbo_club",d("viprequired.buy.vip"),d("viprequired.header"),null);break;case 3:f(d("gate.viprequired.bodytext"),null,"catalog/open/habbo_club",d("viprequired.buy.vip"),d("gate.viprequired.title"),null);break}});const _=H().userId===g;return l(V,{children:[c===vi&&t(My,{objectId:u,onClose:e}),c===wi&&t(Uy,{objectId:u,onClose:e}),c===$d&&t(Py,{objectId:u,onClose:e}),c===Ri&&t(ky,{objectId:u,onClose:e}),t(Ay,{ownerId:g}),o>=0&&s&&l(ar,{objectId:o,category:Q.FLOOR,onClose:r,fades:!0,children:[s===Lt.FRIEND_FURNITURE&&l(V,{children:[t($t,{children:d("friendfurni.context.title")}),t(j,{onClick:E=>n("use_friend_furni"),children:d("friendfurni.context.use")})]}),s===Lt.MONSTERPLANT_SEED&&l(V,{children:[t($t,{children:d("furni.mnstr_seed.name")}),t(j,{onClick:E=>n("use_monsterplant_seed"),children:d("widget.monsterplant_seed.button.use")})]}),s===Lt.RANDOM_TELEPORT&&l(V,{children:[t($t,{children:d("furni.random_teleport.name")}),t(j,{onClick:E=>n("use_random_teleport"),children:d("widget.random_teleport.button.use")})]}),s===Lt.PURCHASABLE_CLOTHING&&l(V,{children:[t($t,{children:d("furni.generic_usable.name")}),t(j,{onClick:E=>n("use_purchaseable_clothing"),children:d("widget.generic_usable.button.use")})]}),s===Lt.MYSTERY_BOX&&l(V,{children:[t($t,{children:d("mysterybox.context.title")}),t(j,{onClick:E=>n("use_mystery_box"),children:d("mysterybox.context."+(_?"owner":"other")+".use")})]}),s===Lt.MYSTERY_TROPHY&&l(V,{children:[t($t,{children:d("mysterytrophy.header.title")}),t(j,{onClick:E=>n("use_mystery_trophy"),children:d("friendfurni.context.use")})]}),s===zd&&m&&l(V,{children:[t($t,{className:"cursor-pointer text-truncate",onClick:()=>ea(m.guildId),children:m.guildName}),!h&&t(j,{onClick:E=>n("join_group"),children:d("widget.furniture.button.join.group")}),t(j,{onClick:E=>n("go_to_group_homeroom"),children:d("widget.furniture.button.go.to.group.home.room")}),m.guildHasReadableForum&&t(j,{onClick:E=>n("open_forum"),children:d("widget.furniture.button.open_group_forum")})]})]})]})},Fy=a=>{const{objectId:e=-1,color:n=0,setColor:r=null,applyToner:o=null,toggleToner:s=null,onClose:c=null}=MS();return e===-1?null:l(ae,{theme:"primary-slim",className:"nitro-room-widget-toner",children:[t(se,{headerText:d("widget.backgroundcolor.title"),onCloseClick:c}),l(re,{overflow:"hidden",justifyContent:"between",children:[t(T,{overflow:"auto",gap:1,children:t("input",{type:"color",className:"form-control",value:Qt.makeColorNumberHex(n),onChange:u=>r(Qt.convertFromHex(u.target.value))})}),l(T,{gap:1,children:[t(L,{fullWidth:!0,variant:"primary",onClick:s,children:d("widget.backgroundcolor.button.on")}),t(L,{fullWidth:!0,variant:"primary",onClick:o,children:d("widget.backgroundcolor.button.apply")})]})]})]})},Gy=a=>{const{objectId:e=-1,color:n="1",badgeName:r="",badgeDesc:o="",date:s="",senderName:c="",onClose:u=null}=US();return e===-1?null:t(Ad,{color:n,message:o,date:s,senderName:c,customTitle:r,onCloseClick:u})},By=a=>{const{objectId:e=-1,recipes:n=[],ingredients:r=[],selectedRecipe:o=null,requiredIngredients:s=null,isCrafting:c=!1,craft:u=null,selectRecipe:m=null,onClose:h=null}=BS(),{roomSession:g=null}=Ge(),[f,_]=i.useState(!1),E=i.useMemo(()=>{const p=q().getRoomObject(g.roomId,e,Q.FLOOR);return Wt(p)},[e,g.roomId]),I=i.useMemo(()=>{if(!s||!s.length)return!1;for(const p of s){const b=r.find(N=>N.name===p.itemName);if(!b||b.count<p.count)return!1}return!0},[r,s]),C=()=>{if(!f){_(!0);return}u(),_(!1)};return i.useEffect(()=>{_(!1)},[o]),e===-1?null:l(ae,{className:"nitro-widget-crafting",theme:"primary-slim",children:[t(se,{headerText:d("crafting.title"),onCloseClick:h}),t(re,{children:l(w,{grow:!0,overflow:"hidden",gap:2,children:[l(w,{column:!0,fullWidth:!0,gap:2,children:[l(T,{overflow:"hidden",fullHeight:!0,children:[t("div",{className:"bg-muted rounded py-1 text-center",children:d("crafting.title.products")}),t(Ue,{columnCount:5,children:n.length>0&&n.map(p=>t(be,{itemImage:p.iconUrl,itemActive:o&&o.name===p.name,onClick:()=>m(p)},p.name))})]}),l(T,{overflow:"hidden",fullHeight:!0,children:[t("div",{className:"bg-muted rounded py-1 text-center",children:d("crafting.title.mixer")}),t(Ue,{columnCount:5,children:r.length>0&&r.map(p=>t(be,{itemImage:p.iconUrl,itemCount:p.count,itemCountMinimum:0,className:(p.count?"":"opacity-0-5 ")+"cursor-default"},p.name))})]})]}),l(w,{column:!0,fullWidth:!0,gap:2,children:[!o&&t(T,{center:!0,fullHeight:!0,className:"text-black text-center",children:d("crafting.info.start")}),o&&l(V,{children:[l(T,{overflow:"hidden",fullHeight:!0,children:[t("div",{className:"bg-muted rounded py-1 text-center",children:d("crafting.current_recipe")}),t(Ue,{columnCount:5,children:!!s&&s.length>0&&s.map(p=>{const b=r.find(v=>v.name===p.itemName),N=[];for(let v=0;v<p.count;v++)N.push(t(be,{itemImage:b.iconUrl,className:(b.count-v<=0?"opacity-0-5 ":"")+"cursor-default"},v));return N})})]}),l(w,{gap:2,column:!0,fullHeight:!0,children:[l(w,{gap:2,className:"bg-muted rounded",column:!0,fullHeight:!0,children:[t("div",{className:"py-1 text-center",children:d("crafting.result")}),l(w,{gap:1,center:!0,column:!0,fullHeight:!0,className:"pb-1",children:[t(T,{fullHeight:!0,children:t("img",{src:o.iconUrl})}),t("div",{className:"text-black",children:o.localizedName})]})]}),l(L,{variant:!E||!I?"danger":f?"warning":c?"primary":"success",disabled:!E||!I||c,onClick:C,children:[!c&&d(E?I?f?"generic.confirm":"crafting.btn.craft":"crafting.status.recipe.incomplete":"crafting.btn.notowner"),c&&t(Ji,{})]})]})]})]})]})})]})},Vy=a=>{const[e,n]=i.useState(!1),{presets:r=[],dimmerState:o=0,selectedPresetId:s=0,color:c=16777215,brightness:u=255,effectId:m=0,selectedColor:h=0,setSelectedColor:g=null,selectedBrightness:f=0,setSelectedBrightness:_=null,selectedEffectId:E=0,setSelectedEffectId:I=null,selectPresetId:C=null,applyChanges:p}=HS(),b=()=>{nn.previewDimmer(c,u,m===2),n(!1)};Te(we.REMOVE_DIMMER,v=>n(!1)),i.useEffect(()=>{!r||!r.length||n(!0)},[r]);const N=i.useMemo(()=>K("widget.dimmer.colorwheel",!1),[]);return e?l(ae,{className:"nitro-room-widget-dimmer",children:[t(se,{headerText:d("widget.dimmer.title"),onCloseClick:b}),o===1&&t(Ir,{children:r.map(v=>t(qn,{isActive:s===v.id,onClick:O=>C(v.id),children:d(`widget.dimmer.tab.${v.id}`)},v.id))}),l(re,{children:[o===0&&l(T,{alignItems:"center",children:[t(U,{className:"dimmer-banner"}),t(S,{center:!0,className:"bg-muted rounded p-1",children:d("widget.dimmer.info.off")}),t(L,{fullWidth:!0,variant:"success",onClick:()=>nn.changeState(),children:d("widget.dimmer.button.on")})]}),o===1&&l(V,{children:[l(T,{gap:1,children:[t(S,{fontWeight:"bold",children:d("widget.backgroundcolor.hue")}),N&&t("input",{type:"color",className:"form-control",value:Qt.makeColorNumberHex(h),onChange:v=>g(Qt.convertFromHex(v.target.value))}),!N&&t(ne,{gap:1,columnCount:7,children:nn.AVAILABLE_COLORS.map((v,O)=>t(T,{fullWidth:!0,pointer:!0,className:Vt("color-swatch rounded",v===h&&"active"),onClick:()=>g(v),style:{backgroundColor:nn.HTML_COLORS[O]}},O))})]}),l(T,{gap:1,children:[t(S,{fontWeight:"bold",children:d("widget.backgroundcolor.lightness")}),t(Dt,{className:"nitro-slider",min:nn.MIN_BRIGHTNESS,max:nn.MAX_BRIGHTNESS,value:f,onChange:v=>_(v),thumbClassName:"thumb percent",renderThumb:(v,O)=>t("div",{...v,children:nn.scaleBrightness(O.valueNow)})})]}),l(w,{alignItems:"center",gap:1,children:[t("input",{className:"form-check-input",type:"checkbox",checked:E===2,onChange:v=>I(v.target.checked?2:1)}),t(S,{children:d("widget.dimmer.type.checkbox")})]}),l(w,{gap:1,children:[t(L,{fullWidth:!0,variant:"danger",onClick:()=>nn.changeState(),children:d("widget.dimmer.button.off")}),t(L,{fullWidth:!0,variant:"success",onClick:p,children:d("widget.dimmer.button.apply")})]})]})]})]}):null},Hy=a=>{const{objectId:e=-1,value:n=0,onClose:r=null,redeem:o=null}=jS();return e===-1?null:l(ae,{className:"nitro-widget-exchange-credit",theme:"primary-slim",children:[t(se,{headerText:d("catalog.redeem.dialog.title"),onCloseClick:r}),t(re,{center:!0,children:l(w,{overflow:"hidden",gap:2,children:[t(T,{center:!0,children:t(U,{className:"exchange-image"})}),l(T,{grow:!0,justifyContent:"between",overflow:"hidden",children:[l(T,{gap:1,overflow:"auto",children:[t(S,{fontWeight:"bold",children:d("creditfurni.description",["credits"],[n.toString()])}),t(S,{children:d("creditfurni.prompt")})]}),t(L,{variant:"success",onClick:o,children:d("catalog.redeem.dialog.button.exchange")})]})]})})]})},Wy=a=>{const{currentIndex:e=-1,currentPhotos:n=null}=a,[r,o]=i.useState(0),s=n&&n.length?n[r]:null,c=()=>{o(m=>{let h=m+1;return h>=n.length&&(h=0),h})},u=()=>{o(m=>{let h=m-1;return h<0&&(h=n.length-1),h})};return i.useEffect(()=>{o(e)},[e]),s?l(ne,{style:{display:"flex",flexDirection:"column"},children:[t(w,{center:!0,className:"picture-preview border border-black",style:s.w?{backgroundImage:"url("+s.w+")"}:{},children:!s.w&&t(S,{bold:!0,children:d("camera.loading")})}),s.m&&s.m.length&&t(S,{center:!0,children:s.m}),l(w,{alignItems:"center",justifyContent:"between",children:[t(S,{children:s.n||""}),t(S,{children:new Date(s.t*1e3).toLocaleDateString()})]}),n.length>1&&l(w,{className:"picture-preview-buttons",children:[t(uu,{className:"cursor-pointer picture-preview-buttons-previous fa-icon",onClick:u}),t(S,{underline:!0,className:"cursor-pointer",onClick:m=>Jt(s.oi),children:s.o}),t(du,{className:"cursor-pointer picture-preview-buttons-next fa-icon",onClick:c})]})]}):null},jy=a=>{const{objectId:e=-1,currentPhotoIndex:n=-1,currentPhotos:r=null,onClose:o=null}=YS(),{report:s=null}=Mn();return e===-1||n===-1?null:l(ae,{className:"nitro-external-image-widget",theme:"primary-slim",children:[t(se,{headerText:"",isGalleryPhoto:!0,onReportPhoto:()=>s(Ve.PHOTO,{extraData:r[n].w,roomId:r[n].s,reportedUserId:H().userId,roomObjectId:Number(r[n].u)}),onCloseClick:o}),t(re,{children:t(Wy,{currentIndex:n,currentPhotos:r})})]})},qy=a=>{const{objectId:e=-1,type:n=0,stage:r=0,usernames:o=[],figures:s=[],date:c=null,onClose:u=null,respond:m=null}=$S();if(e===-1)return null;if(r>0)return l(ae,{className:"nitro-engraving-lock",theme:"primary-slim",children:[t(se,{headerText:d("friend.furniture.confirm.lock.caption"),onCloseClick:u}),l(re,{children:[t("h5",{className:"text-black text-center fw-bold mt-2 mb-2",children:d("friend.furniture.confirm.lock.subtitle")}),t("div",{className:"d-flex justify-content-center mb-2",children:t("div",{className:`engraving-lock-stage-${r}`})}),r===2&&t("div",{className:"text-small text-black text-center mb-2",children:d("friend.furniture.confirm.lock.other.locked")}),l(w,{gap:1,children:[t(L,{fullWidth:!0,onClick:h=>m(!1),children:d("friend.furniture.confirm.lock.button.cancel")}),t(L,{fullWidth:!0,variant:"success",onClick:h=>m(!0),children:d("friend.furniture.confirm.lock.button.confirm")})]})]})]});if(o.length>0)return t(Ar,{handleSelector:".nitro-engraving-lock-view",children:l("div",{className:`nitro-engraving-lock-view engraving-lock-${n}`,children:[t("div",{className:"engraving-lock-close",onClick:u}),l(w,{justifyContent:"center",children:[t("div",{className:"engraving-lock-avatar",children:t(st,{figure:s[0],direction:2})}),t("div",{className:"engraving-lock-avatar",children:t(st,{figure:s[1],direction:4})})]}),l(T,{justifyContent:"between",className:"mt-1",children:[l(T,{alignItems:"center",justifyContent:"center",gap:1,children:[l("div",{children:[n===0&&d("lovelock.engraving.caption"),n===3&&d("wildwest.engraving.caption")]}),t("div",{children:c})]}),l(w,{justifyContent:"center",gap:4,children:[t("div",{children:o[0]}),t("div",{children:o[1]})]})]})]})})},Yy=a=>{const{objectId:e=-1,classId:n=-1,itemType:r=null,text:o=null,isOwnerOfFurniture:s=!1,senderName:c=null,senderFigure:u=null,placedItemId:m=-1,placedItemType:h=null,placedInRoom:g=!1,imageUrl:f=null,openPresent:_=null,onClose:E=null}=cN(),{groupItems:I=[]}=es();if(e===-1)return null;const C=p=>{const b=I.find(N=>{var v;return((v=N.getItemById(p))==null?void 0:v.id)===p});b&&Cs(b),E()};return l(ae,{className:"nitro-gift-opening",theme:"primary-slim",children:[t(se,{headerText:d(c?"widget.furni.present.window.title_from":"widget.furni.present.window.title",["name"],[c]),onCloseClick:E}),l(re,{children:[m===-1&&l(T,{overflow:"hidden",children:[t(w,{center:!0,overflow:"auto",children:t(yd,{userName:c,figure:u,message:o})}),s&&l(w,{gap:1,children:[c&&t(L,{fullWidth:!0,onClick:p=>ee("catalog/open"),children:d("widget.furni.present.give_gift",["name"],[c])}),t(L,{fullWidth:!0,variant:"success",onClick:_,children:d("widget.furni.present.open_gift")})]})]}),m>-1&&l(w,{gap:2,overflow:"hidden",children:[t(T,{center:!0,className:"p-2",children:t(sr,{imageUrl:f})}),l(T,{grow:!0,children:[l(T,{center:!0,gap:1,children:[t(S,{wrap:!0,small:!0,children:d("widget.furni.present.message_opened")}),t(S,{bold:!0,fontSize:5,children:o})]}),l(T,{grow:!0,gap:1,children:[l(w,{gap:1,children:[g&&t(L,{fullWidth:!0,onClick:null,children:d("widget.furni.present.put_in_inventory")}),t(L,{fullWidth:!0,variant:"success",onClick:p=>C(m),children:d(g?"widget.furni.present.keep_in_room":"widget.furni.present.place_in_room")})]}),c&&c.length&&t(L,{fullWidth:!0,onClick:p=>ee("catalog/open"),children:d("widget.furni.present.give_gift",["name"],[c])})]})]})]})]})]})},zy=a=>{const{stuffDatas:e=null,getScoreType:n=null,getClearType:r=null}=JS();return!e||!e.size?null:t(V,{children:Array.from(e.entries()).map(([o,s],c)=>t(ul,{objectId:o,category:Q.FLOOR,children:l(T,{className:"nitro-widget-high-score nitro-context-menu",gap:0,children:[t($t,{children:d("high.score.display.caption",["scoretype","cleartype"],[d(`high.score.display.scoretype.${n(s.scoreType)}`),d(`high.score.display.cleartype.${r(s.clearType)}`)])}),l(Em,{overflow:"hidden",gap:1,className:"h-100",children:[l(T,{gap:1,children:[l(w,{alignItems:"center",children:[t(S,{center:!0,bold:!0,variant:"white",className:"col-8",children:d("high.score.display.users.header")}),t(S,{center:!0,bold:!0,variant:"white",className:"col-4",children:d("high.score.display.score.header")})]}),t("hr",{className:"m-0"})]}),t(T,{overflow:"auto",gap:1,className:"overflow-y-scroll",children:s.entries.map((u,m)=>l(w,{alignItems:"center",children:[t(S,{center:!0,variant:"white",className:"col-8",children:u.users.join(", ")}),t(S,{center:!0,variant:"white",className:"col-4",children:u.score})]},m))})]})]})},c))})},$y=a=>(tN(),null),Ky=-1,Ua=0,si=1,ai=2,oi=3,ii=4,Xy=a=>{const[e,n]=i.useState(null),[r,o]=i.useState(Ky),{objectId:s=-1,figure:c=null,gender:u=null,clubLevel:m=un.NO_CLUB,name:h=null,setName:g=null,saveFigure:f=null,wearFigure:_=null,saveName:E=null,onClose:I=null}=rN();return i.useEffect(()=>{if(s===-1)return;const C=Oe();if(C.isRoomOwner||C.controllerLevel>=tt.GUEST||H().isModerator){o(Ua);return}if(H().gender.toLowerCase()!==u.toLowerCase()){o(ii);return}if(In()<m){o(oi);return}o(ai)},[s,u,m]),i.useEffect(()=>{switch(r){case Ua:case ii:{const C=Nt().createFigureContainer(c);fs.transformAsMannequinFigure(C),n(C.getFigureString());break}case si:{const C=Nt().createFigureContainer(H().figure);fs.transformAsMannequinFigure(C),n(C.getFigureString());break}case ai:case oi:{const C=fs.getMergedMannequinFigureContainer(H().figure,c);n(C.getFigureString());break}}},[r,c,m]),s===-1?null:l(ae,{className:"nitro-mannequin no-resize",theme:"primary-slim",children:[t(se,{headerText:d("mannequin.widget.title"),onCloseClick:I}),t(re,{center:!0,children:l(w,{fullWidth:!0,gap:2,overflow:"hidden",children:[t(T,{children:l(U,{position:"relative",className:"mannequin-preview",children:[t(st,{position:"absolute",figure:e,direction:2}),m>0&&t(lt,{className:"position-absolute end-2 bottom-2",type:"hc"})]})}),l(T,{grow:!0,justifyContent:"between",overflow:"auto",children:[r===Ua&&l(V,{children:[t("input",{type:"text",className:"form-control form-control-sm",value:h,onChange:C=>g(C.target.value),onBlur:E}),l(T,{gap:1,children:[t(L,{variant:"success",onClick:C=>o(si),children:d("mannequin.widget.style")}),t(L,{variant:"success",onClick:_,children:d("mannequin.widget.wear")})]})]}),r===si&&l(V,{children:[l(T,{gap:1,children:[t(S,{bold:!0,children:h}),t(S,{wrap:!0,children:d("mannequin.widget.savetext")})]}),l(w,{alignItems:"center",justifyContent:"between",children:[t(S,{underline:!0,pointer:!0,onClick:C=>o(Ua),children:d("mannequin.widget.back")}),t(L,{variant:"success",onClick:f,children:d("mannequin.widget.save")})]})]}),r===ai&&l(V,{children:[l(T,{gap:1,children:[t(S,{bold:!0,children:h}),t(S,{children:d("mannequin.widget.weartext")})]}),t(L,{variant:"success",onClick:_,children:d("mannequin.widget.wear")})]}),r===oi&&t(w,{center:!0,grow:!0,children:t(S,{children:d("mannequin.widget.clubnotification")})}),r===ii&&t(S,{children:d("mannequin.widget.wronggender")})]})]})})]})},Qy=a=>(mN(),null),Cm=["9CCEFF","FF9CFF","9CFF9C","FFFF33"],Jy=["blue","pink","green","yellow"],Zy=a=>{let e=Cm.indexOf(a);return e===-1&&(e=0),Jy[e]},eO=a=>{const{objectId:e=-1,color:n="0",setColor:r=null,text:o="",setText:s=null,canModify:c=!1,onClose:u=null}=hN();return e===-1?null:t(Ar,{handleSelector:".drag-handler",windowPosition:Pt.TOP_LEFT,children:l("div",{className:"nitro-stickie nitro-stickie-image stickie-"+Zy(n),children:[l("div",{className:"d-flex align-items-center stickie-header drag-handler",children:[t("div",{className:"d-flex align-items-center flex-grow-1 h-100",children:c&&l(V,{children:[t("div",{className:"nitro-stickie-image stickie-trash header-trash",onClick:u}),Cm.map(m=>t("div",{className:"stickie-color ms-1",onClick:h=>r(m),style:{backgroundColor:Qt.makeColorHex(m)}},m))]})}),t("div",{className:"d-flex align-items-center nitro-stickie-image stickie-close header-close",onClick:u})]}),t("div",{className:"stickie-context",children:t("textarea",{className:"context-text",value:o,onChange:m=>s(m.target.value),tabIndex:0,autoFocus:!0})})]})})},tO=a=>{const{objectId:e=-1,height:n=0,maxHeight:r=40,onClose:o=null,updateHeight:s=null}=pN(),[c,u]=i.useState(""),m=h=>{u(h);const g=parseFloat(h);isNaN(g)||g===n||s(g)};return i.useEffect(()=>{u(n.toString())},[n]),e===-1?null:l(ae,{className:"nitro-widget-custom-stack-height",theme:"primary-slim",children:[t(se,{headerText:d("widget.custom.stack.height.title"),onCloseClick:o}),l(re,{justifyContent:"between",children:[t(S,{children:d("widget.custom.stack.height.text")}),l(w,{gap:2,children:[t(Dt,{className:"nitro-slider",min:0,max:r,step:.01,value:n,onChange:h=>s(h),renderThumb:(h,g)=>t("div",{...h,children:g.valueNow})}),t("input",{className:"show-number-arrows",style:{width:50},type:"number",min:0,max:r,value:c,onChange:h=>m(h.target.value)})]}),l(T,{gap:1,children:[t(L,{onClick:h=>M(new mi(e,-100)),children:d("furniture.above.stack")}),t(L,{onClick:h=>M(new mi(e,0)),children:d("furniture.floor.level")})]})]})]})},bm=["9CCEFF","FF9CFF","9CFF9C","FFFF33"],nO=["blue","pink","green","yellow"],rO=["post_it","post_it_shakesp","post_it_dreams","post_it_xmas","post_it_vd","post_it_juninas"],sO=["post_it","shakesp","dreams","christmas","heart","juninas"],aO=a=>{let e=bm.indexOf(a);return e===-1&&(e=0),nO[e]},oO=a=>{let e=rO.indexOf(a);return e===-1&&(e=0),sO[e]},iO=a=>{const{objectId:e=-1,color:n="0",text:r="",type:o="",canModify:s=!1,updateColor:c=null,updateText:u=null,trash:m=null,onClose:h=null}=EN(),[g,f]=i.useState(!1);return i.useEffect(()=>{f(!1)},[e,n,r,o]),e===-1?null:t(Ar,{handleSelector:".drag-handler",windowPosition:Pt.TOP_LEFT,children:l("div",{className:"nitro-stickie nitro-stickie-image stickie-"+(o=="post_it"?aO(n):oO(o)),children:[l("div",{className:"d-flex align-items-center stickie-header drag-handler",children:[t("div",{className:"d-flex align-items-center flex-grow-1 h-100",children:s&&l(V,{children:[t("div",{className:"nitro-stickie-image stickie-trash header-trash",onClick:m}),o=="post_it"&&t(V,{children:bm.map(_=>t("div",{className:"stickie-color ms-1",onClick:E=>c(_),style:{backgroundColor:Qt.makeColorHex(_)}},_))})]})}),t("div",{className:"d-flex align-items-center nitro-stickie-image stickie-close header-close",onClick:h})]}),t("div",{className:"stickie-context",children:!g||!s?t("div",{className:"context-text",onClick:_=>s&&f(!0),children:r}):t("textarea",{className:"context-text",defaultValue:r,tabIndex:0,onBlur:_=>u(_.target.value),autoFocus:!0})})]})})},lO=a=>{const{objectId:e=-1,color:n="1",senderName:r="",date:o="",message:s="",onClose:c=null}=CN();return e===-1?null:t(Ad,{color:n,message:s,date:o,senderName:r,onCloseClick:c})},cO=a=>{const[e,n]=i.useState(null),{objectId:r=-1,videoId:o=null,videoStart:s=0,videoEnd:c=0,currentVideoState:u=null,selectedVideo:m=null,playlists:h=[],onClose:g=null,previous:f=null,next:_=null,pause:E=null,play:I=null,selectVideo:C=null}=wN(),p=N=>{if(n(N.target),r!==-1)switch(N.target.getPlayerState()){case-1:case 1:u!==1&&I();return;case 2:u!==2&&E()}};if(i.useEffect(()=>{if(!(u===null||!e)){if(u===An.PLAYING&&e.getPlayerState()!==An.PLAYING){e.playVideo();return}if(u===An.PAUSED&&e.getPlayerState()!==An.PAUSED){e.pauseVideo();return}}},[u,e]),r===-1)return null;const b={height:"375",width:"500",playerVars:{autoplay:1,disablekb:1,controls:0,origin:window.origin,modestbranding:1,start:s,end:c}};return l(ae,{className:"youtube-tv-widget",children:[t(se,{headerText:d("catalog.page.youtube_tvs"),onCloseClick:g}),t(re,{children:l("div",{className:"row w-100 h-100",children:[l("div",{className:"youtube-video-container col-9 overflow-hidden",children:[o&&o.length>0&&t(Ym,{videoId:o,opts:b,onReady:N=>n(N.target),onStateChange:p,containerClassName:"youtubeContainer"}),(!o||o.length===0)&&t("div",{className:"empty-video w-100 h-100 justify-content-center align-items-center d-flex",children:d("widget.furni.video_viewer.no_videos")})]}),l("div",{className:"playlist-container col-3 d-flex flex-column",children:[l("span",{className:"playlist-controls justify-content-center d-flex",children:[t("i",{className:"icon icon-youtube-prev cursor-pointer",onClick:f}),t("i",{className:"icon icon-youtube-next cursor-pointer",onClick:_})]}),t("div",{className:"mb-1",children:d("widget.furni.video_viewer.playlists")}),t(Ue,{columnCount:1,columnMinWidth:80,columnMinHeight:100,className:"mb-1",overflow:"auto",children:h&&h.map((N,v)=>t(be,{onClick:O=>C(N.video),itemActive:N.video===m,children:t("b",{children:N.title})},v))})]})]})})]})},uO=a=>{const{diskInventory:e=null,addToPlaylist:n=null}=a,[r,o]=i.useState(-1),[s,c]=i.useState(-1),u=i.useCallback((g,f)=>{g.stopPropagation(),c(_=>_===f?-1:f)},[]),m=i.useCallback((g,f)=>{var _,E;g.stopPropagation(),n(f,(E=(_=_e().soundManager.musicController)==null?void 0:_.getRoomItemPlaylist())==null?void 0:E.length)},[n]),h=()=>{ee("catalog/open/"+ut.TRAX_SONGS)};return i.useEffect(()=>{var g;if(s!==-1)return(g=_e().soundManager.musicController)==null||g.playSong(s,Ds.PRIORITY_SONG_PLAY,0,0,0,0),()=>{var f;(f=_e().soundManager.musicController)==null||f.stop(Ds.PRIORITY_SONG_PLAY)}},[s]),i.useEffect(()=>()=>c(-1),[]),l(V,{children:[l("div",{className:"bg-success py-3 container-fluid justify-content-center d-flex rounded",children:[t("img",{src:K("image.library.url")+"playlist/title_mymusic.gif",className:"my-music"}),t("h2",{className:"ms-4",children:d("playlist.editor.my.music")})]}),t("div",{className:"h-100 overflow-y-scroll mt-4 py-2",children:t(Ue,{columnCount:3,columnMinWidth:95,gap:1,children:e&&e.getKeys().map((g,f)=>{var C;const _=e.getKey(f),E=e.getWithIndex(f),I=(C=_e().soundManager.musicController)==null?void 0:C.getSongInfo(E);return l(be,{itemActive:r===f,onClick:()=>o(p=>p===f?-1:f),classNames:["text-black"],children:[t("div",{className:"disk-image flex-shrink-0 mb-n2",style:{backgroundColor:Sd(I==null?void 0:I.songData)}}),t(S,{truncate:!0,fullWidth:!0,className:"text-center",children:I==null?void 0:I.name}),r===f&&l(w,{position:"absolute",className:"bottom-0 mb-1 bg-secondary p-1 rounded",alignItems:"center",justifyContent:"center",gap:2,children:[t(L,{onClick:p=>u(p,E),variant:"light",children:t(U,{className:s===E?"pause-btn":"preview-song"})}),t(L,{onClick:p=>m(p,_),variant:"light",children:t(U,{className:"move-disk"})})]})]},f)})})}),l("div",{className:"playlist-bottom text-black p-1",children:[t("h5",{children:d("playlist.editor.text.get.more.music")}),t("div",{children:d("playlist.editor.text.you.have.no.songdisks.available")}),t("div",{children:d("playlist.editor.text.you.can.buy.some.from.the.catalogue")}),t("button",{className:"btn btn-primary btn-sm",onClick:()=>h(),children:d("playlist.editor.button.open.catalogue")})]}),t("img",{src:K("image.library.url")+"playlist/background_get_more_music.gif",className:"get-more"})]})},dO=a=>{var g,f;const{furniId:e=-1,playlist:n=null,currentPlayingIndex:r=-1,removeFromPlaylist:o=null,togglePlayPause:s=null}=a,[c,u]=i.useState(-1),m=_=>{c===_&&o(_)},h=(_,E)=>{s(_,E!==-1?E:0)};return l(V,{children:[l("div",{className:"bg-primary py-3 container-fluid justify-content-center d-flex rounded",children:[t("img",{src:K("image.library.url")+"playlist/title_playlist.gif",className:"playlist-img"}),t("h2",{className:"ms-4",children:d("playlist.editor.playlist")})]}),t("div",{className:"h-100 overflow-y-scroll py-2",children:t(w,{column:!0,gap:2,children:n&&n.map((_,E)=>l(w,{gap:1,className:"text-black cursor-pointer "+(c===E?"border border-muted border-2 rounded":"border-2"),alignItems:"center",onClick:()=>u(I=>I===E?-1:E),children:[t(U,{onClick:()=>m(E),className:"disk-2 "+(c===E?"selected-song":""),style:{backgroundColor:c===E?"":Sd(_.songData)}}),_.name]},E))})}),(!n||n.length===0)&&l(V,{children:[l("div",{className:"playlist-bottom text-black p-1 ms-5",children:[t("h5",{children:d("playlist.editor.add.songs.to.your.playlist")}),t("div",{children:d("playlist.editor.text.click.song.to.choose.click.again.to.move")})]}),t("img",{src:K("image.library.url")+"playlist/background_add_songs.gif",className:"add-songs"})]}),n&&n.length>0&&l(V,{children:[r===-1&&t(L,{variant:"success",size:"lg",onClick:()=>h(e,c),children:d("playlist.editor.button.play.now")}),r!==-1&&l(w,{gap:1,children:[t(L,{variant:"danger",onClick:()=>h(e,c),children:t(U,{className:"pause-song"})}),l(w,{column:!0,children:[t(S,{bold:!0,display:"block",children:d("playlist.editor.text.now.playing.in.your.room")}),t(S,{children:((g=n[r])==null?void 0:g.name)+" - "+((f=n[r])==null?void 0:f.creator)})]})]})]})]})},mO=a=>{const{objectId:e=-1,currentPlayingIndex:n=-1,playlist:r=null,diskInventory:o=null,onClose:s=null,togglePlayPause:c=null,removeFromPlaylist:u=null,addToPlaylist:m=null}=aN();return e===-1?null:l(ae,{className:"nitro-playlist-editor-widget",theme:"primary-slim",children:[t(se,{headerText:d("playlist.editor.title"),onCloseClick:s}),t(re,{children:l("div",{className:"d-flex flex-row gap-1 h-100",children:[t("div",{className:"w-50 position-relative overflow-hidden h-100 rounded d-flex flex-column",children:t(uO,{addToPlaylist:m,diskInventory:o})}),t("div",{className:"w-50 position-relative overflow-hidden h-100 rounded d-flex flex-column",children:t(dO,{furniId:e,removeFromPlaylist:u,playlist:r,togglePlayPause:c,currentPlayingIndex:n})})]})})]})},gO=a=>l(U,{fit:!0,position:"absolute",className:"nitro-room-widgets top-0 start-0",children:[t(Fy,{}),t(Gy,{}),t(By,{}),t(Vy,{}),t(Hy,{}),t(jy,{}),t(qy,{}),t(Yy,{}),t(zy,{}),t($y,{}),t(Xy,{}),t(mO,{}),t(Qy,{}),t(eO,{}),t(tO,{}),t(iO,{}),t(lO,{}),t(xy,{}),t(cO,{})]}),hO=a=>{const{isVisible:e=!1,errorResult:n=null,petName:r=null,objectType:o=null,onChangePetName:s=null,onConfirm:c=null,onClose:u=null}=WN();return t(V,{children:e&&l(ae,{className:"nitro-pet-package no-resize",theme:"primary-slim",children:[t(se,{center:!0,headerText:d(o==="gnome_box"?"widgets.gnomepackage.name.title":"furni.petpackage.open"),onCloseClick:()=>u()}),l(re,{children:[l(w,{className:"pet-package-container-top p-3",children:[t("div",{className:`package-image-${o} flex-shrink-0`}),t("div",{className:"m-2",children:t(S,{variant:"white",className:"package-text-big",children:d(o==="gnome_box"?"widgets.gnomepackage.name.title":"furni.petpackage")})})]}),t(w,{className:"pet-package-container-bottom p-2",children:l(T,{gap:1,children:[l(w,{alignItems:"center",className:"bg-white rounded py-1 px-2 input-pet-package-container",children:[t("input",{type:"text",className:"form-control form-control-sm input-pet-package",maxLength:K("pet.package.name.max.length"),placeholder:d(o==="gnome_box"?"widgets.gnomepackage.name.select":"widgets.petpackage.name.title"),value:r,onChange:m=>s(m.target.value)}),t("div",{className:"package-pencil-image flex-shrink-0 small fa-icon"})]}),n.length>0&&t(U,{className:"invalid-feedback d-block m-0",children:n}),l(w,{className:"mt-2",gap:5,display:"flex",justifyContent:"center",alignItems:"center",children:[t(S,{pointer:!0,className:"text-decoration",onClick:()=>u(),children:d("cancel")}),t(zm,{variant:r.length<3?"danger":"success",disabled:r.length<3,onClick:()=>c(),children:d(o==="gnome_box"?"widgets.gnomepackage.name.pick":"furni.petpackage.confirm")})]})]})})]})]})})},fO=a=>{const[e,n]=i.useState("bobba"),[r,o]=i.useState(""),[s,c]=i.useState(!1),{wordsFilter:u=[],isVisible:m=null,setWordsFilter:h,onClose:g=null}=xN(),{navigatorData:f=null}=Ln(),_=C=>{(s?!r:!e)||(M(new tC(f.enteredGuestRoom.roomId,C,s?r:e)),o(""),n("bobba"),c(!1),!(C&&u.includes(s?r:e))&&h(p=>{const b=[...p];return C?b.push(s?r:e):b.splice(b.indexOf(s?r:e),1),b}))},E=C=>{n(C),c(!1)},I=C=>{o(C),c(!0)};return m?l(ae,{className:"nitro-guide-tool no-resize",theme:"primary-slim",children:[t(se,{headerText:d("navigator.roomsettings.roomfilter"),onCloseClick:()=>g()}),l(re,{className:"text-black",children:[l(ne,{className:"d-flex align-items-center justify-content-end gap-2",children:[t("input",{type:"text",className:"form-control form-control-sm",maxLength:255,value:e,onChange:C=>E(C.target.value)}),t(L,{onClick:()=>_(!0),children:d("navigator.roomsettings.roomfilter.addword")})]}),t(T,{overflow:"auto",gap:0,className:"form-control form-control-sm",style:{height:"100px"},children:u&&u.length>0&&u.map((C,p)=>t(w,{alignItems:"center",className:Vt("rounded p-1",r===C&&"bg-muted"),pointer:!0,onClick:b=>I(C),children:t(S,{truncate:!0,children:C})},p))}),t(ne,{className:"d-flex align-items-center justify-content-end gap-2",children:t(L,{variant:"danger",onClick:()=>_(!1),disabled:u.length===0||!s,children:d("navigator.roomsettings.roomfilter.removeword")})})]})]}):null},pO=a=>{const[e,n]=i.useState(!1),{roomSession:r=null}=Ge();ct([Fn.SHOW_THUMBNAIL,Fn.HIDE_THUMBNAIL,Fn.TOGGLE_THUMBNAIL],s=>{switch(s.type){case Fn.SHOW_THUMBNAIL:n(!0);return;case Fn.HIDE_THUMBNAIL:n(!1);return;case Fn.TOGGLE_THUMBNAIL:n(c=>!c);return}});const o=s=>{q().saveTextureAsScreenshot(s,!0),n(!1)};return e?t(Vb,{roomId:r.roomId,textureReceiver:o,onClose:()=>n(!1)}):null},IO=a=>{const[e,n]=i.useState(!1),[r,o]=i.useState(null),[s,c]=i.useState(null),[u,m]=i.useState(null),[h,g]=i.useState(!1),{navigatorData:f=null}=Ln(),{roomSession:_=null}=Ge(),E=(I,C)=>{switch(I){case"settings":ee("navigator/toggle-room-info");return;case"zoom":n(p=>{let b=q().getRoomInstanceRenderingCanvasScale(_.roomId,1);return p?b*=2:b/=2,q().setRoomInstanceRenderingCanvasScale(_.roomId,1,b),!p});return;case"chat_history":ee("chat-history/toggle");return;case"like_room":M(new nC(1));return;case"toggle_room_link":ee("navigator/toggle-room-link");return;case"navigator_search_tag":ee(`navigator/search/${C}`),M(new Es("hotel_view",`tag:${C}`));return}};return x(vs,I=>{const C=I.getParser();!C.roomEnter||C.data.roomId!==_.roomId||(r!==C.data.roomName&&o(C.data.roomName),s!==C.data.ownerName&&c(C.data.ownerName),u!==C.data.tags&&m(C.data.tags))}),i.useEffect(()=>{g(!0);const I=setTimeout(()=>g(!1),5e3);return()=>clearTimeout(I)},[r,s,u]),l(w,{className:"nitro-room-tools-container",gap:2,children:[l(T,{center:!0,className:"nitro-room-tools p-2",children:[t(U,{pointer:!0,title:d("room.settings.button.text"),className:"icon icon-cog",onClick:()=>E("settings")}),t(U,{pointer:!0,title:d("room.zoom.button.text"),onClick:()=>E("zoom"),className:Vt("icon",!e&&"icon-zoom-less",e&&"icon-zoom-more")}),t(U,{pointer:!0,title:d("room.chathistory.button.text"),onClick:()=>E("chat_history"),className:"icon icon-chat-history"}),f.canRate&&t(U,{pointer:!0,title:d("room.like.button.text"),onClick:()=>E("like_room"),className:"icon icon-like-room"})]}),t(T,{justifyContent:"center",children:t(ra,{type:wt.SLIDE_LEFT,inProp:h,timeout:300,children:t(T,{center:!0,children:l(T,{className:"nitro-room-tools-info rounded py-2 px-3",children:[l(T,{gap:1,children:[t(S,{wrap:!0,variant:"white",fontSize:4,children:r}),t(S,{variant:"muted",fontSize:5,children:s})]}),u&&u.length>0&&t(w,{gap:2,children:u.map((I,C)=>l(S,{small:!0,pointer:!0,variant:"white",className:"rounded bg-primary p-1",onClick:()=>E("navigator_search_tag",I),children:["#",I]},C))})]})})})})]})},EO=a=>{const{question:e=null,canVote:n=null,vote:r=null,noVotes:o=null,yesVotes:s=null}=a;return l(T,{gap:2,className:"wordquiz-question p-2",children:[!n&&l(w,{fullWidth:!0,alignItems:"center",gap:2,children:[t(w,{center:!0,pointer:!0,className:"bg-danger rounded p-2",children:t(S,{variant:"white",children:o})}),t(S,{variant:"white",center:!0,textBreak:!0,children:e}),t(w,{center:!0,pointer:!0,className:"bg-success rounded p-2",children:t(S,{variant:"white",children:s})})]}),n&&l(T,{children:[t(S,{variant:"white",center:!0,textBreak:!0,children:e}),l(w,{fullWidth:!0,justifyContent:"center",gap:1,children:[t(w,{center:!0,pointer:!0,className:"bg-danger rounded p-1",onClick:c=>r(Qa),children:t(U,{className:"word-quiz-dislike"})}),t(w,{center:!0,pointer:!0,className:"bg-success rounded p-1",onClick:c=>r(Nd),children:t(U,{className:"word-quiz-like"})})]})]})]})},_O=a=>{const{userIndex:e=null,vote:n=null,...r}=a;return t(ul,{objectId:e,category:Q.UNIT,...r,children:t(w,{center:!0,pointer:!0,className:`bg-${n===Qa?"danger":"success"} rounded p-1`,children:t(U,{className:`word-quiz-${n===Qa?"dislike":"like"}-sm`})})})},CO=a=>{const{question:e=null,answerSent:n=!1,answerCounts:r=null,userAnswers:o=null,vote:s=null}=QN();return l(V,{children:[e&&t(EO,{question:e.content,canVote:!n,vote:s,noVotes:r.get(Qa)||0,yesVotes:r.get(Nd)||0}),o&&Array.from(o.entries()).map(([c,u],m)=>t(_O,{userIndex:c,vote:u.value},m))]})},bO=a=>{const{roomSession:e=null}=Ge(),{simpleAlert:n=null}=Xe();return Te(gi.ROOM_ZOOM,r=>q().setRoomInstanceRenderingCanvasScale(r.roomId,1,r.level,null,null,!1,r.asDelta)),Te([we.REQUEST_TEASER,we.REQUEST_ECOTRONBOX,we.REQUEST_CLOTHING_CHANGE,we.REQUEST_PLAYLIST_EDITOR,we.OPEN_WIDGET,we.CLOSE_WIDGET,ga.FURNI_CLICK,ga.FURNI_DOUBLE_CLICK,ga.TOOLTIP_SHOW,ga.TOOLTIP_HIDE],r=>{if(e)switch(r.objectId,r.category,r.type){}}),Ye([mt.RSEME_KICKED,mt.RSEME_PETS_FORBIDDEN_IN_HOTEL,mt.RSEME_PETS_FORBIDDEN_IN_FLAT,mt.RSEME_MAX_PETS,mt.RSEME_MAX_NUMBER_OF_OWN_PETS,mt.RSEME_NO_FREE_TILES_FOR_PET,mt.RSEME_SELECTED_TILE_NOT_FREE_FOR_PET,mt.RSEME_BOTS_FORBIDDEN_IN_HOTEL,mt.RSEME_BOTS_FORBIDDEN_IN_FLAT,mt.RSEME_BOT_LIMIT_REACHED,mt.RSEME_SELECTED_TILE_NOT_FREE_FOR_BOT,mt.RSEME_BOT_NAME_NOT_ACCEPTED],r=>{let o=d("error.title"),s="";switch(r.type){case mt.RSEME_MAX_PETS:s=d("room.error.max_pets");break;case mt.RSEME_MAX_NUMBER_OF_OWN_PETS:s=d("room.error.max_own_pets");break;case mt.RSEME_KICKED:s=d("room.error.kicked"),o=d("generic.alert.title");break;case mt.RSEME_PETS_FORBIDDEN_IN_HOTEL:s=d("room.error.pets.forbidden_in_hotel");break;case mt.RSEME_PETS_FORBIDDEN_IN_FLAT:s=d("room.error.pets.forbidden_in_flat");break;case mt.RSEME_NO_FREE_TILES_FOR_PET:s=d("room.error.pets.no_free_tiles");break;case mt.RSEME_SELECTED_TILE_NOT_FREE_FOR_PET:s=d("room.error.pets.selected_tile_not_free");break;case mt.RSEME_BOTS_FORBIDDEN_IN_HOTEL:s=d("room.error.bots.forbidden_in_hotel");break;case mt.RSEME_BOTS_FORBIDDEN_IN_FLAT:s=d("room.error.bots.forbidden_in_flat");break;case mt.RSEME_BOT_LIMIT_REACHED:s=d("room.error.max_bots");break;case mt.RSEME_SELECTED_TILE_NOT_FREE_FOR_BOT:s=d("room.error.bots.selected_tile_not_free");break;case mt.RSEME_BOT_NAME_NOT_ACCEPTED:s=d("room.error.bots.name.not.accepted");break;default:return}n(s,de.DEFAULT,null,null,o)}),l(V,{children:[t(Iy,{}),t(Ny,{}),t(_y,{}),t(wy,{}),t(gO,{}),t(IO,{}),t(fO,{}),t(pO,{}),t(Ty,{}),t(hO,{}),t(vy,{}),t(CO,{}),t(yy,{})]})},SO=a=>{const{roomSession:e=null}=Ge(),n=i.useRef();return i.useEffect(()=>{const r=_e().application.renderer.view;if(!r)return;r.onclick=s=>Ia(s),r.onmousemove=s=>Ia(s),r.onmousedown=s=>Ia(s),r.onmouseup=s=>Ia(s),r.ontouchstart=s=>Ca(s),r.ontouchmove=s=>Ca(s),r.ontouchend=s=>Ca(s),r.ontouchcancel=s=>Ca(s);const o=n.current;o&&o.appendChild(r)},[]),t(U,{fit:!0,innerRef:n,className:!e&&"d-none",children:e&&l(V,{children:[t(bO,{}),e.isSpectator&&t(zR,{})]})})},NO=a=>{const{useGuideTool:e=!1,unseenAchievementCount:n=0,setMeExpanded:r=null,children:o=null,...s}=a,c=i.useRef();return i.useEffect(()=>{const u=Oe();u&&q().selectRoomObject(u.roomId,u.ownRoomIndex,Q.UNIT)},[]),i.useEffect(()=>{const u=m=>r(!1);return document.addEventListener("click",u),()=>document.removeEventListener(ye.MOUSE_CLICK,u)},[r]),l(w,{innerRef:c,alignItems:"center",className:"nitro-toolbar-me p-2",gap:2,children:[K("guides.enabled")&&e&&t(U,{pointer:!0,className:"navigation-item icon icon-me-helper-tool",onClick:u=>St(new Ht(Ht.TOGGLE_GUIDE_TOOL))}),t(U,{pointer:!0,className:"navigation-item icon icon-me-achievements",onClick:u=>ee("achievements/toggle"),children:n>0&&t(Rr,{count:n})}),t(U,{pointer:!0,className:"navigation-item icon icon-me-profile",onClick:u=>Jt(H().userId)}),t(U,{pointer:!0,className:"navigation-item icon icon-me-rooms",onClick:u=>ee("navigator/search/myworld_view")}),t(U,{pointer:!0,className:"navigation-item icon icon-me-clothing",onClick:u=>ee("avatar-editor/toggle")}),t(U,{pointer:!0,className:"navigation-item icon icon-me-settings",onClick:u=>ee("user-settings/toggle")}),o]})},TO=a=>{const{isInRoom:e}=a,[n,r]=i.useState(!1),[o,s]=i.useState(!1),{userFigure:c=null}=_r(),{getFullCount:u=0}=bn(),{getTotalUnseen:m=0}=fo(),{requests:h=[]}=gn(),{iconState:g=Wn.HIDDEN}=Vd(),f=H().isModerator;return x(Bu,_=>{const E=_.getParser();s(E.isAllowed(Gu.USE_GUIDE_TOOL))}),Te(rC.ANIMATE_ICON,_=>{((I,C,p,b)=>{const N=document.body.getElementsByClassName(I)[0];if(!N)return;C.className="toolbar-icon-animation",C.style.visibility="visible",C.style.left=p+"px",C.style.top=b+"px",document.body.append(C);const v=N.getBoundingClientRect(),O=C.getBoundingClientRect(),R=O.x-v.x,y=O.y-v.y,F=Math.sqrt(R*R+y*y),P=500-Math.abs(1/F*100*500*.5),D=20,A=`ToolbarBouncing[${I}]`;xo.getMotionByTag(A)||(xo.runMotion(new Dl(new sC(P+8),new aC(N,400,12))).tag=A);const k=new Dl(new oC(new iC(C,P,v.x-O.x+D,v.y-O.y,100,1),1),new lC(C));xo.runMotion(k)})("icon-inventory",_.image,_.x,_.y)}),l(V,{children:[t(ra,{type:wt.FADE_IN,inProp:n,timeout:300,children:t(NO,{useGuideTool:o,unseenAchievementCount:m,setMeExpanded:r})}),l(w,{alignItems:"center",justifyContent:"between",gap:2,className:"nitro-toolbar py-1 px-3",children:[l(w,{gap:2,alignItems:"center",children:[l(w,{alignItems:"center",gap:2,children:[l(w,{center:!0,pointer:!0,className:"navigation-item item-avatar "+(n?"active ":""),onClick:_=>r(!n),children:[t(st,{figure:c,direction:2,position:"absolute"}),m>0&&t(Rr,{count:m})]}),e&&t(U,{pointer:!0,className:"navigation-item icon icon-habbo",onClick:_=>Vi()}),!e&&t(U,{pointer:!0,className:"navigation-item icon icon-house",onClick:_=>ee("navigator/goto/home")}),t(U,{pointer:!0,className:"navigation-item icon icon-rooms",onClick:_=>ee("navigator/toggle")}),K("game.center.enabled")&&t(U,{pointer:!0,className:"navigation-item icon icon-game",onClick:_=>ee("games/toggle")}),t(U,{pointer:!0,className:"navigation-item icon icon-catalog",onClick:_=>ee("catalog/toggle")}),t(U,{pointer:!0,className:"navigation-item icon icon-inventory",onClick:_=>ee("inventory/toggle"),children:u>0&&t(Rr,{count:u})}),e&&t(U,{pointer:!0,className:"navigation-item icon icon-camera",onClick:_=>ee("camera/toggle")}),f&&t(U,{pointer:!0,className:"navigation-item icon icon-modtools",onClick:_=>ee("mod-tools/toggle")})]}),t(w,{alignItems:"center",id:"toolbar-chat-input-container"})]}),l(w,{alignItems:"center",gap:2,children:[l(w,{gap:2,children:[t(U,{pointer:!0,className:"navigation-item icon icon-friendall",onClick:_=>ee("friends/toggle"),children:h.length>0&&t(Rr,{count:h.length})}),(g===Wn.SHOW||g===Wn.UNREAD)&&t(U,{pointer:!0,className:`navigation-item icon icon-message ${g===Wn.UNREAD&&"is-unseen"}`,onClick:_=>co()})]}),t(U,{id:"toolbar-friend-bar-container",className:"d-none d-lg-block"})]})]})]})},vO=a=>{const{badges:e=null,gap:n=1,justifyContent:r="between",...o}=a;return t(V,{children:e&&e.length>0&&e.map((s,c)=>t(T,{center:!0,children:t(je,{badgeCode:s},s)},s))})},wO=a=>{const{relationships:e=null}=a,n=({type:r})=>{const o=e&&e.relationshipStatusMap.hasKey(r)?e.relationshipStatusMap.getValue(r):null,s=xn.RELATIONSHIP_NAMES[r].toLocaleLowerCase();return l(w,{fullWidth:!0,gap:1,children:[t(w,{center:!0,className:"user-relationship",children:t("i",{className:`nitro-friends-spritesheet icon-${s}`})}),l(T,{grow:!0,gap:0,children:[l(w,{alignItems:"center",justifyContent:"between",className:"bg-white rounded px-2 py-1 user-relationship",children:[l(S,{small:!0,underline:!0,pointer:!0,onClick:c=>o&&o.randomFriendId>=1&&Jt(o.randomFriendId),children:[(!o||o.friendCount===0)&&d("extendedprofile.add.friends"),o&&o.friendCount>=1&&o.randomFriendName]}),o&&o.friendCount>=1&&t(w,{center:!0,position:"relative",className:"avatar-image-container",children:t(st,{figure:o.randomFriendFigure,headOnly:!0,direction:4})})]}),l(S,{small:!0,italics:!0,className:"user-relationship-count",children:[(!o||o.friendCount===0)&&d("extendedprofile.no.friends.in.this.category"),o&&o.friendCount>1&&d(`extendedprofile.relstatus.others.${s}`,["count"],[(o.friendCount-1).toString()])," "]})]})]})};return l(V,{children:[t(n,{type:xn.HEART}),t(n,{type:xn.SMILE}),t(n,{type:xn.BOBBA})]})},RO=a=>{const{relationships:e=null,friendsCount:n=null}=a;return l(T,{gap:1,children:[l(S,{small:!0,children:[t("b",{children:d("extendedprofile.friends.count")})," ",n]}),t(S,{bold:!0,small:!0,children:d("extendedprofile.relstatus")}),t(T,{children:t(wO,{relationships:e})})]})},yO=a=>{const{itsMe:e=null,groups:n=null,onLeaveGroup:r=null,overflow:o="hidden",gap:s=2,...c}=a,[u,m]=i.useState(null),[h,g]=i.useState(null);return x(Xs,f=>{const _=f.getParser();!u||u!==_.id||_.flag||g(_)}),i.useEffect(()=>{u&&M(new Fs(u,!1))},[u]),i.useEffect(()=>{g(null),n.length>0&&m(f=>(f===n[0].groupId&&M(new Fs(n[0].groupId,!1)),n[0].groupId))},[n]),!n||!n.length?t(T,{center:!0,fullHeight:!0,children:l(w,{justifyContent:"center",gap:2,children:[t(U,{className:"no-group-spritesheet image-1"}),t(U,{className:"no-group-spritesheet image-2"}),t(U,{className:"no-group-spritesheet image-3"})]})}):l(ne,{overflow:o,gap:2,...c,children:[t(T,{alignItems:"center",size:2,overflow:"auto",children:t(Ue,{overflow:null,columnCount:1,columnMinHeight:50,className:"user-groups-container",children:n.map((f,_)=>l(be,{overflow:"unset",itemActive:u===f.groupId,onClick:()=>m(f.groupId),className:"p-1",children:[e&&t("i",{className:"position-absolute end-0 top-0 z-index-1 icon icon-group-"+(f.favourite?"favorite":"not-favorite"),onClick:()=>hb(f)}),t(je,{badgeCode:f.badgeCode,isGroup:!0})]},_))})}),t(T,{size:10,overflow:"hidden",children:h&&t(mm,{groupInformation:h,onClose:r})})]})},OO=a=>{const{userProfile:e=null}=a,[n,r]=i.useState(e.requestSent),o=e.id===H().userId,s=!n&&!o&&!e.isMyFriend&&!e.requestSent,c=()=>{r(!0),M(new Nu(e.username))};return i.useEffect(()=>{r(e.requestSent)},[e]),l(w,{gap:2,children:[t(T,{center:!0,className:"avatar-container",children:t(st,{figure:e.figure,direction:2})}),l(T,{children:[l(T,{gap:0,children:[t(S,{bold:!0,children:e.username}),l(S,{italics:!0,textBreak:!0,small:!0,children:[e.motto," "]})]}),l(T,{gap:1,children:[l(S,{small:!0,children:[t("b",{children:d("extendedprofile.created")})," ",e.registration]}),l(S,{small:!0,children:[t("b",{children:d("extendedprofile.last.login")})," ",Hn.format(e.secondsSinceLastVisit,".ago",2)]}),l(S,{small:!0,children:[t("b",{children:d("extendedprofile.achievementscore")})," ",e.achievementPoints]})]}),l(w,{gap:1,children:[e.isOnline&&t("i",{className:"icon icon-pf-online"}),!e.isOnline&&t("i",{className:"icon icon-pf-offline"}),l(w,{alignItems:"center",gap:1,children:[s&&t(S,{small:!0,underline:!0,pointer:!0,onClick:c,children:d("extendedprofile.addasafriend")}),!s&&l(V,{children:[t("i",{className:"icon icon-pf-tick"}),o&&t(S,{children:d("extendedprofile.me")}),e.isMyFriend&&t(S,{children:d("extendedprofile.friend")}),(n||e.requestSent)&&t(S,{children:d("extendedprofile.friendrequestsent")})]})]})]})]})]})},AO=a=>{const[e,n]=i.useState(null),[r,o]=i.useState([]),[s,c]=i.useState(null),u=()=>{n(null),o([]),c(null)},m=()=>{!e||e.id!==H().userId||Jt(e.id)};return x(cC,h=>{const g=h.getParser();!e||g.userId!==e.id||o(g.badges)}),x(zu,h=>{const g=h.getParser();!e||g.userId!==e.id||c(g)}),x(dC,h=>{const g=h.getParser();let f=!1;n(_=>(_&&_.id&&(f=_.id===g.id),g)),f||(o([]),c(null)),M(new uC(g.id)),M(new $u(g.id))}),x(mC,h=>{const g=h.getParser();g.userId==(e==null?void 0:e.id)&&Jt(g.userId)}),Te(pt.SELECTED,h=>{if(!e||h.category!==Q.UNIT)return;const g=Oe().userDataManager.getUserDataByIndex(h.objectId);g.type===ht.USER&&Jt(g.webID)}),e?l(ae,{uniqueKey:"nitro-user-profile",theme:"primary-slim",className:"user-profile",children:[t(se,{headerText:d("extendedprofile.caption"),onCloseClick:u}),l(re,{overflow:"hidden",children:[l(ne,{fullHeight:!1,gap:2,children:[l(T,{size:7,gap:1,className:"user-container pe-2",children:[t(OO,{userProfile:e}),t(ne,{columnCount:5,fullHeight:!0,className:"bg-muted rounded px-2 py-1",children:t(vO,{fullWidth:!0,center:!0,badges:r})})]}),t(T,{size:5,children:s&&t(RO,{relationships:s,friendsCount:e.friendsCount})})]}),t(w,{alignItems:"center",className:"rooms-button-container px-2 py-1",children:l(w,{alignItems:"center",gap:1,onClick:h=>ee(`navigator/search/hotel_view/owner:${e.username}`),children:[t("i",{className:"icon icon-rooms"}),t(S,{bold:!0,underline:!0,pointer:!0,children:d("extendedprofile.rooms")})]})}),t(yO,{fullWidth:!0,itsMe:e.id===H().userId,groups:e.groups,onLeaveGroup:m})]})]}):null},kO=a=>{const[e,n]=i.useState(!1),[r,o]=i.useState(null),[s,c]=Gd(),[u,m]=Bd(),[h,g]=Kd(),f=(E,I)=>{let C=!0;const p=r.clone();switch(E){case"close_view":n(!1),C=!1;return;case"oldchat":p.oldChat=I,M(new fC(p.oldChat));break;case"room_invites":p.roomInvites=I,M(new hC(p.roomInvites));break;case"camera_follow":p.cameraFollow=I,M(new gC(p.cameraFollow));break;case"system_volume":p.volumeSystem=I,p.volumeSystem=Math.max(0,p.volumeSystem),p.volumeSystem=Math.min(100,p.volumeSystem);break;case"furni_volume":p.volumeFurni=I,p.volumeFurni=Math.max(0,p.volumeFurni),p.volumeFurni=Math.min(100,p.volumeFurni);break;case"trax_volume":p.volumeTrax=I,p.volumeTrax=Math.max(0,p.volumeTrax),p.volumeTrax=Math.min(100,p.volumeTrax);break}C&&o(p),Ii(p)},_=E=>{switch(E){case"volume":M(new pC(Math.round(r.volumeSystem),Math.round(r.volumeFurni),Math.round(r.volumeTrax)));break}};return x(Mu,E=>{const I=E.getParser(),C=new IC;C.volumeSystem=I.volumeSystem,C.volumeFurni=I.volumeFurni,C.volumeTrax=I.volumeTrax,C.oldChat=I.oldChat,C.roomInvites=I.roomInvites,C.cameraFollow=I.cameraFollow,C.flags=I.flags,C.chatType=I.chatType,o(C),Ii(C)}),i.useEffect(()=>{const E={linkReceived:I=>{const C=I.split("/");if(!(C.length<2))switch(C[1]){case"show":n(!0);return;case"hide":n(!1);return;case"toggle":n(p=>!p);return}},eventUrlPrefix:"user-settings/"};return _t(E),()=>Ct(E)},[]),i.useEffect(()=>{r&&St(r)},[r]),!e||!r?null:l(ae,{uniqueKey:"user-settings",className:"user-settings-window",theme:"primary-slim",children:[t(se,{headerText:d("widget.memenu.settings.title"),onCloseClick:E=>f("close_view")}),l(re,{className:"text-black",children:[l(T,{gap:1,children:[l(w,{alignItems:"center",gap:1,children:[t("input",{className:"form-check-input",type:"checkbox",checked:r.oldChat,onChange:E=>f("oldchat",E.target.checked)}),t(S,{children:d("memenu.settings.chat.prefer.old.chat")})]}),l(w,{alignItems:"center",gap:1,children:[t("input",{className:"form-check-input",type:"checkbox",checked:r.roomInvites,onChange:E=>f("room_invites",E.target.checked)}),t(S,{children:d("memenu.settings.other.ignore.room.invites")})]}),l(w,{alignItems:"center",gap:1,children:[t("input",{className:"form-check-input",type:"checkbox",checked:r.cameraFollow,onChange:E=>f("camera_follow",E.target.checked)}),t(S,{children:d("memenu.settings.other.disable.room.camera.follow")})]}),l(w,{alignItems:"center",gap:1,children:[t("input",{className:"form-check-input",type:"checkbox",checked:s,onChange:E=>c(E.target.checked)}),t(S,{children:d("memenu.settings.other.place.multiple.objects")})]}),l(w,{alignItems:"center",gap:1,children:[t("input",{className:"form-check-input",type:"checkbox",checked:u,onChange:E=>m(E.target.checked)}),t(S,{children:d("memenu.settings.other.skip.purchase.confirmation")})]}),l(w,{alignItems:"center",gap:1,children:[t("input",{className:"form-check-input",type:"checkbox",checked:h,onChange:E=>g(E.target.checked)}),t(S,{children:d("memenu.settings.other.skip.translate.user.message")})]})]}),l(T,{children:[t(S,{bold:!0,children:d("widget.memenu.settings.volume")}),l(T,{gap:1,children:[t(S,{children:d("widget.memenu.settings.volume.ui")}),l(w,{alignItems:"center",gap:1,children:[r.volumeSystem===0&&t(To,{className:Vt(r.volumeSystem>=50&&"text-muted","fa-icon")}),r.volumeSystem>0&&t(vo,{className:Vt(r.volumeSystem>=50&&"text-muted","fa-icon")}),t("input",{type:"range",className:"custom-range w-100",min:"0",max:"100",step:"1",id:"volumeSystem",value:r.volumeSystem,onChange:E=>f("system_volume",E.target.value),onMouseUp:()=>_("volume")}),t(wo,{className:Vt(r.volumeSystem<50&&"text-muted","fa-icon")})]})]}),l(T,{gap:1,children:[t(S,{children:d("widget.memenu.settings.volume.furni")}),l(w,{alignItems:"center",gap:1,children:[r.volumeFurni===0&&t(To,{className:Vt(r.volumeFurni>=50&&"text-muted","fa-icon")}),r.volumeFurni>0&&t(vo,{className:Vt(r.volumeFurni>=50&&"text-muted","fa-icon")}),t("input",{type:"range",className:"custom-range w-100",min:"0",max:"100",step:"1",id:"volumeFurni",value:r.volumeFurni,onChange:E=>f("furni_volume",E.target.value),onMouseUp:()=>_("volume")}),t(wo,{className:Vt(r.volumeFurni<50&&"text-muted","fa-icon")})]})]}),l(T,{gap:1,children:[t(S,{children:d("widget.memenu.settings.volume.trax")}),l(w,{alignItems:"center",gap:1,children:[r.volumeTrax===0&&t(To,{className:Vt(r.volumeTrax>=50&&"text-muted","fa-icon")}),r.volumeTrax>0&&t(vo,{className:Vt(r.volumeTrax>=50&&"text-muted","fa-icon")}),t("input",{type:"range",className:"custom-range w-100",min:"0",max:"100",step:"1",id:"volumeTrax",value:r.volumeTrax,onChange:E=>f("trax_volume",E.target.value),onMouseUp:()=>_("volume")}),t(wo,{className:Vt(r.volumeTrax<50&&"text-muted","fa-icon")})]})]})]})]})]})},PO=a=>{const{trigger:e=null,furniIds:n=[]}=ve();return l(T,{gap:1,children:[t(S,{bold:!0,children:d("wiredfurni.pickfurnis.caption",["count","limit"],[n.length.toString(),e.maximumItemSelectionCount.toString()])}),t(S,{small:!0,children:d("wiredfurni.pickfurnis.desc")})]})},dl=a=>{const{wiredType:e="",requiresFurni:n=ie.STUFF_SELECTION_OPTION_NONE,save:r=null,validate:o=null,children:s=null,hasSpecialInput:c=!1}=a,[u,m]=i.useState(null),[h,g]=i.useState(null),[f,_]=i.useState(!1),{trigger:E=null,setTrigger:I=null,setIntParams:C=null,setStringParam:p=null,setFurniIds:b=null,setAllowsFurni:N=null,saveWired:v=null}=ve(),O=()=>I(null),R=()=>{o&&!o()||(r&&r(),_(!0))};return i.useEffect(()=>{f&&(v(),_(!1))},[f,v]),i.useEffect(()=>{if(!E)return;const y=E.spriteId||-1,F=H().getFloorItemData(y);F?(m(F.name),g(F.description)):(m("NAME: "+y),g("NAME: "+y)),c&&(C(E.intData),p(E.stringData)),n>ie.STUFF_SELECTION_OPTION_NONE&&b(P=>(P&&P.length&&ps.clearSelectionShaderFromFurni(P),E.selectedItems&&E.selectedItems.length?(ps.applySelectionShaderToFurni(E.selectedItems),E.selectedItems):[])),N(n)},[E,c,n,C,p,b,N]),l(ae,{uniqueKey:"nitro-wired",className:"nitro-wired",theme:"primary-slim",children:[t(se,{headerText:d("wiredfurni.title"),onCloseClick:O}),l(re,{children:[l(T,{gap:1,children:[l(w,{alignItems:"center",gap:1,children:[t("i",{className:`icon icon-wired-${e}`}),t(S,{bold:!0,children:u})]}),t(S,{small:!0,children:h})]}),!!s&&t("hr",{className:"m-0 bg-dark"}),s,n>ie.STUFF_SELECTION_OPTION_NONE&&l(V,{children:[t("hr",{className:"m-0 bg-dark"}),t(PO,{})]}),l(w,{alignItems:"center",gap:1,children:[t(L,{fullWidth:!0,variant:"success",onClick:R,children:d("wiredfurni.ready")}),t(L,{fullWidth:!0,variant:"secondary",onClick:O,children:d("cancel")})]})]})]})},dt=a=>{const{requiresFurni:e=ie.STUFF_SELECTION_OPTION_NONE,save:n=null,hasSpecialInput:r=!1,children:o=null}=a,{trigger:s=null,actionDelay:c=0,setActionDelay:u=null}=ve();return i.useEffect(()=>{u(s.delayInPulses)},[s,u]),l(dl,{wiredType:"action",requiresFurni:e,save:n,hasSpecialInput:r,children:[o,!!o&&t("hr",{className:"m-0 bg-dark"}),l(T,{children:[t(S,{bold:!0,children:d("wiredfurni.params.delay",["seconds"],[na(c)])}),t(Dt,{className:"nitro-slider",min:0,max:20,value:c,onChange:m=>u(m)})]})]})},DO="hd-180-1.ch-210-66.lg-270-82.sh-290-81",MO=a=>{const[e,n]=i.useState(""),[r,o]=i.useState(""),{trigger:s=null,setStringParam:c=null}=ve(),u=()=>c(e+Ts+r);return i.useEffect(()=>{const m=s.stringData.split(Ts);m.length>0&&n(m[0]),m.length>1&&o(m[1].length>0?m[1]:DO)},[s]),l(dt,{requiresFurni:ie.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!0,save:u,children:[l(T,{gap:1,children:[t(S,{bold:!0,children:d("wiredfurni.params.bot.name")}),t("input",{type:"text",className:"form-control form-control-sm",maxLength:32,value:e,onChange:m=>n(m.target.value)})]}),l(w,{center:!0,children:[t(st,{figure:r,direction:4}),t(L,{onClick:m=>o(H().figure),children:d("wiredfurni.params.capture.figure")})]})]})},LO=a=>{const[e,n]=i.useState(""),[r,o]=i.useState(-1),{trigger:s=null,setStringParam:c=null,setIntParams:u=null}=ve(),m=()=>{c(e),u([r])};return i.useEffect(()=>{n(s.stringData),o(s.intData.length>0?s.intData[0]:0)},[s]),l(dt,{requiresFurni:ie.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!0,save:m,children:[l(T,{gap:1,children:[t(S,{bold:!0,children:d("wiredfurni.params.bot.name")}),t("input",{type:"text",className:"form-control form-control-sm",maxLength:32,value:e,onChange:h=>n(h.target.value)})]}),l(T,{gap:1,children:[l(w,{alignItems:"center",gap:1,children:[t("input",{className:"form-check-input",type:"radio",name:"followMode",id:"followMode1",checked:r===1,onChange:h=>o(1)}),t(S,{children:d("wiredfurni.params.start.following")})]}),l(w,{alignItems:"center",gap:1,children:[t("input",{className:"form-check-input",type:"radio",name:"followMode",id:"followMode2",checked:r===0,onChange:h=>o(0)}),t(S,{children:d("wiredfurni.params.stop.following")})]})]})]})},UO=[2,5,7,8,9,10,27],xO=a=>{const[e,n]=i.useState(""),[r,o]=i.useState(-1),{trigger:s=null,setStringParam:c=null,setIntParams:u=null}=ve(),m=()=>{c(e),u([r])};return i.useEffect(()=>{n(s.stringData),o(s.intData.length>0?s.intData[0]:0)},[s]),l(dt,{requiresFurni:ie.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!0,save:m,children:[l(T,{gap:1,children:[t(S,{bold:!0,children:d("wiredfurni.params.bot.name")}),t("input",{type:"text",className:"form-control form-control-sm",maxLength:32,value:e,onChange:h=>n(h.target.value)})]}),l(T,{gap:1,children:[t(S,{bold:!0,children:d("wiredfurni.params.handitem")}),l("select",{className:"form-select form-select-sm",value:r,onChange:h=>o(parseInt(h.target.value)),children:[t("option",{value:"0",children:"------"}),UO.map(h=>t("option",{value:h,children:d(`handitem${h}`)},h))]})]})]})},FO=a=>{const[e,n]=i.useState(""),{trigger:r=null,setStringParam:o=null}=ve(),s=()=>o(e);return i.useEffect(()=>{n(r.stringData)},[r]),t(dt,{requiresFurni:ie.STUFF_SELECTION_OPTION_BY_ID,hasSpecialInput:!0,save:s,children:l(T,{gap:1,children:[t(S,{bold:!0,children:d("wiredfurni.params.bot.name")}),t("input",{type:"text",className:"form-control form-control-sm",maxLength:32,value:e,onChange:c=>n(c.target.value)})]})})},GO=a=>{const[e,n]=i.useState(""),[r,o]=i.useState(""),[s,c]=i.useState(-1),{trigger:u=null,setStringParam:m=null,setIntParams:h=null}=ve(),g=()=>{m(e+Ts+r),h([s])};return i.useEffect(()=>{const f=u.stringData.split(Ts);f.length>0&&n(f[0]),f.length>1&&o(f[1].length>0?f[1]:""),c(u.intData.length>0?u.intData[0]:0)},[u]),l(dt,{requiresFurni:ie.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!0,save:g,children:[l(T,{gap:1,children:[t(S,{bold:!0,children:d("wiredfurni.params.bot.name")}),t("input",{type:"text",className:"form-control form-control-sm",maxLength:32,value:e,onChange:f=>n(f.target.value)})]}),l(T,{gap:1,children:[t(S,{bold:!0,children:d("wiredfurni.params.message")}),t("input",{type:"text",className:"form-control form-control-sm",maxLength:K("wired.action.bot.talk.to.avatar.max.length",64),value:r,onChange:f=>o(f.target.value)})]}),l(T,{gap:1,children:[l(w,{alignItems:"center",gap:1,children:[t("input",{className:"form-check-input",type:"radio",name:"talkMode",id:"talkMode1",checked:s===0,onChange:f=>c(0)}),t(S,{children:d("wiredfurni.params.talk")})]}),l(w,{alignItems:"center",gap:1,children:[t("input",{className:"form-check-input",type:"radio",name:"talkMode",id:"talkMode2",checked:s===1,onChange:f=>c(1)}),t(S,{children:d("wiredfurni.params.whisper")})]})]})]})},BO=a=>{const[e,n]=i.useState(""),[r,o]=i.useState(""),[s,c]=i.useState(-1),{trigger:u=null,setStringParam:m=null,setIntParams:h=null}=ve(),g=()=>{m(e+Ts+r),h([s])};return i.useEffect(()=>{const f=u.stringData.split(Ts);f.length>0&&n(f[0]),f.length>1&&o(f[1].length>0?f[1]:""),c(u.intData.length>0?u.intData[0]:0)},[u]),l(dt,{requiresFurni:ie.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!0,save:g,children:[l(T,{gap:1,children:[t(S,{bold:!0,children:d("wiredfurni.params.bot.name")}),t("input",{type:"text",className:"form-control form-control-sm",maxLength:32,value:e,onChange:f=>n(f.target.value)})]}),l(T,{gap:1,children:[t(S,{bold:!0,children:d("wiredfurni.params.message")}),t("input",{type:"text",className:"form-control form-control-sm",maxLength:K("wired.action.bot.talk.max.length",64),value:r,onChange:f=>o(f.target.value)})]}),l(T,{gap:1,children:[l(w,{alignItems:"center",gap:1,children:[t("input",{className:"form-check-input",type:"radio",name:"talkMode",id:"talkMode1",checked:s===0,onChange:f=>c(0)}),t(S,{children:d("wiredfurni.params.talk")})]}),l(w,{alignItems:"center",gap:1,children:[t("input",{className:"form-check-input",type:"radio",name:"talkMode",id:"talkMode2",checked:s===1,onChange:f=>c(1)}),t(S,{children:d("wiredfurni.params.shout")})]})]})]})},VO=a=>{const[e,n]=i.useState(""),{trigger:r=null,setStringParam:o=null}=ve(),s=()=>o(e);return i.useEffect(()=>{n(r.stringData)},[r]),t(dt,{requiresFurni:ie.STUFF_SELECTION_OPTION_BY_ID,hasSpecialInput:!0,save:s,children:l(T,{gap:1,children:[t(S,{bold:!0,children:d("wiredfurni.params.bot.name")}),t("input",{type:"text",className:"form-control form-control-sm",maxLength:32,value:e,onChange:c=>n(c.target.value)})]})})},HO=a=>t(dt,{requiresFurni:ie.STUFF_SELECTION_OPTION_BY_ID_BY_TYPE_OR_FROM_CONTEXT,hasSpecialInput:!1,save:null}),WO=a=>t(dt,{requiresFurni:ie.STUFF_SELECTION_OPTION_BY_ID_BY_TYPE_OR_FROM_CONTEXT,hasSpecialInput:!1,save:null}),jO=a=>{const[e,n]=i.useState(""),{trigger:r=null,setStringParam:o=null}=ve(),s=()=>o(e);return i.useEffect(()=>{n(r.stringData)},[r]),t(dt,{requiresFurni:ie.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!0,save:s,children:l(T,{gap:1,children:[t(S,{bold:!0,children:d("wiredfurni.params.message")}),t("input",{type:"text",className:"form-control form-control-sm",value:e,onChange:c=>n(c.target.value),maxLength:K("wired.action.chat.max.length",100)})]})})},qO=a=>t(dt,{requiresFurni:ie.STUFF_SELECTION_OPTION_BY_ID_BY_TYPE_OR_FROM_CONTEXT,hasSpecialInput:!1,save:null}),YO=a=>{const[e,n]=i.useState(!1),[r,o]=i.useState(1),[s,c]=i.useState(!1),[u,m]=i.useState(1),[h,g]=i.useState(1),[f,_]=i.useState([]),{trigger:E=null,setIntParams:I=null,setStringParam:C=null}=ve(),p=()=>_(O=>[...O,{isBadge:!1,itemCode:"",probability:null}]),b=O=>{_(R=>{const y=Array.from(R);return y.splice(O,1),y})},N=(O,R,y,F)=>{const P=Array.from(f),D=P[O];D&&(D.isBadge=R,D.itemCode=y,D.probability=F,_(P))},v=()=>{let O=[];for(const R of f){if(!R.itemCode)continue;const y=[R.isBadge?"0":"1",R.itemCode,R.probability.toString()];O.push(y.join(","))}O.length>0&&(C(O.join(";")),I([r,s?1:0,u,h]))};return i.useEffect(()=>{const O=[];if(E.stringData.length>0&&E.stringData.includes(";")){const R=E.stringData.split(";");for(const y of R){const F=y.split(",");F.length===3&&O.push({isBadge:F[0]==="0",itemCode:F[1],probability:Number(F[2])})}}O.length===0&&O.push({isBadge:!1,itemCode:"",probability:null}),o(E.intData.length>0?E.intData[0]:0),c(E.intData.length>1?E.intData[1]===1:!1),m(E.intData.length>2?E.intData[2]:0),g(E.intData.length>3?E.intData[3]:0),n(E.intData.length>3?E.intData[3]>0:!1),_(O)},[E]),l(dt,{requiresFurni:ie.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!0,save:v,children:[l(w,{alignItems:"center",gap:1,children:[t("input",{className:"form-check-input",type:"checkbox",id:"limitEnabled",onChange:O=>n(O.target.checked)}),t(S,{children:d("wiredfurni.params.prizelimit",["amount"],[e?u.toString():""])})]}),!e&&t(S,{center:!0,small:!0,className:"bg-muted rounded p-1",children:"Reward limit not set. Make sure rewards are badges or non-tradeable items."}),e&&t(Dt,{className:"nitro-slider",min:1,max:1e3,value:u,onChange:O=>m(O)}),t("hr",{className:"m-0 bg-dark"}),l(T,{gap:1,children:[t(S,{bold:!0,children:"How often can a user be rewarded?"}),l(w,{gap:1,children:[l("select",{className:"form-select form-select-sm w-100",value:r,onChange:O=>o(Number(O.target.value)),children:[t("option",{value:"0",children:"Once"}),l("option",{value:"3",children:["Once every ",h," minutes"]}),l("option",{value:"2",children:["Once every ",h," hours"]}),l("option",{value:"1",children:["Once every ",h," days"]})]}),r>0&&t("input",{type:"number",className:"form-control form-control-sm",value:h,onChange:O=>g(Number(O.target.value))})]})]}),t("hr",{className:"m-0 bg-dark"}),l(w,{alignItems:"center",gap:1,children:[t("input",{className:"form-check-input",type:"checkbox",id:"uniqueRewards",checked:s,onChange:O=>c(O.target.checked)}),t(S,{children:"Unique rewards"})]}),t(S,{center:!0,small:!0,className:"bg-muted rounded p-1",children:"If checked each reward will be given once to each user. This will disable the probabilities option."}),t("hr",{className:"m-0 bg-dark"}),l(w,{justifyContent:"between",alignItems:"center",children:[t(S,{bold:!0,children:"Rewards"}),t(L,{variant:"success",onClick:p,children:t(zs,{className:"fa-icon"})})]}),t(T,{gap:1,children:f&&f.map((O,R)=>l(w,{gap:1,children:[l(w,{alignItems:"center",gap:1,children:[t("input",{className:"form-check-input",type:"checkbox",checked:O.isBadge,onChange:y=>N(R,y.target.checked,O.itemCode,O.probability)}),t(S,{small:!0,children:"Badge?"})]}),t("input",{type:"text",className:"form-control form-control-sm",value:O.itemCode,onChange:y=>N(R,O.isBadge,y.target.value,O.probability),placeholder:"Item Code"}),t("input",{type:"number",className:"form-control form-control-sm",value:O.probability,onChange:y=>N(R,O.isBadge,O.itemCode,Number(y.target.value)),placeholder:"Probability"}),R>0&&t(L,{variant:"danger",onClick:y=>b(R),children:t(Pi,{className:"fa-icon"})})]},R))})]})},zO=a=>{const[e,n]=i.useState(1),[r,o]=i.useState(1),[s,c]=i.useState(1),{trigger:u=null,setIntParams:m=null}=ve(),h=()=>m([e,r,s]);return i.useEffect(()=>{u.intData.length>=2?(n(u.intData[0]),o(u.intData[1]),c(u.intData[2])):(n(1),o(1),c(1))},[u]),l(dt,{requiresFurni:ie.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!0,save:h,children:[l(T,{gap:1,children:[t(S,{bold:!0,children:d("wiredfurni.params.setpoints",["points"],[e.toString()])}),t(Dt,{className:"nitro-slider",min:1,max:100,value:e,onChange:g=>n(g)})]}),l(T,{gap:1,children:[t(S,{bold:!0,children:d("wiredfurni.params.settimesingame",["times"],[r.toString()])}),t(Dt,{className:"nitro-slider",min:1,max:10,value:r,onChange:g=>o(g)})]}),l(T,{gap:1,children:[t(S,{bold:!0,children:d("wiredfurni.params.team")}),[1,2,3,4].map(g=>l(w,{gap:1,children:[t("input",{className:"form-check-input",type:"radio",name:"selectedTeam",id:`selectedTeam${g}`,checked:s===g,onChange:f=>c(g)}),t(S,{children:d("wiredfurni.params.team."+g)})]},g))]})]})},$O=a=>{const[e,n]=i.useState(1),[r,o]=i.useState(1),{trigger:s=null,setIntParams:c=null}=ve(),u=()=>c([e,r]);return i.useEffect(()=>{s.intData.length>=2?(n(s.intData[0]),o(s.intData[1])):(n(1),o(1))},[s]),l(dt,{requiresFurni:ie.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!0,save:u,children:[l(T,{gap:1,children:[t(S,{bold:!0,children:d("wiredfurni.params.setpoints",["points"],[e.toString()])}),t(Dt,{className:"nitro-slider",min:1,max:100,value:e,onChange:m=>n(m)})]}),l(T,{gap:1,children:[t(S,{bold:!0,children:d("wiredfurni.params.settimesingame",["times"],[r.toString()])}),t(Dt,{className:"nitro-slider",min:1,max:10,value:r,onChange:m=>o(m)})]})]})},KO=a=>{const[e,n]=i.useState(-1),{trigger:r=null,setIntParams:o=null}=ve(),s=()=>o([e]);return i.useEffect(()=>{n(r.intData.length>0?r.intData[0]:0)},[r]),t(dt,{requiresFurni:ie.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!0,save:s,children:l(T,{gap:1,children:[t(S,{bold:!0,children:d("wiredfurni.params.team")}),[1,2,3,4].map(c=>l(w,{gap:1,children:[t("input",{className:"form-check-input",type:"radio",name:"selectedTeam",id:`selectedTeam${c}`,checked:e===c,onChange:u=>n(c)}),t(S,{children:d(`wiredfurni.params.team.${c}`)})]},c))]})})},XO=a=>{const[e,n]=i.useState(""),{trigger:r=null,setStringParam:o=null}=ve(),s=()=>o(e);return i.useEffect(()=>{n(r.stringData)},[r]),t(dt,{requiresFurni:ie.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!0,save:s,children:l(T,{gap:1,children:[t(S,{bold:!0,children:d("wiredfurni.params.message")}),t("input",{type:"text",className:"form-control form-control-sm",value:e,onChange:c=>n(c.target.value),maxLength:K("wired.action.kick.from.room.max.length",100)})]})})},QO=a=>t(dt,{requiresFurni:ie.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!1,save:null}),JO=[{value:0,icon:"ne"},{value:2,icon:"se"},{value:4,icon:"sw"},{value:6,icon:"nw"}],ZO=[0,1,2,3,4,5,6],eA=a=>{const[e,n]=i.useState(-1),[r,o]=i.useState(-1),{trigger:s=null,setIntParams:c=null}=ve(),u=()=>c([e,r]);return i.useEffect(()=>{s.intData.length>=2?(n(s.intData[0]),o(s.intData[1])):(n(-1),o(-1))},[s]),l(dt,{requiresFurni:ie.STUFF_SELECTION_OPTION_BY_ID_BY_TYPE_OR_FROM_CONTEXT,hasSpecialInput:!0,save:u,children:[l(T,{gap:1,children:[t(S,{bold:!0,children:d("wiredfurni.params.startdir")}),t(w,{gap:1,children:JO.map(m=>l(w,{alignItems:"center",gap:1,children:[t("input",{className:"form-check-input",type:"radio",name:"movement",id:`movement${m.value}`,checked:e===m.value,onChange:h=>n(m.value)}),t(S,{children:t("i",{className:`icon icon-${m.icon}`})})]},m.value))})]}),l(T,{gap:1,children:[t(S,{bold:!0,children:d("wiredfurni.params.turn")}),ZO.map(m=>l(w,{alignItems:"center",gap:1,children:[t("input",{className:"form-check-input",type:"radio",name:"rotation",id:`rotation${m}`,checked:r===m,onChange:h=>o(m)}),t(S,{children:d(`wiredfurni.params.turn.${m}`)})]},m))]})]})},tA=[{value:0,icon:"ne"},{value:2,icon:"se"},{value:4,icon:"sw"},{value:6,icon:"nw"}],nA=a=>{const[e,n]=i.useState(-1),[r,o]=i.useState(-1),{trigger:s=null,setIntParams:c=null}=ve(),u=()=>c([r,e]);return i.useEffect(()=>{s.intData.length>=2?(n(s.intData[1]),o(s.intData[0])):(n(-1),o(-1))},[s]),l(dt,{requiresFurni:ie.STUFF_SELECTION_OPTION_BY_ID_OR_BY_TYPE,hasSpecialInput:!0,save:u,children:[l(T,{gap:1,children:[t(S,{bold:!0,children:d("wiredfurni.params.emptytiles",["tiles"],[e.toString()])}),t(Dt,{className:"nitro-slider",min:1,max:5,value:e,onChange:m=>n(m)})]}),l(T,{gap:1,children:[t(S,{bold:!0,children:d("wiredfurni.params.startdir")}),t(w,{gap:1,children:tA.map(m=>l(w,{alignItems:"center",gap:1,children:[t("input",{className:"form-check-input",type:"radio",name:"movement",id:`movement${m.value}`,checked:r===m.value,onChange:h=>o(m.value)}),t(S,{children:t("i",{className:`icon icon-${m.icon}`})})]},m.value))})]})]})},rA=[{value:4,icon:"ne"},{value:5,icon:"se"},{value:6,icon:"sw"},{value:7,icon:"nw"},{value:2,icon:"mv-2"},{value:3,icon:"mv-3"},{value:1,icon:"mv-1"}],sA=[0,1,2,3],aA=a=>{const[e,n]=i.useState(-1),[r,o]=i.useState(-1),{trigger:s=null,setIntParams:c=null}=ve(),u=()=>c([e,r]);return i.useEffect(()=>{s.intData.length>=2?(n(s.intData[0]),o(s.intData[1])):(n(-1),o(-1))},[s]),l(dt,{requiresFurni:ie.STUFF_SELECTION_OPTION_BY_ID_BY_TYPE_OR_FROM_CONTEXT,hasSpecialInput:!0,save:u,children:[l(T,{gap:1,children:[t(S,{bold:!0,children:d("wiredfurni.params.movefurni")}),l(w,{alignItems:"center",gap:1,children:[t("input",{className:"form-check-input",type:"radio",name:"selectedTeam",id:"movement0",checked:e===0,onChange:m=>n(0)}),t(S,{children:d("wiredfurni.params.movefurni.0")})]}),l(w,{gap:1,children:[rA.map(m=>l(w,{alignItems:"center",gap:1,children:[t("input",{className:"form-check-input",type:"radio",name:"movement",id:`movement${m.value}`,checked:e===m.value,onChange:h=>n(m.value)}),t("i",{className:`icon icon-${m.icon}`})]},m.value)),t("div",{className:"col"})]})]}),l(T,{gap:1,children:[t(S,{bold:!0,children:d("wiredfurni.params.rotatefurni")}),sA.map(m=>l(w,{alignItems:"center",gap:1,children:[t("input",{className:"form-check-input",type:"radio",name:"rotation",id:`rotation${m}`,checked:r===m,onChange:h=>o(m)}),l(S,{children:[[1,2].includes(m)&&t("i",{className:`icon icon-rot-${m}`}),d(`wiredfurni.params.rotatefurni.${m}`)]})]},m))]})]})},oA=a=>{const[e,n]=i.useState(-1),[r,o]=i.useState(""),{trigger:s=null,setIntParams:c=null,setStringParam:u=null}=ve(),m=()=>{c([e]),u(r)};return i.useEffect(()=>{n(s.intData.length>0?s.intData[0]:0),o(s.stringData)},[s]),l(dt,{requiresFurni:ie.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!0,save:m,children:[l(T,{gap:1,children:[t(S,{bold:!0,children:d("wiredfurni.params.length.minutes",["minutes"],[e.toString()])}),t(Dt,{className:"nitro-slider",min:1,max:10,value:e,onChange:h=>n(h)})]}),l(T,{gap:1,children:[t(S,{bold:!0,children:d("wiredfurni.params.message")}),t("input",{type:"text",className:"form-control form-control-sm",value:r,onChange:h=>o(h.target.value),maxLength:K("wired.action.mute.user.max.length",100)})]})]})},iA=a=>t(dt,{requiresFurni:ie.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!1,save:null}),lA=a=>{const[e,n]=i.useState(0),[r,o]=i.useState(0),[s,c]=i.useState(0),{trigger:u=null,setIntParams:m=null}=ve(),h=()=>m([e,r,s]);return i.useEffect(()=>{n(u.getBoolean(0)?1:0),o(u.getBoolean(1)?1:0),c(u.getBoolean(2)?1:0)},[u]),t(dt,{requiresFurni:ie.STUFF_SELECTION_OPTION_BY_ID,hasSpecialInput:!0,save:h,children:l(T,{gap:1,children:[t(S,{bold:!0,children:d("wiredfurni.params.conditions")}),l(w,{alignItems:"center",gap:1,children:[t("input",{className:"form-check-input",type:"checkbox",id:"stateFlag",checked:!!e,onChange:g=>n(g.target.checked?1:0)}),t(S,{children:d("wiredfurni.params.condition.state")})]}),l(w,{alignItems:"center",gap:1,children:[t("input",{className:"form-check-input",type:"checkbox",id:"directionFlag",checked:!!r,onChange:g=>o(g.target.checked?1:0)}),t(S,{children:d("wiredfurni.params.condition.direction")})]}),l(w,{alignItems:"center",gap:1,children:[t("input",{className:"form-check-input",type:"checkbox",id:"positionFlag",checked:!!s,onChange:g=>c(g.target.checked?1:0)}),t(S,{children:d("wiredfurni.params.condition.position")})]})]})})},cA=a=>t(dt,{requiresFurni:ie.STUFF_SELECTION_OPTION_BY_ID_BY_TYPE_OR_FROM_CONTEXT,hasSpecialInput:!1,save:null}),uA=a=>t(dt,{requiresFurni:ie.STUFF_SELECTION_OPTION_BY_ID_BY_TYPE_OR_FROM_CONTEXT,hasSpecialInput:!1,save:null}),dA=a=>{switch(a){case he.BOT_CHANGE_FIGURE:return t(MO,{});case he.BOT_FOLLOW_AVATAR:return t(LO,{});case he.BOT_GIVE_HAND_ITEM:return t(xO,{});case he.BOT_MOVE:return t(FO,{});case he.BOT_TALK:return t(BO,{});case he.BOT_TALK_DIRECT_TO_AVTR:return t(GO,{});case he.BOT_TELEPORT:return t(VO,{});case he.CALL_ANOTHER_STACK:return t(HO,{});case he.CHASE:return t(WO,{});case he.CHAT:return t(jO,{});case he.FLEE:return t(qO,{});case he.GIVE_REWARD:return t(YO,{});case he.GIVE_SCORE:return t($O,{});case he.GIVE_SCORE_TO_PREDEFINED_TEAM:return t(zO,{});case he.JOIN_TEAM:return t(KO,{});case he.KICK_FROM_ROOM:return t(XO,{});case he.LEAVE_TEAM:return t(QO,{});case he.MOVE_FURNI:return t(aA,{});case he.MOVE_AND_ROTATE_FURNI:return t(eA,{});case he.MOVE_FURNI_TO:return t(nA,{});case he.MUTE_USER:return t(oA,{});case he.RESET:return t(iA,{});case he.SET_FURNI_STATE:return t(lA,{});case he.TELEPORT:return t(cA,{});case he.TOGGLE_FURNI_STATE:return t(uA,{})}return null},Zt=a=>{const{requiresFurni:e=ie.STUFF_SELECTION_OPTION_NONE,save:n=null,hasSpecialInput:r=!1,children:o=null}=a;return t(dl,{wiredType:"condition",requiresFurni:e,hasSpecialInput:r,save:()=>n&&n(),children:o})},mA=[2,5,7,8,9,10,27],gA=a=>{const[e,n]=i.useState(-1),{trigger:r=null,setIntParams:o=null}=ve(),s=()=>o([e]);return i.useEffect(()=>{n(r.intData.length>0?r.intData[0]:0)},[r]),t(Zt,{requiresFurni:ie.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!0,save:s,children:l(T,{gap:1,children:[t(S,{bold:!0,children:d("wiredfurni.params.handitem")}),t("select",{className:"form-select form-select-sm",value:e,onChange:c=>n(parseInt(c.target.value)),children:mA.map(c=>t("option",{value:c,children:d(`handitem${c}`)},c))})]})})},hA=a=>t(Zt,{requiresFurni:ie.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!1,save:null}),fA=a=>t(Zt,{requiresFurni:ie.STUFF_SELECTION_OPTION_BY_ID,hasSpecialInput:!1,save:null}),pA=[1,2,3,4],IA=a=>{const[e,n]=i.useState(-1),{trigger:r=null,setIntParams:o=null}=ve(),s=()=>o([e]);return i.useEffect(()=>{n(r.intData.length>0?r.intData[0]:0)},[r]),t(Zt,{requiresFurni:ie.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!0,save:s,children:l(T,{gap:1,children:[t(S,{bold:!0,children:d("wiredfurni.params.team")}),pA.map(c=>l(w,{gap:1,alignItems:"center",children:[t("input",{className:"form-check-input",type:"radio",name:"selectedTeam",id:`selectedTeam${c}`,checked:e===c,onChange:u=>n(c)}),t(S,{children:d(`wiredfurni.params.team.${c}`)})]},c))]})})},EA=a=>{const[e,n]=i.useState(""),{trigger:r=null,setStringParam:o=null}=ve(),s=()=>o(e);return i.useEffect(()=>{n(r.stringData)},[r]),t(Zt,{requiresFurni:ie.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!0,save:s,children:l(T,{gap:1,children:[t(S,{bold:!0,children:d("wiredfurni.params.badgecode")}),t("input",{type:"text",className:"form-control form-control-sm",value:e,onChange:c=>n(c.target.value)})]})})},_A=a=>{const[e,n]=i.useState(-1),{trigger:r=null,setIntParams:o=null}=ve(),s=()=>o([e]);return i.useEffect(()=>{n((r==null?void 0:r.intData[0])??0)},[r]),t(Zt,{requiresFurni:ie.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!0,save:s,children:l(T,{gap:1,children:[t(S,{bold:!0,children:d("wiredfurni.tooltip.effectid")}),t("input",{type:"number",className:"form-control form-control-sm",value:e,onChange:c=>n(parseInt(c.target.value))})]})})},CA=a=>{const[e,n]=i.useState(""),[r,o]=i.useState(""),{trigger:s=null,setIntParams:c=null}=ve(),u=()=>{let m=0,h=0;const g=new Date(e),f=new Date(r);g&&f&&(m=g.getTime()/1e3,h=f.getTime()/1e3),c([m,h])};return i.useEffect(()=>{if(s.intData.length>=2){let m=new Date,h=new Date;s.intData[0]>0&&(m=new Date(s.intData[0]*1e3)),s.intData[1]>0&&(h=new Date(s.intData[1]*1e3)),n(Jl(m)),o(Jl(h))}},[s]),l(Zt,{requiresFurni:ie.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!0,save:u,children:[l(T,{gap:1,children:[t(S,{bold:!0,children:d("wiredfurni.params.startdate")}),t("input",{type:"text",className:"form-control form-control-sm",value:e,onChange:m=>n(m.target.value)})]}),l(T,{gap:1,children:[t(S,{bold:!0,children:d("wiredfurni.params.enddate")}),t("input",{type:"text",className:"form-control form-control-sm",value:r,onChange:m=>o(m.target.value)})]})]})},bA=a=>t(Zt,{requiresFurni:ie.STUFF_SELECTION_OPTION_BY_ID,hasSpecialInput:!1,save:null}),SA=a=>{const[e,n]=i.useState(-1),{trigger:r=null,setIntParams:o=null}=ve(),s=()=>o([e]);return i.useEffect(()=>{n(r.intData.length>0?r.intData[0]:0)},[r]),t(Zt,{requiresFurni:ie.STUFF_SELECTION_OPTION_BY_ID,hasSpecialInput:!0,save:s,children:l(T,{gap:1,children:[t(S,{bold:!0,children:d("wiredfurni.params.requireall")}),[0,1].map(c=>l(w,{alignItems:"center",gap:1,children:[t("input",{className:"form-check-input",type:"radio",name:"requireAll",id:`requireAll${c}`,checked:e===c,onChange:u=>n(c)}),t(S,{children:d("wiredfurni.params.requireall."+c)})]},c))]})})},NA=a=>{const[e,n]=i.useState(-1),{trigger:r=null,setIntParams:o=null}=ve(),s=()=>o([e]);return i.useEffect(()=>{n(r.intData.length>0?r.intData[0]:0)},[r]),t(Zt,{requiresFurni:ie.STUFF_SELECTION_OPTION_BY_ID,hasSpecialInput:!0,save:s,children:l(T,{gap:1,children:[t(S,{bold:!0,children:d("wiredfurni.params.not_requireall")}),[0,1].map(c=>l(w,{alignItems:"center",gap:1,children:[t("input",{className:"form-check-input",type:"radio",name:"requireAll",id:`requireAll${c}`,checked:e===c,onChange:u=>n(c)}),t(S,{children:d(`wiredfurni.params.not_requireall.${c}`)})]},c))]})})},TA=a=>t(Zt,{requiresFurni:ie.STUFF_SELECTION_OPTION_BY_ID_OR_BY_TYPE,hasSpecialInput:!1,save:null}),vA=a=>{const[e,n]=i.useState(0),[r,o]=i.useState(0),[s,c]=i.useState(0),{trigger:u=null,setIntParams:m=null}=ve(),h=()=>m([e,r,s]);return i.useEffect(()=>{n(u.getBoolean(0)?1:0),o(u.getBoolean(1)?1:0),c(u.getBoolean(2)?1:0)},[u]),t(Zt,{requiresFurni:ie.STUFF_SELECTION_OPTION_BY_ID,hasSpecialInput:!0,save:h,children:l(T,{gap:1,children:[t(S,{bold:!0,children:d("wiredfurni.params.conditions")}),l(w,{alignItems:"center",gap:1,children:[t("input",{className:"form-check-input",type:"checkbox",id:"stateFlag",checked:!!e,onChange:g=>n(g.target.checked?1:0)}),t(S,{children:d("wiredfurni.params.condition.state")})]}),l(w,{alignItems:"center",gap:1,children:[t("input",{className:"form-check-input",type:"checkbox",id:"directionFlag",checked:!!r,onChange:g=>o(g.target.checked?1:0)}),t(S,{children:d("wiredfurni.params.condition.direction")})]}),l(w,{alignItems:"center",gap:1,children:[t("input",{className:"form-check-input",type:"checkbox",id:"positionFlag",checked:!!s,onChange:g=>c(g.target.checked?1:0)}),t(S,{children:d("wiredfurni.params.condition.position")})]})]})})},wA=a=>{const[e,n]=i.useState(-1),{trigger:r=null,setIntParams:o=null}=ve(),s=()=>o([e]);return i.useEffect(()=>{n(r.intData.length>0?r.intData[0]:0)},[r]),t(Zt,{requiresFurni:ie.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!0,save:s,children:l(T,{gap:1,children:[t(S,{bold:!0,children:d("wiredfurni.params.allowbefore",["seconds"],[na(e)])}),t(Dt,{className:"nitro-slider",min:1,max:1200,value:e,onChange:c=>n(c)})]})})},RA=a=>{const[e,n]=i.useState(-1),{trigger:r=null,setIntParams:o=null}=ve(),s=()=>o([e]);return i.useEffect(()=>{n(r.intData.length>0?r.intData[0]:0)},[r]),t(Zt,{requiresFurni:ie.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!0,save:s,children:l(T,{gap:1,children:[t(S,{bold:!0,children:d("wiredfurni.params.allowafter",["seconds"],[na(e)])}),t(Dt,{className:"nitro-slider",min:1,max:1200,value:e,onChange:c=>n(c)})]})})},yA=a=>{const[e,n]=i.useState(1),[r,o]=i.useState(1),{trigger:s=null,setIntParams:c=null}=ve(),u=()=>c([e,r]);return i.useEffect(()=>{s.intData.length>=2?(n(s.intData[0]),o(s.intData[1])):(n(1),o(1))},[s]),l(Zt,{requiresFurni:ie.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!0,save:u,children:[l(T,{gap:1,children:[t(S,{bold:!0,children:d("wiredfurni.params.usercountmin",["value"],[e.toString()])}),t(Dt,{className:"nitro-slider",min:1,max:50,value:e,onChange:m=>n(m)})]}),l(T,{gap:1,children:[t(S,{bold:!0,children:d("wiredfurni.params.usercountmax",["value"],[r.toString()])}),t(Dt,{className:"nitro-slider",min:1,max:50,value:r,onChange:m=>o(m)})]})]})},OA=a=>{switch(a){case fe.ACTOR_HAS_HANDITEM:return t(gA,{});case fe.ACTOR_IS_GROUP_MEMBER:case fe.NOT_ACTOR_IN_GROUP:return t(hA,{});case fe.ACTOR_IS_ON_FURNI:case fe.NOT_ACTOR_ON_FURNI:return t(fA,{});case fe.ACTOR_IS_IN_TEAM:case fe.NOT_ACTOR_IN_TEAM:return t(IA,{});case fe.ACTOR_IS_WEARING_BADGE:case fe.NOT_ACTOR_WEARS_BADGE:return t(EA,{});case fe.ACTOR_IS_WEARING_EFFECT:case fe.NOT_ACTOR_WEARING_EFFECT:return t(_A,{});case fe.DATE_RANGE_ACTIVE:return t(CA,{});case fe.FURNIS_HAVE_AVATARS:case fe.FURNI_NOT_HAVE_HABBO:return t(bA,{});case fe.HAS_STACKED_FURNIS:return t(SA,{});case fe.NOT_HAS_STACKED_FURNIS:return t(NA,{});case fe.STUFF_TYPE_MATCHES:case fe.NOT_FURNI_IS_OF_TYPE:return t(TA,{});case fe.STATES_MATCH:case fe.NOT_STATES_MATCH:return t(vA,{});case fe.TIME_ELAPSED_LESS:return t(wA,{});case fe.TIME_ELAPSED_MORE:return t(RA,{});case fe.USER_COUNT_IN:case fe.NOT_USER_COUNT_IN:return t(yA,{})}return null},hn=a=>{const{requiresFurni:e=ie.STUFF_SELECTION_OPTION_NONE,save:n=null,hasSpecialInput:r=!1,children:o=null}=a;return t(dl,{wiredType:"trigger",requiresFurni:e,hasSpecialInput:r,save:()=>n&&n(),children:o})},AA=a=>{const[e,n]=i.useState(""),[r,o]=i.useState(0),{trigger:s=null,setStringParam:c=null}=ve(),u=()=>c(r===1?e:"");return i.useEffect(()=>{n(s.stringData),o(s.stringData?1:0)},[s]),t(hn,{requiresFurni:ie.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!0,save:u,children:l(T,{gap:1,children:[t(S,{bold:!0,children:d("wiredfurni.params.picktriggerer")}),l(w,{alignItems:"center",gap:1,children:[t("input",{className:"form-check-input",type:"radio",name:"avatarMode",id:"avatarMode0",checked:r===0,onChange:m=>o(0)}),t(S,{children:d("wiredfurni.params.anyavatar")})]}),l(w,{alignItems:"center",gap:1,children:[t("input",{className:"form-check-input",type:"radio",name:"avatarMode",id:"avatarMode1",checked:r===1,onChange:m=>o(1)}),t(S,{children:d("wiredfurni.params.certainavatar")})]}),r===1&&t("input",{type:"text",className:"form-control form-control-sm",value:e,onChange:m=>n(m.target.value)})]})})},kA=a=>{const[e,n]=i.useState(""),[r,o]=i.useState(-1),{trigger:s=null,setStringParam:c=null,setIntParams:u=null}=ve(),m=()=>{c(e),u([r])};return i.useEffect(()=>{n(s.stringData),o(s.intData.length>0?s.intData[0]:0)},[s]),l(hn,{requiresFurni:ie.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!0,save:m,children:[l(T,{gap:1,children:[t(S,{bold:!0,children:d("wiredfurni.params.whatissaid")}),t("input",{type:"text",className:"form-control form-control-sm",value:e,onChange:h=>n(h.target.value)})]}),l(T,{gap:1,children:[t(S,{bold:!0,children:d("wiredfurni.params.picktriggerer")}),l(w,{alignItems:"center",gap:1,children:[t("input",{className:"form-check-input",type:"radio",name:"triggererAvatar",id:"triggererAvatar0",checked:r===0,onChange:h=>o(0)}),t(S,{children:d("wiredfurni.params.anyavatar")})]}),l(w,{alignItems:"center",gap:1,children:[t("input",{className:"form-check-input",type:"radio",name:"triggererAvatar",id:"triggererAvatar1",checked:r===1,onChange:h=>o(1)}),t(S,{children:H().userName})]})]})]})},PA=a=>t(hn,{requiresFurni:ie.STUFF_SELECTION_OPTION_BY_ID_OR_BY_TYPE,hasSpecialInput:!1,save:null}),DA=a=>t(hn,{requiresFurni:ie.STUFF_SELECTION_OPTION_BY_ID_OR_BY_TYPE,hasSpecialInput:!1,save:null}),MA=a=>{const[e,n]=i.useState(""),{trigger:r=null,setStringParam:o=null}=ve(),s=()=>o(e);return i.useEffect(()=>{n(r.stringData)},[r]),t(hn,{requiresFurni:ie.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!0,save:s,children:l(T,{gap:1,children:[t(S,{bold:!0,children:d("wiredfurni.params.bot.name")}),t("input",{type:"text",className:"form-control form-control-sm",maxLength:32,value:e,onChange:c=>n(c.target.value)})]})})},LA=a=>{const[e,n]=i.useState(""),{trigger:r=null,setStringParam:o=null}=ve(),s=()=>o(e);return i.useEffect(()=>{n(r.stringData)},[r]),t(hn,{requiresFurni:ie.STUFF_SELECTION_OPTION_BY_ID_OR_BY_TYPE,hasSpecialInput:!0,save:s,children:l(T,{gap:1,children:[t(S,{bold:!0,children:d("wiredfurni.params.bot.name")}),t("input",{type:"text",className:"form-control form-control-sm",maxLength:32,value:e,onChange:c=>n(c.target.value)})]})})},UA=a=>t(hn,{requiresFurni:ie.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!1,save:null}),xA=a=>{const[e,n]=i.useState(1),{trigger:r=null,setIntParams:o=null}=ve(),s=()=>o([e]);return i.useEffect(()=>{n(r.intData.length>0?r.intData[0]:0)},[r]),t(hn,{requiresFurni:ie.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!0,save:s,children:l(T,{gap:1,children:[t(S,{bold:!0,children:d("wiredfurni.params.settime",["seconds"],[na(e)])}),t(Dt,{className:"nitro-slider",min:1,max:1200,value:e,onChange:c=>n(c)})]})})},FA=a=>{const[e,n]=i.useState(1),{trigger:r=null,setIntParams:o=null}=ve(),s=()=>o([e]);return i.useEffect(()=>{n(r.intData.length>0?r.intData[0]:0)},[r]),t(hn,{requiresFurni:ie.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!0,save:s,children:l(T,{gap:1,children:[t(S,{bold:!0,children:d("wiredfurni.params.setlongtime",["time"],[Hn.format(e*5).toString()])}),t(Dt,{className:"nitro-slider",min:1,max:120,value:e,onChange:c=>n(c)})]})})},GA=a=>{const[e,n]=i.useState(1),{trigger:r=null,setIntParams:o=null}=ve(),s=()=>o([e]);return i.useEffect(()=>{n(r.intData.length>0?r.intData[0]:0)},[r]),t(hn,{requiresFurni:ie.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!0,save:s,children:l(T,{gap:1,children:[t(S,{bold:!0,children:d("wiredfurni.params.settime",["seconds"],[na(e)])}),t(Dt,{className:"nitro-slider",min:1,max:60,value:e,onChange:c=>n(c)})]})})},BA=a=>t(hn,{requiresFurni:ie.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!1,save:null}),VA=a=>t(hn,{requiresFurni:ie.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!1,save:null}),HA=a=>{const[e,n]=i.useState(1),{trigger:r=null,setIntParams:o=null}=ve(),s=()=>o([e]);return i.useEffect(()=>{n(r.intData.length>0?r.intData[0]:0)},[r]),t(hn,{requiresFurni:ie.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!0,save:s,children:l(T,{gap:1,children:[t(S,{bold:!0,children:d("wiredfurni.params.setscore",["points"],[e.toString()])}),t(Dt,{className:"nitro-slider",min:1,max:1e3,value:e,onChange:c=>n(c)})]})})},WA=a=>t(hn,{requiresFurni:ie.STUFF_SELECTION_OPTION_BY_ID_OR_BY_TYPE,hasSpecialInput:!1,save:null}),jA=a=>{switch(a){case Je.AVATAR_ENTERS_ROOM:return t(AA,{});case Je.AVATAR_SAYS_SOMETHING:return t(kA,{});case Je.AVATAR_WALKS_OFF_FURNI:return t(PA,{});case Je.AVATAR_WALKS_ON_FURNI:return t(DA,{});case Je.BOT_REACHED_AVATAR:return t(MA,{});case Je.BOT_REACHED_STUFF:return t(LA,{});case Je.COLLISION:return t(UA,{});case Je.EXECUTE_ONCE:return t(xA,{});case Je.EXECUTE_PERIODICALLY:return t(GA,{});case Je.EXECUTE_PERIODICALLY_LONG:return t(FA,{});case Je.GAME_ENDS:return t(BA,{});case Je.GAME_STARTS:return t(VA,{});case Je.SCORE_ACHIEVED:return t(HA,{});case Je.TOGGLE_FURNI:return t(WA,{})}return null},qA=a=>{const{trigger:e=null}=ve();return e?e instanceof Au?dA(e.code):e instanceof ku?jA(e.code):e instanceof Pu?OA(e.code):null:null},YA=a=>{const[e,n]=i.useState(!1),[r,o]=i.useState(!0);return Ye(qt.CREATED,s=>o(!1)),Ye(qt.ENDED,s=>o(s.openLandingView)),i.useEffect(()=>{n(!0),Bs().connection.onReady()},[]),i.useEffect(()=>{const s={linkReceived:c=>{const u=c.split("/");if(!(u.length<2))switch(u[1]){case"open":if(u.length>2)switch(u[2]){case"credits":break;default:{const m=u[2];$s.openHabblet(m)}}return}},eventUrlPrefix:"habblet/"};return _t(s),()=>Ct(s)},[]),l(U,{fit:!0,children:[t(ra,{type:wt.FADE_IN,inProp:r,timeout:300,children:t(Mw,{})}),t(TO,{isInRoom:!r}),t(oR,{}),t(SO,{}),t(uv,{}),t(qA,{}),t(fT,{}),t(oT,{}),t(bR,{}),t(qw,{}),t(cv,{}),t(Mv,{}),t(YR,{}),t(kO,{}),t(AO,{}),t(Qv,{}),t(ST,{}),t(Rw,{}),t(NR,{}),t(lw,{}),t(cw,{}),t(vT,{}),t(Fv,{}),t(bv,{})]})};hu.UI_VERSION=md();const zA=a=>{const[e,n]=i.useState(!1),[r,o]=i.useState(!1),[s,c]=i.useState("Getting Ready"),[u,m]=i.useState(0),[h,g]=i.useState(!0);if(!_e()){if(!NitroConfig)throw new Error("NitroConfig is not defined!");ls.bootstrap()}const f=i.useCallback(async _=>{switch(_.type){case ha.LOADED:_e().localization.init(),m(E=>E+20);return;case ha.FAILED:o(!0),c("Configuration Failed");return;case ls.WEBGL_UNAVAILABLE:o(!0),c("WebGL Required");return;case ls.WEBGL_CONTEXT_LOST:o(!0),c("WebGL Context Lost - Reloading"),setTimeout(()=>window.location.reload(),1500);return;case Kn.CONNECTION_HANDSHAKING:m(E=>E+20);return;case Kn.CONNECTION_HANDSHAKE_FAILED:o(!0),c("Handshake Failed");return;case Kn.CONNECTION_AUTHENTICATED:m(E=>E+20),_e().init(),Gs.available&&Gs.call("legacyTrack","authentication","authok",[]);return;case Kn.CONNECTION_ERROR:o(!0),c("Connection Error");return;case Kn.CONNECTION_CLOSED:c("Connection Error"),$s.send(-1,"client.init.handshake.fail");return;case pn.ENGINE_INITIALIZED:m(E=>E+20),setTimeout(()=>n(!0),300);return;case Ml.LOADED:{const E=K("preload.assets.urls"),I=[];if(E&&E.length)for(const p of E)I.push(ur.interpolate(p));await xu().downloadAssets(I)?(Bs().init(),m(p=>p+20)):(o(!0),c("Assets Failed"));return}}},[]);return Fr(ls.WEBGL_UNAVAILABLE,f),Fr(ls.WEBGL_CONTEXT_LOST,f),Fr(Kn.CONNECTION_HANDSHAKING,f),Fr(Kn.CONNECTION_HANDSHAKE_FAILED,f),Fr(Kn.CONNECTION_AUTHENTICATED,f),Fr(Kn.CONNECTION_ERROR,f),Fr(Kn.CONNECTION_CLOSED,f),Te(pn.ENGINE_INITIALIZED,f),zb(Ml.LOADED,f),tc(ha.LOADED,f),tc(ha.FAILED,f),i.useEffect(()=>{_e().core.configuration.init();const _=E=>g(!(window.devicePixelRatio%1));return window.addEventListener("resize",_),_(),()=>{window.removeEventListener("resize",_)}},[]),l(U,{fit:!0,overflow:"hidden",className:h&&"image-rendering-pixelated",children:[(!e||r)&&t(qb,{isError:r,message:s,percent:u}),t(ra,{type:wt.FADE_IN,inProp:e,children:t(YA,{})}),t(U,{id:"draggable-windows-container"})]})};$m(document.getElementById("root")).render(t(zA,{}));
